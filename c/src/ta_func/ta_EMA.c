// Type: TicTacTec.TA.Library.Core
// Assembly: TA-Lib-Core, Version=1.0.7312.40736, Culture=neutral, PublicKeyToken=fdb2a6b268f56aa5
// MVID: 867F7C4F-EEFF-4DDF-9CC2-24045281ADFF

using System;

namespace TicTacTec.TA.Library
{
  public static class Core
  {
    private static Core.GlobalsType Globals = new Core.GlobalsType();

    private static Core.RetCode TA_INT_EMA(
      int startIdx,
      int endIdx,
      float[] inReal_0,
      int optInTimePeriod_0,
      double optInK_1,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0)
    {
      int num1 = Core.EmaLookback(optInTimePeriod_0);
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode = Core.RetCode.Success;
      }
      else
      {
        outBegIdx = startIdx;
        int index1;
        double num2;
        if (Core.Globals.compatibility == Core.Compatibility.Default)
        {
          index1 = startIdx - num1;
          int num3 = optInTimePeriod_0;
          double num4 = 0.0;
          while (true)
          {
            int num5 = num3;
            --num3;
            if (num5 > 0)
            {
              num4 += (double) inReal_0[index1];
              ++index1;
            }
            else
              break;
          }
          num2 = num4 / (double) optInTimePeriod_0;
        }
        else
        {
          num2 = (double) inReal_0[0];
          index1 = 1;
        }
        for (; index1 <= startIdx; ++index1)
          num2 = ((double) inReal_0[index1] - num2) * optInK_1 + num2;
        outReal_0[0] = num2;
        int index2 = 1;
        while (index1 <= endIdx)
        {
          num2 = ((double) inReal_0[index1] - num2) * optInK_1 + num2;
          ++index1;
          outReal_0[index2] = num2;
          ++index2;
        }
        outNbElement = index2;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_EMA(
      int startIdx,
      int endIdx,
      double[] inReal_0,
      int optInTimePeriod_0,
      double optInK_1,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0)
    {
      int num1 = Core.EmaLookback(optInTimePeriod_0);
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode = Core.RetCode.Success;
      }
      else
      {
        outBegIdx = startIdx;
        int index1;
        double num2;
        if (Core.Globals.compatibility == Core.Compatibility.Default)
        {
          index1 = startIdx - num1;
          int num3 = optInTimePeriod_0;
          double num4 = 0.0;
          while (true)
          {
            int num5 = num3;
            --num3;
            if (num5 > 0)
            {
              num4 += inReal_0[index1];
              ++index1;
            }
            else
              break;
          }
          num2 = num4 / (double) optInTimePeriod_0;
        }
        else
        {
          num2 = inReal_0[0];
          index1 = 1;
        }
        for (; index1 <= startIdx; ++index1)
          num2 = (inReal_0[index1] - num2) * optInK_1 + num2;
        outReal_0[0] = num2;
        int index2 = 1;
        while (index1 <= endIdx)
        {
          num2 = (inReal_0[index1] - num2) * optInK_1 + num2;
          ++index1;
          outReal_0[index2] = num2;
          ++index2;
        }
        outNbElement = index2;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_SMA(
      int startIdx,
      int endIdx,
      float[] inReal_0,
      int optInTimePeriod_0,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0)
    {
      int num1 = optInTimePeriod_0 - 1;
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode = Core.RetCode.Success;
      }
      else
      {
        double num2 = 0.0;
        int index1 = startIdx - num1;
        int index2 = index1;
        if (optInTimePeriod_0 > 1)
        {
          for (; index2 < startIdx; ++index2)
            num2 += (double) inReal_0[index2];
        }
        int index3 = 0;
        do
        {
          double num3 = num2 + (double) inReal_0[index2];
          ++index2;
          double num4 = num3;
          num2 = num3 - (double) inReal_0[index1];
          ++index1;
          outReal_0[index3] = num4 / (double) optInTimePeriod_0;
          ++index3;
        }
        while (index2 <= endIdx);
        outNbElement = index3;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_SMA(
      int startIdx,
      int endIdx,
      double[] inReal_0,
      int optInTimePeriod_0,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0)
    {
      int num1 = optInTimePeriod_0 - 1;
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode = Core.RetCode.Success;
      }
      else
      {
        double num2 = 0.0;
        int index1 = startIdx - num1;
        int index2 = index1;
        if (optInTimePeriod_0 > 1)
        {
          for (; index2 < startIdx; ++index2)
            num2 += inReal_0[index2];
        }
        int index3 = 0;
        do
        {
          double num3 = num2 + inReal_0[index2];
          ++index2;
          double num4 = num3;
          num2 = num3 - inReal_0[index1];
          ++index1;
          outReal_0[index3] = num4 / (double) optInTimePeriod_0;
          ++index3;
        }
        while (index2 <= endIdx);
        outNbElement = index3;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_MACD(
      int startIdx,
      int endIdx,
      float[] inReal_0,
      int optInFastPeriod_0,
      int optInSlowPeriod_1,
      int optInSignalPeriod_2,
      out int outBegIdx,
      out int outNbElement,
      double[] outMACD_0,
      double[] outMACDSignal_1,
      double[] outMACDHist_2)
    {
      if (optInSlowPeriod_1 < optInFastPeriod_0)
      {
        int num = optInSlowPeriod_1;
        optInSlowPeriod_1 = optInFastPeriod_0;
        optInFastPeriod_0 = num;
      }
      double optInK_1_1;
      if (optInSlowPeriod_1 != 0)
      {
        optInK_1_1 = 2.0 / (double) (optInSlowPeriod_1 + 1);
      }
      else
      {
        optInSlowPeriod_1 = 26;
        optInK_1_1 = 0.075;
      }
      double optInK_1_2;
      if (optInFastPeriod_0 != 0)
      {
        optInK_1_2 = 2.0 / (double) (optInFastPeriod_0 + 1);
      }
      else
      {
        optInFastPeriod_0 = 12;
        optInK_1_2 = 0.15;
      }
      int sourceIndex = Core.EmaLookback(optInSignalPeriod_2);
      int num1 = sourceIndex + Core.EmaLookback(optInSlowPeriod_1);
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode1;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode1 = Core.RetCode.Success;
      }
      else
      {
        int length = endIdx - startIdx + 1 + sourceIndex;
        double[] numArray = new double[length];
        if (numArray == null)
        {
          outBegIdx = 0;
          outNbElement = 0;
          retCode1 = Core.RetCode.AllocErr;
        }
        else
        {
          double[] outReal_0 = new double[length];
          if (outReal_0 == null)
          {
            outBegIdx = 0;
            outNbElement = 0;
            retCode1 = Core.RetCode.AllocErr;
          }
          else
          {
            int startIdx1 = startIdx - sourceIndex;
            int outBegIdx1;
            int outNbElement1;
            Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx1, endIdx, inReal_0, optInSlowPeriod_1, optInK_1_1, out outBegIdx1, out outNbElement1, outReal_0);
            if (retCode2 != Core.RetCode.Success)
            {
              outBegIdx = 0;
              outNbElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              int outBegIdx2;
              int outNbElement2;
              Core.RetCode retCode3 = Core.TA_INT_EMA(startIdx1, endIdx, inReal_0, optInFastPeriod_0, optInK_1_2, out outBegIdx2, out outNbElement2, numArray);
              if (retCode3 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNbElement = 0;
                retCode1 = retCode3;
              }
              else if (outBegIdx1 != startIdx1 || outBegIdx2 != startIdx1 || (outNbElement1 != outNbElement2 || outNbElement1 != endIdx - startIdx + 1 + sourceIndex))
              {
                outBegIdx = 0;
                outNbElement = 0;
                retCode1 = Core.RetCode.InternalError;
              }
              else
              {
                for (int index = 0; index < outNbElement1; ++index)
                  numArray[index] = numArray[index] - outReal_0[index];
                Array.Copy((Array) numArray, sourceIndex, (Array) outMACD_0, 0, endIdx - startIdx + 1);
                Core.RetCode retCode4 = Core.TA_INT_EMA(0, outNbElement1 - 1, numArray, optInSignalPeriod_2, 2.0 / (double) (optInSignalPeriod_2 + 1), out outBegIdx2, out outNbElement2, outMACDSignal_1);
                if (retCode4 != Core.RetCode.Success)
                {
                  outBegIdx = 0;
                  outNbElement = 0;
                  retCode1 = retCode4;
                }
                else
                {
                  for (int index = 0; index < outNbElement2; ++index)
                    outMACDHist_2[index] = outMACD_0[index] - outMACDSignal_1[index];
                  outBegIdx = startIdx;
                  outNbElement = outNbElement2;
                  retCode1 = Core.RetCode.Success;
                }
              }
            }
          }
        }
      }
      return retCode1;
    }

    private static Core.RetCode TA_INT_MACD(
      int startIdx,
      int endIdx,
      double[] inReal_0,
      int optInFastPeriod_0,
      int optInSlowPeriod_1,
      int optInSignalPeriod_2,
      out int outBegIdx,
      out int outNbElement,
      double[] outMACD_0,
      double[] outMACDSignal_1,
      double[] outMACDHist_2)
    {
      if (optInSlowPeriod_1 < optInFastPeriod_0)
      {
        int num = optInSlowPeriod_1;
        optInSlowPeriod_1 = optInFastPeriod_0;
        optInFastPeriod_0 = num;
      }
      double optInK_1_1;
      if (optInSlowPeriod_1 != 0)
      {
        optInK_1_1 = 2.0 / (double) (optInSlowPeriod_1 + 1);
      }
      else
      {
        optInSlowPeriod_1 = 26;
        optInK_1_1 = 0.075;
      }
      double optInK_1_2;
      if (optInFastPeriod_0 != 0)
      {
        optInK_1_2 = 2.0 / (double) (optInFastPeriod_0 + 1);
      }
      else
      {
        optInFastPeriod_0 = 12;
        optInK_1_2 = 0.15;
      }
      int sourceIndex = Core.EmaLookback(optInSignalPeriod_2);
      int num1 = sourceIndex + Core.EmaLookback(optInSlowPeriod_1);
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode1;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode1 = Core.RetCode.Success;
      }
      else
      {
        int length = endIdx - startIdx + 1 + sourceIndex;
        double[] numArray = new double[length];
        if (numArray == null)
        {
          outBegIdx = 0;
          outNbElement = 0;
          retCode1 = Core.RetCode.AllocErr;
        }
        else
        {
          double[] outReal_0 = new double[length];
          if (outReal_0 == null)
          {
            outBegIdx = 0;
            outNbElement = 0;
            retCode1 = Core.RetCode.AllocErr;
          }
          else
          {
            int startIdx1 = startIdx - sourceIndex;
            int outBegIdx1;
            int outNbElement1;
            Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx1, endIdx, inReal_0, optInSlowPeriod_1, optInK_1_1, out outBegIdx1, out outNbElement1, outReal_0);
            if (retCode2 != Core.RetCode.Success)
            {
              outBegIdx = 0;
              outNbElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              int outBegIdx2;
              int outNbElement2;
              Core.RetCode retCode3 = Core.TA_INT_EMA(startIdx1, endIdx, inReal_0, optInFastPeriod_0, optInK_1_2, out outBegIdx2, out outNbElement2, numArray);
              if (retCode3 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNbElement = 0;
                retCode1 = retCode3;
              }
              else if (outBegIdx1 != startIdx1 || outBegIdx2 != startIdx1 || (outNbElement1 != outNbElement2 || outNbElement1 != endIdx - startIdx + 1 + sourceIndex))
              {
                outBegIdx = 0;
                outNbElement = 0;
                retCode1 = Core.RetCode.InternalError;
              }
              else
              {
                for (int index = 0; index < outNbElement1; ++index)
                  numArray[index] = numArray[index] - outReal_0[index];
                Array.Copy((Array) numArray, sourceIndex, (Array) outMACD_0, 0, endIdx - startIdx + 1);
                Core.RetCode retCode4 = Core.TA_INT_EMA(0, outNbElement1 - 1, numArray, optInSignalPeriod_2, 2.0 / (double) (optInSignalPeriod_2 + 1), out outBegIdx2, out outNbElement2, outMACDSignal_1);
                if (retCode4 != Core.RetCode.Success)
                {
                  outBegIdx = 0;
                  outNbElement = 0;
                  retCode1 = retCode4;
                }
                else
                {
                  for (int index = 0; index < outNbElement2; ++index)
                    outMACDHist_2[index] = outMACD_0[index] - outMACDSignal_1[index];
                  outBegIdx = startIdx;
                  outNbElement = outNbElement2;
                  retCode1 = Core.RetCode.Success;
                }
              }
            }
          }
        }
      }
      return retCode1;
    }

    private static Core.RetCode TA_INT_PO(
      int startIdx,
      int endIdx,
      float[] inReal_0,
      int optInFastPeriod_0,
      int optInSlowPeriod_1,
      Core.MAType optInMethod_2,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0,
      double[] tempBuffer,
      int doPercentageOutput)
    {
      if (optInSlowPeriod_1 < optInFastPeriod_0)
      {
        int num = optInSlowPeriod_1;
        optInSlowPeriod_1 = optInFastPeriod_0;
        optInFastPeriod_0 = num;
      }
      int outBegIdx1;
      Core.RetCode retCode = Core.MovingAverage(startIdx, endIdx, inReal_0, optInFastPeriod_0, optInMethod_2, out outBegIdx1, out int _, tempBuffer);
      if (retCode == Core.RetCode.Success)
      {
        int outBegIdx2;
        int outNBElement;
        retCode = Core.MovingAverage(startIdx, endIdx, inReal_0, optInSlowPeriod_1, optInMethod_2, out outBegIdx2, out outNBElement, outReal_0);
        if (retCode == Core.RetCode.Success)
        {
          int num1 = outBegIdx2 - outBegIdx1;
          if (doPercentageOutput != 0)
          {
            int index1 = 0;
            int index2 = num1;
            while (index1 < outNBElement)
            {
              double num2 = outReal_0[index1];
              outReal_0[index1] = -1E-08 >= num2 || num2 >= 1E-08 ? (tempBuffer[index2] - num2) / num2 * 100.0 : 0.0;
              ++index1;
              ++index2;
            }
          }
          else
          {
            int index1 = 0;
            int index2 = num1;
            while (index1 < outNBElement)
            {
              outReal_0[index1] = tempBuffer[index2] - outReal_0[index1];
              ++index1;
              ++index2;
            }
          }
          outBegIdx = outBegIdx2;
          outNbElement = outNBElement;
        }
      }
      if (retCode != Core.RetCode.Success)
      {
        outBegIdx = 0;
        outNbElement = 0;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_PO(
      int startIdx,
      int endIdx,
      double[] inReal_0,
      int optInFastPeriod_0,
      int optInSlowPeriod_1,
      Core.MAType optInMethod_2,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0,
      double[] tempBuffer,
      int doPercentageOutput)
    {
      if (optInSlowPeriod_1 < optInFastPeriod_0)
      {
        int num = optInSlowPeriod_1;
        optInSlowPeriod_1 = optInFastPeriod_0;
        optInFastPeriod_0 = num;
      }
      int outBegIdx1;
      Core.RetCode retCode = Core.MovingAverage(startIdx, endIdx, inReal_0, optInFastPeriod_0, optInMethod_2, out outBegIdx1, out int _, tempBuffer);
      if (retCode == Core.RetCode.Success)
      {
        int outBegIdx2;
        int outNBElement;
        retCode = Core.MovingAverage(startIdx, endIdx, inReal_0, optInSlowPeriod_1, optInMethod_2, out outBegIdx2, out outNBElement, outReal_0);
        if (retCode == Core.RetCode.Success)
        {
          int num1 = outBegIdx2 - outBegIdx1;
          if (doPercentageOutput != 0)
          {
            int index1 = 0;
            int index2 = num1;
            while (index1 < outNBElement)
            {
              double num2 = outReal_0[index1];
              outReal_0[index1] = -1E-08 >= num2 || num2 >= 1E-08 ? (tempBuffer[index2] - num2) / num2 * 100.0 : 0.0;
              ++index1;
              ++index2;
            }
          }
          else
          {
            int index1 = 0;
            int index2 = num1;
            while (index1 < outNBElement)
            {
              outReal_0[index1] = tempBuffer[index2] - outReal_0[index1];
              ++index1;
              ++index2;
            }
          }
          outBegIdx = outBegIdx2;
          outNbElement = outNBElement;
        }
      }
      if (retCode != Core.RetCode.Success)
      {
        outBegIdx = 0;
        outNbElement = 0;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_VAR(
      int startIdx,
      int endIdx,
      float[] inReal_0,
      int optInTimePeriod_0,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0)
    {
      int num1 = optInTimePeriod_0 - 1;
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode = Core.RetCode.Success;
      }
      else
      {
        double num2 = 0.0;
        double num3 = 0.0;
        int index1 = startIdx - num1;
        int index2 = index1;
        if (optInTimePeriod_0 > 1)
        {
          while (index2 < startIdx)
          {
            double num4 = (double) inReal_0[index2];
            ++index2;
            num2 += num4;
            double num5 = num4;
            double num6 = num5 * num5;
            num3 += num6;
          }
        }
        int num7 = 0;
        do
        {
          double num4 = (double) inReal_0[index2];
          ++index2;
          double num5 = num2 + num4;
          double num6 = num4;
          double num8 = num6 * num6;
          double num9 = num3 + num8;
          double num10 = num5 / (double) optInTimePeriod_0;
          double num11 = num9 / (double) optInTimePeriod_0;
          double num12 = (double) inReal_0[index1];
          ++index1;
          num2 = num5 - num12;
          double num13 = num12;
          double num14 = num13 * num13;
          num3 = num9 - num14;
          double[] numArray = outReal_0;
          int index3 = num7;
          double num15 = num11;
          double num16 = num10;
          double num17 = num16 * num16;
          double num18 = num15 - num17;
          numArray[index3] = num18;
          ++num7;
        }
        while (index2 <= endIdx);
        outNbElement = num7;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    private static Core.RetCode TA_INT_VAR(
      int startIdx,
      int endIdx,
      double[] inReal_0,
      int optInTimePeriod_0,
      out int outBegIdx,
      out int outNbElement,
      double[] outReal_0)
    {
      int num1 = optInTimePeriod_0 - 1;
      if (startIdx < num1)
        startIdx = num1;
      Core.RetCode retCode;
      if (startIdx > endIdx)
      {
        outBegIdx = 0;
        outNbElement = 0;
        retCode = Core.RetCode.Success;
      }
      else
      {
        double num2 = 0.0;
        double num3 = 0.0;
        int index1 = startIdx - num1;
        int index2 = index1;
        if (optInTimePeriod_0 > 1)
        {
          while (index2 < startIdx)
          {
            double num4 = inReal_0[index2];
            ++index2;
            num2 += num4;
            double num5 = num4;
            double num6 = num5 * num5;
            num3 += num6;
          }
        }
        int num7 = 0;
        do
        {
          double num4 = inReal_0[index2];
          ++index2;
          double num5 = num2 + num4;
          double num6 = num4;
          double num8 = num6 * num6;
          double num9 = num3 + num8;
          double num10 = num5 / (double) optInTimePeriod_0;
          double num11 = num9 / (double) optInTimePeriod_0;
          double num12 = inReal_0[index1];
          ++index1;
          num2 = num5 - num12;
          double num13 = num12;
          double num14 = num13 * num13;
          num3 = num9 - num14;
          double[] numArray = outReal_0;
          int index3 = num7;
          double num15 = num11;
          double num16 = num10;
          double num17 = num16 * num16;
          double num18 = num15 - num17;
          numArray[index3] = num18;
          ++num7;
        }
        while (index2 <= endIdx);
        outNbElement = num7;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    private static void TA_INT_stddev_using_precalc_ma(
      float[] inReal,
      double[] inMovAvg,
      int inMovAvgBegIdx,
      int inMovAvgNbElement,
      int timePeriod,
      double[] output)
    {
      int index1 = inMovAvgBegIdx + 1 - timePeriod;
      int index2 = inMovAvgBegIdx;
      double num1 = 0.0;
      for (int index3 = index1; index3 < index2; ++index3)
      {
        double num2 = (double) inReal[index3];
        double num3 = num2 * num2;
        num1 += num3;
      }
      int index4 = 0;
      while (index4 < inMovAvgNbElement)
      {
        double num2 = (double) inReal[index2];
        double num3 = num2 * num2;
        double num4 = num1 + num3;
        double num5 = num4 / (double) timePeriod;
        double num6 = (double) inReal[index1];
        double num7 = num6 * num6;
        num1 = num4 - num7;
        double num8 = inMovAvg[index4];
        double num9 = num8 * num8;
        double d = num5 - num9;
        output[index4] = d < 1E-08 ? 0.0 : Math.Sqrt(d);
        ++index4;
        ++index1;
        ++index2;
      }
    }

    private static void TA_INT_stddev_using_precalc_ma(
      double[] inReal,
      double[] inMovAvg,
      int inMovAvgBegIdx,
      int inMovAvgNbElement,
      int timePeriod,
      double[] output)
    {
      int index1 = inMovAvgBegIdx + 1 - timePeriod;
      int index2 = inMovAvgBegIdx;
      double num1 = 0.0;
      for (int index3 = index1; index3 < index2; ++index3)
      {
        double num2 = inReal[index3];
        double num3 = num2 * num2;
        num1 += num3;
      }
      int index4 = 0;
      while (index4 < inMovAvgNbElement)
      {
        double num2 = inReal[index2];
        double num3 = num2 * num2;
        double num4 = num1 + num3;
        double num5 = num4 / (double) timePeriod;
        double num6 = inReal[index1];
        double num7 = num6 * num6;
        num1 = num4 - num7;
        double num8 = inMovAvg[index4];
        double num9 = num8 * num8;
        double d = num5 - num9;
        output[index4] = d < 1E-08 ? 0.0 : Math.Sqrt(d);
        ++index4;
        ++index1;
        ++index2;
      }
    }

    static Core()
    {
      int num = (int) Core.RestoreCandleDefaultSettings(Core.CandleSettingType.AllCandleSettings);
    }

    public static Core.RetCode SetUnstablePeriod(Core.FuncUnstId id, uint unstablePeriod)
    {
      Core.RetCode retCode;
      if (id > Core.FuncUnstId.FuncUnstAll)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (id == Core.FuncUnstId.FuncUnstAll)
        {
          for (int index = 0; index < 23; ++index)
            Core.Globals.unstablePeriod[index] = unstablePeriod;
        }
        else
          Core.Globals.unstablePeriod[(int) id] = unstablePeriod;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static uint GetUnstablePeriod(Core.FuncUnstId id)
    {
      return id < Core.FuncUnstId.FuncUnstAll ? Core.Globals.unstablePeriod[(int) id] : 0U;
    }

    public static Core.RetCode SetCompatibility(Core.Compatibility value)
    {
      Core.Globals.compatibility = value;
      return Core.RetCode.Success;
    }

    public static Core.Compatibility GetCompatibility()
    {
      return Core.Globals.compatibility;
    }

    public static Core.RetCode SetCandleSettings(
      Core.CandleSettingType settingType,
      Core.RangeType rangeType,
      int avgPeriod,
      double factor)
    {
      Core.RetCode retCode;
      if (settingType >= Core.CandleSettingType.AllCandleSettings)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        Core.Globals.candleSettings[(int) settingType].settingType = settingType;
        Core.Globals.candleSettings[(int) settingType].rangeType = rangeType;
        Core.Globals.candleSettings[(int) settingType].avgPeriod = avgPeriod;
        Core.Globals.candleSettings[(int) settingType].factor = factor;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode RestoreCandleDefaultSettings(Core.CandleSettingType settingType)
    {
      switch (settingType)
      {
        case Core.CandleSettingType.BodyLong:
          int num1 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyLong, Core.RangeType.RealBody, 10, 1.0);
          break;
        case Core.CandleSettingType.BodyVeryLong:
          int num2 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyVeryLong, Core.RangeType.RealBody, 10, 3.0);
          break;
        case Core.CandleSettingType.BodyShort:
          int num3 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyShort, Core.RangeType.RealBody, 10, 1.0);
          break;
        case Core.CandleSettingType.BodyDoji:
          int num4 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyDoji, Core.RangeType.HighLow, 10, 0.1);
          break;
        case Core.CandleSettingType.ShadowLong:
          int num5 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowLong, Core.RangeType.RealBody, 0, 1.0);
          break;
        case Core.CandleSettingType.ShadowVeryLong:
          int num6 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowVeryLong, Core.RangeType.RealBody, 0, 2.0);
          break;
        case Core.CandleSettingType.ShadowShort:
          int num7 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowShort, Core.RangeType.Shadows, 10, 1.0);
          break;
        case Core.CandleSettingType.ShadowVeryShort:
          int num8 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowVeryShort, Core.RangeType.HighLow, 10, 0.1);
          break;
        case Core.CandleSettingType.Near:
          int num9 = (int) Core.SetCandleSettings(Core.CandleSettingType.Near, Core.RangeType.HighLow, 5, 0.2);
          break;
        case Core.CandleSettingType.Far:
          int num10 = (int) Core.SetCandleSettings(Core.CandleSettingType.Far, Core.RangeType.HighLow, 5, 0.6);
          break;
        case Core.CandleSettingType.Equal:
          int num11 = (int) Core.SetCandleSettings(Core.CandleSettingType.Equal, Core.RangeType.HighLow, 5, 0.05);
          break;
        case Core.CandleSettingType.AllCandleSettings:
          int num12 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyLong, Core.RangeType.RealBody, 10, 1.0);
          int num13 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyVeryLong, Core.RangeType.RealBody, 10, 3.0);
          int num14 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyShort, Core.RangeType.RealBody, 10, 1.0);
          int num15 = (int) Core.SetCandleSettings(Core.CandleSettingType.BodyDoji, Core.RangeType.HighLow, 10, 0.1);
          int num16 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowLong, Core.RangeType.RealBody, 0, 1.0);
          int num17 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowVeryLong, Core.RangeType.RealBody, 0, 2.0);
          int num18 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowShort, Core.RangeType.Shadows, 10, 1.0);
          int num19 = (int) Core.SetCandleSettings(Core.CandleSettingType.ShadowVeryShort, Core.RangeType.HighLow, 10, 0.1);
          int num20 = (int) Core.SetCandleSettings(Core.CandleSettingType.Near, Core.RangeType.HighLow, 5, 0.2);
          int num21 = (int) Core.SetCandleSettings(Core.CandleSettingType.Far, Core.RangeType.HighLow, 5, 0.6);
          int num22 = (int) Core.SetCandleSettings(Core.CandleSettingType.Equal, Core.RangeType.HighLow, 5, 0.05);
          break;
      }
      return Core.RetCode.Success;
    }

    public static int AcosLookback()
    {
      return 0;
    }

    public static Core.RetCode Acos(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Acos((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Acos(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Acos(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int AdLookback()
    {
      return 0;
    }

    public static Core.RetCode Ad(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      float[] inVolume,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || (inClose == null || inVolume == null))
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = endIdx - startIdx + 1;
        outNBElement = num1;
        outBegIdx = startIdx;
        int index1 = startIdx;
        int index2 = 0;
        double num2 = 0.0;
        for (; num1 != 0; --num1)
        {
          double num3 = (double) inHigh[index1];
          double num4 = (double) inLow[index1];
          double num5 = num3 - num4;
          double num6 = (double) inClose[index1];
          if (num5 > 0.0)
            num2 += (num6 - num4 - (num3 - num6)) / num5 * (double) inVolume[index1];
          outReal[index2] = num2;
          ++index2;
          ++index1;
        }
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Ad(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double[] inVolume,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || (inClose == null || inVolume == null))
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = endIdx - startIdx + 1;
        outNBElement = num1;
        outBegIdx = startIdx;
        int index1 = startIdx;
        int index2 = 0;
        double num2 = 0.0;
        for (; num1 != 0; --num1)
        {
          double num3 = inHigh[index1];
          double num4 = inLow[index1];
          double num5 = num3 - num4;
          double num6 = inClose[index1];
          if (num5 > 0.0)
            num2 += (num6 - num4 - (num3 - num6)) / num5 * inVolume[index1];
          outReal[index2] = num2;
          ++index2;
          ++index1;
        }
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int AddLookback()
    {
      return 0;
    }

    public static Core.RetCode Add(
      int startIdx,
      int endIdx,
      float[] inReal0,
      float[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = (double) inReal0[index1] + (double) inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Add(
      int startIdx,
      int endIdx,
      double[] inReal0,
      double[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = inReal0[index1] + inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int AdOscLookback(int optInFastPeriod, int optInSlowPeriod)
    {
      int num;
      if (optInFastPeriod == int.MinValue)
        optInFastPeriod = 3;
      else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInSlowPeriod == int.MinValue)
        optInSlowPeriod = 10;
      else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      num = Core.EmaLookback(optInFastPeriod >= optInSlowPeriod ? optInFastPeriod : optInSlowPeriod);
label_9:
      return num;
    }

    public static Core.RetCode AdOsc(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      float[] inVolume,
      int optInFastPeriod,
      int optInSlowPeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || (inClose == null || inVolume == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 3;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_33;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 10;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_33;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.EmaLookback(optInFastPeriod >= optInSlowPeriod ? optInFastPeriod : optInSlowPeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num1;
            double num2 = 0.0;
            double num3 = 2.0 / (double) (optInFastPeriod + 1);
            double num4 = 1.0 - num3;
            double num5 = 2.0 / (double) (optInSlowPeriod + 1);
            double num6 = 1.0 - num5;
            double num7 = (double) inHigh[index1];
            double num8 = (double) inLow[index1];
            double num9 = num7 - num8;
            double num10 = (double) inClose[index1];
            if (num9 > 0.0)
              num2 += (num10 - num8 - (num7 - num10)) / num9 * (double) inVolume[index1];
            int index2 = index1 + 1;
            double num11 = num2;
            double num12 = num2;
            while (index2 < startIdx)
            {
              double num13 = (double) inHigh[index2];
              double num14 = (double) inLow[index2];
              double num15 = num13 - num14;
              double num16 = (double) inClose[index2];
              if (num15 > 0.0)
                num2 += (num16 - num14 - (num13 - num16)) / num15 * (double) inVolume[index2];
              ++index2;
              num11 = num3 * num2 + num4 * num11;
              num12 = num5 * num2 + num6 * num12;
            }
            int index3 = 0;
            while (index2 <= endIdx)
            {
              double num13 = (double) inHigh[index2];
              double num14 = (double) inLow[index2];
              double num15 = num13 - num14;
              double num16 = (double) inClose[index2];
              if (num15 > 0.0)
                num2 += (num16 - num14 - (num13 - num16)) / num15 * (double) inVolume[index2];
              ++index2;
              num11 = num3 * num2 + num4 * num11;
              num12 = num5 * num2 + num6 * num12;
              outReal[index3] = num11 - num12;
              ++index3;
            }
            outNBElement = index3;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_33:
      return retCode;
    }

    public static Core.RetCode AdOsc(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double[] inVolume,
      int optInFastPeriod,
      int optInSlowPeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || (inClose == null || inVolume == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 3;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_33;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 10;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_33;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.EmaLookback(optInFastPeriod >= optInSlowPeriod ? optInFastPeriod : optInSlowPeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num1;
            double num2 = 0.0;
            double num3 = 2.0 / (double) (optInFastPeriod + 1);
            double num4 = 1.0 - num3;
            double num5 = 2.0 / (double) (optInSlowPeriod + 1);
            double num6 = 1.0 - num5;
            double num7 = inHigh[index1];
            double num8 = inLow[index1];
            double num9 = num7 - num8;
            double num10 = inClose[index1];
            if (num9 > 0.0)
              num2 += (num10 - num8 - (num7 - num10)) / num9 * inVolume[index1];
            int index2 = index1 + 1;
            double num11 = num2;
            double num12 = num2;
            while (index2 < startIdx)
            {
              double num13 = inHigh[index2];
              double num14 = inLow[index2];
              double num15 = num13 - num14;
              double num16 = inClose[index2];
              if (num15 > 0.0)
                num2 += (num16 - num14 - (num13 - num16)) / num15 * inVolume[index2];
              ++index2;
              num11 = num3 * num2 + num4 * num11;
              num12 = num5 * num2 + num6 * num12;
            }
            int index3 = 0;
            while (index2 <= endIdx)
            {
              double num13 = inHigh[index2];
              double num14 = inLow[index2];
              double num15 = num13 - num14;
              double num16 = inClose[index2];
              if (num15 > 0.0)
                num2 += (num16 - num14 - (num13 - num16)) / num15 * inVolume[index2];
              ++index2;
              num11 = num3 * num2 + num4 * num11;
              num12 = num5 * num2 + num6 * num12;
              outReal[index3] = num11 - num12;
              ++index3;
            }
            outNBElement = index3;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_33:
      return retCode;
    }

    public static int AdxLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod * 2 + (int) Core.Globals.unstablePeriod[0] - 1;
label_5:
      return num;
    }

    public static Core.RetCode Adx(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_68;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod * 2 + (int) Core.Globals.unstablePeriod[0] - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int num2 = startIdx;
            outBegIdx = num2;
            double num3 = 0.0;
            double num4 = 0.0;
            double num5 = 0.0;
            int index1 = startIdx - num1;
            double num6 = (double) inHigh[index1];
            double num7 = (double) inLow[index1];
            double num8 = (double) inClose[index1];
            int num9 = optInTimePeriod - 1;
            while (true)
            {
              int num10 = num9;
              --num9;
              if (num10 > 0)
              {
                ++index1;
                double num11 = (double) inHigh[index1];
                double num12 = num11 - num6;
                num6 = num11;
                double num13 = (double) inLow[index1];
                double num14 = num7 - num13;
                num7 = num13;
                if (num14 > 0.0 && num12 < num14)
                  num3 += num14;
                else if (num12 > 0.0 && num12 > num14)
                  num4 += num12;
                double num15 = num6 - num7;
                double num16 = Math.Abs(num6 - num8);
                if (num16 > num15)
                  num15 = num16;
                double num17 = Math.Abs(num7 - num8);
                if (num17 > num15)
                  num15 = num17;
                num5 += num15;
                num8 = (double) inClose[index1];
              }
              else
                break;
            }
            double num18 = 0.0;
            int num19 = optInTimePeriod;
            while (true)
            {
              double num10;
              double num11;
              double num12;
              do
              {
                do
                {
                  int num13 = num19;
                  --num19;
                  if (num13 > 0)
                  {
                    ++index1;
                    double num14 = (double) inHigh[index1];
                    double num15 = num14 - num6;
                    num6 = num14;
                    double num16 = (double) inLow[index1];
                    double num17 = num7 - num16;
                    num7 = num16;
                    double num20 = num3;
                    num3 = num20 - num20 / (double) optInTimePeriod;
                    double num21 = num4;
                    num4 = num21 - num21 / (double) optInTimePeriod;
                    if (num17 > 0.0 && num15 < num17)
                      num3 += num17;
                    else if (num15 > 0.0 && num15 > num17)
                      num4 += num15;
                    double num22 = num6 - num7;
                    double num23 = Math.Abs(num6 - num8);
                    if (num23 > num22)
                      num22 = num23;
                    double num24 = Math.Abs(num7 - num8);
                    if (num24 > num22)
                      num22 = num24;
                    double num25 = num5;
                    num5 = num25 - num25 / (double) optInTimePeriod + num22;
                    num8 = (double) inClose[index1];
                  }
                  else
                    goto label_40;
                }
                while (-1E-08 < num5 && num5 < 1E-08);
                num10 = 100.0 * (num3 / num5);
                num11 = 100.0 * (num4 / num5);
                num12 = num10 + num11;
              }
              while (-1E-08 < num12 && num12 < 1E-08);
              num18 += 100.0 * (Math.Abs(num10 - num11) / num12);
            }
label_40:
            double num26 = num18 / (double) optInTimePeriod;
            int num27 = (int) Core.Globals.unstablePeriod[0];
            while (true)
            {
              double num10;
              double num11;
              double num12;
              do
              {
                do
                {
                  int num13 = num27;
                  --num27;
                  if (num13 > 0)
                  {
                    ++index1;
                    double num14 = (double) inHigh[index1];
                    double num15 = num14 - num6;
                    num6 = num14;
                    double num16 = (double) inLow[index1];
                    double num17 = num7 - num16;
                    num7 = num16;
                    double num20 = num3;
                    num3 = num20 - num20 / (double) optInTimePeriod;
                    double num21 = num4;
                    num4 = num21 - num21 / (double) optInTimePeriod;
                    if (num17 > 0.0 && num15 < num17)
                      num3 += num17;
                    else if (num15 > 0.0 && num15 > num17)
                      num4 += num15;
                    double num22 = num6 - num7;
                    double num23 = Math.Abs(num6 - num8);
                    if (num23 > num22)
                      num22 = num23;
                    double num24 = Math.Abs(num7 - num8);
                    if (num24 > num22)
                      num22 = num24;
                    double num25 = num5;
                    num5 = num25 - num25 / (double) optInTimePeriod + num22;
                    num8 = (double) inClose[index1];
                  }
                  else
                    goto label_53;
                }
                while (-1E-08 < num5 && num5 < 1E-08);
                num10 = 100.0 * (num3 / num5);
                num11 = 100.0 * (num4 / num5);
                num12 = num10 + num11;
              }
              while (-1E-08 < num12 && num12 < 1E-08);
              double num28 = 100.0 * (Math.Abs(num10 - num11) / num12);
              num26 = (num26 * (double) (optInTimePeriod - 1) + num28) / (double) optInTimePeriod;
            }
label_53:
            outReal[0] = num26;
            int index2 = 1;
            while (index1 < endIdx)
            {
              ++index1;
              double num10 = (double) inHigh[index1];
              double num11 = num10 - num6;
              num6 = num10;
              double num12 = (double) inLow[index1];
              double num13 = num7 - num12;
              num7 = num12;
              double num14 = num3;
              num3 = num14 - num14 / (double) optInTimePeriod;
              double num15 = num4;
              num4 = num15 - num15 / (double) optInTimePeriod;
              if (num13 > 0.0 && num11 < num13)
                num3 += num13;
              else if (num11 > 0.0 && num11 > num13)
                num4 += num11;
              double num16 = num6 - num7;
              double num17 = Math.Abs(num6 - num8);
              if (num17 > num16)
                num16 = num17;
              double num20 = Math.Abs(num7 - num8);
              if (num20 > num16)
                num16 = num20;
              double num21 = num5;
              num5 = num21 - num21 / (double) optInTimePeriod + num16;
              num8 = (double) inClose[index1];
              if (-1E-08 >= num5 || num5 >= 1E-08)
              {
                double num22 = 100.0 * (num3 / num5);
                double num23 = 100.0 * (num4 / num5);
                double num24 = num22 + num23;
                if (-1E-08 >= num24 || num24 >= 1E-08)
                {
                  double num25 = 100.0 * (Math.Abs(num22 - num23) / num24);
                  num26 = (num26 * (double) (optInTimePeriod - 1) + num25) / (double) optInTimePeriod;
                }
              }
              outReal[index2] = num26;
              ++index2;
            }
            outNBElement = index2;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_68:
      return retCode;
    }

    public static Core.RetCode Adx(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_68;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod * 2 + (int) Core.Globals.unstablePeriod[0] - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int num2 = startIdx;
            outBegIdx = num2;
            double num3 = 0.0;
            double num4 = 0.0;
            double num5 = 0.0;
            int index1 = startIdx - num1;
            double num6 = inHigh[index1];
            double num7 = inLow[index1];
            double num8 = inClose[index1];
            int num9 = optInTimePeriod - 1;
            while (true)
            {
              int num10 = num9;
              --num9;
              if (num10 > 0)
              {
                ++index1;
                double num11 = inHigh[index1];
                double num12 = num11 - num6;
                num6 = num11;
                double num13 = inLow[index1];
                double num14 = num7 - num13;
                num7 = num13;
                if (num14 > 0.0 && num12 < num14)
                  num3 += num14;
                else if (num12 > 0.0 && num12 > num14)
                  num4 += num12;
                double num15 = num6 - num7;
                double num16 = Math.Abs(num6 - num8);
                if (num16 > num15)
                  num15 = num16;
                double num17 = Math.Abs(num7 - num8);
                if (num17 > num15)
                  num15 = num17;
                num5 += num15;
                num8 = inClose[index1];
              }
              else
                break;
            }
            double num18 = 0.0;
            int num19 = optInTimePeriod;
            while (true)
            {
              double num10;
              double num11;
              double num12;
              do
              {
                do
                {
                  int num13 = num19;
                  --num19;
                  if (num13 > 0)
                  {
                    ++index1;
                    double num14 = inHigh[index1];
                    double num15 = num14 - num6;
                    num6 = num14;
                    double num16 = inLow[index1];
                    double num17 = num7 - num16;
                    num7 = num16;
                    double num20 = num3;
                    num3 = num20 - num20 / (double) optInTimePeriod;
                    double num21 = num4;
                    num4 = num21 - num21 / (double) optInTimePeriod;
                    if (num17 > 0.0 && num15 < num17)
                      num3 += num17;
                    else if (num15 > 0.0 && num15 > num17)
                      num4 += num15;
                    double num22 = num6 - num7;
                    double num23 = Math.Abs(num6 - num8);
                    if (num23 > num22)
                      num22 = num23;
                    double num24 = Math.Abs(num7 - num8);
                    if (num24 > num22)
                      num22 = num24;
                    double num25 = num5;
                    num5 = num25 - num25 / (double) optInTimePeriod + num22;
                    num8 = inClose[index1];
                  }
                  else
                    goto label_40;
                }
                while (-1E-08 < num5 && num5 < 1E-08);
                num10 = 100.0 * (num3 / num5);
                num11 = 100.0 * (num4 / num5);
                num12 = num10 + num11;
              }
              while (-1E-08 < num12 && num12 < 1E-08);
              num18 += 100.0 * (Math.Abs(num10 - num11) / num12);
            }
label_40:
            double num26 = num18 / (double) optInTimePeriod;
            int num27 = (int) Core.Globals.unstablePeriod[0];
            while (true)
            {
              double num10;
              double num11;
              double num12;
              do
              {
                do
                {
                  int num13 = num27;
                  --num27;
                  if (num13 > 0)
                  {
                    ++index1;
                    double num14 = inHigh[index1];
                    double num15 = num14 - num6;
                    num6 = num14;
                    double num16 = inLow[index1];
                    double num17 = num7 - num16;
                    num7 = num16;
                    double num20 = num3;
                    num3 = num20 - num20 / (double) optInTimePeriod;
                    double num21 = num4;
                    num4 = num21 - num21 / (double) optInTimePeriod;
                    if (num17 > 0.0 && num15 < num17)
                      num3 += num17;
                    else if (num15 > 0.0 && num15 > num17)
                      num4 += num15;
                    double num22 = num6 - num7;
                    double num23 = Math.Abs(num6 - num8);
                    if (num23 > num22)
                      num22 = num23;
                    double num24 = Math.Abs(num7 - num8);
                    if (num24 > num22)
                      num22 = num24;
                    double num25 = num5;
                    num5 = num25 - num25 / (double) optInTimePeriod + num22;
                    num8 = inClose[index1];
                  }
                  else
                    goto label_53;
                }
                while (-1E-08 < num5 && num5 < 1E-08);
                num10 = 100.0 * (num3 / num5);
                num11 = 100.0 * (num4 / num5);
                num12 = num10 + num11;
              }
              while (-1E-08 < num12 && num12 < 1E-08);
              double num28 = 100.0 * (Math.Abs(num10 - num11) / num12);
              num26 = (num26 * (double) (optInTimePeriod - 1) + num28) / (double) optInTimePeriod;
            }
label_53:
            outReal[0] = num26;
            int index2 = 1;
            while (index1 < endIdx)
            {
              ++index1;
              double num10 = inHigh[index1];
              double num11 = num10 - num6;
              num6 = num10;
              double num12 = inLow[index1];
              double num13 = num7 - num12;
              num7 = num12;
              double num14 = num3;
              num3 = num14 - num14 / (double) optInTimePeriod;
              double num15 = num4;
              num4 = num15 - num15 / (double) optInTimePeriod;
              if (num13 > 0.0 && num11 < num13)
                num3 += num13;
              else if (num11 > 0.0 && num11 > num13)
                num4 += num11;
              double num16 = num6 - num7;
              double num17 = Math.Abs(num6 - num8);
              if (num17 > num16)
                num16 = num17;
              double num20 = Math.Abs(num7 - num8);
              if (num20 > num16)
                num16 = num20;
              double num21 = num5;
              num5 = num21 - num21 / (double) optInTimePeriod + num16;
              num8 = inClose[index1];
              if (-1E-08 >= num5 || num5 >= 1E-08)
              {
                double num22 = 100.0 * (num3 / num5);
                double num23 = 100.0 * (num4 / num5);
                double num24 = num22 + num23;
                if (-1E-08 >= num24 || num24 >= 1E-08)
                {
                  double num25 = 100.0 * (Math.Abs(num22 - num23) / num24);
                  num26 = (num26 * (double) (optInTimePeriod - 1) + num25) / (double) optInTimePeriod;
                }
              }
              outReal[index2] = num26;
              ++index2;
            }
            outNBElement = index2;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_68:
      return retCode;
    }

    public static int AdxrLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_7;
      }
      if (optInTimePeriod > 1)
      {
        int optInTimePeriod1 = optInTimePeriod;
        num = optInTimePeriod1 + Core.AdxLookback(optInTimePeriod1) - 1;
      }
      else
        num = 3;
label_7:
      return num;
    }

    public static Core.RetCode Adxr(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_24;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.AdxrLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double[] outReal1 = new double[endIdx - startIdx + optInTimePeriod];
            if (outReal1 == null)
            {
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              Core.RetCode retCode2 = Core.Adx(startIdx - (optInTimePeriod - 1), endIdx, inHigh, inLow, inClose, optInTimePeriod, out outBegIdx, out outNBElement, outReal1);
              if (retCode2 != Core.RetCode.Success)
              {
                retCode1 = retCode2;
              }
              else
              {
                int index1 = optInTimePeriod - 1;
                int index2 = 0;
                int index3 = 0;
                int num2 = endIdx - startIdx + 2;
                while (true)
                {
                  --num2;
                  if (num2 != 0)
                  {
                    outReal[index3] = (outReal1[index1] + outReal1[index2]) / 2.0;
                    ++index3;
                    ++index2;
                    ++index1;
                  }
                  else
                    break;
                }
                outBegIdx = startIdx;
                outNBElement = index3;
                retCode1 = Core.RetCode.Success;
              }
            }
          }
        }
      }
label_24:
      return retCode1;
    }

    public static Core.RetCode Adxr(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_24;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.AdxrLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double[] outReal1 = new double[endIdx - startIdx + optInTimePeriod];
            if (outReal1 == null)
            {
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              Core.RetCode retCode2 = Core.Adx(startIdx - (optInTimePeriod - 1), endIdx, inHigh, inLow, inClose, optInTimePeriod, out outBegIdx, out outNBElement, outReal1);
              if (retCode2 != Core.RetCode.Success)
              {
                retCode1 = retCode2;
              }
              else
              {
                int index1 = optInTimePeriod - 1;
                int index2 = 0;
                int index3 = 0;
                int num2 = endIdx - startIdx + 2;
                while (true)
                {
                  --num2;
                  if (num2 != 0)
                  {
                    outReal[index3] = (outReal1[index1] + outReal1[index2]) / 2.0;
                    ++index3;
                    ++index2;
                    ++index1;
                  }
                  else
                    break;
                }
                outBegIdx = startIdx;
                outNBElement = index3;
                retCode1 = Core.RetCode.Success;
              }
            }
          }
        }
      }
label_24:
      return retCode1;
    }

    public static int ApoLookback(
      int optInFastPeriod,
      int optInSlowPeriod,
      Core.MAType optInMAType)
    {
      int num;
      if (optInFastPeriod == int.MinValue)
        optInFastPeriod = 12;
      else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInSlowPeriod == int.MinValue)
        optInSlowPeriod = 26;
      else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      num = Core.MovingAverageLookback(optInSlowPeriod <= optInFastPeriod ? optInFastPeriod : optInSlowPeriod, optInMAType);
label_9:
      return num;
    }

    public static Core.RetCode Apo(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInFastPeriod,
      int optInSlowPeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          double[] tempBuffer = new double[endIdx - startIdx + 1];
          retCode = tempBuffer != null ? Core.TA_INT_PO(startIdx, endIdx, inReal, optInFastPeriod, optInSlowPeriod, optInMAType, out outBegIdx, out outNBElement, outReal, tempBuffer, 0) : Core.RetCode.AllocErr;
        }
      }
label_17:
      return retCode;
    }

    public static Core.RetCode Apo(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInFastPeriod,
      int optInSlowPeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          double[] tempBuffer = new double[endIdx - startIdx + 1];
          retCode = tempBuffer != null ? Core.TA_INT_PO(startIdx, endIdx, inReal, optInFastPeriod, optInSlowPeriod, optInMAType, out outBegIdx, out outNBElement, outReal, tempBuffer, 0) : Core.RetCode.AllocErr;
        }
      }
label_17:
      return retCode;
    }

    public static int AroonLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode Aroon(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outAroonDown,
      double[] outAroonUp)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outAroonDown == null)
          retCode = Core.RetCode.BadParam;
        else if (outAroonUp == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num1 = startIdx - optInTimePeriod;
            int index3 = -1;
            int index4 = -1;
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 100.0 / (double) optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = (double) inLow[index2];
              if (index3 < num1)
              {
                index3 = num1;
                num2 = (double) inLow[index3];
                int index5 = index3;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = (double) inLow[index5];
                    else
                      goto label_27;
                  }
                  while (num6 > num2);
                  index3 = index5;
                  num2 = num6;
                }
              }
              else if (num5 <= num2)
              {
                index3 = index2;
                num2 = num5;
              }
label_27:
              double num7 = (double) inHigh[index2];
              if (index4 < num1)
              {
                index4 = num1;
                num3 = (double) inHigh[index4];
                int index5 = index4;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = (double) inHigh[index5];
                    else
                      goto label_34;
                  }
                  while (num6 < num3);
                  index4 = index5;
                  num3 = num6;
                }
              }
              else if (num7 >= num3)
              {
                index4 = index2;
                num3 = num7;
              }
label_34:
              outAroonUp[index1] = num4 * (double) (optInTimePeriod - (index2 - index4));
              outAroonDown[index1] = num4 * (double) (optInTimePeriod - (index2 - index3));
              ++index1;
              ++num1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static Core.RetCode Aroon(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outAroonDown,
      double[] outAroonUp)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outAroonDown == null)
          retCode = Core.RetCode.BadParam;
        else if (outAroonUp == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num1 = startIdx - optInTimePeriod;
            int index3 = -1;
            int index4 = -1;
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 100.0 / (double) optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = inLow[index2];
              if (index3 < num1)
              {
                index3 = num1;
                num2 = inLow[index3];
                int index5 = index3;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = inLow[index5];
                    else
                      goto label_27;
                  }
                  while (num6 > num2);
                  index3 = index5;
                  num2 = num6;
                }
              }
              else if (num5 <= num2)
              {
                index3 = index2;
                num2 = num5;
              }
label_27:
              double num7 = inHigh[index2];
              if (index4 < num1)
              {
                index4 = num1;
                num3 = inHigh[index4];
                int index5 = index4;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = inHigh[index5];
                    else
                      goto label_34;
                  }
                  while (num6 < num3);
                  index4 = index5;
                  num3 = num6;
                }
              }
              else if (num7 >= num3)
              {
                index4 = index2;
                num3 = num7;
              }
label_34:
              outAroonUp[index1] = num4 * (double) (optInTimePeriod - (index2 - index4));
              outAroonDown[index1] = num4 * (double) (optInTimePeriod - (index2 - index3));
              ++index1;
              ++num1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static int AroonOscLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode AroonOsc(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_34;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num1 = startIdx - optInTimePeriod;
            int index3 = -1;
            int index4 = -1;
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 100.0 / (double) optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = (double) inLow[index2];
              if (index3 < num1)
              {
                index3 = num1;
                num2 = (double) inLow[index3];
                int index5 = index3;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = (double) inLow[index5];
                    else
                      goto label_25;
                  }
                  while (num6 > num2);
                  index3 = index5;
                  num2 = num6;
                }
              }
              else if (num5 <= num2)
              {
                index3 = index2;
                num2 = num5;
              }
label_25:
              double num7 = (double) inHigh[index2];
              if (index4 < num1)
              {
                index4 = num1;
                num3 = (double) inHigh[index4];
                int index5 = index4;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = (double) inHigh[index5];
                    else
                      goto label_32;
                  }
                  while (num6 < num3);
                  index4 = index5;
                  num3 = num6;
                }
              }
              else if (num7 >= num3)
              {
                index4 = index2;
                num3 = num7;
              }
label_32:
              double num8 = num4 * (double) (index4 - index3);
              outReal[index1] = num8;
              ++index1;
              ++num1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_34:
      return retCode;
    }

    public static Core.RetCode AroonOsc(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_34;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num1 = startIdx - optInTimePeriod;
            int index3 = -1;
            int index4 = -1;
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 100.0 / (double) optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = inLow[index2];
              if (index3 < num1)
              {
                index3 = num1;
                num2 = inLow[index3];
                int index5 = index3;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = inLow[index5];
                    else
                      goto label_25;
                  }
                  while (num6 > num2);
                  index3 = index5;
                  num2 = num6;
                }
              }
              else if (num5 <= num2)
              {
                index3 = index2;
                num2 = num5;
              }
label_25:
              double num7 = inHigh[index2];
              if (index4 < num1)
              {
                index4 = num1;
                num3 = inHigh[index4];
                int index5 = index4;
                while (true)
                {
                  double num6;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num6 = inHigh[index5];
                    else
                      goto label_32;
                  }
                  while (num6 < num3);
                  index4 = index5;
                  num3 = num6;
                }
              }
              else if (num7 >= num3)
              {
                index4 = index2;
                num3 = num7;
              }
label_32:
              double num8 = num4 * (double) (index4 - index3);
              outReal[index1] = num8;
              ++index1;
              ++num1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_34:
      return retCode;
    }

    public static int AsinLookback()
    {
      return 0;
    }

    public static Core.RetCode Asin(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Asin((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Asin(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Asin(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int AtanLookback()
    {
      return 0;
    }

    public static Core.RetCode Atan(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Atan((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Atan(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Atan(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int AtrLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod + (int) Core.Globals.unstablePeriod[2];
label_5:
      return num;
    }

    public static Core.RetCode Atr(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal_0 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_29;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.AtrLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
            retCode1 = Core.RetCode.Success;
          else if (optInTimePeriod <= 1)
          {
            retCode1 = Core.TrueRange(startIdx, endIdx, inHigh, inLow, inClose, out outBegIdx, out outNBElement, outReal);
          }
          else
          {
            double[] numArray = new double[num1 + (endIdx - startIdx) + 1];
            int outBegIdx1;
            int num2;
            Core.RetCode retCode2 = Core.TrueRange(startIdx - num1 + 1, endIdx, inHigh, inLow, inClose, out outBegIdx1, out num2, numArray);
            if (retCode2 != Core.RetCode.Success)
            {
              retCode1 = retCode2;
            }
            else
            {
              Core.RetCode retCode3 = Core.TA_INT_SMA(optInTimePeriod - 1, optInTimePeriod - 1, numArray, optInTimePeriod, out outBegIdx1, out num2, outReal_0);
              if (retCode3 != Core.RetCode.Success)
              {
                retCode1 = retCode3;
              }
              else
              {
                double num3 = outReal_0[0];
                int index1 = optInTimePeriod;
                for (int index2 = (int) Core.Globals.unstablePeriod[2]; index2 != 0; --index2)
                {
                  double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                  ++index1;
                  num3 = num4 / (double) optInTimePeriod;
                }
                int index3 = 1;
                outReal[0] = num3;
                int num5 = endIdx - startIdx + 1;
                while (true)
                {
                  --num5;
                  if (num5 != 0)
                  {
                    double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                    ++index1;
                    num3 = num4 / (double) optInTimePeriod;
                    outReal[index3] = num3;
                    ++index3;
                  }
                  else
                    break;
                }
                outBegIdx = startIdx;
                outNBElement = index3;
                retCode1 = retCode3;
              }
            }
          }
        }
      }
label_29:
      return retCode1;
    }

    public static Core.RetCode Atr(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal_0 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_29;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.AtrLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
            retCode1 = Core.RetCode.Success;
          else if (optInTimePeriod <= 1)
          {
            retCode1 = Core.TrueRange(startIdx, endIdx, inHigh, inLow, inClose, out outBegIdx, out outNBElement, outReal);
          }
          else
          {
            double[] numArray = new double[num1 + (endIdx - startIdx) + 1];
            int outBegIdx1;
            int num2;
            Core.RetCode retCode2 = Core.TrueRange(startIdx - num1 + 1, endIdx, inHigh, inLow, inClose, out outBegIdx1, out num2, numArray);
            if (retCode2 != Core.RetCode.Success)
            {
              retCode1 = retCode2;
            }
            else
            {
              Core.RetCode retCode3 = Core.TA_INT_SMA(optInTimePeriod - 1, optInTimePeriod - 1, numArray, optInTimePeriod, out outBegIdx1, out num2, outReal_0);
              if (retCode3 != Core.RetCode.Success)
              {
                retCode1 = retCode3;
              }
              else
              {
                double num3 = outReal_0[0];
                int index1 = optInTimePeriod;
                for (int index2 = (int) Core.Globals.unstablePeriod[2]; index2 != 0; --index2)
                {
                  double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                  ++index1;
                  num3 = num4 / (double) optInTimePeriod;
                }
                int index3 = 1;
                outReal[0] = num3;
                int num5 = endIdx - startIdx + 1;
                while (true)
                {
                  --num5;
                  if (num5 != 0)
                  {
                    double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                    ++index1;
                    num3 = num4 / (double) optInTimePeriod;
                    outReal[index3] = num3;
                    ++index3;
                  }
                  else
                    break;
                }
                outBegIdx = startIdx;
                outNBElement = index3;
                retCode1 = retCode3;
              }
            }
          }
        }
      }
label_29:
      return retCode1;
    }

    public static int AvgPriceLookback()
    {
      return 0;
    }

    public static Core.RetCode AvgPrice(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = ((double) inHigh[index2] + (double) inLow[index2] + (double) inClose[index2] + (double) inOpen[index2]) / 4.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode AvgPrice(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = (inHigh[index2] + inLow[index2] + inClose[index2] + inOpen[index2]) / 4.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int BbandsLookback(
      int optInTimePeriod,
      double optInNbDevUp,
      double optInNbDevDn,
      Core.MAType optInMAType)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 5;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInNbDevUp == -4E+37)
        optInNbDevUp = 2.0;
      else if (optInNbDevUp < -3E+37 || optInNbDevUp > 3E+37)
      {
        num = -1;
        goto label_13;
      }
      if (optInNbDevDn == -4E+37)
        optInNbDevDn = 2.0;
      else if (optInNbDevDn < -3E+37 || optInNbDevDn > 3E+37)
      {
        num = -1;
        goto label_13;
      }
      num = Core.MovingAverageLookback(optInTimePeriod, optInMAType);
label_13:
      return num;
    }

    public static Core.RetCode Bbands(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      double optInNbDevUp,
      double optInNbDevDn,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outRealUpperBand,
      double[] outRealMiddleBand,
      double[] outRealLowerBand)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_50;
        }
        if (optInNbDevUp == -4E+37)
          optInNbDevUp = 2.0;
        else if (optInNbDevUp < -3E+37 || optInNbDevUp > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_50;
        }
        if (optInNbDevDn == -4E+37)
          optInNbDevDn = 2.0;
        else if (optInNbDevDn < -3E+37 || optInNbDevDn > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_50;
        }
        if (outRealUpperBand == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outRealMiddleBand == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outRealLowerBand == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          double[] numArray1 = outRealMiddleBand;
          double[] numArray2 = outRealLowerBand;
          Core.RetCode retCode2 = Core.MovingAverage(startIdx, endIdx, inReal, optInTimePeriod, optInMAType, out outBegIdx, out outNBElement, numArray1);
          if (retCode2 != Core.RetCode.Success || outNBElement == 0)
          {
            outNBElement = 0;
            retCode1 = retCode2;
          }
          else
          {
            if (optInMAType == Core.MAType.Sma)
            {
              Core.TA_INT_stddev_using_precalc_ma(inReal, numArray1, outBegIdx, outNBElement, optInTimePeriod, numArray2);
            }
            else
            {
              Core.RetCode retCode3 = Core.StdDev(outBegIdx, endIdx, inReal, optInTimePeriod, 1.0, out outBegIdx, out outNBElement, numArray2);
              if (retCode3 != Core.RetCode.Success)
              {
                outNBElement = 0;
                retCode1 = retCode3;
                goto label_50;
              }
            }
            if (optInNbDevUp == optInNbDevDn)
            {
              if (optInNbDevUp == 1.0)
              {
                for (int index = 0; index < outNBElement; ++index)
                {
                  double num1 = numArray2[index];
                  double num2 = outRealMiddleBand[index];
                  outRealUpperBand[index] = num2 + num1;
                  outRealLowerBand[index] = num2 - num1;
                }
              }
              else
              {
                for (int index = 0; index < outNBElement; ++index)
                {
                  double num1 = numArray2[index] * optInNbDevUp;
                  double num2 = outRealMiddleBand[index];
                  outRealUpperBand[index] = num2 + num1;
                  outRealLowerBand[index] = num2 - num1;
                }
              }
            }
            else if (optInNbDevUp == 1.0)
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double num1 = numArray2[index];
                double num2 = outRealMiddleBand[index];
                outRealUpperBand[index] = num2 + num1;
                outRealLowerBand[index] = num2 - num1 * optInNbDevDn;
              }
            }
            else if (optInNbDevDn == 1.0)
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double num1 = numArray2[index];
                double num2 = outRealMiddleBand[index];
                outRealLowerBand[index] = num2 - num1;
                outRealUpperBand[index] = num2 + num1 * optInNbDevUp;
              }
            }
            else
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double num1 = numArray2[index];
                double num2 = outRealMiddleBand[index];
                outRealUpperBand[index] = num2 + num1 * optInNbDevUp;
                outRealLowerBand[index] = num2 - num1 * optInNbDevDn;
              }
            }
            retCode1 = Core.RetCode.Success;
          }
        }
      }
label_50:
      return retCode1;
    }

    public static Core.RetCode Bbands(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      double optInNbDevUp,
      double optInNbDevDn,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outRealUpperBand,
      double[] outRealMiddleBand,
      double[] outRealLowerBand)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_61;
        }
        if (optInNbDevUp == -4E+37)
          optInNbDevUp = 2.0;
        else if (optInNbDevUp < -3E+37 || optInNbDevUp > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_61;
        }
        if (optInNbDevDn == -4E+37)
          optInNbDevDn = 2.0;
        else if (optInNbDevDn < -3E+37 || optInNbDevDn > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_61;
        }
        if (outRealUpperBand == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outRealMiddleBand == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outRealLowerBand == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          double[] numArray1;
          double[] numArray2;
          if (inReal == outRealUpperBand)
          {
            numArray1 = outRealMiddleBand;
            numArray2 = outRealLowerBand;
          }
          else if (inReal == outRealLowerBand)
          {
            numArray1 = outRealMiddleBand;
            numArray2 = outRealUpperBand;
          }
          else if (inReal == outRealMiddleBand)
          {
            numArray1 = outRealLowerBand;
            numArray2 = outRealUpperBand;
          }
          else
          {
            numArray1 = outRealMiddleBand;
            numArray2 = outRealUpperBand;
          }
          if (numArray1 == inReal || numArray2 == inReal)
          {
            retCode1 = Core.RetCode.BadParam;
          }
          else
          {
            Core.RetCode retCode2 = Core.MovingAverage(startIdx, endIdx, inReal, optInTimePeriod, optInMAType, out outBegIdx, out outNBElement, numArray1);
            if (retCode2 != Core.RetCode.Success || outNBElement == 0)
            {
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              if (optInMAType == Core.MAType.Sma)
              {
                Core.TA_INT_stddev_using_precalc_ma(inReal, numArray1, outBegIdx, outNBElement, optInTimePeriod, numArray2);
              }
              else
              {
                Core.RetCode retCode3 = Core.StdDev(outBegIdx, endIdx, inReal, optInTimePeriod, 1.0, out outBegIdx, out outNBElement, numArray2);
                if (retCode3 != Core.RetCode.Success)
                {
                  outNBElement = 0;
                  retCode1 = retCode3;
                  goto label_61;
                }
              }
              if (numArray1 != outRealMiddleBand)
                Array.Copy((Array) numArray1, 0, (Array) outRealMiddleBand, 0, outNBElement);
              if (optInNbDevUp == optInNbDevDn)
              {
                if (optInNbDevUp == 1.0)
                {
                  for (int index = 0; index < outNBElement; ++index)
                  {
                    double num1 = numArray2[index];
                    double num2 = outRealMiddleBand[index];
                    outRealUpperBand[index] = num2 + num1;
                    outRealLowerBand[index] = num2 - num1;
                  }
                }
                else
                {
                  for (int index = 0; index < outNBElement; ++index)
                  {
                    double num1 = numArray2[index] * optInNbDevUp;
                    double num2 = outRealMiddleBand[index];
                    outRealUpperBand[index] = num2 + num1;
                    outRealLowerBand[index] = num2 - num1;
                  }
                }
              }
              else if (optInNbDevUp == 1.0)
              {
                for (int index = 0; index < outNBElement; ++index)
                {
                  double num1 = numArray2[index];
                  double num2 = outRealMiddleBand[index];
                  outRealUpperBand[index] = num2 + num1;
                  outRealLowerBand[index] = num2 - num1 * optInNbDevDn;
                }
              }
              else if (optInNbDevDn == 1.0)
              {
                for (int index = 0; index < outNBElement; ++index)
                {
                  double num1 = numArray2[index];
                  double num2 = outRealMiddleBand[index];
                  outRealLowerBand[index] = num2 - num1;
                  outRealUpperBand[index] = num2 + num1 * optInNbDevUp;
                }
              }
              else
              {
                for (int index = 0; index < outNBElement; ++index)
                {
                  double num1 = numArray2[index];
                  double num2 = outRealMiddleBand[index];
                  outRealUpperBand[index] = num2 + num1 * optInNbDevUp;
                  outRealLowerBand[index] = num2 - num1 * optInNbDevDn;
                }
              }
              retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_61:
      return retCode1;
    }

    public static int BetaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 5;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode Beta(
      int startIdx,
      int endIdx,
      float[] inReal0,
      float[] inReal1,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double num1 = 0.0;
      double num2 = 0.0;
      double num3 = 0.0;
      double num4 = 0.0;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num5 = optInTimePeriod;
          if (startIdx < num5)
            startIdx = num5;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = startIdx - num5;
            double num6 = (double) inReal0[index1];
            double num7 = num6;
            double num8 = (double) inReal1[index1];
            double num9 = num8;
            int index2 = index1 + 1;
            int index3 = index2;
            while (index3 < startIdx)
            {
              double num10 = (double) inReal0[index3];
              double num11 = -1E-08 >= num7 || num7 >= 1E-08 ? (num10 - num7) / num7 : 0.0;
              num7 = num10;
              double num12 = (double) inReal1[index3];
              ++index3;
              double num13 = -1E-08 >= num9 || num9 >= 1E-08 ? (num12 - num9) / num9 : 0.0;
              num9 = num12;
              double num14 = num1;
              double num15 = num11;
              double num16 = num15 * num15;
              num1 = num14 + num16;
              num2 += num11 * num13;
              num3 += num11;
              num4 += num13;
            }
            int index4 = 0;
            double num17 = (double) optInTimePeriod;
            do
            {
              double num10 = (double) inReal0[index3];
              double num11 = -1E-08 >= num7 || num7 >= 1E-08 ? (num10 - num7) / num7 : 0.0;
              num7 = num10;
              double num12 = (double) inReal1[index3];
              ++index3;
              double num13 = -1E-08 >= num9 || num9 >= 1E-08 ? (num12 - num9) / num9 : 0.0;
              num9 = num12;
              double num14 = num1;
              double num15 = num11;
              double num16 = num15 * num15;
              double num18 = num14 + num16;
              double num19 = num2 + num11 * num13;
              double num20 = num3 + num11;
              double num21 = num4 + num13;
              double num22 = (double) inReal0[index2];
              double num23 = -1E-08 >= num6 || num6 >= 1E-08 ? (num22 - num6) / num6 : 0.0;
              num6 = num22;
              double num24 = (double) inReal1[index2];
              ++index2;
              double num25 = -1E-08 >= num8 || num8 >= 1E-08 ? (num24 - num8) / num8 : 0.0;
              num8 = num24;
              double num26 = num17 * num18;
              double num27 = num20;
              double num28 = num27 * num27;
              double num29 = num26 - num28;
              if (-1E-08 >= num29 || num29 >= 1E-08)
              {
                outReal[index4] = (num17 * num19 - num20 * num21) / num29;
                ++index4;
              }
              else
              {
                outReal[index4] = 0.0;
                ++index4;
              }
              double num30 = num18;
              double num31 = num23;
              double num32 = num31 * num31;
              num1 = num30 - num32;
              num2 = num19 - num23 * num25;
              num3 = num20 - num23;
              num4 = num21 - num25;
            }
            while (index3 <= endIdx);
            outNBElement = index4;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode Beta(
      int startIdx,
      int endIdx,
      double[] inReal0,
      double[] inReal1,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double num1 = 0.0;
      double num2 = 0.0;
      double num3 = 0.0;
      double num4 = 0.0;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num5 = optInTimePeriod;
          if (startIdx < num5)
            startIdx = num5;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = startIdx - num5;
            double num6 = inReal0[index1];
            double num7 = num6;
            double num8 = inReal1[index1];
            double num9 = num8;
            int index2 = index1 + 1;
            int index3 = index2;
            while (index3 < startIdx)
            {
              double num10 = inReal0[index3];
              double num11 = -1E-08 >= num7 || num7 >= 1E-08 ? (num10 - num7) / num7 : 0.0;
              num7 = num10;
              double num12 = inReal1[index3];
              ++index3;
              double num13 = -1E-08 >= num9 || num9 >= 1E-08 ? (num12 - num9) / num9 : 0.0;
              num9 = num12;
              double num14 = num1;
              double num15 = num11;
              double num16 = num15 * num15;
              num1 = num14 + num16;
              num2 += num11 * num13;
              num3 += num11;
              num4 += num13;
            }
            int index4 = 0;
            double num17 = (double) optInTimePeriod;
            do
            {
              double num10 = inReal0[index3];
              double num11 = -1E-08 >= num7 || num7 >= 1E-08 ? (num10 - num7) / num7 : 0.0;
              num7 = num10;
              double num12 = inReal1[index3];
              ++index3;
              double num13 = -1E-08 >= num9 || num9 >= 1E-08 ? (num12 - num9) / num9 : 0.0;
              num9 = num12;
              double num14 = num1;
              double num15 = num11;
              double num16 = num15 * num15;
              double num18 = num14 + num16;
              double num19 = num2 + num11 * num13;
              double num20 = num3 + num11;
              double num21 = num4 + num13;
              double num22 = inReal0[index2];
              double num23 = -1E-08 >= num6 || num6 >= 1E-08 ? (num22 - num6) / num6 : 0.0;
              num6 = num22;
              double num24 = inReal1[index2];
              ++index2;
              double num25 = -1E-08 >= num8 || num8 >= 1E-08 ? (num24 - num8) / num8 : 0.0;
              num8 = num24;
              double num26 = num17 * num18;
              double num27 = num20;
              double num28 = num27 * num27;
              double num29 = num26 - num28;
              if (-1E-08 >= num29 || num29 >= 1E-08)
              {
                outReal[index4] = (num17 * num19 - num20 * num21) / num29;
                ++index4;
              }
              else
              {
                outReal[index4] = 0.0;
                ++index4;
              }
              double num30 = num18;
              double num31 = num23;
              double num32 = num31 * num31;
              num1 = num30 - num32;
              num2 = num19 - num23 * num25;
              num3 = num20 - num23;
              num4 = num21 - num25;
            }
            while (index3 <= endIdx);
            outNBElement = index4;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int BopLookback()
    {
      return 0;
    }

    public static Core.RetCode Bop(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          double num = (double) inHigh[index2] - (double) inLow[index2];
          if (num >= 1E-08)
            goto label_13;
          outReal[index1] = 0.0;
          ++index1;
          continue;
label_13:
          outReal[index1] = ((double) inClose[index2] - (double) inOpen[index2]) / num;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Bop(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          double num = inHigh[index2] - inLow[index2];
          if (num >= 1E-08)
            goto label_13;
          outReal[index1] = 0.0;
          ++index1;
          continue;
label_13:
          outReal[index1] = (inClose[index2] - inOpen[index2]) / num;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int CciLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Cci(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      int index1 = 0;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_38;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else if (optInTimePeriod <= 0)
          {
            retCode = Core.RetCode.AllocErr;
          }
          else
          {
            double[] numArray = new double[optInTimePeriod];
            if (numArray == null)
            {
              retCode = Core.RetCode.AllocErr;
            }
            else
            {
              int num2 = optInTimePeriod - 1;
              int index2 = startIdx - num1;
              if (optInTimePeriod > 1)
              {
                while (index2 < startIdx)
                {
                  numArray[index1] = ((double) inHigh[index2] + (double) inLow[index2] + (double) inClose[index2]) / 3.0;
                  ++index2;
                  ++index1;
                  if (index1 > num2)
                    index1 = 0;
                }
              }
              int index3 = 0;
              do
              {
                double num3 = ((double) inHigh[index2] + (double) inLow[index2] + (double) inClose[index2]) / 3.0;
                numArray[index1] = num3;
                double num4 = 0.0;
                for (int index4 = 0; index4 < optInTimePeriod; ++index4)
                  num4 += numArray[index4];
                double num5 = num4 / (double) optInTimePeriod;
                double num6 = 0.0;
                for (int index4 = 0; index4 < optInTimePeriod; ++index4)
                  num6 += Math.Abs(numArray[index4] - num5);
                double num7 = num3 - num5;
                if (num7 != 0.0 && num6 != 0.0)
                {
                  outReal[index3] = num7 / (0.015 * (num6 / (double) optInTimePeriod));
                  ++index3;
                }
                else
                {
                  outReal[index3] = 0.0;
                  ++index3;
                }
                ++index1;
                if (index1 > num2)
                  index1 = 0;
                ++index2;
              }
              while (index2 <= endIdx);
              outNBElement = index3;
              outBegIdx = startIdx;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_38:
      return retCode;
    }

    public static Core.RetCode Cci(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      int index1 = 0;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_38;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else if (optInTimePeriod <= 0)
          {
            retCode = Core.RetCode.AllocErr;
          }
          else
          {
            double[] numArray = new double[optInTimePeriod];
            if (numArray == null)
            {
              retCode = Core.RetCode.AllocErr;
            }
            else
            {
              int num2 = optInTimePeriod - 1;
              int index2 = startIdx - num1;
              if (optInTimePeriod > 1)
              {
                while (index2 < startIdx)
                {
                  numArray[index1] = (inHigh[index2] + inLow[index2] + inClose[index2]) / 3.0;
                  ++index2;
                  ++index1;
                  if (index1 > num2)
                    index1 = 0;
                }
              }
              int index3 = 0;
              do
              {
                double num3 = (inHigh[index2] + inLow[index2] + inClose[index2]) / 3.0;
                numArray[index1] = num3;
                double num4 = 0.0;
                for (int index4 = 0; index4 < optInTimePeriod; ++index4)
                  num4 += numArray[index4];
                double num5 = num4 / (double) optInTimePeriod;
                double num6 = 0.0;
                for (int index4 = 0; index4 < optInTimePeriod; ++index4)
                  num6 += Math.Abs(numArray[index4] - num5);
                double num7 = num3 - num5;
                if (num7 != 0.0 && num6 != 0.0)
                {
                  outReal[index3] = num7 / (0.015 * (num6 / (double) optInTimePeriod));
                  ++index3;
                }
                else
                {
                  outReal[index3] = 0.0;
                  ++index3;
                }
                ++index1;
                if (index1 > num2)
                  index1 = 0;
                ++index2;
              }
              while (index2 <= endIdx);
              outNBElement = index3;
              outBegIdx = startIdx;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_38:
      return retCode;
    }

    public static int Cdl2CrowsLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod + 2;
    }

    public static Core.RetCode Cdl2Crows(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl2CrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          for (int index2 = index1; index2 < startIdx - 2; ++index2)
          {
            float num3;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += (double) num3;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if (((double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? -1 : 1) == 1)
            {
              double num3;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num3 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num4 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num5 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num7 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      float num8 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num6 = (float) ((double) inHigh[index3 - 2] - (double) num7 + ((double) num8 - (double) inLow[index3 - 2]));
                    }
                    else
                      num6 = 0.0f;
                    num5 = num6;
                  }
                  num4 = num5;
                }
                num3 = (double) num4;
              }
              double num9 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) > Core.Globals.candleSettings[0].factor * num3 / num9 && (((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1) == -1 && ((double) inOpen[index3 - 1] >= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]) > ((double) inOpen[index3 - 2] <= (double) inClose[index3 - 2] ? (double) inClose[index3 - 2] : (double) inOpen[index3 - 2])) && (((double) inClose[index3] < (double) inOpen[index3] ? -1 : 1) == -1 && (double) inOpen[index3] < (double) inOpen[index3 - 1] && ((double) inOpen[index3] > (double) inClose[index3 - 1] && (double) inClose[index3] > (double) inOpen[index3 - 2]) && (double) inClose[index3] < (double) inClose[index3 - 2]))
              {
                outInteger[index4] = -100;
                ++index4;
                goto label_41;
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_41:
            float num10;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              float num3;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num3 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num5 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  float num6 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num4 = (float) ((double) inHigh[index3 - 2] - (double) num5 + ((double) num6 - (double) inLow[index3 - 2]));
                }
                else
                  num4 = 0.0f;
                num3 = num4;
              }
              num10 = num3;
            }
            float num11;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num3;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num3 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num5 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num6 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num4 = (float) ((double) inHigh[index1] - (double) num5 + ((double) num6 - (double) inLow[index1]));
                }
                else
                  num4 = 0.0f;
                num3 = num4;
              }
              num11 = num3;
            }
            num2 += (double) num10 - (double) num11;
            ++index3;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl2Crows(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl2CrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          for (int index2 = index1; index2 < startIdx - 2; ++index2)
          {
            double num3;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += num3;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if ((inClose[index3 - 2] < inOpen[index3 - 2] ? -1 : 1) == 1)
            {
              double num3;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num3 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num4 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num5 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num7 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      double num8 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num6 = inHigh[index3 - 2] - num7 + (num8 - inLow[index3 - 2]);
                    }
                    else
                      num6 = 0.0;
                    num5 = num6;
                  }
                  num4 = num5;
                }
                num3 = num4;
              }
              double num9 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) > Core.Globals.candleSettings[0].factor * num3 / num9 && ((inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1) == -1 && (inOpen[index3 - 1] >= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]) > (inOpen[index3 - 2] <= inClose[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2])) && ((inClose[index3] < inOpen[index3] ? -1 : 1) == -1 && inOpen[index3] < inOpen[index3 - 1] && (inOpen[index3] > inClose[index3 - 1] && inClose[index3] > inOpen[index3 - 2]) && inClose[index3] < inClose[index3 - 2]))
              {
                outInteger[index4] = -100;
                ++index4;
                goto label_41;
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_41:
            double num10;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              double num3;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num3 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num5 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  double num6 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num4 = inHigh[index3 - 2] - num5 + (num6 - inLow[index3 - 2]);
                }
                else
                  num4 = 0.0;
                num3 = num4;
              }
              num10 = num3;
            }
            double num11;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num3;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num3 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num5 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num6 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num4 = inHigh[index1] - num5 + (num6 - inLow[index1]);
                }
                else
                  num4 = 0.0;
                num3 = num4;
              }
              num11 = num3;
            }
            num2 += num10 - num11;
            ++index3;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int Cdl3BlackCrowsLookback()
    {
      return Core.Globals.candleSettings[7].avgPeriod + 3;
    }

    public static Core.RetCode Cdl3BlackCrows(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3BlackCrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[2] = 0.0;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num3;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = (float) ((double) inHigh[index - 2] - (double) num6 + ((double) num7 - (double) inLow[index - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[2] = numArray[2] + (double) num3;
            float num8;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num5 = (float) ((double) inHigh[index - 1] - (double) num6 + ((double) num7 - (double) inLow[index - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[1] = numArray[1] + (double) num8;
            float num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index] - inLow[index];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num5 = (float) ((double) inHigh[index] - (double) num6 + ((double) num7 - (double) inLow[index]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num9 = num4;
            }
            numArray[0] = numArray[0] + (double) num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) == 1 && ((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1)
            {
              float num3 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
              double num4;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num4 = numArray[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      float num9 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num7 = (float) ((double) inHigh[index1 - 2] - (double) num8 + ((double) num9 - (double) inLow[index1 - 2]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num3 - (double) inLow[index1 - 2] < Core.Globals.candleSettings[7].factor * num4 / num10 && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1)
              {
                float num5 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num9 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num12 - (double) inLow[index1 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num5 - (double) inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num6 / num13 && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1] - inOpen[index1]);
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1] - inLow[index1];
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num14 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                          float num15 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                          num12 = (float) ((double) inHigh[index1] - (double) num14 + ((double) num15 - (double) inLow[index1]));
                        }
                        else
                          num12 = 0.0f;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num7 - (double) inLow[index1] < Core.Globals.candleSettings[7].factor * num8 / num16 && (double) inOpen[index1 - 1] < (double) inOpen[index1 - 2] && ((double) inOpen[index1 - 1] > (double) inClose[index1 - 2] && (double) inOpen[index1] < (double) inOpen[index1 - 1]) && ((double) inOpen[index1] > (double) inClose[index1 - 1] && (double) inHigh[index1 - 3] > (double) inClose[index1 - 2] && ((double) inClose[index1 - 2] > (double) inClose[index1 - 1] && (double) inClose[index1 - 1] > (double) inClose[index1])))
                  {
                    outInteger[index2] = -100;
                    ++index2;
                    goto label_85;
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_85:
            for (int index3 = 2; index3 >= 0; --index3)
            {
              float num3;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = (float) ((double) inHigh[index1 - index3] - (double) num6 + ((double) num7 - (double) inLow[index1 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num3 = num4;
              }
              float num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = (float) ((double) inHigh[num2 - index3] - (double) num6 + ((double) num7 - (double) inLow[num2 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + ((double) num3 - (double) num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl3BlackCrows(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3BlackCrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[2] = 0.0;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num3;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = inHigh[index - 2] - num6 + (num7 - inLow[index - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[2] = numArray[2] + num3;
            double num8;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num5 = inHigh[index - 1] - num6 + (num7 - inLow[index - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[1] = numArray[1] + num8;
            double num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index] - inLow[index];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num7 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num5 = inHigh[index] - num6 + (num7 - inLow[index]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num9 = num4;
            }
            numArray[0] = numArray[0] + num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) == 1 && (inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1)
            {
              double num3 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
              double num4;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num4 = numArray[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      double num9 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num7 = inHigh[index1 - 2] - num8 + (num9 - inLow[index1 - 2]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num3 - inLow[index1 - 2] < Core.Globals.candleSettings[7].factor * num4 / num10 && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1)
              {
                double num5 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num9 = inHigh[index1 - 1] - num11 + (num12 - inLow[index1 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num5 - inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num6 / num13 && (inClose[index1] < inOpen[index1] ? -1 : 1) == -1)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1] - inOpen[index1]);
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1] - inLow[index1];
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num14 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                          double num15 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                          num12 = inHigh[index1] - num14 + (num15 - inLow[index1]);
                        }
                        else
                          num12 = 0.0;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num7 - inLow[index1] < Core.Globals.candleSettings[7].factor * num8 / num16 && inOpen[index1 - 1] < inOpen[index1 - 2] && (inOpen[index1 - 1] > inClose[index1 - 2] && inOpen[index1] < inOpen[index1 - 1]) && (inOpen[index1] > inClose[index1 - 1] && inHigh[index1 - 3] > inClose[index1 - 2] && (inClose[index1 - 2] > inClose[index1 - 1] && inClose[index1 - 1] > inClose[index1])))
                  {
                    outInteger[index2] = -100;
                    ++index2;
                    goto label_85;
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_85:
            for (int index3 = 2; index3 >= 0; --index3)
            {
              double num3;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = inHigh[index1 - index3] - num6 + (num7 - inLow[index1 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num3 = num4;
              }
              double num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = inHigh[num2 - index3] - num6 + (num7 - inLow[num2 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + (num3 - num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int Cdl3InsideLookback()
    {
      return (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 2;
    }

    public static Core.RetCode Cdl3Inside(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3InsideLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 2; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          for (int index3 = index2; index3 < startIdx - 1; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = (float) ((double) inHigh[index4 - 2] - (double) num8 + ((double) num9 - (double) inLow[index4 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4 - 1] - inLow[index4 - 1];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                      float num11 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                      num8 = (float) ((double) inHigh[index4 - 1] - (double) num9 + ((double) num11 - (double) inLow[index4 - 1]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num5 / num12 && ((double) inClose[index4 - 1] <= (double) inOpen[index4 - 1] ? (double) inOpen[index4 - 1] : (double) inClose[index4 - 1]) < ((double) inClose[index4 - 2] <= (double) inOpen[index4 - 2] ? (double) inOpen[index4 - 2] : (double) inClose[index4 - 2]) && ((double) inClose[index4 - 1] >= (double) inOpen[index4 - 1] ? (double) inOpen[index4 - 1] : (double) inClose[index4 - 1]) > ((double) inClose[index4 - 2] >= (double) inOpen[index4 - 2] ? (double) inOpen[index4 - 2] : (double) inClose[index4 - 2]) && (((double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1) == 1 && (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == -1 && (double) inClose[index4] < (double) inOpen[index4 - 2]) || ((double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1) == -1 && (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == 1 && (double) inClose[index4] > (double) inOpen[index4 - 2])))
              {
                int num6 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            float num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 2] - inLow[index4 - 2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                  float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                  num6 = (float) ((double) inHigh[index4 - 2] - (double) num7 + ((double) num8 - (double) inLow[index4 - 2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num13 = num5;
            }
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += (double) num13 - (double) num14;
            float num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = (float) ((double) inHigh[index4 - 1] - (double) num7 + ((double) num8 - (double) inLow[index4 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += (double) num15 - (double) num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl3Inside(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3InsideLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 2; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          for (int index3 = index2; index3 < startIdx - 1; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = inHigh[index4 - 2] - num8 + (num9 - inLow[index4 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4 - 1] - inLow[index4 - 1];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                      double num11 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                      num8 = inHigh[index4 - 1] - num9 + (num11 - inLow[index4 - 1]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num5 / num12 && (inClose[index4 - 1] <= inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1]) < (inClose[index4 - 2] <= inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2]) && (inClose[index4 - 1] >= inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1]) > (inClose[index4 - 2] >= inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2]) && ((inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1) == 1 && ((inClose[index4] < inOpen[index4] ? -1 : 1) == -1 && inClose[index4] < inOpen[index4 - 2]) || (inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1) == -1 && ((inClose[index4] < inOpen[index4] ? -1 : 1) == 1 && inClose[index4] > inOpen[index4 - 2])))
              {
                int num6 = inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            double num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 2] - inLow[index4 - 2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                  double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                  num6 = inHigh[index4 - 2] - num7 + (num8 - inLow[index4 - 2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num13 = num5;
            }
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += num13 - num14;
            double num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = inHigh[index4 - 1] - num7 + (num8 - inLow[index4 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += num15 - num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int Cdl3LineStrikeLookback()
    {
      return Core.Globals.candleSettings[8].avgPeriod + 3;
    }

    public static Core.RetCode Cdl3LineStrike(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[4];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3LineStrikeLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[3] = 0.0;
          numArray[2] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num3;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 3] - inOpen[index - 3]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 3] - inLow[index - 3];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 3] < (double) inOpen[index - 3] ? inOpen[index - 3] : inClose[index - 3];
                  float num7 = (double) inClose[index - 3] < (double) inOpen[index - 3] ? inClose[index - 3] : inOpen[index - 3];
                  num5 = (float) ((double) inHigh[index - 3] - (double) num6 + ((double) num7 - (double) inLow[index - 3]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[3] = numArray[3] + (double) num3;
            float num8;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = (float) ((double) inHigh[index - 2] - (double) num6 + ((double) num7 - (double) inLow[index - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[2] = numArray[2] + (double) num8;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) == ((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) && ((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1))
            {
              float num3 = (double) inOpen[index1 - 3] >= (double) inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
              double num4;
              if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
              {
                num4 = numArray[3] / (double) Core.Globals.candleSettings[8].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 3] - inLow[index1 - 3];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                      float num9 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                      num7 = (float) ((double) inHigh[index1 - 3] - (double) num8 + ((double) num9 - (double) inLow[index1 - 3]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inOpen[index1 - 2] >= (double) num3 - Core.Globals.candleSettings[8].factor * num4 / num10)
              {
                float num5 = (double) inOpen[index1 - 3] <= (double) inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                double num6;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num6 = numArray[3] / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 3] - inLow[index1 - 3];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                        float num12 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                        num9 = (float) ((double) inHigh[index1 - 3] - (double) num11 + ((double) num12 - (double) inLow[index1 - 3]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inOpen[index1 - 2] <= (double) num5 + Core.Globals.candleSettings[8].factor * num6 / num13)
                {
                  float num7 = (double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  double num8;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num8 = numArray[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          float num14 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          float num15 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num12 = (float) ((double) inHigh[index1 - 2] - (double) num14 + ((double) num15 - (double) inLow[index1 - 2]));
                        }
                        else
                          num12 = 0.0f;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) inOpen[index1 - 1] >= (double) num7 - Core.Globals.candleSettings[8].factor * num8 / num16)
                  {
                    float num9 = (double) inOpen[index1 - 2] <= (double) inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                    double num11;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num11 = numArray[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num14 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            float num17 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            float num18 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num15 = (float) ((double) inHigh[index1 - 2] - (double) num17 + ((double) num18 - (double) inLow[index1 - 2]));
                          }
                          else
                            num15 = 0.0f;
                          num14 = num15;
                        }
                        num12 = num14;
                      }
                      num11 = (double) num12;
                    }
                    double num19 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inOpen[index1 - 1] <= (double) num9 + Core.Globals.candleSettings[8].factor * num11 / num19 && (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (double) inClose[index1 - 1] > (double) inClose[index1 - 2] && ((double) inClose[index1 - 2] > (double) inClose[index1 - 3] && (double) inOpen[index1] > (double) inClose[index1 - 1]) && (double) inClose[index1] < (double) inOpen[index1 - 3] || ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && (double) inClose[index1 - 1] < (double) inClose[index1 - 2] && ((double) inClose[index1 - 2] < (double) inClose[index1 - 3] && (double) inOpen[index1] < (double) inClose[index1 - 1]) && (double) inClose[index1] > (double) inOpen[index1 - 3]))
                    {
                      int num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1;
                      outInteger[index2] = num12 * 100;
                      ++index2;
                      goto label_89;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_89:
            for (int index3 = 3; index3 >= 2; --index3)
            {
              float num3;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = (float) ((double) inHigh[index1 - index3] - (double) num6 + ((double) num7 - (double) inLow[index1 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num3 = num4;
              }
              float num8;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = (float) ((double) inHigh[num2 - index3] - (double) num6 + ((double) num7 - (double) inLow[num2 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + ((double) num3 - (double) num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl3LineStrike(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[4];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3LineStrikeLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[3] = 0.0;
          numArray[2] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num3;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 3] - inOpen[index - 3]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 3] - inLow[index - 3];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 3] < inOpen[index - 3] ? inOpen[index - 3] : inClose[index - 3];
                  double num7 = inClose[index - 3] < inOpen[index - 3] ? inClose[index - 3] : inOpen[index - 3];
                  num5 = inHigh[index - 3] - num6 + (num7 - inLow[index - 3]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[3] = numArray[3] + num3;
            double num8;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = inHigh[index - 2] - num6 + (num7 - inLow[index - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[2] = numArray[2] + num8;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) == (inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) && (inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) && (inClose[index1] < inOpen[index1] ? -1 : 1) == -(inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1))
            {
              double num3 = inOpen[index1 - 3] >= inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
              double num4;
              if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
              {
                num4 = numArray[3] / (double) Core.Globals.candleSettings[8].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 3] - inLow[index1 - 3];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 3] < inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                      double num9 = inClose[index1 - 3] < inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                      num7 = inHigh[index1 - 3] - num8 + (num9 - inLow[index1 - 3]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inOpen[index1 - 2] >= num3 - Core.Globals.candleSettings[8].factor * num4 / num10)
              {
                double num5 = inOpen[index1 - 3] <= inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                double num6;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num6 = numArray[3] / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 3] - inLow[index1 - 3];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 3] < inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                        double num12 = inClose[index1 - 3] < inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                        num9 = inHigh[index1 - 3] - num11 + (num12 - inLow[index1 - 3]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inOpen[index1 - 2] <= num5 + Core.Globals.candleSettings[8].factor * num6 / num13)
                {
                  double num7 = inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  double num8;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num8 = numArray[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          double num14 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          double num15 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num12 = inHigh[index1 - 2] - num14 + (num15 - inLow[index1 - 2]);
                        }
                        else
                          num12 = 0.0;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (inOpen[index1 - 1] >= num7 - Core.Globals.candleSettings[8].factor * num8 / num16)
                  {
                    double num9 = inOpen[index1 - 2] <= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                    double num11;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num11 = numArray[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num14 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            double num17 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            double num18 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num15 = inHigh[index1 - 2] - num17 + (num18 - inLow[index1 - 2]);
                          }
                          else
                            num15 = 0.0;
                          num14 = num15;
                        }
                        num12 = num14;
                      }
                      num11 = num12;
                    }
                    double num19 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inOpen[index1 - 1] <= num9 + Core.Globals.candleSettings[8].factor * num11 / num19 && ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && inClose[index1 - 1] > inClose[index1 - 2] && (inClose[index1 - 2] > inClose[index1 - 3] && inOpen[index1] > inClose[index1 - 1]) && inClose[index1] < inOpen[index1 - 3] || (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && inClose[index1 - 1] < inClose[index1 - 2] && (inClose[index1 - 2] < inClose[index1 - 3] && inOpen[index1] < inClose[index1 - 1]) && inClose[index1] > inOpen[index1 - 3]))
                    {
                      int num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1;
                      outInteger[index2] = num12 * 100;
                      ++index2;
                      goto label_89;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_89:
            for (int index3 = 3; index3 >= 2; --index3)
            {
              double num3;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = inHigh[index1 - index3] - num6 + (num7 - inLow[index1 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num3 = num4;
              }
              double num8;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = inHigh[num2 - index3] - num6 + (num7 - inLow[num2 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + (num3 - num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int Cdl3OutsideLookback()
    {
      return 3;
    }

    public static Core.RetCode Cdl3Outside(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3OutsideLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1 && (double) inClose[index1 - 1] > (double) inOpen[index1 - 2] && ((double) inOpen[index1 - 1] < (double) inClose[index1 - 2] && (double) inClose[index1] > (double) inClose[index1 - 1])) || ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == 1 && (double) inOpen[index1 - 1] > (double) inClose[index1 - 2] && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 2] && (double) inClose[index1] < (double) inClose[index1 - 1])))
            {
              int num2 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1;
              outInteger[index2] = num2 * 100;
              ++index2;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl3Outside(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3OutsideLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1 && inClose[index1 - 1] > inOpen[index1 - 2] && (inOpen[index1 - 1] < inClose[index1 - 2] && inClose[index1] > inClose[index1 - 1])) || (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == 1 && inOpen[index1 - 1] > inClose[index1 - 2] && (inClose[index1 - 1] < inOpen[index1 - 2] && inClose[index1] < inClose[index1 - 1])))
            {
              int num2 = inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1;
              outInteger[index2] = num2 * 100;
              ++index2;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int Cdl3StarsInSouthLookback()
    {
      return ((Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) <= (Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : Core.Globals.candleSettings[0].avgPeriod) ? (Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : Core.Globals.candleSettings[0].avgPeriod) : (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[7].avgPeriod)) + 2;
    }

    public static Core.RetCode Cdl3StarsInSouth(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3StarsInSouthLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num6 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num7 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index2 = num3; index2 < startIdx; ++index2)
          {
            float num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num12 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num10 = (float) ((double) inHigh[index2 - 2] - (double) num11 + ((double) num12 - (double) inLow[index2 - 2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            num2 += (double) num8;
          }
          for (int index2 = num5; index2 < startIdx; ++index2)
          {
            float num8;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num12 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num10 = (float) ((double) inHigh[index2 - 2] - (double) num11 + ((double) num12 - (double) inLow[index2 - 2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            num4 += (double) num8;
          }
          for (int index2 = num6; index2 < startIdx; ++index2)
          {
            float num8;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num12 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num10 = (float) ((double) inHigh[index2 - 1] - (double) num11 + ((double) num12 - (double) inLow[index2 - 1]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray[1] = numArray[1] + (double) num8;
            float num13;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num12 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num10 = (float) ((double) inHigh[index2] - (double) num11 + ((double) num12 - (double) inLow[index2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray[0] = numArray[0] + (double) num13;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            float num8;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num12 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num10 = (float) ((double) inHigh[index2] - (double) num11 + ((double) num12 - (double) inLow[index2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            num7 += (double) num8;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if (((double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? -1 : 1) == -1 && ((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1) == -1 && ((double) inClose[index3] < (double) inOpen[index3] ? -1 : 1) == -1)
            {
              double num8;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num8 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num12 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      float num13 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num11 = (float) ((double) inHigh[index3 - 2] - (double) num12 + ((double) num13 - (double) inLow[index3 - 2]));
                    }
                    else
                      num11 = 0.0f;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = (double) num9;
              }
              double num14 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) > Core.Globals.candleSettings[0].factor * num8 / num14)
              {
                float num9 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                double num10;
                if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                {
                  num10 = num4 / (double) Core.Globals.candleSettings[4].avgPeriod;
                }
                else
                {
                  float num11;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                  {
                    num11 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                  }
                  else
                  {
                    float num12;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index3 - 2] - inLow[index3 - 2];
                    }
                    else
                    {
                      float num13;
                      if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                      {
                        float num15 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                        float num16 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                        num13 = (float) ((double) inHigh[index3 - 2] - (double) num15 + ((double) num16 - (double) inLow[index3 - 2]));
                      }
                      else
                        num13 = 0.0f;
                      num12 = num13;
                    }
                    num11 = num12;
                  }
                  num10 = (double) num11;
                }
                double num17 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num9 - (double) inLow[index3 - 2] > Core.Globals.candleSettings[4].factor * num10 / num17 && (double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) < (double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) && ((double) inOpen[index3 - 1] > (double) inClose[index3 - 2] && (double) inOpen[index3 - 1] <= (double) inHigh[index3 - 2]) && ((double) inLow[index3 - 1] < (double) inClose[index3 - 2] && (double) inLow[index3 - 1] >= (double) inLow[index3 - 2]))
                {
                  float num11 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  double num12;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num12 = numArray[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num13;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num13 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                    }
                    else
                    {
                      float num15;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num15 = inHigh[index3 - 1] - inLow[index3 - 1];
                      }
                      else
                      {
                        float num16;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num18 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                          float num19 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                          num16 = (float) ((double) inHigh[index3 - 1] - (double) num18 + ((double) num19 - (double) inLow[index3 - 1]));
                        }
                        else
                          num16 = 0.0f;
                        num15 = num16;
                      }
                      num13 = num15;
                    }
                    num12 = (double) num13;
                  }
                  double num20 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num11 - (double) inLow[index3 - 1] > Core.Globals.candleSettings[7].factor * num12 / num20)
                  {
                    double num13;
                    if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                    {
                      num13 = num7 / (double) Core.Globals.candleSettings[2].avgPeriod;
                    }
                    else
                    {
                      float num15;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                      {
                        num15 = Math.Abs(inClose[index3] - inOpen[index3]);
                      }
                      else
                      {
                        float num16;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                        {
                          num16 = inHigh[index3] - inLow[index3];
                        }
                        else
                        {
                          float num18;
                          if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                          {
                            float num19 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                            float num21 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                            num18 = (float) ((double) inHigh[index3] - (double) num19 + ((double) num21 - (double) inLow[index3]));
                          }
                          else
                            num18 = 0.0f;
                          num16 = num18;
                        }
                        num15 = num16;
                      }
                      num13 = (double) num15;
                    }
                    double num22 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) Math.Abs(inClose[index3] - inOpen[index3]) < Core.Globals.candleSettings[2].factor * num13 / num22)
                    {
                      float num15 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                      double num16;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num16 = numArray[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        float num18;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num18 = Math.Abs(inClose[index3] - inOpen[index3]);
                        }
                        else
                        {
                          float num19;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num19 = inHigh[index3] - inLow[index3];
                          }
                          else
                          {
                            float num21;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              float num23 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                              float num24 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                              num21 = (float) ((double) inHigh[index3] - (double) num23 + ((double) num24 - (double) inLow[index3]));
                            }
                            else
                              num21 = 0.0f;
                            num19 = num21;
                          }
                          num18 = num19;
                        }
                        num16 = (double) num18;
                      }
                      double num25 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) num15 - (double) inLow[index3] < Core.Globals.candleSettings[7].factor * num16 / num25)
                      {
                        float num18 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                        double num19;
                        if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                        {
                          num19 = numArray[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                        }
                        else
                        {
                          float num21;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                          {
                            num21 = Math.Abs(inClose[index3] - inOpen[index3]);
                          }
                          else
                          {
                            float num23;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                            {
                              num23 = inHigh[index3] - inLow[index3];
                            }
                            else
                            {
                              float num24;
                              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                              {
                                float num26 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                                float num27 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                                num24 = (float) ((double) inHigh[index3] - (double) num26 + ((double) num27 - (double) inLow[index3]));
                              }
                              else
                                num24 = 0.0f;
                              num23 = num24;
                            }
                            num21 = num23;
                          }
                          num19 = (double) num21;
                        }
                        double num28 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) inHigh[index3] - (double) num18 < Core.Globals.candleSettings[7].factor * num19 / num28 && (double) inLow[index3] > (double) inLow[index3 - 1] && (double) inHigh[index3] < (double) inHigh[index3 - 1])
                        {
                          outInteger[index4] = 100;
                          ++index4;
                          goto label_151;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_151:
            float num29;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  float num11 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num9 = (float) ((double) inHigh[index3 - 2] - (double) num10 + ((double) num11 - (double) inLow[index3 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num29 = num8;
            }
            float num30;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num30 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  float num11 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num9 = (float) ((double) inHigh[num3 - 2] - (double) num10 + ((double) num11 - (double) inLow[num3 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num30 = num8;
            }
            num2 += (double) num29 - (double) num30;
            float num31;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num31 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  float num11 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num9 = (float) ((double) inHigh[index3 - 2] - (double) num10 + ((double) num11 - (double) inLow[index3 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num31 = num8;
            }
            float num32;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num32 = Math.Abs(inClose[num5 - 2] - inOpen[num5 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[num5 - 2] - inLow[num5 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[num5 - 2] < (double) inOpen[num5 - 2] ? inOpen[num5 - 2] : inClose[num5 - 2];
                  float num11 = (double) inClose[num5 - 2] < (double) inOpen[num5 - 2] ? inClose[num5 - 2] : inOpen[num5 - 2];
                  num9 = (float) ((double) inHigh[num5 - 2] - (double) num10 + ((double) num11 - (double) inLow[num5 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num32 = num8;
            }
            num4 += (double) num31 - (double) num32;
            for (int index2 = 1; index2 >= 0; --index2)
            {
              float num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num12 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num10 = (float) ((double) inHigh[index3 - index2] - (double) num11 + ((double) num12 - (double) inLow[index3 - index2]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num8 = num9;
              }
              float num13;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num6 - index2] - inOpen[num6 - index2]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num6 - index2] - inLow[num6 - index2];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[num6 - index2] < (double) inOpen[num6 - index2] ? inOpen[num6 - index2] : inClose[num6 - index2];
                    float num12 = (double) inClose[num6 - index2] < (double) inOpen[num6 - index2] ? inClose[num6 - index2] : inOpen[num6 - index2];
                    num10 = (float) ((double) inHigh[num6 - index2] - (double) num11 + ((double) num12 - (double) inLow[num6 - index2]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray[index2] = numArray[index2] + ((double) num8 - (double) num13);
            }
            float num33;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num33 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num11 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num9 = (float) ((double) inHigh[index3] - (double) num10 + ((double) num11 - (double) inLow[index3]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num33 = num8;
            }
            float num34;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num34 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num11 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num9 = (float) ((double) inHigh[index1] - (double) num10 + ((double) num11 - (double) inLow[index1]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num34 = num8;
            }
            num7 += (double) num33 - (double) num34;
            ++index3;
            ++num3;
            ++num5;
            ++num6;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl3StarsInSouth(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3StarsInSouthLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num6 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num7 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index2 = num3; index2 < startIdx; ++index2)
          {
            double num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num12 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num10 = inHigh[index2 - 2] - num11 + (num12 - inLow[index2 - 2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            num2 += num8;
          }
          for (int index2 = num5; index2 < startIdx; ++index2)
          {
            double num8;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num12 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num10 = inHigh[index2 - 2] - num11 + (num12 - inLow[index2 - 2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            num4 += num8;
          }
          for (int index2 = num6; index2 < startIdx; ++index2)
          {
            double num8;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num12 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num10 = inHigh[index2 - 1] - num11 + (num12 - inLow[index2 - 1]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray[1] = numArray[1] + num8;
            double num13;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num12 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num10 = inHigh[index2] - num11 + (num12 - inLow[index2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray[0] = numArray[0] + num13;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            double num8;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num12 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num10 = inHigh[index2] - num11 + (num12 - inLow[index2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            num7 += num8;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if ((inClose[index3 - 2] < inOpen[index3 - 2] ? -1 : 1) == -1 && (inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1) == -1 && (inClose[index3] < inOpen[index3] ? -1 : 1) == -1)
            {
              double num8;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num8 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num12 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      double num13 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num11 = inHigh[index3 - 2] - num12 + (num13 - inLow[index3 - 2]);
                    }
                    else
                      num11 = 0.0;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = num9;
              }
              double num14 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) > Core.Globals.candleSettings[0].factor * num8 / num14)
              {
                double num9 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                double num10;
                if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                {
                  num10 = num4 / (double) Core.Globals.candleSettings[4].avgPeriod;
                }
                else
                {
                  double num11;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                  {
                    num11 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                  }
                  else
                  {
                    double num12;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index3 - 2] - inLow[index3 - 2];
                    }
                    else
                    {
                      double num13;
                      if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                      {
                        double num15 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                        double num16 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                        num13 = inHigh[index3 - 2] - num15 + (num16 - inLow[index3 - 2]);
                      }
                      else
                        num13 = 0.0;
                      num12 = num13;
                    }
                    num11 = num12;
                  }
                  num10 = num11;
                }
                double num17 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num9 - inLow[index3 - 2] > Core.Globals.candleSettings[4].factor * num10 / num17 && Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) < Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) && (inOpen[index3 - 1] > inClose[index3 - 2] && inOpen[index3 - 1] <= inHigh[index3 - 2]) && (inLow[index3 - 1] < inClose[index3 - 2] && inLow[index3 - 1] >= inLow[index3 - 2]))
                {
                  double num11 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  double num12;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num12 = numArray[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num13;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num13 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                    }
                    else
                    {
                      double num15;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num15 = inHigh[index3 - 1] - inLow[index3 - 1];
                      }
                      else
                      {
                        double num16;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num18 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                          double num19 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                          num16 = inHigh[index3 - 1] - num18 + (num19 - inLow[index3 - 1]);
                        }
                        else
                          num16 = 0.0;
                        num15 = num16;
                      }
                      num13 = num15;
                    }
                    num12 = num13;
                  }
                  double num20 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num11 - inLow[index3 - 1] > Core.Globals.candleSettings[7].factor * num12 / num20)
                  {
                    double num13;
                    if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                    {
                      num13 = num7 / (double) Core.Globals.candleSettings[2].avgPeriod;
                    }
                    else
                    {
                      double num15;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                      {
                        num15 = Math.Abs(inClose[index3] - inOpen[index3]);
                      }
                      else
                      {
                        double num16;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                        {
                          num16 = inHigh[index3] - inLow[index3];
                        }
                        else
                        {
                          double num18;
                          if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                          {
                            double num19 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                            double num21 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                            num18 = inHigh[index3] - num19 + (num21 - inLow[index3]);
                          }
                          else
                            num18 = 0.0;
                          num16 = num18;
                        }
                        num15 = num16;
                      }
                      num13 = num15;
                    }
                    double num22 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (Math.Abs(inClose[index3] - inOpen[index3]) < Core.Globals.candleSettings[2].factor * num13 / num22)
                    {
                      double num15 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                      double num16;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num16 = numArray[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        double num18;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num18 = Math.Abs(inClose[index3] - inOpen[index3]);
                        }
                        else
                        {
                          double num19;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num19 = inHigh[index3] - inLow[index3];
                          }
                          else
                          {
                            double num21;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              double num23 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                              double num24 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                              num21 = inHigh[index3] - num23 + (num24 - inLow[index3]);
                            }
                            else
                              num21 = 0.0;
                            num19 = num21;
                          }
                          num18 = num19;
                        }
                        num16 = num18;
                      }
                      double num25 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (num15 - inLow[index3] < Core.Globals.candleSettings[7].factor * num16 / num25)
                      {
                        double num18 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                        double num19;
                        if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                        {
                          num19 = numArray[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                        }
                        else
                        {
                          double num21;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                          {
                            num21 = Math.Abs(inClose[index3] - inOpen[index3]);
                          }
                          else
                          {
                            double num23;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                            {
                              num23 = inHigh[index3] - inLow[index3];
                            }
                            else
                            {
                              double num24;
                              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                              {
                                double num26 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                                double num27 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                                num24 = inHigh[index3] - num26 + (num27 - inLow[index3]);
                              }
                              else
                                num24 = 0.0;
                              num23 = num24;
                            }
                            num21 = num23;
                          }
                          num19 = num21;
                        }
                        double num28 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (inHigh[index3] - num18 < Core.Globals.candleSettings[7].factor * num19 / num28 && inLow[index3] > inLow[index3 - 1] && inHigh[index3] < inHigh[index3 - 1])
                        {
                          outInteger[index4] = 100;
                          ++index4;
                          goto label_151;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_151:
            double num29;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  double num11 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num9 = inHigh[index3 - 2] - num10 + (num11 - inLow[index3 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num29 = num8;
            }
            double num30;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num30 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[num3 - 2] < inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  double num11 = inClose[num3 - 2] < inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num9 = inHigh[num3 - 2] - num10 + (num11 - inLow[num3 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num30 = num8;
            }
            num2 += num29 - num30;
            double num31;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num31 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  double num11 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num9 = inHigh[index3 - 2] - num10 + (num11 - inLow[index3 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num31 = num8;
            }
            double num32;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num32 = Math.Abs(inClose[num5 - 2] - inOpen[num5 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[num5 - 2] - inLow[num5 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[num5 - 2] < inOpen[num5 - 2] ? inOpen[num5 - 2] : inClose[num5 - 2];
                  double num11 = inClose[num5 - 2] < inOpen[num5 - 2] ? inClose[num5 - 2] : inOpen[num5 - 2];
                  num9 = inHigh[num5 - 2] - num10 + (num11 - inLow[num5 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num32 = num8;
            }
            num4 += num31 - num32;
            for (int index2 = 1; index2 >= 0; --index2)
            {
              double num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num12 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num10 = inHigh[index3 - index2] - num11 + (num12 - inLow[index3 - index2]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num8 = num9;
              }
              double num13;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num6 - index2] - inOpen[num6 - index2]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num6 - index2] - inLow[num6 - index2];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[num6 - index2] < inOpen[num6 - index2] ? inOpen[num6 - index2] : inClose[num6 - index2];
                    double num12 = inClose[num6 - index2] < inOpen[num6 - index2] ? inClose[num6 - index2] : inOpen[num6 - index2];
                    num10 = inHigh[num6 - index2] - num11 + (num12 - inLow[num6 - index2]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray[index2] = numArray[index2] + (num8 - num13);
            }
            double num33;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num33 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num11 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num9 = inHigh[index3] - num10 + (num11 - inLow[index3]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num33 = num8;
            }
            double num34;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num34 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num11 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num9 = inHigh[index1] - num10 + (num11 - inLow[index1]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num34 = num8;
            }
            num7 += num33 - num34;
            ++index3;
            ++num3;
            ++num5;
            ++num6;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int Cdl3WhiteSoldiersLookback()
    {
      return ((Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) <= (Core.Globals.candleSettings[9].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[9].avgPeriod) ? (Core.Globals.candleSettings[9].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[9].avgPeriod) : (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : Core.Globals.candleSettings[7].avgPeriod)) + 2;
    }

    public static Core.RetCode Cdl3WhiteSoldiers(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3WhiteSoldiersLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[2] = 0.0;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          numArray3[2] = 0.0;
          numArray3[1] = 0.0;
          numArray3[0] = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[9].avgPeriod;
          double num5 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index2 = num2; index2 < startIdx; ++index2)
          {
            float num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num10 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num8 = (float) ((double) inHigh[index2 - 2] - (double) num9 + ((double) num10 - (double) inLow[index2 - 2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            numArray1[2] = numArray1[2] + (double) num6;
            float num11;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num10 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num8 = (float) ((double) inHigh[index2 - 1] - (double) num9 + ((double) num10 - (double) inLow[index2 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num11 = num7;
            }
            numArray1[1] = numArray1[1] + (double) num11;
            float num12;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num10 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = (float) ((double) inHigh[index2] - (double) num9 + ((double) num10 - (double) inLow[index2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num12 = num7;
            }
            numArray1[0] = numArray1[0] + (double) num12;
          }
          for (int index2 = num3; index2 < startIdx; ++index2)
          {
            float num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num10 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num8 = (float) ((double) inHigh[index2 - 2] - (double) num9 + ((double) num10 - (double) inLow[index2 - 2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            numArray2[2] = numArray2[2] + (double) num6;
            float num11;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num10 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num8 = (float) ((double) inHigh[index2 - 1] - (double) num9 + ((double) num10 - (double) inLow[index2 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num11 = num7;
            }
            numArray2[1] = numArray2[1] + (double) num11;
          }
          for (int index2 = num4; index2 < startIdx; ++index2)
          {
            float num6;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num10 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num8 = (float) ((double) inHigh[index2 - 2] - (double) num9 + ((double) num10 - (double) inLow[index2 - 2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            numArray3[2] = numArray3[2] + (double) num6;
            float num11;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num10 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num8 = (float) ((double) inHigh[index2 - 1] - (double) num9 + ((double) num10 - (double) inLow[index2 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num11 = num7;
            }
            numArray3[1] = numArray3[1] + (double) num11;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            float num6;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num10 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = (float) ((double) inHigh[index2] - (double) num9 + ((double) num10 - (double) inLow[index2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num5 += (double) num6;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if (((double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? -1 : 1) == 1)
            {
              float num6 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
              double num7;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num7 = numArray1[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      float num12 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num10 = (float) ((double) inHigh[index3 - 2] - (double) num11 + ((double) num12 - (double) inLow[index3 - 2]));
                    }
                    else
                      num10 = 0.0f;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = (double) num8;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index3 - 2] - (double) num6 < Core.Globals.candleSettings[7].factor * num7 / num13 && ((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1) == 1)
              {
                float num8 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                double num9;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num9 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index3 - 1] - inLow[index3 - 1];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                        float num15 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                        num12 = (float) ((double) inHigh[index3 - 1] - (double) num14 + ((double) num15 - (double) inLow[index3 - 1]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num10 = num11;
                  }
                  num9 = (double) num10;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index3 - 1] - (double) num8 < Core.Globals.candleSettings[7].factor * num9 / num16 && ((double) inClose[index3] < (double) inOpen[index3] ? -1 : 1) == 1)
                {
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num11;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num11 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num12;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num12 = Math.Abs(inClose[index3] - inOpen[index3]);
                    }
                    else
                    {
                      float num14;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num14 = inHigh[index3] - inLow[index3];
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num17 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                          float num18 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                          num15 = (float) ((double) inHigh[index3] - (double) num17 + ((double) num18 - (double) inLow[index3]));
                        }
                        else
                          num15 = 0.0f;
                        num14 = num15;
                      }
                      num12 = num14;
                    }
                    num11 = (double) num12;
                  }
                  double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) inHigh[index3] - (double) num10 < Core.Globals.candleSettings[7].factor * num11 / num19 && (double) inClose[index3] > (double) inClose[index3 - 1] && ((double) inClose[index3 - 1] > (double) inClose[index3 - 2] && (double) inOpen[index3 - 1] > (double) inOpen[index3 - 2]))
                  {
                    double num12;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num12 = numArray2[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      float num14;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num14 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num15 = inHigh[index3 - 2] - inLow[index3 - 2];
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            float num18 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                            float num20 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                            num17 = (float) ((double) inHigh[index3 - 2] - (double) num18 + ((double) num20 - (double) inLow[index3 - 2]));
                          }
                          else
                            num17 = 0.0f;
                          num15 = num17;
                        }
                        num14 = num15;
                      }
                      num12 = (double) num14;
                    }
                    double num21 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inOpen[index3 - 1] <= (double) inClose[index3 - 2] + Core.Globals.candleSettings[8].factor * num12 / num21 && (double) inOpen[index3] > (double) inOpen[index3 - 1])
                    {
                      double num14;
                      if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                      {
                        num14 = numArray2[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index3 - 1] - inLow[index3 - 1];
                          }
                          else
                          {
                            float num18;
                            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                            {
                              float num20 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                              float num22 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                              num18 = (float) ((double) inHigh[index3 - 1] - (double) num20 + ((double) num22 - (double) inLow[index3 - 1]));
                            }
                            else
                              num18 = 0.0f;
                            num17 = num18;
                          }
                          num15 = num17;
                        }
                        num14 = (double) num15;
                      }
                      double num23 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) inOpen[index3] <= (double) inClose[index3 - 1] + Core.Globals.candleSettings[8].factor * num14 / num23)
                      {
                        double num15;
                        if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                        {
                          num15 = numArray3[2] / (double) Core.Globals.candleSettings[9].avgPeriod;
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                          }
                          else
                          {
                            float num18;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                            {
                              num18 = inHigh[index3 - 2] - inLow[index3 - 2];
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                              {
                                float num22 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                                float num24 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                                num20 = (float) ((double) inHigh[index3 - 2] - (double) num22 + ((double) num24 - (double) inLow[index3 - 2]));
                              }
                              else
                                num20 = 0.0f;
                              num18 = num20;
                            }
                            num17 = num18;
                          }
                          num15 = (double) num17;
                        }
                        double num25 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) > (double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) - Core.Globals.candleSettings[9].factor * num15 / num25)
                        {
                          double num17;
                          if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                          {
                            num17 = numArray3[1] / (double) Core.Globals.candleSettings[9].avgPeriod;
                          }
                          else
                          {
                            float num18;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                            {
                              num18 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                              {
                                num20 = inHigh[index3 - 1] - inLow[index3 - 1];
                              }
                              else
                              {
                                float num22;
                                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                                {
                                  float num24 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                                  float num26 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                                  num22 = (float) ((double) inHigh[index3 - 1] - (double) num24 + ((double) num26 - (double) inLow[index3 - 1]));
                                }
                                else
                                  num22 = 0.0f;
                                num20 = num22;
                              }
                              num18 = num20;
                            }
                            num17 = (double) num18;
                          }
                          double num27 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if ((double) Math.Abs(inClose[index3] - inOpen[index3]) > (double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) - Core.Globals.candleSettings[9].factor * num17 / num27)
                          {
                            double num18;
                            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                            {
                              num18 = num5 / (double) Core.Globals.candleSettings[2].avgPeriod;
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                              {
                                num20 = Math.Abs(inClose[index3] - inOpen[index3]);
                              }
                              else
                              {
                                float num22;
                                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                                {
                                  num22 = inHigh[index3] - inLow[index3];
                                }
                                else
                                {
                                  float num24;
                                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                                  {
                                    float num26 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                                    float num28 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                                    num24 = (float) ((double) inHigh[index3] - (double) num26 + ((double) num28 - (double) inLow[index3]));
                                  }
                                  else
                                    num24 = 0.0f;
                                  num22 = num24;
                                }
                                num20 = num22;
                              }
                              num18 = (double) num20;
                            }
                            double num29 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                            if ((double) Math.Abs(inClose[index3] - inOpen[index3]) > Core.Globals.candleSettings[2].factor * num18 / num29)
                            {
                              outInteger[index4] = 100;
                              ++index4;
                              goto label_204;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_204:
            for (int index2 = 2; index2 >= 0; --index2)
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num10 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num8 = (float) ((double) inHigh[index3 - index2] - (double) num9 + ((double) num10 - (double) inLow[index3 - index2]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num6 = num7;
              }
              float num11;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num2 - index2] - inOpen[num2 - index2]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[num2 - index2] - inLow[num2 - index2];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[num2 - index2] < (double) inOpen[num2 - index2] ? inOpen[num2 - index2] : inClose[num2 - index2];
                    float num10 = (double) inClose[num2 - index2] < (double) inOpen[num2 - index2] ? inClose[num2 - index2] : inOpen[num2 - index2];
                    num8 = (float) ((double) inHigh[num2 - index2] - (double) num9 + ((double) num10 - (double) inLow[num2 - index2]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num11 = num7;
              }
              numArray1[index2] = numArray1[index2] + ((double) num6 - (double) num11);
            }
            for (int index2 = 2; index2 >= 1; --index2)
            {
              float num6;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num10 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num8 = (float) ((double) inHigh[index3 - index2] - (double) num9 + ((double) num10 - (double) inLow[index3 - index2]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num6 = num7;
              }
              float num11;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num4 - index2] - inOpen[num4 - index2]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[num4 - index2] - inLow[num4 - index2];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[num4 - index2] < (double) inOpen[num4 - index2] ? inOpen[num4 - index2] : inClose[num4 - index2];
                    float num10 = (double) inClose[num4 - index2] < (double) inOpen[num4 - index2] ? inClose[num4 - index2] : inOpen[num4 - index2];
                    num8 = (float) ((double) inHigh[num4 - index2] - (double) num9 + ((double) num10 - (double) inLow[num4 - index2]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num11 = num7;
              }
              numArray3[index2] = numArray3[index2] + ((double) num6 - (double) num11);
              float num12;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num12 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num10 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num8 = (float) ((double) inHigh[index3 - index2] - (double) num9 + ((double) num10 - (double) inLow[index3 - index2]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num12 = num7;
              }
              float num13;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num3 - index2] - inOpen[num3 - index2]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[num3 - index2] - inLow[num3 - index2];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[num3 - index2] < (double) inOpen[num3 - index2] ? inOpen[num3 - index2] : inClose[num3 - index2];
                    float num10 = (double) inClose[num3 - index2] < (double) inOpen[num3 - index2] ? inClose[num3 - index2] : inOpen[num3 - index2];
                    num8 = (float) ((double) inHigh[num3 - index2] - (double) num9 + ((double) num10 - (double) inLow[num3 - index2]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num13 = num7;
              }
              numArray2[index2] = numArray2[index2] + ((double) num12 - (double) num13);
            }
            float num30;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num30 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num30 = num6;
            }
            float num31;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num31 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num31 = num6;
            }
            num5 += (double) num30 - (double) num31;
            ++index3;
            ++num2;
            ++num3;
            ++num4;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode Cdl3WhiteSoldiers(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.Cdl3WhiteSoldiersLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[2] = 0.0;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          numArray3[2] = 0.0;
          numArray3[1] = 0.0;
          numArray3[0] = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[9].avgPeriod;
          double num5 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index2 = num2; index2 < startIdx; ++index2)
          {
            double num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num10 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num8 = inHigh[index2 - 2] - num9 + (num10 - inLow[index2 - 2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            numArray1[2] = numArray1[2] + num6;
            double num11;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num10 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num8 = inHigh[index2 - 1] - num9 + (num10 - inLow[index2 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num11 = num7;
            }
            numArray1[1] = numArray1[1] + num11;
            double num12;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num10 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = inHigh[index2] - num9 + (num10 - inLow[index2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num12 = num7;
            }
            numArray1[0] = numArray1[0] + num12;
          }
          for (int index2 = num3; index2 < startIdx; ++index2)
          {
            double num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num10 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num8 = inHigh[index2 - 2] - num9 + (num10 - inLow[index2 - 2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            numArray2[2] = numArray2[2] + num6;
            double num11;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num10 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num8 = inHigh[index2 - 1] - num9 + (num10 - inLow[index2 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num11 = num7;
            }
            numArray2[1] = numArray2[1] + num11;
          }
          for (int index2 = num4; index2 < startIdx; ++index2)
          {
            double num6;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num10 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num8 = inHigh[index2 - 2] - num9 + (num10 - inLow[index2 - 2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            numArray3[2] = numArray3[2] + num6;
            double num11;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num10 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num8 = inHigh[index2 - 1] - num9 + (num10 - inLow[index2 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num11 = num7;
            }
            numArray3[1] = numArray3[1] + num11;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            double num6;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num10 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = inHigh[index2] - num9 + (num10 - inLow[index2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num5 += num6;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if ((inClose[index3 - 2] < inOpen[index3 - 2] ? -1 : 1) == 1)
            {
              double num6 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
              double num7;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num7 = numArray1[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      double num12 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num10 = inHigh[index3 - 2] - num11 + (num12 - inLow[index3 - 2]);
                    }
                    else
                      num10 = 0.0;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = num8;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index3 - 2] - num6 < Core.Globals.candleSettings[7].factor * num7 / num13 && (inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1) == 1)
              {
                double num8 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                double num9;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num9 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index3 - 1] - inLow[index3 - 1];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                        double num15 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                        num12 = inHigh[index3 - 1] - num14 + (num15 - inLow[index3 - 1]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num10 = num11;
                  }
                  num9 = num10;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index3 - 1] - num8 < Core.Globals.candleSettings[7].factor * num9 / num16 && (inClose[index3] < inOpen[index3] ? -1 : 1) == 1)
                {
                  double num10 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num11;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num11 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num12;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num12 = Math.Abs(inClose[index3] - inOpen[index3]);
                    }
                    else
                    {
                      double num14;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num14 = inHigh[index3] - inLow[index3];
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num17 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                          double num18 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                          num15 = inHigh[index3] - num17 + (num18 - inLow[index3]);
                        }
                        else
                          num15 = 0.0;
                        num14 = num15;
                      }
                      num12 = num14;
                    }
                    num11 = num12;
                  }
                  double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (inHigh[index3] - num10 < Core.Globals.candleSettings[7].factor * num11 / num19 && inClose[index3] > inClose[index3 - 1] && (inClose[index3 - 1] > inClose[index3 - 2] && inOpen[index3 - 1] > inOpen[index3 - 2]))
                  {
                    double num12;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num12 = numArray2[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      double num14;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num14 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num15 = inHigh[index3 - 2] - inLow[index3 - 2];
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            double num18 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                            double num20 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                            num17 = inHigh[index3 - 2] - num18 + (num20 - inLow[index3 - 2]);
                          }
                          else
                            num17 = 0.0;
                          num15 = num17;
                        }
                        num14 = num15;
                      }
                      num12 = num14;
                    }
                    double num21 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inOpen[index3 - 1] <= inClose[index3 - 2] + Core.Globals.candleSettings[8].factor * num12 / num21 && inOpen[index3] > inOpen[index3 - 1])
                    {
                      double num14;
                      if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                      {
                        num14 = numArray2[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index3 - 1] - inLow[index3 - 1];
                          }
                          else
                          {
                            double num18;
                            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                            {
                              double num20 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                              double num22 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                              num18 = inHigh[index3 - 1] - num20 + (num22 - inLow[index3 - 1]);
                            }
                            else
                              num18 = 0.0;
                            num17 = num18;
                          }
                          num15 = num17;
                        }
                        num14 = num15;
                      }
                      double num23 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (inOpen[index3] <= inClose[index3 - 1] + Core.Globals.candleSettings[8].factor * num14 / num23)
                      {
                        double num15;
                        if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                        {
                          num15 = numArray3[2] / (double) Core.Globals.candleSettings[9].avgPeriod;
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                          }
                          else
                          {
                            double num18;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                            {
                              num18 = inHigh[index3 - 2] - inLow[index3 - 2];
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                              {
                                double num22 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                                double num24 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                                num20 = inHigh[index3 - 2] - num22 + (num24 - inLow[index3 - 2]);
                              }
                              else
                                num20 = 0.0;
                              num18 = num20;
                            }
                            num17 = num18;
                          }
                          num15 = num17;
                        }
                        double num25 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) > Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) - Core.Globals.candleSettings[9].factor * num15 / num25)
                        {
                          double num17;
                          if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                          {
                            num17 = numArray3[1] / (double) Core.Globals.candleSettings[9].avgPeriod;
                          }
                          else
                          {
                            double num18;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                            {
                              num18 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                              {
                                num20 = inHigh[index3 - 1] - inLow[index3 - 1];
                              }
                              else
                              {
                                double num22;
                                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                                {
                                  double num24 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                                  double num26 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                                  num22 = inHigh[index3 - 1] - num24 + (num26 - inLow[index3 - 1]);
                                }
                                else
                                  num22 = 0.0;
                                num20 = num22;
                              }
                              num18 = num20;
                            }
                            num17 = num18;
                          }
                          double num27 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if (Math.Abs(inClose[index3] - inOpen[index3]) > Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) - Core.Globals.candleSettings[9].factor * num17 / num27)
                          {
                            double num18;
                            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                            {
                              num18 = num5 / (double) Core.Globals.candleSettings[2].avgPeriod;
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                              {
                                num20 = Math.Abs(inClose[index3] - inOpen[index3]);
                              }
                              else
                              {
                                double num22;
                                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                                {
                                  num22 = inHigh[index3] - inLow[index3];
                                }
                                else
                                {
                                  double num24;
                                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                                  {
                                    double num26 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                                    double num28 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                                    num24 = inHigh[index3] - num26 + (num28 - inLow[index3]);
                                  }
                                  else
                                    num24 = 0.0;
                                  num22 = num24;
                                }
                                num20 = num22;
                              }
                              num18 = num20;
                            }
                            double num29 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                            if (Math.Abs(inClose[index3] - inOpen[index3]) > Core.Globals.candleSettings[2].factor * num18 / num29)
                            {
                              outInteger[index4] = 100;
                              ++index4;
                              goto label_204;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_204:
            for (int index2 = 2; index2 >= 0; --index2)
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num10 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num8 = inHigh[index3 - index2] - num9 + (num10 - inLow[index3 - index2]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num6 = num7;
              }
              double num11;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num2 - index2] - inOpen[num2 - index2]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[num2 - index2] - inLow[num2 - index2];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[num2 - index2] < inOpen[num2 - index2] ? inOpen[num2 - index2] : inClose[num2 - index2];
                    double num10 = inClose[num2 - index2] < inOpen[num2 - index2] ? inClose[num2 - index2] : inOpen[num2 - index2];
                    num8 = inHigh[num2 - index2] - num9 + (num10 - inLow[num2 - index2]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num11 = num7;
              }
              numArray1[index2] = numArray1[index2] + (num6 - num11);
            }
            for (int index2 = 2; index2 >= 1; --index2)
            {
              double num6;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num10 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num8 = inHigh[index3 - index2] - num9 + (num10 - inLow[index3 - index2]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num6 = num7;
              }
              double num11;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num4 - index2] - inOpen[num4 - index2]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[num4 - index2] - inLow[num4 - index2];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[num4 - index2] < inOpen[num4 - index2] ? inOpen[num4 - index2] : inClose[num4 - index2];
                    double num10 = inClose[num4 - index2] < inOpen[num4 - index2] ? inClose[num4 - index2] : inOpen[num4 - index2];
                    num8 = inHigh[num4 - index2] - num9 + (num10 - inLow[num4 - index2]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num11 = num7;
              }
              numArray3[index2] = numArray3[index2] + (num6 - num11);
              double num12;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num12 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num10 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num8 = inHigh[index3 - index2] - num9 + (num10 - inLow[index3 - index2]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num12 = num7;
              }
              double num13;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num3 - index2] - inOpen[num3 - index2]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[num3 - index2] - inLow[num3 - index2];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[num3 - index2] < inOpen[num3 - index2] ? inOpen[num3 - index2] : inClose[num3 - index2];
                    double num10 = inClose[num3 - index2] < inOpen[num3 - index2] ? inClose[num3 - index2] : inOpen[num3 - index2];
                    num8 = inHigh[num3 - index2] - num9 + (num10 - inLow[num3 - index2]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num13 = num7;
              }
              numArray2[index2] = numArray2[index2] + (num12 - num13);
            }
            double num30;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num30 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num30 = num6;
            }
            double num31;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num31 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num31 = num6;
            }
            num5 += num30 - num31;
            ++index3;
            ++num2;
            ++num3;
            ++num4;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlAbandonedBabyLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.3;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = ((Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod)) + 2;
label_5:
      return num;
    }

    public static Core.RetCode CdlAbandonedBaby(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_150;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlAbandonedBabyLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[3].avgPeriod;
            int index3 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            for (int index4 = index1; index4 < startIdx - 2; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += (double) num5;
            }
            for (int index4 = index2; index4 < startIdx - 1; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += (double) num5;
            }
            for (int index4 = index3; index4 < startIdx; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 += (double) num5;
            }
            int index5 = startIdx;
            int index6 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index5 - 2] - inLow[index5 - 2];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                      float num10 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                      num8 = (float) ((double) inHigh[index5 - 2] - (double) num9 + ((double) num10 - (double) inLow[index5 - 2]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index5 - 1] - inLow[index5 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                        float num12 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                        num9 = (float) ((double) inHigh[index5 - 1] - (double) num10 + ((double) num12 - (double) inLow[index5 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]) <= Core.Globals.candleSettings[3].factor * num6 / num13)
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                          float num14 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num14 - (double) inLow[index5]));
                        }
                        else
                          num10 = 0.0f;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = (double) num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index5] - inOpen[index5]) > Core.Globals.candleSettings[2].factor * num7 / num15 && (((double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? -1 : 1) == 1 && (((double) inClose[index5] < (double) inOpen[index5] ? -1 : 1) == -1 && (double) inClose[index5] < (double) inClose[index5 - 2] - (double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration && ((double) inLow[index5 - 1] > (double) inHigh[index5 - 2] && (double) inHigh[index5] < (double) inLow[index5 - 1])) || ((double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? -1 : 1) == -1 && (((double) inClose[index5] < (double) inOpen[index5] ? -1 : 1) == 1 && (double) inClose[index5] > (double) inClose[index5 - 2] + (double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration && ((double) inHigh[index5 - 1] < (double) inLow[index5 - 2] && (double) inLow[index5] > (double) inHigh[index5 - 1]))))
                  {
                    int num8 = (double) inClose[index5] < (double) inOpen[index5] ? -1 : 1;
                    outInteger[index6] = num8 * 100;
                    ++index6;
                    goto label_94;
                  }
                }
              }
              outInteger[index6] = 0;
              ++index6;
label_94:
              float num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 2] - inLow[index5 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                    float num9 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                    num7 = (float) ((double) inHigh[index5 - 2] - (double) num8 + ((double) num9 - (double) inLow[index5 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num16 = num6;
              }
              float num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                    float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += (double) num16 - (double) num17;
              float num18;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 1] - inLow[index5 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                    float num9 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                    num7 = (float) ((double) inHigh[index5 - 1] - (double) num8 + ((double) num9 - (double) inLow[index5 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num18 = num6;
              }
              float num19;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += (double) num18 - (double) num19;
              float num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num20 = num6;
              }
              float num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += (double) num20 - (double) num21;
              ++index5;
              ++index1;
              ++index2;
              ++index3;
            }
            while (index5 <= endIdx);
            outNBElement = index6;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_150:
      return retCode;
    }

    public static Core.RetCode CdlAbandonedBaby(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_150;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlAbandonedBabyLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[3].avgPeriod;
            int index3 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            for (int index4 = index1; index4 < startIdx - 2; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += num5;
            }
            for (int index4 = index2; index4 < startIdx - 1; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += num5;
            }
            for (int index4 = index3; index4 < startIdx; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 += num5;
            }
            int index5 = startIdx;
            int index6 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index5 - 2] - inLow[index5 - 2];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index5 - 2] < inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                      double num10 = inClose[index5 - 2] < inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                      num8 = inHigh[index5 - 2] - num9 + (num10 - inLow[index5 - 2]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index5 - 1] - inLow[index5 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index5 - 1] < inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                        double num12 = inClose[index5 - 1] < inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                        num9 = inHigh[index5 - 1] - num10 + (num12 - inLow[index5 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]) <= Core.Globals.candleSettings[3].factor * num6 / num13)
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                          double num14 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num10 = inHigh[index5] - num12 + (num14 - inLow[index5]);
                        }
                        else
                          num10 = 0.0;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index5] - inOpen[index5]) > Core.Globals.candleSettings[2].factor * num7 / num15 && ((inClose[index5 - 2] < inOpen[index5 - 2] ? -1 : 1) == 1 && ((inClose[index5] < inOpen[index5] ? -1 : 1) == -1 && inClose[index5] < inClose[index5 - 2] - Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration && (inLow[index5 - 1] > inHigh[index5 - 2] && inHigh[index5] < inLow[index5 - 1])) || (inClose[index5 - 2] < inOpen[index5 - 2] ? -1 : 1) == -1 && ((inClose[index5] < inOpen[index5] ? -1 : 1) == 1 && inClose[index5] > inClose[index5 - 2] + Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration && (inHigh[index5 - 1] < inLow[index5 - 2] && inLow[index5] > inHigh[index5 - 1]))))
                  {
                    int num8 = inClose[index5] < inOpen[index5] ? -1 : 1;
                    outInteger[index6] = num8 * 100;
                    ++index6;
                    goto label_94;
                  }
                }
              }
              outInteger[index6] = 0;
              ++index6;
label_94:
              double num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 2] - inLow[index5 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5 - 2] < inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                    double num9 = inClose[index5 - 2] < inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                    num7 = inHigh[index5 - 2] - num8 + (num9 - inLow[index5 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num16 = num6;
              }
              double num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                    double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += num16 - num17;
              double num18;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 1] - inLow[index5 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5 - 1] < inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                    double num9 = inClose[index5 - 1] < inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                    num7 = inHigh[index5 - 1] - num8 + (num9 - inLow[index5 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num18 = num6;
              }
              double num19;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += num18 - num19;
              double num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num20 = num6;
              }
              double num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += num20 - num21;
              ++index5;
              ++index1;
              ++index2;
              ++index3;
            }
            while (index5 <= endIdx);
            outNBElement = index6;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_150:
      return retCode;
    }

    public static int CdlAdvanceBlockLookback()
    {
      return (((Core.Globals.candleSettings[4].avgPeriod <= Core.Globals.candleSettings[6].avgPeriod ? Core.Globals.candleSettings[6].avgPeriod : Core.Globals.candleSettings[4].avgPeriod) <= (Core.Globals.candleSettings[9].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[9].avgPeriod) ? (Core.Globals.candleSettings[9].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[9].avgPeriod) : (Core.Globals.candleSettings[4].avgPeriod <= Core.Globals.candleSettings[6].avgPeriod ? Core.Globals.candleSettings[6].avgPeriod : Core.Globals.candleSettings[4].avgPeriod)) <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : ((Core.Globals.candleSettings[4].avgPeriod <= Core.Globals.candleSettings[6].avgPeriod ? Core.Globals.candleSettings[6].avgPeriod : Core.Globals.candleSettings[4].avgPeriod) <= (Core.Globals.candleSettings[9].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[9].avgPeriod) ? (Core.Globals.candleSettings[9].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[9].avgPeriod) : (Core.Globals.candleSettings[4].avgPeriod <= Core.Globals.candleSettings[6].avgPeriod ? Core.Globals.candleSettings[6].avgPeriod : Core.Globals.candleSettings[4].avgPeriod))) + 2;
    }

    public static Core.RetCode CdlAdvanceBlock(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[2];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlAdvanceBlockLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[6].avgPeriod;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          numArray3[2] = 0.0;
          numArray3[1] = 0.0;
          numArray3[0] = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          numArray4[2] = 0.0;
          numArray4[1] = 0.0;
          numArray4[0] = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[9].avgPeriod;
          double num6 = 0.0;
          int num7 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num8;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num12 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = (float) ((double) inHigh[index - 2] - (double) num11 + ((double) num12 - (double) inLow[index - 2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray1[2] = numArray1[2] + (double) num8;
            float num13;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num12 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = (float) ((double) inHigh[index - 1] - (double) num11 + ((double) num12 - (double) inLow[index - 1]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray1[1] = numArray1[1] + (double) num13;
            float num14;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index] - inLow[index];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num12 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num10 = (float) ((double) inHigh[index] - (double) num11 + ((double) num12 - (double) inLow[index]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num14 = num9;
            }
            numArray1[0] = numArray1[0] + (double) num14;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            float num8;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num12 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = (float) ((double) inHigh[index - 1] - (double) num11 + ((double) num12 - (double) inLow[index - 1]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray2[1] = numArray2[1] + (double) num8;
            float num13;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index] - inLow[index];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num12 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num10 = (float) ((double) inHigh[index] - (double) num11 + ((double) num12 - (double) inLow[index]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray2[0] = numArray2[0] + (double) num13;
          }
          for (int index = num4; index < startIdx; ++index)
          {
            float num8;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num12 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = (float) ((double) inHigh[index - 2] - (double) num11 + ((double) num12 - (double) inLow[index - 2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray3[2] = numArray3[2] + (double) num8;
            float num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num12 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = (float) ((double) inHigh[index - 1] - (double) num11 + ((double) num12 - (double) inLow[index - 1]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray3[1] = numArray3[1] + (double) num13;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            float num8;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num12 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = (float) ((double) inHigh[index - 2] - (double) num11 + ((double) num12 - (double) inLow[index - 2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray4[2] = numArray4[2] + (double) num8;
            float num13;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num12 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = (float) ((double) inHigh[index - 1] - (double) num11 + ((double) num12 - (double) inLow[index - 1]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray4[1] = numArray4[1] + (double) num13;
          }
          for (int index = num7; index < startIdx; ++index)
          {
            float num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num10;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num11 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num12 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = (float) ((double) inHigh[index - 2] - (double) num11 + ((double) num12 - (double) inLow[index - 2]));
                }
                else
                  num10 = 0.0f;
                num9 = num10;
              }
              num8 = num9;
            }
            num6 += (double) num8;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == 1 && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (double) inClose[index1] > (double) inClose[index1 - 1] && ((double) inClose[index1 - 1] > (double) inClose[index1 - 2] && (double) inOpen[index1 - 1] > (double) inOpen[index1 - 2])))
            {
              double num8;
              if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
              {
                num8 = numArray3[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                    {
                      float num12 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      float num13 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num11 = (float) ((double) inHigh[index1 - 2] - (double) num12 + ((double) num13 - (double) inLow[index1 - 2]));
                    }
                    else
                      num11 = 0.0f;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = (double) num9;
              }
              double num14 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inOpen[index1 - 1] <= (double) inClose[index1 - 2] + Core.Globals.candleSettings[8].factor * num8 / num14 && (double) inOpen[index1] > (double) inOpen[index1 - 1])
              {
                double num9;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num9 = numArray3[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num12 = (float) ((double) inHigh[index1 - 1] - (double) num13 + ((double) num15 - (double) inLow[index1 - 1]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num10 = num11;
                  }
                  num9 = (double) num10;
                }
                double num16 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inOpen[index1] <= (double) inClose[index1 - 1] + Core.Globals.candleSettings[8].factor * num9 / num16)
                {
                  double num10;
                  if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                  {
                    num10 = num6 / (double) Core.Globals.candleSettings[0].avgPeriod;
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                    {
                      num11 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                      {
                        num12 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        float num13;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                        {
                          float num15 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          float num17 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num13 = (float) ((double) inHigh[index1 - 2] - (double) num15 + ((double) num17 - (double) inLow[index1 - 2]));
                        }
                        else
                          num13 = 0.0f;
                        num12 = num13;
                      }
                      num11 = num12;
                    }
                    num10 = (double) num11;
                  }
                  double num18 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]) > Core.Globals.candleSettings[0].factor * num10 / num18)
                  {
                    float num11 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                    double num12;
                    if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                    {
                      num12 = numArray1[2] / (double) Core.Globals.candleSettings[6].avgPeriod;
                    }
                    else
                    {
                      float num13;
                      if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                      {
                        num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                        {
                          num15 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                          {
                            float num19 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            float num20 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num17 = (float) ((double) inHigh[index1 - 2] - (double) num19 + ((double) num20 - (double) inLow[index1 - 2]));
                          }
                          else
                            num17 = 0.0f;
                          num15 = num17;
                        }
                        num13 = num15;
                      }
                      num12 = (double) num13;
                    }
                    double num21 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inHigh[index1 - 2] - (double) num11 < Core.Globals.candleSettings[6].factor * num12 / num21)
                    {
                      double num13;
                      if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                      {
                        num13 = numArray4[2] / (double) Core.Globals.candleSettings[9].avgPeriod;
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index1 - 2] - inLow[index1 - 2];
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                            {
                              float num20 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                              float num22 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                              num19 = (float) ((double) inHigh[index1 - 2] - (double) num20 + ((double) num22 - (double) inLow[index1 - 2]));
                            }
                            else
                              num19 = 0.0f;
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        num13 = (double) num15;
                      }
                      double num23 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) < (double) Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]) - Core.Globals.candleSettings[9].factor * num13 / num23)
                      {
                        double num15;
                        if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                        {
                          num15 = numArray3[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                            {
                              num19 = inHigh[index1 - 1] - inLow[index1 - 1];
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                              {
                                float num22 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                float num24 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                num20 = (float) ((double) inHigh[index1 - 1] - (double) num22 + ((double) num24 - (double) inLow[index1 - 1]));
                              }
                              else
                                num20 = 0.0f;
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          num15 = (double) num17;
                        }
                        double num25 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) Math.Abs(inClose[index1] - inOpen[index1]) < (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) + Core.Globals.candleSettings[8].factor * num15 / num25)
                          goto label_251;
                      }
                      double num26;
                      if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                      {
                        num26 = numArray4[1] / (double) Core.Globals.candleSettings[9].avgPeriod;
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index1 - 1] - inLow[index1 - 1];
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                            {
                              float num20 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                              float num22 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                              num19 = (float) ((double) inHigh[index1 - 1] - (double) num20 + ((double) num22 - (double) inLow[index1 - 1]));
                            }
                            else
                              num19 = 0.0f;
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        num26 = (double) num15;
                      }
                      double num27 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) Math.Abs(inClose[index1] - inOpen[index1]) >= (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Core.Globals.candleSettings[9].factor * num26 / num27)
                      {
                        if ((double) Math.Abs(inClose[index1] - inOpen[index1]) < (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) && (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) < (double) Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]))
                        {
                          float num15 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                          double num17;
                          if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                          {
                            num17 = numArray1[0] / (double) Core.Globals.candleSettings[6].avgPeriod;
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                            {
                              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                              {
                                num20 = inHigh[index1] - inLow[index1];
                              }
                              else
                              {
                                float num22;
                                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                                {
                                  float num24 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                                  float num25 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                                  num22 = (float) ((double) inHigh[index1] - (double) num24 + ((double) num25 - (double) inLow[index1]));
                                }
                                else
                                  num22 = 0.0f;
                                num20 = num22;
                              }
                              num19 = num20;
                            }
                            num17 = (double) num19;
                          }
                          double num28 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if ((double) inHigh[index1] - (double) num15 <= Core.Globals.candleSettings[6].factor * num17 / num28)
                          {
                            float num19 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            double num20;
                            if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                            {
                              num20 = numArray1[1] / (double) Core.Globals.candleSettings[6].avgPeriod;
                            }
                            else
                            {
                              float num22;
                              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                              {
                                num22 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                              }
                              else
                              {
                                float num24;
                                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                                {
                                  num24 = inHigh[index1 - 1] - inLow[index1 - 1];
                                }
                                else
                                {
                                  float num25;
                                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                                  {
                                    float num29 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                    float num30 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                    num25 = (float) ((double) inHigh[index1 - 1] - (double) num29 + ((double) num30 - (double) inLow[index1 - 1]));
                                  }
                                  else
                                    num25 = 0.0f;
                                  num24 = num25;
                                }
                                num22 = num24;
                              }
                              num20 = (double) num22;
                            }
                            double num31 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                            if ((double) inHigh[index1 - 1] - (double) num19 > Core.Globals.candleSettings[6].factor * num20 / num31)
                              goto label_251;
                          }
                          else
                            goto label_251;
                        }
                        if ((double) Math.Abs(inClose[index1] - inOpen[index1]) < (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]))
                        {
                          float num15 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                          double num17;
                          if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                          {
                            num17 = numArray2[0] / (double) Core.Globals.candleSettings[4].avgPeriod;
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                            {
                              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                              {
                                num20 = inHigh[index1] - inLow[index1];
                              }
                              else
                              {
                                float num22;
                                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                                {
                                  float num24 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                                  float num25 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                                  num22 = (float) ((double) inHigh[index1] - (double) num24 + ((double) num25 - (double) inLow[index1]));
                                }
                                else
                                  num22 = 0.0f;
                                num20 = num22;
                              }
                              num19 = num20;
                            }
                            num17 = (double) num19;
                          }
                          double num28 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if ((double) inHigh[index1] - (double) num15 <= Core.Globals.candleSettings[4].factor * num17 / num28)
                            goto label_252;
                        }
                        else
                          goto label_252;
                      }
label_251:
                      outInteger[index2] = -100;
                      ++index2;
                      goto label_253;
                    }
                  }
                }
              }
            }
label_252:
            outInteger[index2] = 0;
            ++index2;
label_253:
            for (int index3 = 2; index3 >= 0; --index3)
            {
              float num8;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num12 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = (float) ((double) inHigh[index1 - index3] - (double) num11 + ((double) num12 - (double) inLow[index1 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num8 = num9;
              }
              float num13;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num12 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num10 = (float) ((double) inHigh[num2 - index3] - (double) num11 + ((double) num12 - (double) inLow[num2 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray1[index3] = numArray1[index3] + ((double) num8 - (double) num13);
            }
            for (int index3 = 1; index3 >= 0; --index3)
            {
              float num8;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num12 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = (float) ((double) inHigh[index1 - index3] - (double) num11 + ((double) num12 - (double) inLow[index1 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num8 = num9;
              }
              float num13;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    float num12 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num10 = (float) ((double) inHigh[num3 - index3] - (double) num11 + ((double) num12 - (double) inLow[num3 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray2[index3] = numArray2[index3] + ((double) num8 - (double) num13);
            }
            for (int index3 = 2; index3 >= 1; --index3)
            {
              float num8;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num12 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = (float) ((double) inHigh[index1 - index3] - (double) num11 + ((double) num12 - (double) inLow[index1 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num8 = num9;
              }
              float num13;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num5 - index3] - inOpen[num5 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num5 - index3] - inLow[num5 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[num5 - index3] < (double) inOpen[num5 - index3] ? inOpen[num5 - index3] : inClose[num5 - index3];
                    float num12 = (double) inClose[num5 - index3] < (double) inOpen[num5 - index3] ? inClose[num5 - index3] : inOpen[num5 - index3];
                    num10 = (float) ((double) inHigh[num5 - index3] - (double) num11 + ((double) num12 - (double) inLow[num5 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray4[index3] = numArray4[index3] + ((double) num8 - (double) num13);
              float num14;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num14 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num12 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = (float) ((double) inHigh[index1 - index3] - (double) num11 + ((double) num12 - (double) inLow[index1 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num14 = num9;
              }
              float num15;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num15 = Math.Abs(inClose[num4 - index3] - inOpen[num4 - index3]);
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num4 - index3] - inLow[num4 - index3];
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num11 = (double) inClose[num4 - index3] < (double) inOpen[num4 - index3] ? inOpen[num4 - index3] : inClose[num4 - index3];
                    float num12 = (double) inClose[num4 - index3] < (double) inOpen[num4 - index3] ? inClose[num4 - index3] : inOpen[num4 - index3];
                    num10 = (float) ((double) inHigh[num4 - index3] - (double) num11 + ((double) num12 - (double) inLow[num4 - index3]));
                  }
                  else
                    num10 = 0.0f;
                  num9 = num10;
                }
                num15 = num9;
              }
              numArray3[index3] = numArray3[index3] + ((double) num14 - (double) num15);
            }
            float num32;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num32 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index1 - 2] - inLow[index1 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  float num11 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  num9 = (float) ((double) inHigh[index1 - 2] - (double) num10 + ((double) num11 - (double) inLow[index1 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num32 = num8;
            }
            float num33;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num33 = Math.Abs(inClose[num7 - 2] - inOpen[num7 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[num7 - 2] - inLow[num7 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[num7 - 2] < (double) inOpen[num7 - 2] ? inOpen[num7 - 2] : inClose[num7 - 2];
                  float num11 = (double) inClose[num7 - 2] < (double) inOpen[num7 - 2] ? inClose[num7 - 2] : inOpen[num7 - 2];
                  num9 = (float) ((double) inHigh[num7 - 2] - (double) num10 + ((double) num11 - (double) inLow[num7 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num33 = num8;
            }
            num6 += (double) num32 - (double) num33;
            ++index1;
            ++num2;
            ++num3;
            ++num4;
            ++num5;
            ++num7;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlAdvanceBlock(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[2];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlAdvanceBlockLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[6].avgPeriod;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          numArray3[2] = 0.0;
          numArray3[1] = 0.0;
          numArray3[0] = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          numArray4[2] = 0.0;
          numArray4[1] = 0.0;
          numArray4[0] = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[9].avgPeriod;
          double num6 = 0.0;
          int num7 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num8;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num12 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = inHigh[index - 2] - num11 + (num12 - inLow[index - 2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray1[2] = numArray1[2] + num8;
            double num13;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num12 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = inHigh[index - 1] - num11 + (num12 - inLow[index - 1]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray1[1] = numArray1[1] + num13;
            double num14;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index] - inLow[index];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num12 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num10 = inHigh[index] - num11 + (num12 - inLow[index]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num14 = num9;
            }
            numArray1[0] = numArray1[0] + num14;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            double num8;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num12 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = inHigh[index - 1] - num11 + (num12 - inLow[index - 1]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray2[1] = numArray2[1] + num8;
            double num13;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index] - inLow[index];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num12 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num10 = inHigh[index] - num11 + (num12 - inLow[index]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray2[0] = numArray2[0] + num13;
          }
          for (int index = num4; index < startIdx; ++index)
          {
            double num8;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num12 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = inHigh[index - 2] - num11 + (num12 - inLow[index - 2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray3[2] = numArray3[2] + num8;
            double num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num12 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = inHigh[index - 1] - num11 + (num12 - inLow[index - 1]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray3[1] = numArray3[1] + num13;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            double num8;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num12 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = inHigh[index - 2] - num11 + (num12 - inLow[index - 2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            numArray4[2] = numArray4[2] + num8;
            double num13;
            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num12 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num10 = inHigh[index - 1] - num11 + (num12 - inLow[index - 1]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num13 = num9;
            }
            numArray4[1] = numArray4[1] + num13;
          }
          for (int index = num7; index < startIdx; ++index)
          {
            double num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num9 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num10;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num11 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num12 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num10 = inHigh[index - 2] - num11 + (num12 - inLow[index - 2]);
                }
                else
                  num10 = 0.0;
                num9 = num10;
              }
              num8 = num9;
            }
            num6 += num8;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == 1 && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && inClose[index1] > inClose[index1 - 1] && (inClose[index1 - 1] > inClose[index1 - 2] && inOpen[index1 - 1] > inOpen[index1 - 2])))
            {
              double num8;
              if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
              {
                num8 = numArray3[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                    {
                      double num12 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      double num13 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num11 = inHigh[index1 - 2] - num12 + (num13 - inLow[index1 - 2]);
                    }
                    else
                      num11 = 0.0;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = num9;
              }
              double num14 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inOpen[index1 - 1] <= inClose[index1 - 2] + Core.Globals.candleSettings[8].factor * num8 / num14 && inOpen[index1] > inOpen[index1 - 1])
              {
                double num9;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num9 = numArray3[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num12 = inHigh[index1 - 1] - num13 + (num15 - inLow[index1 - 1]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num10 = num11;
                  }
                  num9 = num10;
                }
                double num16 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inOpen[index1] <= inClose[index1 - 1] + Core.Globals.candleSettings[8].factor * num9 / num16)
                {
                  double num10;
                  if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                  {
                    num10 = num6 / (double) Core.Globals.candleSettings[0].avgPeriod;
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                    {
                      num11 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                      {
                        num12 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        double num13;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                        {
                          double num15 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          double num17 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num13 = inHigh[index1 - 2] - num15 + (num17 - inLow[index1 - 2]);
                        }
                        else
                          num13 = 0.0;
                        num12 = num13;
                      }
                      num11 = num12;
                    }
                    num10 = num11;
                  }
                  double num18 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]) > Core.Globals.candleSettings[0].factor * num10 / num18)
                  {
                    double num11 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                    double num12;
                    if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                    {
                      num12 = numArray1[2] / (double) Core.Globals.candleSettings[6].avgPeriod;
                    }
                    else
                    {
                      double num13;
                      if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                      {
                        num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                        {
                          num15 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                          {
                            double num19 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            double num20 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num17 = inHigh[index1 - 2] - num19 + (num20 - inLow[index1 - 2]);
                          }
                          else
                            num17 = 0.0;
                          num15 = num17;
                        }
                        num13 = num15;
                      }
                      num12 = num13;
                    }
                    double num21 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inHigh[index1 - 2] - num11 < Core.Globals.candleSettings[6].factor * num12 / num21)
                    {
                      double num13;
                      if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                      {
                        num13 = numArray4[2] / (double) Core.Globals.candleSettings[9].avgPeriod;
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index1 - 2] - inLow[index1 - 2];
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                            {
                              double num20 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                              double num22 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                              num19 = inHigh[index1 - 2] - num20 + (num22 - inLow[index1 - 2]);
                            }
                            else
                              num19 = 0.0;
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        num13 = num15;
                      }
                      double num23 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) < Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]) - Core.Globals.candleSettings[9].factor * num13 / num23)
                      {
                        double num15;
                        if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                        {
                          num15 = numArray3[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                            {
                              num19 = inHigh[index1 - 1] - inLow[index1 - 1];
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                              {
                                double num22 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                double num24 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                num20 = inHigh[index1 - 1] - num22 + (num24 - inLow[index1 - 1]);
                              }
                              else
                                num20 = 0.0;
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        double num25 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (Math.Abs(inClose[index1] - inOpen[index1]) < Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) + Core.Globals.candleSettings[8].factor * num15 / num25)
                          goto label_251;
                      }
                      double num26;
                      if ((double) Core.Globals.candleSettings[9].avgPeriod != 0.0)
                      {
                        num26 = numArray4[1] / (double) Core.Globals.candleSettings[9].avgPeriod;
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index1 - 1] - inLow[index1 - 1];
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                            {
                              double num20 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                              double num22 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                              num19 = inHigh[index1 - 1] - num20 + (num22 - inLow[index1 - 1]);
                            }
                            else
                              num19 = 0.0;
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        num26 = num15;
                      }
                      double num27 = Core.Globals.candleSettings[9].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (Math.Abs(inClose[index1] - inOpen[index1]) >= Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Core.Globals.candleSettings[9].factor * num26 / num27)
                      {
                        if (Math.Abs(inClose[index1] - inOpen[index1]) < Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) && Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) < Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]))
                        {
                          double num15 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                          double num17;
                          if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                          {
                            num17 = numArray1[0] / (double) Core.Globals.candleSettings[6].avgPeriod;
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                            {
                              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                              {
                                num20 = inHigh[index1] - inLow[index1];
                              }
                              else
                              {
                                double num22;
                                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                                {
                                  double num24 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                                  double num25 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                                  num22 = inHigh[index1] - num24 + (num25 - inLow[index1]);
                                }
                                else
                                  num22 = 0.0;
                                num20 = num22;
                              }
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          double num28 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if (inHigh[index1] - num15 <= Core.Globals.candleSettings[6].factor * num17 / num28)
                          {
                            double num19 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            double num20;
                            if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                            {
                              num20 = numArray1[1] / (double) Core.Globals.candleSettings[6].avgPeriod;
                            }
                            else
                            {
                              double num22;
                              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                              {
                                num22 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                              }
                              else
                              {
                                double num24;
                                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                                {
                                  num24 = inHigh[index1 - 1] - inLow[index1 - 1];
                                }
                                else
                                {
                                  double num25;
                                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                                  {
                                    double num29 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                    double num30 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                    num25 = inHigh[index1 - 1] - num29 + (num30 - inLow[index1 - 1]);
                                  }
                                  else
                                    num25 = 0.0;
                                  num24 = num25;
                                }
                                num22 = num24;
                              }
                              num20 = num22;
                            }
                            double num31 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                            if (inHigh[index1 - 1] - num19 > Core.Globals.candleSettings[6].factor * num20 / num31)
                              goto label_251;
                          }
                          else
                            goto label_251;
                        }
                        if (Math.Abs(inClose[index1] - inOpen[index1]) < Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]))
                        {
                          double num15 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                          double num17;
                          if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                          {
                            num17 = numArray2[0] / (double) Core.Globals.candleSettings[4].avgPeriod;
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                            {
                              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                              {
                                num20 = inHigh[index1] - inLow[index1];
                              }
                              else
                              {
                                double num22;
                                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                                {
                                  double num24 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                                  double num25 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                                  num22 = inHigh[index1] - num24 + (num25 - inLow[index1]);
                                }
                                else
                                  num22 = 0.0;
                                num20 = num22;
                              }
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          double num28 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if (inHigh[index1] - num15 <= Core.Globals.candleSettings[4].factor * num17 / num28)
                            goto label_252;
                        }
                        else
                          goto label_252;
                      }
label_251:
                      outInteger[index2] = -100;
                      ++index2;
                      goto label_253;
                    }
                  }
                }
              }
            }
label_252:
            outInteger[index2] = 0;
            ++index2;
label_253:
            for (int index3 = 2; index3 >= 0; --index3)
            {
              double num8;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num12 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = inHigh[index1 - index3] - num11 + (num12 - inLow[index1 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num8 = num9;
              }
              double num13;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num12 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num10 = inHigh[num2 - index3] - num11 + (num12 - inLow[num2 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray1[index3] = numArray1[index3] + (num8 - num13);
            }
            for (int index3 = 1; index3 >= 0; --index3)
            {
              double num8;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num12 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = inHigh[index1 - index3] - num11 + (num12 - inLow[index1 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num8 = num9;
              }
              double num13;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[num3 - index3] < inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    double num12 = inClose[num3 - index3] < inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num10 = inHigh[num3 - index3] - num11 + (num12 - inLow[num3 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray2[index3] = numArray2[index3] + (num8 - num13);
            }
            for (int index3 = 2; index3 >= 1; --index3)
            {
              double num8;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num12 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = inHigh[index1 - index3] - num11 + (num12 - inLow[index1 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num8 = num9;
              }
              double num13;
              if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[num5 - index3] - inOpen[num5 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num5 - index3] - inLow[num5 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[9].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[num5 - index3] < inOpen[num5 - index3] ? inOpen[num5 - index3] : inClose[num5 - index3];
                    double num12 = inClose[num5 - index3] < inOpen[num5 - index3] ? inClose[num5 - index3] : inOpen[num5 - index3];
                    num10 = inHigh[num5 - index3] - num11 + (num12 - inLow[num5 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num13 = num9;
              }
              numArray4[index3] = numArray4[index3] + (num8 - num13);
              double num14;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num14 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num12 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num10 = inHigh[index1 - index3] - num11 + (num12 - inLow[index1 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num14 = num9;
              }
              double num15;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num15 = Math.Abs(inClose[num4 - index3] - inOpen[num4 - index3]);
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num9 = inHigh[num4 - index3] - inLow[num4 - index3];
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num11 = inClose[num4 - index3] < inOpen[num4 - index3] ? inOpen[num4 - index3] : inClose[num4 - index3];
                    double num12 = inClose[num4 - index3] < inOpen[num4 - index3] ? inClose[num4 - index3] : inOpen[num4 - index3];
                    num10 = inHigh[num4 - index3] - num11 + (num12 - inLow[num4 - index3]);
                  }
                  else
                    num10 = 0.0;
                  num9 = num10;
                }
                num15 = num9;
              }
              numArray3[index3] = numArray3[index3] + (num14 - num15);
            }
            double num32;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num32 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index1 - 2] - inLow[index1 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  double num11 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  num9 = inHigh[index1 - 2] - num10 + (num11 - inLow[index1 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num32 = num8;
            }
            double num33;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num33 = Math.Abs(inClose[num7 - 2] - inOpen[num7 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[num7 - 2] - inLow[num7 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[num7 - 2] < inOpen[num7 - 2] ? inOpen[num7 - 2] : inClose[num7 - 2];
                  double num11 = inClose[num7 - 2] < inOpen[num7 - 2] ? inClose[num7 - 2] : inOpen[num7 - 2];
                  num9 = inHigh[num7 - 2] - num10 + (num11 - inLow[num7 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num33 = num8;
            }
            num6 += num32 - num33;
            ++index1;
            ++num2;
            ++num3;
            ++num4;
            ++num5;
            ++num7;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlBeltHoldLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[0].avgPeriod;
    }

    public static Core.RetCode CdlBeltHold(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlBeltHoldLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              if (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == 1)
              {
                float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num5 - (double) inLow[index4] < Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_78;
              }
              if (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == -1)
              {
                float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index4] - (double) num5 >= Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_79;
              }
              else
                goto label_79;
label_78:
              int num14 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
              outInteger[index5] = num14 * 100;
              ++index5;
              goto label_80;
            }
label_79:
            outInteger[index5] = 0;
            ++index5;
label_80:
            float num15;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num2 += (double) num15 - (double) num16;
            float num17;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num3 += (double) num17 - (double) num18;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlBeltHold(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlBeltHoldLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              if ((inClose[index4] < inOpen[index4] ? -1 : 1) == 1)
              {
                double num5 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num5 - inLow[index4] < Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_78;
              }
              if ((inClose[index4] < inOpen[index4] ? -1 : 1) == -1)
              {
                double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index4] - num5 >= Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_79;
              }
              else
                goto label_79;
label_78:
              int num14 = inClose[index4] < inOpen[index4] ? -1 : 1;
              outInteger[index5] = num14 * 100;
              ++index5;
              goto label_80;
            }
label_79:
            outInteger[index5] = 0;
            ++index5;
label_80:
            double num15;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num2 += num15 - num16;
            double num17;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num3 += num17 - num18;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlBreakawayLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod + 4;
    }

    public static Core.RetCode CdlBreakaway(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlBreakawayLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 4] - inOpen[index - 4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 4] - inLow[index - 4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 4] < (double) inOpen[index - 4] ? inOpen[index - 4] : inClose[index - 4];
                  float num8 = (double) inClose[index - 4] < (double) inOpen[index - 4] ? inClose[index - 4] : inOpen[index - 4];
                  num6 = (float) ((double) inHigh[index - 4] - (double) num7 + ((double) num8 - (double) inLow[index - 4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1 - 4] - inLow[index1 - 4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                    float num9 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                    num7 = (float) ((double) inHigh[index1 - 4] - (double) num8 + ((double) num9 - (double) inLow[index1 - 4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) > Core.Globals.candleSettings[0].factor * num4 / num10 && ((double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? -1 : 1) == ((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) && (((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) == ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1)) && (((double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? -1 : 1) == -1 && (((double) inOpen[index1 - 3] <= (double) inClose[index1 - 3] ? (double) inClose[index1 - 3] : (double) inOpen[index1 - 3]) < ((double) inOpen[index1 - 4] >= (double) inClose[index1 - 4] ? (double) inClose[index1 - 4] : (double) inOpen[index1 - 4]) && (double) inHigh[index1 - 2] < (double) inHigh[index1 - 3] && ((double) inLow[index1 - 2] < (double) inLow[index1 - 3] && (double) inHigh[index1 - 1] < (double) inHigh[index1 - 2]) && ((double) inLow[index1 - 1] < (double) inLow[index1 - 2] && (double) inClose[index1] > (double) inOpen[index1 - 3] && (double) inClose[index1] < (double) inClose[index1 - 4])) || ((double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? -1 : 1) == 1 && (((double) inOpen[index1 - 3] >= (double) inClose[index1 - 3] ? (double) inClose[index1 - 3] : (double) inOpen[index1 - 3]) > ((double) inOpen[index1 - 4] <= (double) inClose[index1 - 4] ? (double) inClose[index1 - 4] : (double) inOpen[index1 - 4]) && (double) inHigh[index1 - 2] > (double) inHigh[index1 - 3] && ((double) inLow[index1 - 2] > (double) inLow[index1 - 3] && (double) inHigh[index1 - 1] > (double) inHigh[index1 - 2]) && ((double) inLow[index1 - 1] > (double) inLow[index1 - 2] && (double) inClose[index1] < (double) inOpen[index1 - 3] && (double) inClose[index1] > (double) inClose[index1 - 4]))))
            {
              int num5 = (double) inClose[index1] < (double) inOpen[index1] ? -1 : 1;
              outInteger[index2] = num5 * 100;
              ++index2;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            float num11;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1 - 4] - inLow[index1 - 4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                  float num8 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                  num6 = (float) ((double) inHigh[index1 - 4] - (double) num7 + ((double) num8 - (double) inLow[index1 - 4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num11 = num5;
            }
            float num12;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[num3 - 4] - inOpen[num3 - 4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[num3 - 4] - inLow[num3 - 4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[num3 - 4] < (double) inOpen[num3 - 4] ? inOpen[num3 - 4] : inClose[num3 - 4];
                  float num8 = (double) inClose[num3 - 4] < (double) inOpen[num3 - 4] ? inClose[num3 - 4] : inOpen[num3 - 4];
                  num6 = (float) ((double) inHigh[num3 - 4] - (double) num7 + ((double) num8 - (double) inLow[num3 - 4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num12 = num5;
            }
            num2 += (double) num11 - (double) num12;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlBreakaway(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlBreakawayLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 4] - inOpen[index - 4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 4] - inLow[index - 4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 4] < inOpen[index - 4] ? inOpen[index - 4] : inClose[index - 4];
                  double num8 = inClose[index - 4] < inOpen[index - 4] ? inClose[index - 4] : inOpen[index - 4];
                  num6 = inHigh[index - 4] - num7 + (num8 - inLow[index - 4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1 - 4] - inLow[index1 - 4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1 - 4] < inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                    double num9 = inClose[index1 - 4] < inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                    num7 = inHigh[index1 - 4] - num8 + (num9 - inLow[index1 - 4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) > Core.Globals.candleSettings[0].factor * num4 / num10 && (inClose[index1 - 4] < inOpen[index1 - 4] ? -1 : 1) == (inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) && ((inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) == (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -(inClose[index1] < inOpen[index1] ? -1 : 1)) && ((inClose[index1 - 4] < inOpen[index1 - 4] ? -1 : 1) == -1 && ((inOpen[index1 - 3] <= inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3]) < (inOpen[index1 - 4] >= inClose[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4]) && inHigh[index1 - 2] < inHigh[index1 - 3] && (inLow[index1 - 2] < inLow[index1 - 3] && inHigh[index1 - 1] < inHigh[index1 - 2]) && (inLow[index1 - 1] < inLow[index1 - 2] && inClose[index1] > inOpen[index1 - 3] && inClose[index1] < inClose[index1 - 4])) || (inClose[index1 - 4] < inOpen[index1 - 4] ? -1 : 1) == 1 && ((inOpen[index1 - 3] >= inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3]) > (inOpen[index1 - 4] <= inClose[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4]) && inHigh[index1 - 2] > inHigh[index1 - 3] && (inLow[index1 - 2] > inLow[index1 - 3] && inHigh[index1 - 1] > inHigh[index1 - 2]) && (inLow[index1 - 1] > inLow[index1 - 2] && inClose[index1] < inOpen[index1 - 3] && inClose[index1] > inClose[index1 - 4]))))
            {
              int num5 = inClose[index1] < inOpen[index1] ? -1 : 1;
              outInteger[index2] = num5 * 100;
              ++index2;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            double num11;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1 - 4] - inLow[index1 - 4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1 - 4] < inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                  double num8 = inClose[index1 - 4] < inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                  num6 = inHigh[index1 - 4] - num7 + (num8 - inLow[index1 - 4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num11 = num5;
            }
            double num12;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[num3 - 4] - inOpen[num3 - 4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[num3 - 4] - inLow[num3 - 4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[num3 - 4] < inOpen[num3 - 4] ? inOpen[num3 - 4] : inClose[num3 - 4];
                  double num8 = inClose[num3 - 4] < inOpen[num3 - 4] ? inClose[num3 - 4] : inOpen[num3 - 4];
                  num6 = inHigh[num3 - 4] - num7 + (num8 - inLow[num3 - 4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num12 = num5;
            }
            num2 += num11 - num12;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlClosingMarubozuLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[0].avgPeriod;
    }

    public static Core.RetCode CdlClosingMarubozu(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlClosingMarubozuLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              if (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == 1)
              {
                float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index4] - (double) num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_78;
              }
              if (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == -1)
              {
                float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num5 - (double) inLow[index4] >= Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_79;
              }
              else
                goto label_79;
label_78:
              int num14 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
              outInteger[index5] = num14 * 100;
              ++index5;
              goto label_80;
            }
label_79:
            outInteger[index5] = 0;
            ++index5;
label_80:
            float num15;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num2 += (double) num15 - (double) num16;
            float num17;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num3 += (double) num17 - (double) num18;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlClosingMarubozu(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlClosingMarubozuLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              if ((inClose[index4] < inOpen[index4] ? -1 : 1) == 1)
              {
                double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index4] - num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_78;
              }
              if ((inClose[index4] < inOpen[index4] ? -1 : 1) == -1)
              {
                double num5 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num5 - inLow[index4] >= Core.Globals.candleSettings[7].factor * num6 / num13)
                  goto label_79;
              }
              else
                goto label_79;
label_78:
              int num14 = inClose[index4] < inOpen[index4] ? -1 : 1;
              outInteger[index5] = num14 * 100;
              ++index5;
              goto label_80;
            }
label_79:
            outInteger[index5] = 0;
            ++index5;
label_80:
            double num15;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num2 += num15 - num16;
            double num17;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num3 += num17 - num18;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlConcealBabysWallLookback()
    {
      return Core.Globals.candleSettings[7].avgPeriod + 3;
    }

    public static Core.RetCode CdlConcealBabysWall(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[4];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlConcealBabysWallLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[3] = 0.0;
          numArray[2] = 0.0;
          numArray[1] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num3;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 3] - inOpen[index - 3]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 3] - inLow[index - 3];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 3] < (double) inOpen[index - 3] ? inOpen[index - 3] : inClose[index - 3];
                  float num7 = (double) inClose[index - 3] < (double) inOpen[index - 3] ? inClose[index - 3] : inOpen[index - 3];
                  num5 = (float) ((double) inHigh[index - 3] - (double) num6 + ((double) num7 - (double) inLow[index - 3]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[3] = numArray[3] + (double) num3;
            float num8;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = (float) ((double) inHigh[index - 2] - (double) num6 + ((double) num7 - (double) inLow[index - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[2] = numArray[2] + (double) num8;
            float num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num5 = (float) ((double) inHigh[index - 1] - (double) num6 + ((double) num7 - (double) inLow[index - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num9 = num4;
            }
            numArray[1] = numArray[1] + (double) num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) == -1 && ((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1 && (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1))
            {
              float num3 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
              double num4;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num4 = numArray[3] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 3] - inLow[index1 - 3];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                      float num9 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                      num7 = (float) ((double) inHigh[index1 - 3] - (double) num8 + ((double) num9 - (double) inLow[index1 - 3]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num3 - (double) inLow[index1 - 3] < Core.Globals.candleSettings[7].factor * num4 / num10)
              {
                float num5 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray[3] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 3] - inLow[index1 - 3];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                        float num12 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                        num9 = (float) ((double) inHigh[index1 - 3] - (double) num11 + ((double) num12 - (double) inLow[index1 - 3]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index1 - 3] - (double) num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                {
                  float num7 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num14 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          float num15 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num12 = (float) ((double) inHigh[index1 - 2] - (double) num14 + ((double) num15 - (double) inLow[index1 - 2]));
                        }
                        else
                          num12 = 0.0f;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num7 - (double) inLow[index1 - 2] < Core.Globals.candleSettings[7].factor * num8 / num16)
                  {
                    float num9 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                    double num11;
                    if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                    {
                      num11 = numArray[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                        {
                          num14 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                          {
                            float num17 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            float num18 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num15 = (float) ((double) inHigh[index1 - 2] - (double) num17 + ((double) num18 - (double) inLow[index1 - 2]));
                          }
                          else
                            num15 = 0.0f;
                          num14 = num15;
                        }
                        num12 = num14;
                      }
                      num11 = (double) num12;
                    }
                    double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inHigh[index1 - 2] - (double) num9 < Core.Globals.candleSettings[7].factor * num11 / num19 && ((double) inOpen[index1 - 1] <= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) < ((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]))
                    {
                      float num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num14;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num14 = numArray[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        float num15;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index1 - 1] - inLow[index1 - 1];
                          }
                          else
                          {
                            float num18;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              float num20 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                              float num21 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                              num18 = (float) ((double) inHigh[index1 - 1] - (double) num20 + ((double) num21 - (double) inLow[index1 - 1]));
                            }
                            else
                              num18 = 0.0f;
                            num17 = num18;
                          }
                          num15 = num17;
                        }
                        num14 = (double) num15;
                      }
                      double num22 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) inHigh[index1 - 1] - (double) num12 > Core.Globals.candleSettings[7].factor * num14 / num22 && (double) inHigh[index1 - 1] > (double) inClose[index1 - 2] && ((double) inHigh[index1] > (double) inHigh[index1 - 1] && (double) inLow[index1] < (double) inLow[index1 - 1]))
                      {
                        outInteger[index2] = 100;
                        ++index2;
                        goto label_111;
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_111:
            for (int index3 = 3; index3 >= 1; --index3)
            {
              float num3;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = (float) ((double) inHigh[index1 - index3] - (double) num6 + ((double) num7 - (double) inLow[index1 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num3 = num4;
              }
              float num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = (float) ((double) inHigh[num2 - index3] - (double) num6 + ((double) num7 - (double) inLow[num2 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + ((double) num3 - (double) num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlConcealBabysWall(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[4];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlConcealBabysWallLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[3] = 0.0;
          numArray[2] = 0.0;
          numArray[1] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num3;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 3] - inOpen[index - 3]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 3] - inLow[index - 3];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 3] < inOpen[index - 3] ? inOpen[index - 3] : inClose[index - 3];
                  double num7 = inClose[index - 3] < inOpen[index - 3] ? inClose[index - 3] : inOpen[index - 3];
                  num5 = inHigh[index - 3] - num6 + (num7 - inLow[index - 3]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[3] = numArray[3] + num3;
            double num8;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = inHigh[index - 2] - num6 + (num7 - inLow[index - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[2] = numArray[2] + num8;
            double num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num5 = inHigh[index - 1] - num6 + (num7 - inLow[index - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num9 = num4;
            }
            numArray[1] = numArray[1] + num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) == -1 && (inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1 && ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && (inClose[index1] < inOpen[index1] ? -1 : 1) == -1))
            {
              double num3 = inClose[index1 - 3] < inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
              double num4;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num4 = numArray[3] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 3] - inLow[index1 - 3];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 3] < inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                      double num9 = inClose[index1 - 3] < inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                      num7 = inHigh[index1 - 3] - num8 + (num9 - inLow[index1 - 3]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num3 - inLow[index1 - 3] < Core.Globals.candleSettings[7].factor * num4 / num10)
              {
                double num5 = inClose[index1 - 3] < inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray[3] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 3] - inLow[index1 - 3];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 3] < inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                        double num12 = inClose[index1 - 3] < inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                        num9 = inHigh[index1 - 3] - num11 + (num12 - inLow[index1 - 3]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index1 - 3] - num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                {
                  double num7 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num14 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          double num15 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num12 = inHigh[index1 - 2] - num14 + (num15 - inLow[index1 - 2]);
                        }
                        else
                          num12 = 0.0;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num7 - inLow[index1 - 2] < Core.Globals.candleSettings[7].factor * num8 / num16)
                  {
                    double num9 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                    double num11;
                    if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                    {
                      num11 = numArray[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                        {
                          num14 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                          {
                            double num17 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            double num18 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num15 = inHigh[index1 - 2] - num17 + (num18 - inLow[index1 - 2]);
                          }
                          else
                            num15 = 0.0;
                          num14 = num15;
                        }
                        num12 = num14;
                      }
                      num11 = num12;
                    }
                    double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inHigh[index1 - 2] - num9 < Core.Globals.candleSettings[7].factor * num11 / num19 && (inOpen[index1 - 1] <= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) < (inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]))
                    {
                      double num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num14;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num14 = numArray[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        double num15;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num17 = inHigh[index1 - 1] - inLow[index1 - 1];
                          }
                          else
                          {
                            double num18;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              double num20 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                              double num21 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                              num18 = inHigh[index1 - 1] - num20 + (num21 - inLow[index1 - 1]);
                            }
                            else
                              num18 = 0.0;
                            num17 = num18;
                          }
                          num15 = num17;
                        }
                        num14 = num15;
                      }
                      double num22 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (inHigh[index1 - 1] - num12 > Core.Globals.candleSettings[7].factor * num14 / num22 && inHigh[index1 - 1] > inClose[index1 - 2] && (inHigh[index1] > inHigh[index1 - 1] && inLow[index1] < inLow[index1 - 1]))
                      {
                        outInteger[index2] = 100;
                        ++index2;
                        goto label_111;
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_111:
            for (int index3 = 3; index3 >= 1; --index3)
            {
              double num3;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = inHigh[index1 - index3] - num6 + (num7 - inLow[index1 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num3 = num4;
              }
              double num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = inHigh[num2 - index3] - num6 + (num7 - inLow[num2 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + (num3 - num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlCounterAttackLookback()
    {
      return (Core.Globals.candleSettings[10].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[10].avgPeriod) + 1;
    }

    public static Core.RetCode CdlCounterAttack(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlCounterAttackLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num5;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num7 = (float) ((double) inHigh[index - 1] - (double) num8 + ((double) num9 - (double) inLow[index - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += (double) num5;
          }
          for (int index = num4; index < startIdx; ++index)
          {
            float num5;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num7 = (float) ((double) inHigh[index - 1] - (double) num8 + ((double) num9 - (double) inLow[index - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            numArray[1] = numArray[1] + (double) num5;
            float num10;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index] - inLow[index];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num9 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num7 = (float) ((double) inHigh[index] - (double) num8 + ((double) num9 - (double) inLow[index]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num10 = num6;
            }
            numArray[0] = numArray[0] + (double) num10;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1))
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = numArray[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num8 = (float) ((double) inHigh[index1 - 1] - (double) num9 + ((double) num10 - (double) inLow[index1 - 1]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num5 / num11)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num6 = numArray[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1] - inOpen[index1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1] - inLow[index1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                        float num12 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                        num9 = (float) ((double) inHigh[index1] - (double) num10 + ((double) num12 - (double) inLow[index1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num6 / num13)
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                  {
                    num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          float num14 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num10 = (float) ((double) inHigh[index1 - 1] - (double) num12 + ((double) num14 - (double) inLow[index1 - 1]));
                        }
                        else
                          num10 = 0.0f;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = (double) num8;
                  }
                  double num15 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) inClose[index1] <= (double) inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num15)
                  {
                    double num8;
                    if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                    {
                      num8 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                      {
                        num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                        {
                          num10 = inHigh[index1 - 1] - inLow[index1 - 1];
                        }
                        else
                        {
                          float num12;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                          {
                            float num14 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            float num16 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                            num12 = (float) ((double) inHigh[index1 - 1] - (double) num14 + ((double) num16 - (double) inLow[index1 - 1]));
                          }
                          else
                            num12 = 0.0f;
                          num10 = num12;
                        }
                        num9 = num10;
                      }
                      num8 = (double) num9;
                    }
                    double num17 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inClose[index1] >= (double) inClose[index1 - 1] - Core.Globals.candleSettings[10].factor * num8 / num17)
                    {
                      int num9 = (double) inClose[index1] < (double) inOpen[index1] ? -1 : 1;
                      outInteger[index2] = num9 * 100;
                      ++index2;
                      goto label_101;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_101:
            float num18;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num6 = (float) ((double) inHigh[index1 - 1] - (double) num7 + ((double) num8 - (double) inLow[index1 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            float num19;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num8 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num6 = (float) ((double) inHigh[num3 - 1] - (double) num7 + ((double) num8 - (double) inLow[num3 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            num2 += (double) num18 - (double) num19;
            for (int index3 = 1; index3 >= 0; --index3)
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num9 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num7 = (float) ((double) inHigh[index1 - index3] - (double) num8 + ((double) num9 - (double) inLow[index1 - index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              float num10;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[num4 - index3] - inOpen[num4 - index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[num4 - index3] - inLow[num4 - index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[num4 - index3] < (double) inOpen[num4 - index3] ? inOpen[num4 - index3] : inClose[num4 - index3];
                    float num9 = (double) inClose[num4 - index3] < (double) inOpen[num4 - index3] ? inClose[num4 - index3] : inOpen[num4 - index3];
                    num7 = (float) ((double) inHigh[num4 - index3] - (double) num8 + ((double) num9 - (double) inLow[num4 - index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num10 = num6;
              }
              numArray[index3] = numArray[index3] + ((double) num5 - (double) num10);
            }
            ++index1;
            ++num3;
            ++num4;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlCounterAttack(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlCounterAttackLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num5;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num7 = inHigh[index - 1] - num8 + (num9 - inLow[index - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += num5;
          }
          for (int index = num4; index < startIdx; ++index)
          {
            double num5;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num7 = inHigh[index - 1] - num8 + (num9 - inLow[index - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            numArray[1] = numArray[1] + num5;
            double num10;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index] - inLow[index];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num9 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num7 = inHigh[index] - num8 + (num9 - inLow[index]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num10 = num6;
            }
            numArray[0] = numArray[0] + num10;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -(inClose[index1] < inOpen[index1] ? -1 : 1))
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = numArray[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num8 = inHigh[index1 - 1] - num9 + (num10 - inLow[index1 - 1]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num5 / num11)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num6 = numArray[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1] - inOpen[index1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1] - inLow[index1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                        double num12 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                        num9 = inHigh[index1] - num10 + (num12 - inLow[index1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num6 / num13)
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                  {
                    num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          double num14 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num10 = inHigh[index1 - 1] - num12 + (num14 - inLow[index1 - 1]);
                        }
                        else
                          num10 = 0.0;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  double num15 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (inClose[index1] <= inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num15)
                  {
                    double num8;
                    if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                    {
                      num8 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                      {
                        num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                        {
                          num10 = inHigh[index1 - 1] - inLow[index1 - 1];
                        }
                        else
                        {
                          double num12;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                          {
                            double num14 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            double num16 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                            num12 = inHigh[index1 - 1] - num14 + (num16 - inLow[index1 - 1]);
                          }
                          else
                            num12 = 0.0;
                          num10 = num12;
                        }
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    double num17 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inClose[index1] >= inClose[index1 - 1] - Core.Globals.candleSettings[10].factor * num8 / num17)
                    {
                      int num9 = inClose[index1] < inOpen[index1] ? -1 : 1;
                      outInteger[index2] = num9 * 100;
                      ++index2;
                      goto label_101;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_101:
            double num18;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num6 = inHigh[index1 - 1] - num7 + (num8 - inLow[index1 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            double num19;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num8 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num6 = inHigh[num3 - 1] - num7 + (num8 - inLow[num3 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            num2 += num18 - num19;
            for (int index3 = 1; index3 >= 0; --index3)
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num9 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num7 = inHigh[index1 - index3] - num8 + (num9 - inLow[index1 - index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              double num10;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[num4 - index3] - inOpen[num4 - index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[num4 - index3] - inLow[num4 - index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[num4 - index3] < inOpen[num4 - index3] ? inOpen[num4 - index3] : inClose[num4 - index3];
                    double num9 = inClose[num4 - index3] < inOpen[num4 - index3] ? inClose[num4 - index3] : inOpen[num4 - index3];
                    num7 = inHigh[num4 - index3] - num8 + (num9 - inLow[num4 - index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num10 = num6;
              }
              numArray[index3] = numArray[index3] + (num5 - num10);
            }
            ++index1;
            ++num3;
            ++num4;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlDarkCloudCoverLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.5;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = Core.Globals.candleSettings[0].avgPeriod + 1;
label_5:
      return num;
    }

    public static Core.RetCode CdlDarkCloudCover(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.5;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_65;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlDarkCloudCoverLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
            for (int index = num3; index < startIdx; ++index)
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 1] - inLow[index - 1];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                    float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                    num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              num2 += (double) num4;
            }
            int index1 = startIdx;
            int index2 = 0;
            do
            {
              if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1)
              {
                double num4;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num7;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                      }
                      else
                        num7 = 0.0f;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = (double) num5;
                }
                double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1 && (double) inOpen[index1] > (double) inHigh[index1 - 1] && ((double) inClose[index1] > (double) inOpen[index1 - 1] && (double) inClose[index1] < (double) inClose[index1 - 1] - (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) * optInPenetration)))
                {
                  outInteger[index2] = -100;
                  ++index2;
                  goto label_45;
                }
              }
              outInteger[index2] = 0;
              ++index2;
label_45:
              float num11;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - 1] - inLow[index1 - 1];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                    float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                    num5 = (float) ((double) inHigh[index1 - 1] - (double) num6 + ((double) num7 - (double) inLow[index1 - 1]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num11 = num4;
              }
              float num12;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num12 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num3 - 1] - inLow[num3 - 1];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                    float num7 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                    num5 = (float) ((double) inHigh[num3 - 1] - (double) num6 + ((double) num7 - (double) inLow[num3 - 1]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num12 = num4;
              }
              num2 += (double) num11 - (double) num12;
              ++index1;
              ++num3;
            }
            while (index1 <= endIdx);
            outNBElement = index2;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_65:
      return retCode;
    }

    public static Core.RetCode CdlDarkCloudCover(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.5;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_65;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlDarkCloudCoverLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
            for (int index = num3; index < startIdx; ++index)
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 1] - inLow[index - 1];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                    double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                    num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              num2 += num4;
            }
            int index1 = startIdx;
            int index2 = 0;
            do
            {
              if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1)
              {
                double num4;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num7;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                      }
                      else
                        num7 = 0.0;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = num5;
                }
                double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == -1 && inOpen[index1] > inHigh[index1 - 1] && (inClose[index1] > inOpen[index1 - 1] && inClose[index1] < inClose[index1 - 1] - Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) * optInPenetration)))
                {
                  outInteger[index2] = -100;
                  ++index2;
                  goto label_45;
                }
              }
              outInteger[index2] = 0;
              ++index2;
label_45:
              double num11;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - 1] - inLow[index1 - 1];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                    double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                    num5 = inHigh[index1 - 1] - num6 + (num7 - inLow[index1 - 1]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num11 = num4;
              }
              double num12;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num12 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num3 - 1] - inLow[num3 - 1];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                    double num7 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                    num5 = inHigh[num3 - 1] - num6 + (num7 - inLow[num3 - 1]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num12 = num4;
              }
              num2 += num11 - num12;
              ++index1;
              ++num3;
            }
            while (index1 <= endIdx);
            outNBElement = index2;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_65:
      return retCode;
    }

    public static int CdlDojiLookback()
    {
      return Core.Globals.candleSettings[3].avgPeriod;
    }

    public static Core.RetCode CdlDoji(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          int index2;
          for (index2 = index1; index2 < startIdx; ++index2)
          {
            float num3;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += (double) num3;
          }
          int index3 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num3 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = (double) num4;
            }
            double num9 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index2] - inOpen[index2]) <= Core.Globals.candleSettings[3].factor * num3 / num9)
            {
              outInteger[index3] = 100;
              ++index3;
            }
            else
            {
              outInteger[index3] = 0;
              ++index3;
            }
            float num10;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num10 = num4;
            }
            float num11;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = (float) ((double) inHigh[index1] - (double) num6 + ((double) num7 - (double) inLow[index1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num11 = num4;
            }
            num2 += (double) num10 - (double) num11;
            ++index2;
            ++index1;
          }
          while (index2 <= endIdx);
          outNBElement = index3;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlDoji(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          int index2;
          for (index2 = index1; index2 < startIdx; ++index2)
          {
            double num3;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += num3;
          }
          int index3 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num3 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = num4;
            }
            double num9 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index2] - inOpen[index2]) <= Core.Globals.candleSettings[3].factor * num3 / num9)
            {
              outInteger[index3] = 100;
              ++index3;
            }
            else
            {
              outInteger[index3] = 0;
              ++index3;
            }
            double num10;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num10 = num4;
            }
            double num11;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num7 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = inHigh[index1] - num6 + (num7 - inLow[index1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num11 = num4;
            }
            num2 += num10 - num11;
            ++index2;
            ++index1;
          }
          while (index2 <= endIdx);
          outNBElement = index3;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlDojiStarLookback()
    {
      return (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) + 1;
    }

    public static Core.RetCode CdlDojiStar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlDojiStarLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 1 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 1; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = (float) ((double) inHigh[index4 - 1] - (double) num8 + ((double) num9 - (double) inLow[index4 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = (float) ((double) inHigh[index4] - (double) num9 + ((double) num11 - (double) inLow[index4]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num12 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num5 / num12 && (((double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1) == 1 && ((double) inOpen[index4] >= (double) inClose[index4] ? (double) inClose[index4] : (double) inOpen[index4]) > ((double) inOpen[index4 - 1] <= (double) inClose[index4 - 1] ? (double) inClose[index4 - 1] : (double) inOpen[index4 - 1]) || ((double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1) == -1 && ((double) inOpen[index4] <= (double) inClose[index4] ? (double) inClose[index4] : (double) inOpen[index4]) < ((double) inOpen[index4 - 1] >= (double) inClose[index4 - 1] ? (double) inClose[index4 - 1] : (double) inOpen[index4 - 1])))
              {
                int num6 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            float num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = (float) ((double) inHigh[index4 - 1] - (double) num7 + ((double) num8 - (double) inLow[index4 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num13 = num5;
            }
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += (double) num13 - (double) num14;
            float num15;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += (double) num15 - (double) num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlDojiStar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlDojiStarLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 1 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 1; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = inHigh[index4 - 1] - num8 + (num9 - inLow[index4 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num11 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = inHigh[index4] - num9 + (num11 - inLow[index4]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num12 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num5 / num12 && ((inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1) == 1 && (inOpen[index4] >= inClose[index4] ? inClose[index4] : inOpen[index4]) > (inOpen[index4 - 1] <= inClose[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1]) || (inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1) == -1 && (inOpen[index4] <= inClose[index4] ? inClose[index4] : inOpen[index4]) < (inOpen[index4 - 1] >= inClose[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1])))
              {
                int num6 = inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            double num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = inHigh[index4 - 1] - num7 + (num8 - inLow[index4 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num13 = num5;
            }
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += num13 - num14;
            double num15;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += num15 - num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlDragonflyDojiLookback()
    {
      return Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[3].avgPeriod;
    }

    public static Core.RetCode CdlDragonflyDoji(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlDragonflyDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index4] - (double) num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num7 - (double) inLow[index4] > Core.Globals.candleSettings[7].factor * num8 / num16)
                {
                  outInteger[index5] = 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlDragonflyDoji(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlDragonflyDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index4] - num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num7 - inLow[index4] > Core.Globals.candleSettings[7].factor * num8 / num16)
                {
                  outInteger[index5] = 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlEngulfingLookback()
    {
      return 2;
    }

    public static Core.RetCode CdlEngulfing(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlEngulfingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && (double) inClose[index1] > (double) inOpen[index1 - 1] && (double) inOpen[index1] < (double) inClose[index1 - 1]) || ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1 && (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (double) inOpen[index1] > (double) inClose[index1 - 1] && (double) inClose[index1] < (double) inOpen[index1 - 1]))
            {
              int num2 = (double) inClose[index1] < (double) inOpen[index1] ? -1 : 1;
              outInteger[index2] = num2 * 100;
              ++index2;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlEngulfing(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlEngulfingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && inClose[index1] > inOpen[index1 - 1] && inOpen[index1] < inClose[index1 - 1]) || (inClose[index1] < inOpen[index1] ? -1 : 1) == -1 && ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && inOpen[index1] > inClose[index1 - 1] && inClose[index1] < inOpen[index1 - 1]))
            {
              int num2 = inClose[index1] < inOpen[index1] ? -1 : 1;
              outInteger[index2] = num2 * 100;
              ++index2;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlEveningDojiStarLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.3;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = ((Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod)) + 2;
label_5:
      return num;
    }

    public static Core.RetCode CdlEveningDojiStar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_150;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlEveningDojiStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[3].avgPeriod;
            int index3 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            for (int index4 = index1; index4 < startIdx - 2; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += (double) num5;
            }
            for (int index4 = index2; index4 < startIdx - 1; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += (double) num5;
            }
            for (int index4 = index3; index4 < startIdx; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 += (double) num5;
            }
            int index5 = startIdx;
            int index6 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index5 - 2] - inLow[index5 - 2];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                      float num10 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                      num8 = (float) ((double) inHigh[index5 - 2] - (double) num9 + ((double) num10 - (double) inLow[index5 - 2]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && ((double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? -1 : 1) == 1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index5 - 1] - inLow[index5 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                        float num12 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                        num9 = (float) ((double) inHigh[index5 - 1] - (double) num10 + ((double) num12 - (double) inLow[index5 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]) <= Core.Globals.candleSettings[3].factor * num6 / num13 && ((double) inOpen[index5 - 1] >= (double) inClose[index5 - 1] ? (double) inClose[index5 - 1] : (double) inOpen[index5 - 1]) > ((double) inOpen[index5 - 2] <= (double) inClose[index5 - 2] ? (double) inClose[index5 - 2] : (double) inOpen[index5 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                          float num14 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num14 - (double) inLow[index5]));
                        }
                        else
                          num10 = 0.0f;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = (double) num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index5] - inOpen[index5]) > Core.Globals.candleSettings[2].factor * num7 / num15 && (((double) inClose[index5] < (double) inOpen[index5] ? -1 : 1) == -1 && (double) inClose[index5] < (double) inClose[index5 - 2] - (double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration))
                  {
                    outInteger[index6] = -100;
                    ++index6;
                    goto label_94;
                  }
                }
              }
              outInteger[index6] = 0;
              ++index6;
label_94:
              float num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 2] - inLow[index5 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                    float num9 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                    num7 = (float) ((double) inHigh[index5 - 2] - (double) num8 + ((double) num9 - (double) inLow[index5 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num16 = num6;
              }
              float num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                    float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += (double) num16 - (double) num17;
              float num18;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 1] - inLow[index5 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                    float num9 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                    num7 = (float) ((double) inHigh[index5 - 1] - (double) num8 + ((double) num9 - (double) inLow[index5 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num18 = num6;
              }
              float num19;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += (double) num18 - (double) num19;
              float num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num20 = num6;
              }
              float num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += (double) num20 - (double) num21;
              ++index5;
              ++index1;
              ++index2;
              ++index3;
            }
            while (index5 <= endIdx);
            outNBElement = index6;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_150:
      return retCode;
    }

    public static Core.RetCode CdlEveningDojiStar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_150;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlEveningDojiStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[3].avgPeriod;
            int index3 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            for (int index4 = index1; index4 < startIdx - 2; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += num5;
            }
            for (int index4 = index2; index4 < startIdx - 1; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += num5;
            }
            for (int index4 = index3; index4 < startIdx; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 += num5;
            }
            int index5 = startIdx;
            int index6 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index5 - 2] - inLow[index5 - 2];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index5 - 2] < inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                      double num10 = inClose[index5 - 2] < inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                      num8 = inHigh[index5 - 2] - num9 + (num10 - inLow[index5 - 2]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && (inClose[index5 - 2] < inOpen[index5 - 2] ? -1 : 1) == 1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index5 - 1] - inLow[index5 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index5 - 1] < inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                        double num12 = inClose[index5 - 1] < inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                        num9 = inHigh[index5 - 1] - num10 + (num12 - inLow[index5 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]) <= Core.Globals.candleSettings[3].factor * num6 / num13 && (inOpen[index5 - 1] >= inClose[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1]) > (inOpen[index5 - 2] <= inClose[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                          double num14 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num10 = inHigh[index5] - num12 + (num14 - inLow[index5]);
                        }
                        else
                          num10 = 0.0;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index5] - inOpen[index5]) > Core.Globals.candleSettings[2].factor * num7 / num15 && ((inClose[index5] < inOpen[index5] ? -1 : 1) == -1 && inClose[index5] < inClose[index5 - 2] - Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration))
                  {
                    outInteger[index6] = -100;
                    ++index6;
                    goto label_94;
                  }
                }
              }
              outInteger[index6] = 0;
              ++index6;
label_94:
              double num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 2] - inLow[index5 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5 - 2] < inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                    double num9 = inClose[index5 - 2] < inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                    num7 = inHigh[index5 - 2] - num8 + (num9 - inLow[index5 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num16 = num6;
              }
              double num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                    double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += num16 - num17;
              double num18;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 1] - inLow[index5 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5 - 1] < inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                    double num9 = inClose[index5 - 1] < inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                    num7 = inHigh[index5 - 1] - num8 + (num9 - inLow[index5 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num18 = num6;
              }
              double num19;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += num18 - num19;
              double num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num20 = num6;
              }
              double num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += num20 - num21;
              ++index5;
              ++index1;
              ++index2;
              ++index3;
            }
            while (index5 <= endIdx);
            outNBElement = index6;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_150:
      return retCode;
    }

    public static int CdlEveningStarLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.3;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 2;
label_5:
      return num;
    }

    public static Core.RetCode CdlEveningStar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_147;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlEveningStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
            for (int index3 = index1; index3 < startIdx - 2; ++index3)
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += (double) num5;
            }
            for (int index3 = index2; index3 < startIdx - 1; ++index3)
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += (double) num5;
              float num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index3 + 1] - inOpen[index3 + 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3 + 1] - inLow[index3 + 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3 + 1] < (double) inOpen[index3 + 1] ? inOpen[index3 + 1] : inClose[index3 + 1];
                    float num9 = (double) inClose[index3 + 1] < (double) inOpen[index3 + 1] ? inClose[index3 + 1] : inOpen[index3 + 1];
                    num7 = (float) ((double) inHigh[index3 + 1] - (double) num8 + ((double) num9 - (double) inLow[index3 + 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num10 = num6;
              }
              num4 += (double) num10;
            }
            int index4 = startIdx;
            int index5 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4 - 2] - inLow[index4 - 2];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                      float num10 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                      num8 = (float) ((double) inHigh[index4 - 2] - (double) num9 + ((double) num10 - (double) inLow[index4 - 2]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && ((double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1) == 1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        float num12 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num9 = (float) ((double) inHigh[index4 - 1] - (double) num10 + ((double) num12 - (double) inLow[index4 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num6 / num13 && ((double) inOpen[index4 - 1] >= (double) inClose[index4 - 1] ? (double) inClose[index4 - 1] : (double) inOpen[index4 - 1]) > ((double) inOpen[index4 - 2] <= (double) inClose[index4 - 2] ? (double) inClose[index4 - 2] : (double) inOpen[index4 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index4] - inOpen[index4]);
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index4] - inLow[index4];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                          float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                          num10 = (float) ((double) inHigh[index4] - (double) num12 + ((double) num14 - (double) inLow[index4]));
                        }
                        else
                          num10 = 0.0f;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = (double) num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[2].factor * num7 / num15 && (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == -1 && (double) inClose[index4] < (double) inClose[index4 - 2] - (double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) * optInPenetration))
                  {
                    outInteger[index5] = -100;
                    ++index5;
                    goto label_91;
                  }
                }
              }
              outInteger[index5] = 0;
              ++index5;
label_91:
              float num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = (float) ((double) inHigh[index4 - 2] - (double) num8 + ((double) num9 - (double) inLow[index4 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num16 = num6;
              }
              float num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                    float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += (double) num16 - (double) num17;
              float num18;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = (float) ((double) inHigh[index4 - 1] - (double) num8 + ((double) num9 - (double) inLow[index4 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num18 = num6;
              }
              float num19;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += (double) num18 - (double) num19;
              float num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num20 = num6;
              }
              float num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index2 + 1] - inOpen[index2 + 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2 + 1] - inLow[index2 + 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2 + 1] < (double) inOpen[index2 + 1] ? inOpen[index2 + 1] : inClose[index2 + 1];
                    float num9 = (double) inClose[index2 + 1] < (double) inOpen[index2 + 1] ? inClose[index2 + 1] : inOpen[index2 + 1];
                    num7 = (float) ((double) inHigh[index2 + 1] - (double) num8 + ((double) num9 - (double) inLow[index2 + 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += (double) num20 - (double) num21;
              ++index4;
              ++index1;
              ++index2;
            }
            while (index4 <= endIdx);
            outNBElement = index5;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_147:
      return retCode;
    }

    public static Core.RetCode CdlEveningStar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_147;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlEveningStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
            for (int index3 = index1; index3 < startIdx - 2; ++index3)
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += num5;
            }
            for (int index3 = index2; index3 < startIdx - 1; ++index3)
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += num5;
              double num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index3 + 1] - inOpen[index3 + 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3 + 1] - inLow[index3 + 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3 + 1] < inOpen[index3 + 1] ? inOpen[index3 + 1] : inClose[index3 + 1];
                    double num9 = inClose[index3 + 1] < inOpen[index3 + 1] ? inClose[index3 + 1] : inOpen[index3 + 1];
                    num7 = inHigh[index3 + 1] - num8 + (num9 - inLow[index3 + 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num10 = num6;
              }
              num4 += num10;
            }
            int index4 = startIdx;
            int index5 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4 - 2] - inLow[index4 - 2];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                      double num10 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                      num8 = inHigh[index4 - 2] - num9 + (num10 - inLow[index4 - 2]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && (inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1) == 1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        double num12 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num9 = inHigh[index4 - 1] - num10 + (num12 - inLow[index4 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num6 / num13 && (inOpen[index4 - 1] >= inClose[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1]) > (inOpen[index4 - 2] <= inClose[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index4] - inOpen[index4]);
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index4] - inLow[index4];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                          double num14 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                          num10 = inHigh[index4] - num12 + (num14 - inLow[index4]);
                        }
                        else
                          num10 = 0.0;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[2].factor * num7 / num15 && ((inClose[index4] < inOpen[index4] ? -1 : 1) == -1 && inClose[index4] < inClose[index4 - 2] - Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) * optInPenetration))
                  {
                    outInteger[index5] = -100;
                    ++index5;
                    goto label_91;
                  }
                }
              }
              outInteger[index5] = 0;
              ++index5;
label_91:
              double num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = inHigh[index4 - 2] - num8 + (num9 - inLow[index4 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num16 = num6;
              }
              double num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                    double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += num16 - num17;
              double num18;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = inHigh[index4 - 1] - num8 + (num9 - inLow[index4 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num18 = num6;
              }
              double num19;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += num18 - num19;
              double num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num20 = num6;
              }
              double num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index2 + 1] - inOpen[index2 + 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2 + 1] - inLow[index2 + 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2 + 1] < inOpen[index2 + 1] ? inOpen[index2 + 1] : inClose[index2 + 1];
                    double num9 = inClose[index2 + 1] < inOpen[index2 + 1] ? inClose[index2 + 1] : inOpen[index2 + 1];
                    num7 = inHigh[index2 + 1] - num8 + (num9 - inLow[index2 + 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += num20 - num21;
              ++index4;
              ++index1;
              ++index2;
            }
            while (index4 <= endIdx);
            outNBElement = index5;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_147:
      return retCode;
    }

    public static int CdlGapSideSideWhiteLookback()
    {
      return (Core.Globals.candleSettings[8].avgPeriod <= Core.Globals.candleSettings[10].avgPeriod ? Core.Globals.candleSettings[10].avgPeriod : Core.Globals.candleSettings[8].avgPeriod) + 2;
    }

    public static Core.RetCode CdlGapSideSideWhite(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlGapSideSideWhiteLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          int num5 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num4; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += (double) num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((((double) inOpen[index1 - 1] >= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) > ((double) inOpen[index1 - 2] <= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) && ((double) inOpen[index1] >= (double) inClose[index1] ? (double) inClose[index1] : (double) inOpen[index1]) > ((double) inOpen[index1 - 2] <= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) || ((double) inOpen[index1 - 1] <= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) < ((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) && ((double) inOpen[index1] <= (double) inClose[index1] ? (double) inClose[index1] : (double) inOpen[index1]) < ((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2])) && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
              {
                num6 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                    {
                      float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = (float) ((double) inHigh[index1 - 1] - (double) num10 + ((double) num11 - (double) inLow[index1 - 1]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1] - inOpen[index1]) >= (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Core.Globals.candleSettings[8].factor * num6 / num12)
              {
                double num7;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num13 - (double) inLow[index1 - 1]));
                      }
                      else
                        num10 = 0.0f;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = (double) num8;
                }
                double num14 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index1] - inOpen[index1]) <= (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) + Core.Globals.candleSettings[8].factor * num7 / num14)
                {
                  double num8;
                  if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                  {
                    num8 = num3 / (double) Core.Globals.candleSettings[10].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                      {
                        num10 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        float num11;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                        {
                          float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num11 = (float) ((double) inHigh[index1 - 1] - (double) num13 + ((double) num15 - (double) inLow[index1 - 1]));
                        }
                        else
                          num11 = 0.0f;
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) inOpen[index1] >= (double) inOpen[index1 - 1] - Core.Globals.candleSettings[10].factor * num8 / num16)
                  {
                    double num9;
                    if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                    {
                      num9 = num3 / (double) Core.Globals.candleSettings[10].avgPeriod;
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                      {
                        num10 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                      }
                      else
                      {
                        float num11;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                        {
                          num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                        }
                        else
                        {
                          float num13;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                          {
                            float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            float num17 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                            num13 = (float) ((double) inHigh[index1 - 1] - (double) num15 + ((double) num17 - (double) inLow[index1 - 1]));
                          }
                          else
                            num13 = 0.0f;
                          num11 = num13;
                        }
                        num10 = num11;
                      }
                      num9 = (double) num10;
                    }
                    double num18 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inOpen[index1] <= (double) inOpen[index1 - 1] + Core.Globals.candleSettings[10].factor * num9 / num18)
                    {
                      int num10 = ((double) inOpen[index1 - 1] >= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) <= ((double) inOpen[index1 - 2] <= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) ? -100 : 100;
                      outInteger[index2] = num10;
                      ++index2;
                      goto label_92;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_92:
            float num19;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num19 = num6;
            }
            float num20;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[num4 - 1] - inOpen[num4 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num4 - 1] - inLow[num4 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num4 - 1] < (double) inOpen[num4 - 1] ? inOpen[num4 - 1] : inClose[num4 - 1];
                  float num9 = (double) inClose[num4 - 1] < (double) inOpen[num4 - 1] ? inClose[num4 - 1] : inOpen[num4 - 1];
                  num7 = (float) ((double) inHigh[num4 - 1] - (double) num8 + ((double) num9 - (double) inLow[num4 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num20 = num6;
            }
            num2 += (double) num19 - (double) num20;
            float num21;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num21 = num6;
            }
            float num22;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  float num9 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = (float) ((double) inHigh[num5 - 1] - (double) num8 + ((double) num9 - (double) inLow[num5 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num22 = num6;
            }
            num3 += (double) num21 - (double) num22;
            ++index1;
            ++num4;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlGapSideSideWhite(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlGapSideSideWhiteLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          int num5 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num4; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((inOpen[index1 - 1] >= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) > (inOpen[index1 - 2] <= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) && (inOpen[index1] >= inClose[index1] ? inClose[index1] : inOpen[index1]) > (inOpen[index1 - 2] <= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) || (inOpen[index1 - 1] <= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) < (inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) && (inOpen[index1] <= inClose[index1] ? inClose[index1] : inOpen[index1]) < (inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2])) && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && (inClose[index1] < inOpen[index1] ? -1 : 1) == 1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
              {
                num6 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                    {
                      double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = inHigh[index1 - 1] - num10 + (num11 - inLow[index1 - 1]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1] - inOpen[index1]) >= Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Core.Globals.candleSettings[8].factor * num6 / num12)
              {
                double num7;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = inHigh[index1 - 1] - num11 + (num13 - inLow[index1 - 1]);
                      }
                      else
                        num10 = 0.0;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = num8;
                }
                double num14 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index1] - inOpen[index1]) <= Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) + Core.Globals.candleSettings[8].factor * num7 / num14)
                {
                  double num8;
                  if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                  {
                    num8 = num3 / (double) Core.Globals.candleSettings[10].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                      {
                        num10 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        double num11;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                        {
                          double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num11 = inHigh[index1 - 1] - num13 + (num15 - inLow[index1 - 1]);
                        }
                        else
                          num11 = 0.0;
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (inOpen[index1] >= inOpen[index1 - 1] - Core.Globals.candleSettings[10].factor * num8 / num16)
                  {
                    double num9;
                    if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                    {
                      num9 = num3 / (double) Core.Globals.candleSettings[10].avgPeriod;
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                      {
                        num10 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                      }
                      else
                      {
                        double num11;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                        {
                          num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                        }
                        else
                        {
                          double num13;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                          {
                            double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            double num17 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                            num13 = inHigh[index1 - 1] - num15 + (num17 - inLow[index1 - 1]);
                          }
                          else
                            num13 = 0.0;
                          num11 = num13;
                        }
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    double num18 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inOpen[index1] <= inOpen[index1 - 1] + Core.Globals.candleSettings[10].factor * num9 / num18)
                    {
                      int num10 = (inOpen[index1 - 1] >= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) <= (inOpen[index1 - 2] <= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) ? -100 : 100;
                      outInteger[index2] = num10;
                      ++index2;
                      goto label_92;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_92:
            double num19;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num19 = num6;
            }
            double num20;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[num4 - 1] - inOpen[num4 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num4 - 1] - inLow[num4 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num4 - 1] < inOpen[num4 - 1] ? inOpen[num4 - 1] : inClose[num4 - 1];
                  double num9 = inClose[num4 - 1] < inOpen[num4 - 1] ? inClose[num4 - 1] : inOpen[num4 - 1];
                  num7 = inHigh[num4 - 1] - num8 + (num9 - inLow[num4 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num20 = num6;
            }
            num2 += num19 - num20;
            double num21;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num21 = num6;
            }
            double num22;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num5 - 1] < inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  double num9 = inClose[num5 - 1] < inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = inHigh[num5 - 1] - num8 + (num9 - inLow[num5 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num22 = num6;
            }
            num3 += num21 - num22;
            ++index1;
            ++num4;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlGravestoneDojiLookback()
    {
      return Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[3].avgPeriod;
    }

    public static Core.RetCode CdlGravestoneDoji(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlGravestoneDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num5 - (double) inLow[index4] < Core.Globals.candleSettings[7].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index4] - (double) num7 > Core.Globals.candleSettings[7].factor * num8 / num16)
                {
                  outInteger[index5] = 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlGravestoneDoji(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlGravestoneDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num5 - inLow[index4] < Core.Globals.candleSettings[7].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index4] - num7 > Core.Globals.candleSettings[7].factor * num8 / num16)
                {
                  outInteger[index5] = 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHammerLookback()
    {
      return (((Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod)) <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : ((Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod))) + 1;
    }

    public static Core.RetCode CdlHammer(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHammerLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num5 = 0.0;
          int index4 = startIdx - 1 - Core.Globals.candleSettings[8].avgPeriod;
          for (int index5 = index1; index5 < startIdx; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index5 = index2; index5 < startIdx; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += (double) num6;
          }
          for (int index5 = index3; index5 < startIdx; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += (double) num6;
          }
          for (int index5 = index4; index5 < startIdx - 1; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num5 += (double) num6;
          }
          int index6 = startIdx;
          int index7 = 0;
          do
          {
            double num6;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num6 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num7 = Math.Abs(inClose[index6] - inOpen[index6]);
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index6] - inLow[index6];
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                    float num11 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                    num9 = (float) ((double) inHigh[index6] - (double) num10 + ((double) num11 - (double) inLow[index6]));
                  }
                  else
                    num9 = 0.0f;
                  num8 = num9;
                }
                num7 = num8;
              }
              num6 = (double) num7;
            }
            double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index6] - inOpen[index6]) < Core.Globals.candleSettings[2].factor * num6 / num12)
            {
              float num7 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
              double num8;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num8 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index6] - inOpen[index6]);
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index6] - inLow[index6];
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      float num13 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                      float num14 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                      num11 = (float) ((double) inHigh[index6] - (double) num13 + ((double) num14 - (double) inLow[index6]));
                    }
                    else
                      num11 = 0.0f;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = (double) num9;
              }
              double num15 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num7 - (double) inLow[index6] > Core.Globals.candleSettings[4].factor * num8 / num15)
              {
                float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                double num10;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num10 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num11;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num11 = Math.Abs(inClose[index6] - inOpen[index6]);
                  }
                  else
                  {
                    float num13;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num13 = inHigh[index6] - inLow[index6];
                    }
                    else
                    {
                      float num14;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num16 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                        float num17 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                        num14 = (float) ((double) inHigh[index6] - (double) num16 + ((double) num17 - (double) inLow[index6]));
                      }
                      else
                        num14 = 0.0f;
                      num13 = num14;
                    }
                    num11 = num13;
                  }
                  num10 = (double) num11;
                }
                double num18 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index6] - (double) num9 < Core.Globals.candleSettings[7].factor * num10 / num18)
                {
                  float num11 = (double) inClose[index6] >= (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num13;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num13 = num5 / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    float num14;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num14 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
                    }
                    else
                    {
                      float num16;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num16 = inHigh[index6 - 1] - inLow[index6 - 1];
                      }
                      else
                      {
                        float num17;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          float num19 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                          float num20 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                          num17 = (float) ((double) inHigh[index6 - 1] - (double) num19 + ((double) num20 - (double) inLow[index6 - 1]));
                        }
                        else
                          num17 = 0.0f;
                        num16 = num17;
                      }
                      num14 = num16;
                    }
                    num13 = (double) num14;
                  }
                  double num21 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num11 <= (double) inLow[index6 - 1] + Core.Globals.candleSettings[8].factor * num13 / num21)
                  {
                    outInteger[index7] = 100;
                    ++index7;
                    goto label_115;
                  }
                }
              }
            }
            outInteger[index7] = 0;
            ++index7;
label_115:
            float num22;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = (float) ((double) inHigh[index6] - (double) num9 + ((double) num10 - (double) inLow[index6]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num22 = num7;
            }
            float num23;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num10 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num8 = (float) ((double) inHigh[index1] - (double) num9 + ((double) num10 - (double) inLow[index1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num23 = num7;
            }
            num2 += (double) num22 - (double) num23;
            float num24;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = (float) ((double) inHigh[index6] - (double) num9 + ((double) num10 - (double) inLow[index6]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num24 = num7;
            }
            float num25;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num10 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = (float) ((double) inHigh[index2] - (double) num9 + ((double) num10 - (double) inLow[index2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num25 = num7;
            }
            num3 += (double) num24 - (double) num25;
            float num26;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = (float) ((double) inHigh[index6] - (double) num9 + ((double) num10 - (double) inLow[index6]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num26 = num7;
            }
            float num27;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = (float) ((double) inHigh[index3] - (double) num9 + ((double) num10 - (double) inLow[index3]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num27 = num7;
            }
            num4 += (double) num26 - (double) num27;
            float num28;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6 - 1] - inLow[index6 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                  float num10 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                  num8 = (float) ((double) inHigh[index6 - 1] - (double) num9 + ((double) num10 - (double) inLow[index6 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num28 = num7;
            }
            float num29;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num10 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num8 = (float) ((double) inHigh[index4] - (double) num9 + ((double) num10 - (double) inLow[index4]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num29 = num7;
            }
            num5 += (double) num28 - (double) num29;
            ++index6;
            ++index1;
            ++index2;
            ++index3;
            ++index4;
          }
          while (index6 <= endIdx);
          outNBElement = index7;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHammer(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHammerLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num5 = 0.0;
          int index4 = startIdx - 1 - Core.Globals.candleSettings[8].avgPeriod;
          for (int index5 = index1; index5 < startIdx; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index5 = index2; index5 < startIdx; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += num6;
          }
          for (int index5 = index3; index5 < startIdx; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += num6;
          }
          for (int index5 = index4; index5 < startIdx - 1; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num5 += num6;
          }
          int index6 = startIdx;
          int index7 = 0;
          do
          {
            double num6;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num6 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num7 = Math.Abs(inClose[index6] - inOpen[index6]);
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index6] - inLow[index6];
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num10 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                    double num11 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                    num9 = inHigh[index6] - num10 + (num11 - inLow[index6]);
                  }
                  else
                    num9 = 0.0;
                  num8 = num9;
                }
                num7 = num8;
              }
              num6 = num7;
            }
            double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index6] - inOpen[index6]) < Core.Globals.candleSettings[2].factor * num6 / num12)
            {
              double num7 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
              double num8;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num8 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index6] - inOpen[index6]);
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index6] - inLow[index6];
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      double num13 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                      double num14 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                      num11 = inHigh[index6] - num13 + (num14 - inLow[index6]);
                    }
                    else
                      num11 = 0.0;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = num9;
              }
              double num15 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num7 - inLow[index6] > Core.Globals.candleSettings[4].factor * num8 / num15)
              {
                double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                double num10;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num10 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num11;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num11 = Math.Abs(inClose[index6] - inOpen[index6]);
                  }
                  else
                  {
                    double num13;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num13 = inHigh[index6] - inLow[index6];
                    }
                    else
                    {
                      double num14;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num16 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                        double num17 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                        num14 = inHigh[index6] - num16 + (num17 - inLow[index6]);
                      }
                      else
                        num14 = 0.0;
                      num13 = num14;
                    }
                    num11 = num13;
                  }
                  num10 = num11;
                }
                double num18 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index6] - num9 < Core.Globals.candleSettings[7].factor * num10 / num18)
                {
                  double num11 = inClose[index6] >= inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num13;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num13 = num5 / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    double num14;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num14 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
                    }
                    else
                    {
                      double num16;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num16 = inHigh[index6 - 1] - inLow[index6 - 1];
                      }
                      else
                      {
                        double num17;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          double num19 = inClose[index6 - 1] < inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                          double num20 = inClose[index6 - 1] < inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                          num17 = inHigh[index6 - 1] - num19 + (num20 - inLow[index6 - 1]);
                        }
                        else
                          num17 = 0.0;
                        num16 = num17;
                      }
                      num14 = num16;
                    }
                    num13 = num14;
                  }
                  double num21 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num11 <= inLow[index6 - 1] + Core.Globals.candleSettings[8].factor * num13 / num21)
                  {
                    outInteger[index7] = 100;
                    ++index7;
                    goto label_115;
                  }
                }
              }
            }
            outInteger[index7] = 0;
            ++index7;
label_115:
            double num22;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num10 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = inHigh[index6] - num9 + (num10 - inLow[index6]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num22 = num7;
            }
            double num23;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num10 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num8 = inHigh[index1] - num9 + (num10 - inLow[index1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num23 = num7;
            }
            num2 += num22 - num23;
            double num24;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num10 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = inHigh[index6] - num9 + (num10 - inLow[index6]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num24 = num7;
            }
            double num25;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num10 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = inHigh[index2] - num9 + (num10 - inLow[index2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num25 = num7;
            }
            num3 += num24 - num25;
            double num26;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num10 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = inHigh[index6] - num9 + (num10 - inLow[index6]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num26 = num7;
            }
            double num27;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num10 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = inHigh[index3] - num9 + (num10 - inLow[index3]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num27 = num7;
            }
            num4 += num26 - num27;
            double num28;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6 - 1] - inLow[index6 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6 - 1] < inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                  double num10 = inClose[index6 - 1] < inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                  num8 = inHigh[index6 - 1] - num9 + (num10 - inLow[index6 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num28 = num7;
            }
            double num29;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num10 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num8 = inHigh[index4] - num9 + (num10 - inLow[index4]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num29 = num7;
            }
            num5 += num28 - num29;
            ++index6;
            ++index1;
            ++index2;
            ++index3;
            ++index4;
          }
          while (index6 <= endIdx);
          outNBElement = index7;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHangingManLookback()
    {
      return (((Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod)) <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : ((Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod))) + 1;
    }

    public static Core.RetCode CdlHangingMan(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHangingManLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num5 = 0.0;
          int index4 = startIdx - 1 - Core.Globals.candleSettings[8].avgPeriod;
          for (int index5 = index1; index5 < startIdx; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index5 = index2; index5 < startIdx; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += (double) num6;
          }
          for (int index5 = index3; index5 < startIdx; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += (double) num6;
          }
          for (int index5 = index4; index5 < startIdx - 1; ++index5)
          {
            float num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num5 += (double) num6;
          }
          int index6 = startIdx;
          int index7 = 0;
          do
          {
            double num6;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num6 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num7 = Math.Abs(inClose[index6] - inOpen[index6]);
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index6] - inLow[index6];
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                    float num11 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                    num9 = (float) ((double) inHigh[index6] - (double) num10 + ((double) num11 - (double) inLow[index6]));
                  }
                  else
                    num9 = 0.0f;
                  num8 = num9;
                }
                num7 = num8;
              }
              num6 = (double) num7;
            }
            double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index6] - inOpen[index6]) < Core.Globals.candleSettings[2].factor * num6 / num12)
            {
              float num7 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
              double num8;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num8 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index6] - inOpen[index6]);
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index6] - inLow[index6];
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      float num13 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                      float num14 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                      num11 = (float) ((double) inHigh[index6] - (double) num13 + ((double) num14 - (double) inLow[index6]));
                    }
                    else
                      num11 = 0.0f;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = (double) num9;
              }
              double num15 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num7 - (double) inLow[index6] > Core.Globals.candleSettings[4].factor * num8 / num15)
              {
                float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                double num10;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num10 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num11;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num11 = Math.Abs(inClose[index6] - inOpen[index6]);
                  }
                  else
                  {
                    float num13;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num13 = inHigh[index6] - inLow[index6];
                    }
                    else
                    {
                      float num14;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num16 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                        float num17 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                        num14 = (float) ((double) inHigh[index6] - (double) num16 + ((double) num17 - (double) inLow[index6]));
                      }
                      else
                        num14 = 0.0f;
                      num13 = num14;
                    }
                    num11 = num13;
                  }
                  num10 = (double) num11;
                }
                double num18 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index6] - (double) num9 < Core.Globals.candleSettings[7].factor * num10 / num18)
                {
                  float num11 = (double) inClose[index6] >= (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num13;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num13 = num5 / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    float num14;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num14 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
                    }
                    else
                    {
                      float num16;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num16 = inHigh[index6 - 1] - inLow[index6 - 1];
                      }
                      else
                      {
                        float num17;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          float num19 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                          float num20 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                          num17 = (float) ((double) inHigh[index6 - 1] - (double) num19 + ((double) num20 - (double) inLow[index6 - 1]));
                        }
                        else
                          num17 = 0.0f;
                        num16 = num17;
                      }
                      num14 = num16;
                    }
                    num13 = (double) num14;
                  }
                  double num21 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num11 >= (double) inHigh[index6 - 1] - Core.Globals.candleSettings[8].factor * num13 / num21)
                  {
                    outInteger[index7] = -100;
                    ++index7;
                    goto label_115;
                  }
                }
              }
            }
            outInteger[index7] = 0;
            ++index7;
label_115:
            float num22;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = (float) ((double) inHigh[index6] - (double) num9 + ((double) num10 - (double) inLow[index6]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num22 = num7;
            }
            float num23;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num10 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num8 = (float) ((double) inHigh[index1] - (double) num9 + ((double) num10 - (double) inLow[index1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num23 = num7;
            }
            num2 += (double) num22 - (double) num23;
            float num24;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = (float) ((double) inHigh[index6] - (double) num9 + ((double) num10 - (double) inLow[index6]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num24 = num7;
            }
            float num25;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num10 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = (float) ((double) inHigh[index2] - (double) num9 + ((double) num10 - (double) inLow[index2]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num25 = num7;
            }
            num3 += (double) num24 - (double) num25;
            float num26;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6] < (double) inOpen[index6] ? inOpen[index6] : inClose[index6];
                  float num10 = (double) inClose[index6] < (double) inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = (float) ((double) inHigh[index6] - (double) num9 + ((double) num10 - (double) inLow[index6]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num26 = num7;
            }
            float num27;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = (float) ((double) inHigh[index3] - (double) num9 + ((double) num10 - (double) inLow[index3]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num27 = num7;
            }
            num4 += (double) num26 - (double) num27;
            float num28;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6 - 1] - inLow[index6 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                  float num10 = (double) inClose[index6 - 1] < (double) inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                  num8 = (float) ((double) inHigh[index6 - 1] - (double) num9 + ((double) num10 - (double) inLow[index6 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num28 = num7;
            }
            float num29;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num10 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num8 = (float) ((double) inHigh[index4] - (double) num9 + ((double) num10 - (double) inLow[index4]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num29 = num7;
            }
            num5 += (double) num28 - (double) num29;
            ++index6;
            ++index1;
            ++index2;
            ++index3;
            ++index4;
          }
          while (index6 <= endIdx);
          outNBElement = index7;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHangingMan(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHangingManLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num5 = 0.0;
          int index4 = startIdx - 1 - Core.Globals.candleSettings[8].avgPeriod;
          for (int index5 = index1; index5 < startIdx; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index5 = index2; index5 < startIdx; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += num6;
          }
          for (int index5 = index3; index5 < startIdx; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += num6;
          }
          for (int index5 = index4; index5 < startIdx - 1; ++index5)
          {
            double num6;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num5 += num6;
          }
          int index6 = startIdx;
          int index7 = 0;
          do
          {
            double num6;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num6 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num7 = Math.Abs(inClose[index6] - inOpen[index6]);
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index6] - inLow[index6];
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num10 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                    double num11 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                    num9 = inHigh[index6] - num10 + (num11 - inLow[index6]);
                  }
                  else
                    num9 = 0.0;
                  num8 = num9;
                }
                num7 = num8;
              }
              num6 = num7;
            }
            double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index6] - inOpen[index6]) < Core.Globals.candleSettings[2].factor * num6 / num12)
            {
              double num7 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
              double num8;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num8 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num9 = Math.Abs(inClose[index6] - inOpen[index6]);
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num10 = inHigh[index6] - inLow[index6];
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      double num13 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                      double num14 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                      num11 = inHigh[index6] - num13 + (num14 - inLow[index6]);
                    }
                    else
                      num11 = 0.0;
                    num10 = num11;
                  }
                  num9 = num10;
                }
                num8 = num9;
              }
              double num15 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num7 - inLow[index6] > Core.Globals.candleSettings[4].factor * num8 / num15)
              {
                double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                double num10;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num10 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num11;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num11 = Math.Abs(inClose[index6] - inOpen[index6]);
                  }
                  else
                  {
                    double num13;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num13 = inHigh[index6] - inLow[index6];
                    }
                    else
                    {
                      double num14;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num16 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                        double num17 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                        num14 = inHigh[index6] - num16 + (num17 - inLow[index6]);
                      }
                      else
                        num14 = 0.0;
                      num13 = num14;
                    }
                    num11 = num13;
                  }
                  num10 = num11;
                }
                double num18 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index6] - num9 < Core.Globals.candleSettings[7].factor * num10 / num18)
                {
                  double num11 = inClose[index6] >= inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num13;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num13 = num5 / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    double num14;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num14 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
                    }
                    else
                    {
                      double num16;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num16 = inHigh[index6 - 1] - inLow[index6 - 1];
                      }
                      else
                      {
                        double num17;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          double num19 = inClose[index6 - 1] < inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                          double num20 = inClose[index6 - 1] < inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                          num17 = inHigh[index6 - 1] - num19 + (num20 - inLow[index6 - 1]);
                        }
                        else
                          num17 = 0.0;
                        num16 = num17;
                      }
                      num14 = num16;
                    }
                    num13 = num14;
                  }
                  double num21 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num11 >= inHigh[index6 - 1] - Core.Globals.candleSettings[8].factor * num13 / num21)
                  {
                    outInteger[index7] = -100;
                    ++index7;
                    goto label_115;
                  }
                }
              }
            }
            outInteger[index7] = 0;
            ++index7;
label_115:
            double num22;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num10 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = inHigh[index6] - num9 + (num10 - inLow[index6]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num22 = num7;
            }
            double num23;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num10 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num8 = inHigh[index1] - num9 + (num10 - inLow[index1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num23 = num7;
            }
            num2 += num22 - num23;
            double num24;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num10 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = inHigh[index6] - num9 + (num10 - inLow[index6]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num24 = num7;
            }
            double num25;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num10 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num8 = inHigh[index2] - num9 + (num10 - inLow[index2]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num25 = num7;
            }
            num3 += num24 - num25;
            double num26;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index6] - inOpen[index6]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6] - inLow[index6];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6] < inOpen[index6] ? inOpen[index6] : inClose[index6];
                  double num10 = inClose[index6] < inOpen[index6] ? inClose[index6] : inOpen[index6];
                  num8 = inHigh[index6] - num9 + (num10 - inLow[index6]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num26 = num7;
            }
            double num27;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num10 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = inHigh[index3] - num9 + (num10 - inLow[index3]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num27 = num7;
            }
            num4 += num26 - num27;
            double num28;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[index6 - 1] - inOpen[index6 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index6 - 1] - inLow[index6 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index6 - 1] < inOpen[index6 - 1] ? inOpen[index6 - 1] : inClose[index6 - 1];
                  double num10 = inClose[index6 - 1] < inOpen[index6 - 1] ? inClose[index6 - 1] : inOpen[index6 - 1];
                  num8 = inHigh[index6 - 1] - num9 + (num10 - inLow[index6 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num28 = num7;
            }
            double num29;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num10 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num8 = inHigh[index4] - num9 + (num10 - inLow[index4]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num29 = num7;
            }
            num5 += num28 - num29;
            ++index6;
            ++index1;
            ++index2;
            ++index3;
            ++index4;
          }
          while (index6 <= endIdx);
          outNBElement = index7;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHaramiLookback()
    {
      return (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 1;
    }

    public static Core.RetCode CdlHarami(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHaramiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 1 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 1; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = (float) ((double) inHigh[index4 - 1] - (double) num8 + ((double) num9 - (double) inLow[index4 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = (float) ((double) inHigh[index4] - (double) num9 + ((double) num11 - (double) inLow[index4]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[2].factor * num5 / num12 && ((double) inClose[index4] <= (double) inOpen[index4] ? (double) inOpen[index4] : (double) inClose[index4]) < ((double) inClose[index4 - 1] <= (double) inOpen[index4 - 1] ? (double) inOpen[index4 - 1] : (double) inClose[index4 - 1]) && ((double) inClose[index4] >= (double) inOpen[index4] ? (double) inOpen[index4] : (double) inClose[index4]) > ((double) inClose[index4 - 1] >= (double) inOpen[index4 - 1] ? (double) inOpen[index4 - 1] : (double) inClose[index4 - 1]))
              {
                int num6 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            float num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = (float) ((double) inHigh[index4 - 1] - (double) num7 + ((double) num8 - (double) inLow[index4 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num13 = num5;
            }
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += (double) num13 - (double) num14;
            float num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += (double) num15 - (double) num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHarami(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHaramiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 1 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 1; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = inHigh[index4 - 1] - num8 + (num9 - inLow[index4 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num11 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = inHigh[index4] - num9 + (num11 - inLow[index4]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[2].factor * num5 / num12 && (inClose[index4] <= inOpen[index4] ? inOpen[index4] : inClose[index4]) < (inClose[index4 - 1] <= inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1]) && (inClose[index4] >= inOpen[index4] ? inOpen[index4] : inClose[index4]) > (inClose[index4 - 1] >= inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1]))
              {
                int num6 = inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            double num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = inHigh[index4 - 1] - num7 + (num8 - inLow[index4 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num13 = num5;
            }
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += num13 - num14;
            double num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += num15 - num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHaramiCrossLookback()
    {
      return (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) + 1;
    }

    public static Core.RetCode CdlHaramiCross(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHaramiCrossLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 1 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 1; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = (float) ((double) inHigh[index4 - 1] - (double) num8 + ((double) num9 - (double) inLow[index4 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = (float) ((double) inHigh[index4] - (double) num9 + ((double) num11 - (double) inLow[index4]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num12 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num5 / num12 && ((double) inClose[index4] <= (double) inOpen[index4] ? (double) inOpen[index4] : (double) inClose[index4]) < ((double) inClose[index4 - 1] <= (double) inOpen[index4 - 1] ? (double) inOpen[index4 - 1] : (double) inClose[index4 - 1]) && ((double) inClose[index4] >= (double) inOpen[index4] ? (double) inOpen[index4] : (double) inClose[index4]) > ((double) inClose[index4 - 1] >= (double) inOpen[index4 - 1] ? (double) inOpen[index4 - 1] : (double) inClose[index4 - 1]))
              {
                int num6 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            float num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = (float) ((double) inHigh[index4 - 1] - (double) num7 + ((double) num8 - (double) inLow[index4 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num13 = num5;
            }
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += (double) num13 - (double) num14;
            float num15;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += (double) num15 - (double) num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHaramiCross(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHaramiCrossLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 1 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 1; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = inHigh[index4 - 1] - num8 + (num9 - inLow[index4 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num11 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = inHigh[index4] - num9 + (num11 - inLow[index4]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num12 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num5 / num12 && (inClose[index4] <= inOpen[index4] ? inOpen[index4] : inClose[index4]) < (inClose[index4 - 1] <= inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1]) && (inClose[index4] >= inOpen[index4] ? inOpen[index4] : inClose[index4]) > (inClose[index4 - 1] >= inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1]))
              {
                int num6 = inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1;
                outInteger[index5] = -num6 * 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            double num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num6 = inHigh[index4 - 1] - num7 + (num8 - inLow[index4 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num13 = num5;
            }
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += num13 - num14;
            double num15;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += num15 - num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHignWaveLookback()
    {
      return Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[5].avgPeriod ? Core.Globals.candleSettings[5].avgPeriod : Core.Globals.candleSettings[2].avgPeriod;
    }

    public static Core.RetCode CdlHignWave(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHignWaveLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[5].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) < Core.Globals.candleSettings[2].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[5].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[5].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[5].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index4] - (double) num5 > Core.Globals.candleSettings[5].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[5].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[5].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[5].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num7 - (double) inLow[index4] > Core.Globals.candleSettings[5].factor * num8 / num16)
                {
                  int num9 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHignWave(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHignWaveLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[5].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) < Core.Globals.candleSettings[2].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[5].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[5].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[5].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index4] - num5 > Core.Globals.candleSettings[5].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[5].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[5].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[5].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num7 - inLow[index4] > Core.Globals.candleSettings[5].factor * num8 / num16)
                {
                  int num9 = inClose[index4] < inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHikkakeLookback()
    {
      return 5;
    }

    public static Core.RetCode CdlHikkake(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHikkakeLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int num2 = 0;
          int num3 = 0;
          for (int index = startIdx - 3; index < startIdx; ++index)
          {
            if ((double) inHigh[index - 1] < (double) inHigh[index - 2] && (double) inLow[index - 1] > (double) inLow[index - 2] && ((double) inHigh[index] < (double) inHigh[index - 1] && (double) inLow[index] < (double) inLow[index - 1] || (double) inHigh[index] > (double) inHigh[index - 1] && (double) inLow[index] > (double) inLow[index - 1]))
            {
              num3 = ((double) inHigh[index] >= (double) inHigh[index - 1] ? -1 : 1) * 100;
              num2 = index;
            }
            else if (index <= num2 + 3 && (num3 > 0 && (double) inClose[index] > (double) inHigh[num2 - 1] || num3 < 0 && (double) inClose[index] < (double) inLow[num2 - 1]))
              num2 = 0;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((double) inHigh[index1 - 1] < (double) inHigh[index1 - 2] && (double) inLow[index1 - 1] > (double) inLow[index1 - 2] && ((double) inHigh[index1] < (double) inHigh[index1 - 1] && (double) inLow[index1] < (double) inLow[index1 - 1] || (double) inHigh[index1] > (double) inHigh[index1 - 1] && (double) inLow[index1] > (double) inLow[index1 - 1]))
            {
              num3 = ((double) inHigh[index1] >= (double) inHigh[index1 - 1] ? -1 : 1) * 100;
              num2 = index1;
              outInteger[index2] = num3;
              ++index2;
            }
            else if (index1 <= num2 + 3 && (num3 > 0 && (double) inClose[index1] > (double) inHigh[num2 - 1] || num3 < 0 && (double) inClose[index1] < (double) inLow[num2 - 1]))
            {
              int num4 = num3 <= 0 ? -1 : 1;
              outInteger[index2] = num3 + num4 * 100;
              ++index2;
              num2 = 0;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHikkake(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHikkakeLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int num2 = 0;
          int num3 = 0;
          for (int index = startIdx - 3; index < startIdx; ++index)
          {
            if (inHigh[index - 1] < inHigh[index - 2] && inLow[index - 1] > inLow[index - 2] && (inHigh[index] < inHigh[index - 1] && inLow[index] < inLow[index - 1] || inHigh[index] > inHigh[index - 1] && inLow[index] > inLow[index - 1]))
            {
              num3 = (inHigh[index] >= inHigh[index - 1] ? -1 : 1) * 100;
              num2 = index;
            }
            else if (index <= num2 + 3 && (num3 > 0 && inClose[index] > inHigh[num2 - 1] || num3 < 0 && inClose[index] < inLow[num2 - 1]))
              num2 = 0;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (inHigh[index1 - 1] < inHigh[index1 - 2] && inLow[index1 - 1] > inLow[index1 - 2] && (inHigh[index1] < inHigh[index1 - 1] && inLow[index1] < inLow[index1 - 1] || inHigh[index1] > inHigh[index1 - 1] && inLow[index1] > inLow[index1 - 1]))
            {
              num3 = (inHigh[index1] >= inHigh[index1 - 1] ? -1 : 1) * 100;
              num2 = index1;
              outInteger[index2] = num3;
              ++index2;
            }
            else if (index1 <= num2 + 3 && (num3 > 0 && inClose[index1] > inHigh[num2 - 1] || num3 < 0 && inClose[index1] < inLow[num2 - 1]))
            {
              int num4 = num3 <= 0 ? -1 : 1;
              outInteger[index2] = num3 + num4 * 100;
              ++index2;
              num2 = 0;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHikkakeModLookback()
    {
      return (1 <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : 1) + 5;
    }

    public static Core.RetCode CdlHikkakeMod(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHikkakeModLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - 3 - Core.Globals.candleSettings[8].avgPeriod;
          for (int index = num3; index < startIdx - 3; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = (float) ((double) inHigh[index - 2] - (double) num7 + ((double) num8 - (double) inLow[index - 2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int num9 = 0;
          int num10 = 0;
          for (int index = startIdx - 3; index < startIdx; ++index)
          {
            if ((double) inHigh[index - 2] < (double) inHigh[index - 3] && (double) inLow[index - 2] > (double) inLow[index - 3] && ((double) inHigh[index - 1] < (double) inHigh[index - 2] && (double) inLow[index - 1] > (double) inLow[index - 2]))
            {
              if ((double) inHigh[index] < (double) inHigh[index - 1] && (double) inLow[index] < (double) inLow[index - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index - 2] - inLow[index - 2];
                    }
                    else
                    {
                      float num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                        float num11 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                        num7 = (float) ((double) inHigh[index - 2] - (double) num8 + ((double) num11 - (double) inLow[index - 2]));
                      }
                      else
                        num7 = 0.0f;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = (double) num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index - 2] <= (double) inLow[index - 2] + Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_55;
              }
              if ((double) inHigh[index] > (double) inHigh[index - 1] && (double) inLow[index] > (double) inLow[index - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index - 2] - inLow[index - 2];
                    }
                    else
                    {
                      float num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                        float num11 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                        num7 = (float) ((double) inHigh[index - 2] - (double) num8 + ((double) num11 - (double) inLow[index - 2]));
                      }
                      else
                        num7 = 0.0f;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = (double) num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index - 2] < (double) inHigh[index - 2] - Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_56;
              }
              else
                goto label_56;
label_55:
              num10 = ((double) inHigh[index] >= (double) inHigh[index - 1] ? -1 : 1) * 100;
              num9 = index;
              goto label_58;
            }
label_56:
            if (index <= num9 + 3 && (num10 > 0 && (double) inClose[index] > (double) inHigh[num9 - 1] || num10 < 0 && (double) inClose[index] < (double) inLow[num9 - 1]))
              num9 = 0;
label_58:
            float num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = (float) ((double) inHigh[index - 2] - (double) num6 + ((double) num7 - (double) inLow[index - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            float num14;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  float num7 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num5 = (float) ((double) inHigh[num3 - 2] - (double) num6 + ((double) num7 - (double) inLow[num3 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += (double) num13 - (double) num14;
            ++num3;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((double) inHigh[index1 - 2] < (double) inHigh[index1 - 3] && (double) inLow[index1 - 2] > (double) inLow[index1 - 3] && ((double) inHigh[index1 - 1] < (double) inHigh[index1 - 2] && (double) inLow[index1 - 1] > (double) inLow[index1 - 2]))
            {
              if ((double) inHigh[index1] < (double) inHigh[index1 - 1] && (double) inLow[index1] < (double) inLow[index1 - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                    }
                    else
                    {
                      float num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num8 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                        float num11 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                        num7 = (float) ((double) inHigh[index1 - 2] - (double) num8 + ((double) num11 - (double) inLow[index1 - 2]));
                      }
                      else
                        num7 = 0.0f;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = (double) num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1 - 2] <= (double) inLow[index1 - 2] + Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_107;
              }
              if ((double) inHigh[index1] > (double) inHigh[index1 - 1] && (double) inLow[index1] > (double) inLow[index1 - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                    }
                    else
                    {
                      float num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num8 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                        float num11 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                        num7 = (float) ((double) inHigh[index1 - 2] - (double) num8 + ((double) num11 - (double) inLow[index1 - 2]));
                      }
                      else
                        num7 = 0.0f;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = (double) num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1 - 2] < (double) inHigh[index1 - 2] - Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_108;
              }
              else
                goto label_108;
label_107:
              num10 = ((double) inHigh[index1] >= (double) inHigh[index1 - 1] ? -1 : 1) * 100;
              num9 = index1;
              outInteger[index2] = num10;
              ++index2;
              goto label_111;
            }
label_108:
            if (index1 <= num9 + 3 && (num10 > 0 && (double) inClose[index1] > (double) inHigh[num9 - 1] || num10 < 0 && (double) inClose[index1] < (double) inLow[num9 - 1]))
            {
              int num4 = num10 <= 0 ? -1 : 1;
              outInteger[index2] = num10 + num4 * 100;
              ++index2;
              num9 = 0;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
label_111:
            float num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 2] - inLow[index1 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  float num7 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  num5 = (float) ((double) inHigh[index1 - 2] - (double) num6 + ((double) num7 - (double) inLow[index1 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            float num14;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  float num7 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num5 = (float) ((double) inHigh[num3 - 2] - (double) num6 + ((double) num7 - (double) inLow[num3 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += (double) num13 - (double) num14;
            ++num3;
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHikkakeMod(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHikkakeModLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - 3 - Core.Globals.candleSettings[8].avgPeriod;
          for (int index = num3; index < startIdx - 3; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num8 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = inHigh[index - 2] - num7 + (num8 - inLow[index - 2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int num9 = 0;
          int num10 = 0;
          for (int index = startIdx - 3; index < startIdx; ++index)
          {
            if (inHigh[index - 2] < inHigh[index - 3] && inLow[index - 2] > inLow[index - 3] && (inHigh[index - 1] < inHigh[index - 2] && inLow[index - 1] > inLow[index - 2]))
            {
              if (inHigh[index] < inHigh[index - 1] && inLow[index] < inLow[index - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index - 2] - inLow[index - 2];
                    }
                    else
                    {
                      double num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num8 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                        double num11 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                        num7 = inHigh[index - 2] - num8 + (num11 - inLow[index - 2]);
                      }
                      else
                        num7 = 0.0;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index - 2] <= inLow[index - 2] + Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_55;
              }
              if (inHigh[index] > inHigh[index - 1] && inLow[index] > inLow[index - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index - 2] - inLow[index - 2];
                    }
                    else
                    {
                      double num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num8 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                        double num11 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                        num7 = inHigh[index - 2] - num8 + (num11 - inLow[index - 2]);
                      }
                      else
                        num7 = 0.0;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index - 2] < inHigh[index - 2] - Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_56;
              }
              else
                goto label_56;
label_55:
              num10 = (inHigh[index] >= inHigh[index - 1] ? -1 : 1) * 100;
              num9 = index;
              goto label_58;
            }
label_56:
            if (index <= num9 + 3 && (num10 > 0 && inClose[index] > inHigh[num9 - 1] || num10 < 0 && inClose[index] < inLow[num9 - 1]))
              num9 = 0;
label_58:
            double num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num5 = inHigh[index - 2] - num6 + (num7 - inLow[index - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            double num14;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[num3 - 2] < inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  double num7 = inClose[num3 - 2] < inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num5 = inHigh[num3 - 2] - num6 + (num7 - inLow[num3 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += num13 - num14;
            ++num3;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (inHigh[index1 - 2] < inHigh[index1 - 3] && inLow[index1 - 2] > inLow[index1 - 3] && (inHigh[index1 - 1] < inHigh[index1 - 2] && inLow[index1 - 1] > inLow[index1 - 2]))
            {
              if (inHigh[index1] < inHigh[index1 - 1] && inLow[index1] < inLow[index1 - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                    }
                    else
                    {
                      double num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num8 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                        double num11 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                        num7 = inHigh[index1 - 2] - num8 + (num11 - inLow[index1 - 2]);
                      }
                      else
                        num7 = 0.0;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1 - 2] <= inLow[index1 - 2] + Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_107;
              }
              if (inHigh[index1] > inHigh[index1 - 1] && inLow[index1] > inLow[index1 - 1])
              {
                double num4;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num4 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                    }
                    else
                    {
                      double num7;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num8 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                        double num11 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                        num7 = inHigh[index1 - 2] - num8 + (num11 - inLow[index1 - 2]);
                      }
                      else
                        num7 = 0.0;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = num5;
                }
                double num12 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1 - 2] < inHigh[index1 - 2] - Core.Globals.candleSettings[8].factor * num4 / num12)
                  goto label_108;
              }
              else
                goto label_108;
label_107:
              num10 = (inHigh[index1] >= inHigh[index1 - 1] ? -1 : 1) * 100;
              num9 = index1;
              outInteger[index2] = num10;
              ++index2;
              goto label_111;
            }
label_108:
            if (index1 <= num9 + 3 && (num10 > 0 && inClose[index1] > inHigh[num9 - 1] || num10 < 0 && inClose[index1] < inLow[num9 - 1]))
            {
              int num4 = num10 <= 0 ? -1 : 1;
              outInteger[index2] = num10 + num4 * 100;
              ++index2;
              num9 = 0;
            }
            else
            {
              outInteger[index2] = 0;
              ++index2;
            }
label_111:
            double num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 2] - inLow[index1 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  double num7 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  num5 = inHigh[index1 - 2] - num6 + (num7 - inLow[index1 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            double num14;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[num3 - 2] < inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  double num7 = inClose[num3 - 2] < inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num5 = inHigh[num3 - 2] - num6 + (num7 - inLow[num3 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += num13 - num14;
            ++num3;
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlHomingPigeonLookback()
    {
      return (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 1;
    }

    public static Core.RetCode CdlHomingPigeon(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHomingPigeonLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index2 = num4; index2 < startIdx; ++index2)
          {
            float num5;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num9 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num7 = (float) ((double) inHigh[index2 - 1] - (double) num8 + ((double) num9 - (double) inLow[index2 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += (double) num5;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            float num5;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += (double) num5;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if (((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1) == -1 && ((double) inClose[index3] < (double) inOpen[index3] ? -1 : 1) == -1)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index3 - 1] - inLow[index3 - 1];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                      float num10 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                      num8 = (float) ((double) inHigh[index3 - 1] - (double) num9 + ((double) num10 - (double) inLow[index3 - 1]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) > Core.Globals.candleSettings[0].factor * num5 / num11)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index3] - inOpen[index3]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index3] - inLow[index3];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                        float num12 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                        num9 = (float) ((double) inHigh[index3] - (double) num10 + ((double) num12 - (double) inLow[index3]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index3] - inOpen[index3]) <= Core.Globals.candleSettings[2].factor * num6 / num13 && (double) inOpen[index3] < (double) inOpen[index3 - 1] && (double) inClose[index3] > (double) inClose[index3 - 1])
                {
                  outInteger[index4] = 100;
                  ++index4;
                  goto label_66;
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_66:
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3 - 1] - inLow[index3 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  float num8 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  num6 = (float) ((double) inHigh[index3 - 1] - (double) num7 + ((double) num8 - (double) inLow[index3 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num14 = num5;
            }
            float num15;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[num4 - 1] - inOpen[num4 - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[num4 - 1] - inLow[num4 - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[num4 - 1] < (double) inOpen[num4 - 1] ? inOpen[num4 - 1] : inClose[num4 - 1];
                  float num8 = (double) inClose[num4 - 1] < (double) inOpen[num4 - 1] ? inClose[num4 - 1] : inOpen[num4 - 1];
                  num6 = (float) ((double) inHigh[num4 - 1] - (double) num7 + ((double) num8 - (double) inLow[num4 - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            num2 += (double) num14 - (double) num15;
            float num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            float num17;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            num3 += (double) num16 - (double) num17;
            ++index3;
            ++num4;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlHomingPigeon(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlHomingPigeonLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int num4 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index2 = num4; index2 < startIdx; ++index2)
          {
            double num5;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num9 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num7 = inHigh[index2 - 1] - num8 + (num9 - inLow[index2 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += num5;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            double num5;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += num5;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if ((inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1) == -1 && (inClose[index3] < inOpen[index3] ? -1 : 1) == -1)
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index3 - 1] - inLow[index3 - 1];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                      double num10 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                      num8 = inHigh[index3 - 1] - num9 + (num10 - inLow[index3 - 1]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) > Core.Globals.candleSettings[0].factor * num5 / num11)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index3] - inOpen[index3]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index3] - inLow[index3];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                        double num12 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                        num9 = inHigh[index3] - num10 + (num12 - inLow[index3]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index3] - inOpen[index3]) <= Core.Globals.candleSettings[2].factor * num6 / num13 && inOpen[index3] < inOpen[index3 - 1] && inClose[index3] > inClose[index3 - 1])
                {
                  outInteger[index4] = 100;
                  ++index4;
                  goto label_66;
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_66:
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3 - 1] - inLow[index3 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  double num8 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  num6 = inHigh[index3 - 1] - num7 + (num8 - inLow[index3 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num14 = num5;
            }
            double num15;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[num4 - 1] - inOpen[num4 - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[num4 - 1] - inLow[num4 - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[num4 - 1] < inOpen[num4 - 1] ? inOpen[num4 - 1] : inClose[num4 - 1];
                  double num8 = inClose[num4 - 1] < inOpen[num4 - 1] ? inClose[num4 - 1] : inOpen[num4 - 1];
                  num6 = inHigh[num4 - 1] - num7 + (num8 - inLow[num4 - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            num2 += num14 - num15;
            double num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            double num17;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            num3 += num16 - num17;
            ++index3;
            ++num4;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlIdentical3CrowsLookback()
    {
      return (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[10].avgPeriod ? Core.Globals.candleSettings[10].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) + 2;
    }

    public static Core.RetCode CdlIdentical3Crows(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlIdentical3CrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[2] = 0.0;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = (float) ((double) inHigh[index - 2] - (double) num7 + ((double) num8 - (double) inLow[index - 2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray1[2] = numArray1[2] + (double) num4;
            float num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray1[1] = numArray1[1] + (double) num9;
            float num10;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num8 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = (float) ((double) inHigh[index] - (double) num7 + ((double) num8 - (double) inLow[index]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num10 = num5;
            }
            numArray1[0] = numArray1[0] + (double) num10;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = (float) ((double) inHigh[index - 2] - (double) num7 + ((double) num8 - (double) inLow[index - 2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray2[2] = numArray2[2] + (double) num4;
            float num9;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray2[1] = numArray2[1] + (double) num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1)
            {
              float num4 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
              double num5;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num5 = numArray1[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      float num10 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num8 = (float) ((double) inHigh[index1 - 2] - (double) num9 + ((double) num10 - (double) inLow[index1 - 2]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num4 - (double) inLow[index1 - 2] < Core.Globals.candleSettings[7].factor * num5 / num11 && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1)
              {
                float num6 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                double num7;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num7 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = (float) ((double) inHigh[index1 - 1] - (double) num12 + ((double) num13 - (double) inLow[index1 - 1]));
                      }
                      else
                        num10 = 0.0f;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = (double) num8;
                }
                double num14 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num6 - (double) inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num7 / num14 && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  double num9;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num9 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num10 = Math.Abs(inClose[index1] - inOpen[index1]);
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num12 = inHigh[index1] - inLow[index1];
                      }
                      else
                      {
                        float num13;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num15 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                          float num16 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                          num13 = (float) ((double) inHigh[index1] - (double) num15 + ((double) num16 - (double) inLow[index1]));
                        }
                        else
                          num13 = 0.0f;
                        num12 = num13;
                      }
                      num10 = num12;
                    }
                    num9 = (double) num10;
                  }
                  double num17 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num8 - (double) inLow[index1] < Core.Globals.candleSettings[7].factor * num9 / num17 && (double) inClose[index1 - 2] > (double) inClose[index1 - 1] && (double) inClose[index1 - 1] > (double) inClose[index1])
                  {
                    double num10;
                    if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                    {
                      num10 = numArray2[2] / (double) Core.Globals.candleSettings[10].avgPeriod;
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        float num13;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                        {
                          num13 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                          {
                            float num16 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            float num18 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num15 = (float) ((double) inHigh[index1 - 2] - (double) num16 + ((double) num18 - (double) inLow[index1 - 2]));
                          }
                          else
                            num15 = 0.0f;
                          num13 = num15;
                        }
                        num12 = num13;
                      }
                      num10 = (double) num12;
                    }
                    double num19 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inOpen[index1 - 1] <= (double) inClose[index1 - 2] + Core.Globals.candleSettings[10].factor * num10 / num19)
                    {
                      double num12;
                      if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                      {
                        num12 = numArray2[2] / (double) Core.Globals.candleSettings[10].avgPeriod;
                      }
                      else
                      {
                        float num13;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                        {
                          num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                          {
                            num15 = inHigh[index1 - 2] - inLow[index1 - 2];
                          }
                          else
                          {
                            float num16;
                            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                            {
                              float num18 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                              float num20 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                              num16 = (float) ((double) inHigh[index1 - 2] - (double) num18 + ((double) num20 - (double) inLow[index1 - 2]));
                            }
                            else
                              num16 = 0.0f;
                            num15 = num16;
                          }
                          num13 = num15;
                        }
                        num12 = (double) num13;
                      }
                      double num21 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) inOpen[index1 - 1] >= (double) inClose[index1 - 2] - Core.Globals.candleSettings[10].factor * num12 / num21)
                      {
                        double num13;
                        if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                        {
                          num13 = numArray2[1] / (double) Core.Globals.candleSettings[10].avgPeriod;
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                          {
                            num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                          }
                          else
                          {
                            float num16;
                            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                            {
                              num16 = inHigh[index1 - 1] - inLow[index1 - 1];
                            }
                            else
                            {
                              float num18;
                              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                              {
                                float num20 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                float num22 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                num18 = (float) ((double) inHigh[index1 - 1] - (double) num20 + ((double) num22 - (double) inLow[index1 - 1]));
                              }
                              else
                                num18 = 0.0f;
                              num16 = num18;
                            }
                            num15 = num16;
                          }
                          num13 = (double) num15;
                        }
                        double num23 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) inOpen[index1] <= (double) inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num13 / num23)
                        {
                          double num15;
                          if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                          {
                            num15 = numArray2[1] / (double) Core.Globals.candleSettings[10].avgPeriod;
                          }
                          else
                          {
                            float num16;
                            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                            {
                              num16 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                            }
                            else
                            {
                              float num18;
                              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                              {
                                num18 = inHigh[index1 - 1] - inLow[index1 - 1];
                              }
                              else
                              {
                                float num20;
                                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                                {
                                  float num22 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                  float num24 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                  num20 = (float) ((double) inHigh[index1 - 1] - (double) num22 + ((double) num24 - (double) inLow[index1 - 1]));
                                }
                                else
                                  num20 = 0.0f;
                                num18 = num20;
                              }
                              num16 = num18;
                            }
                            num15 = (double) num16;
                          }
                          double num25 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if ((double) inOpen[index1] >= (double) inClose[index1 - 1] - Core.Globals.candleSettings[10].factor * num15 / num25)
                          {
                            outInteger[index2] = -100;
                            ++index2;
                            goto label_158;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_158:
            for (int index3 = 2; index3 >= 0; --index3)
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = (float) ((double) inHigh[index1 - index3] - (double) num7 + ((double) num8 - (double) inLow[index1 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              float num9;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num8 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num6 = (float) ((double) inHigh[num2 - index3] - (double) num7 + ((double) num8 - (double) inLow[num2 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray1[index3] = numArray1[index3] + ((double) num4 - (double) num9);
            }
            for (int index3 = 2; index3 >= 1; --index3)
            {
              float num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = (float) ((double) inHigh[index1 - index3] - (double) num7 + ((double) num8 - (double) inLow[index1 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              float num9;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    float num8 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num6 = (float) ((double) inHigh[num3 - index3] - (double) num7 + ((double) num8 - (double) inLow[num3 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray2[index3] = numArray2[index3] + ((double) num4 - (double) num9);
            }
            ++index1;
            ++num2;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlIdentical3Crows(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlIdentical3CrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[2] = 0.0;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num8 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = inHigh[index - 2] - num7 + (num8 - inLow[index - 2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray1[2] = numArray1[2] + num4;
            double num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray1[1] = numArray1[1] + num9;
            double num10;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num8 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = inHigh[index] - num7 + (num8 - inLow[index]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num10 = num5;
            }
            numArray1[0] = numArray1[0] + num10;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num8 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = inHigh[index - 2] - num7 + (num8 - inLow[index - 2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray2[2] = numArray2[2] + num4;
            double num9;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray2[1] = numArray2[1] + num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1)
            {
              double num4 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
              double num5;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num5 = numArray1[2] / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      double num10 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num8 = inHigh[index1 - 2] - num9 + (num10 - inLow[index1 - 2]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num4 - inLow[index1 - 2] < Core.Globals.candleSettings[7].factor * num5 / num11 && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1)
              {
                double num6 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                double num7;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num7 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = inHigh[index1 - 1] - num12 + (num13 - inLow[index1 - 1]);
                      }
                      else
                        num10 = 0.0;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = num8;
                }
                double num14 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num6 - inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num7 / num14 && (inClose[index1] < inOpen[index1] ? -1 : 1) == -1)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  double num9;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num9 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num10 = Math.Abs(inClose[index1] - inOpen[index1]);
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num12 = inHigh[index1] - inLow[index1];
                      }
                      else
                      {
                        double num13;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num15 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                          double num16 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                          num13 = inHigh[index1] - num15 + (num16 - inLow[index1]);
                        }
                        else
                          num13 = 0.0;
                        num12 = num13;
                      }
                      num10 = num12;
                    }
                    num9 = num10;
                  }
                  double num17 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num8 - inLow[index1] < Core.Globals.candleSettings[7].factor * num9 / num17 && inClose[index1 - 2] > inClose[index1 - 1] && inClose[index1 - 1] > inClose[index1])
                  {
                    double num10;
                    if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                    {
                      num10 = numArray2[2] / (double) Core.Globals.candleSettings[10].avgPeriod;
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                      }
                      else
                      {
                        double num13;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                        {
                          num13 = inHigh[index1 - 2] - inLow[index1 - 2];
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                          {
                            double num16 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                            double num18 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                            num15 = inHigh[index1 - 2] - num16 + (num18 - inLow[index1 - 2]);
                          }
                          else
                            num15 = 0.0;
                          num13 = num15;
                        }
                        num12 = num13;
                      }
                      num10 = num12;
                    }
                    double num19 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inOpen[index1 - 1] <= inClose[index1 - 2] + Core.Globals.candleSettings[10].factor * num10 / num19)
                    {
                      double num12;
                      if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                      {
                        num12 = numArray2[2] / (double) Core.Globals.candleSettings[10].avgPeriod;
                      }
                      else
                      {
                        double num13;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                        {
                          num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                          {
                            num15 = inHigh[index1 - 2] - inLow[index1 - 2];
                          }
                          else
                          {
                            double num16;
                            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                            {
                              double num18 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                              double num20 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                              num16 = inHigh[index1 - 2] - num18 + (num20 - inLow[index1 - 2]);
                            }
                            else
                              num16 = 0.0;
                            num15 = num16;
                          }
                          num13 = num15;
                        }
                        num12 = num13;
                      }
                      double num21 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (inOpen[index1 - 1] >= inClose[index1 - 2] - Core.Globals.candleSettings[10].factor * num12 / num21)
                      {
                        double num13;
                        if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                        {
                          num13 = numArray2[1] / (double) Core.Globals.candleSettings[10].avgPeriod;
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                          {
                            num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                          }
                          else
                          {
                            double num16;
                            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                            {
                              num16 = inHigh[index1 - 1] - inLow[index1 - 1];
                            }
                            else
                            {
                              double num18;
                              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                              {
                                double num20 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                double num22 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                num18 = inHigh[index1 - 1] - num20 + (num22 - inLow[index1 - 1]);
                              }
                              else
                                num18 = 0.0;
                              num16 = num18;
                            }
                            num15 = num16;
                          }
                          num13 = num15;
                        }
                        double num23 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (inOpen[index1] <= inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num13 / num23)
                        {
                          double num15;
                          if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                          {
                            num15 = numArray2[1] / (double) Core.Globals.candleSettings[10].avgPeriod;
                          }
                          else
                          {
                            double num16;
                            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                            {
                              num16 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                            }
                            else
                            {
                              double num18;
                              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                              {
                                num18 = inHigh[index1 - 1] - inLow[index1 - 1];
                              }
                              else
                              {
                                double num20;
                                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                                {
                                  double num22 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                                  double num24 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                                  num20 = inHigh[index1 - 1] - num22 + (num24 - inLow[index1 - 1]);
                                }
                                else
                                  num20 = 0.0;
                                num18 = num20;
                              }
                              num16 = num18;
                            }
                            num15 = num16;
                          }
                          double num25 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                          if (inOpen[index1] >= inClose[index1 - 1] - Core.Globals.candleSettings[10].factor * num15 / num25)
                          {
                            outInteger[index2] = -100;
                            ++index2;
                            goto label_158;
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_158:
            for (int index3 = 2; index3 >= 0; --index3)
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = inHigh[index1 - index3] - num7 + (num8 - inLow[index1 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              double num9;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num8 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num6 = inHigh[num2 - index3] - num7 + (num8 - inLow[num2 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray1[index3] = numArray1[index3] + (num4 - num9);
            }
            for (int index3 = 2; index3 >= 1; --index3)
            {
              double num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = inHigh[index1 - index3] - num7 + (num8 - inLow[index1 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              double num9;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num3 - index3] < inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    double num8 = inClose[num3 - index3] < inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num6 = inHigh[num3 - index3] - num7 + (num8 - inLow[num3 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray2[index3] = numArray2[index3] + (num4 - num9);
            }
            ++index1;
            ++num2;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlInNeckLookback()
    {
      return (Core.Globals.candleSettings[10].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[10].avgPeriod) + 1;
    }

    public static Core.RetCode CdlInNeck(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlInNeckLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += (double) num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = (float) ((double) inHigh[index1 - 1] - (double) num10 + ((double) num11 - (double) inLow[index1 - 1]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num12 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num6 / num12 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (double) inOpen[index1] < (double) inLow[index1 - 1]))
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num13 - (double) inLow[index1 - 1]));
                      }
                      else
                        num10 = 0.0f;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = (double) num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1] <= (double) inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num14 && (double) inClose[index1] >= (double) inClose[index1 - 1])
                {
                  outInteger[index2] = -100;
                  ++index2;
                  goto label_66;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_66:
            float num15;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num15 = num6;
            }
            float num16;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num9 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num7 = (float) ((double) inHigh[num3 - 1] - (double) num8 + ((double) num9 - (double) inLow[num3 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num16 = num6;
            }
            num2 += (double) num15 - (double) num16;
            float num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num17 = num6;
            }
            float num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  float num9 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = (float) ((double) inHigh[num5 - 1] - (double) num8 + ((double) num9 - (double) inLow[num5 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num18 = num6;
            }
            num4 += (double) num17 - (double) num18;
            ++index1;
            ++num3;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlInNeck(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlInNeckLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = inHigh[index1 - 1] - num10 + (num11 - inLow[index1 - 1]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num12 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num6 / num12 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && inOpen[index1] < inLow[index1 - 1]))
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = inHigh[index1 - 1] - num11 + (num13 - inLow[index1 - 1]);
                      }
                      else
                        num10 = 0.0;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1] <= inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num14 && inClose[index1] >= inClose[index1 - 1])
                {
                  outInteger[index2] = -100;
                  ++index2;
                  goto label_66;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_66:
            double num15;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num15 = num6;
            }
            double num16;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num9 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num7 = inHigh[num3 - 1] - num8 + (num9 - inLow[num3 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num16 = num6;
            }
            num2 += num15 - num16;
            double num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num17 = num6;
            }
            double num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num5 - 1] < inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  double num9 = inClose[num5 - 1] < inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = inHigh[num5 - 1] - num8 + (num9 - inLow[num5 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num18 = num6;
            }
            num4 += num17 - num18;
            ++index1;
            ++num3;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlInvertedHammerLookback()
    {
      return ((Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod)) + 1;
    }

    public static Core.RetCode CdlInvertedHammer(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlInvertedHammerLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += (double) num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += (double) num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            float num5;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += (double) num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = (double) num6;
            }
            double num11 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index5] - inOpen[index5]) < Core.Globals.candleSettings[2].factor * num5 / num11)
            {
              float num6 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                      float num13 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num13 - (double) inLow[index5]));
                    }
                    else
                      num10 = 0.0f;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = (double) num8;
              }
              double num14 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index5] - (double) num6 > Core.Globals.candleSettings[4].factor * num7 / num14)
              {
                float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num9 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    float num12;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      float num13;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num15 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                        float num16 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = (float) ((double) inHigh[index5] - (double) num15 + ((double) num16 - (double) inLow[index5]));
                      }
                      else
                        num13 = 0.0f;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = (double) num10;
                }
                double num17 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num8 - (double) inLow[index5] < Core.Globals.candleSettings[7].factor * num9 / num17 && ((double) inOpen[index5] <= (double) inClose[index5] ? (double) inClose[index5] : (double) inOpen[index5]) < ((double) inOpen[index5 - 1] >= (double) inClose[index5 - 1] ? (double) inClose[index5 - 1] : (double) inOpen[index5 - 1]))
                {
                  outInteger[index6] = 100;
                  ++index6;
                  goto label_90;
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_90:
            float num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num18 = num6;
            }
            float num19;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num19 = num6;
            }
            num2 += (double) num18 - (double) num19;
            float num20;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num20 = num6;
            }
            float num21;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num21 = num6;
            }
            num3 += (double) num20 - (double) num21;
            float num22;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num22 = num6;
            }
            float num23;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num23 = num6;
            }
            num4 += (double) num22 - (double) num23;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlInvertedHammer(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlInvertedHammerLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            double num5;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = num6;
            }
            double num11 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index5] - inOpen[index5]) < Core.Globals.candleSettings[2].factor * num5 / num11)
            {
              double num6 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                      double num13 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = inHigh[index5] - num12 + (num13 - inLow[index5]);
                    }
                    else
                      num10 = 0.0;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = num8;
              }
              double num14 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index5] - num6 > Core.Globals.candleSettings[4].factor * num7 / num14)
              {
                double num8 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num9 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    double num12;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      double num13;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num15 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                        double num16 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = inHigh[index5] - num15 + (num16 - inLow[index5]);
                      }
                      else
                        num13 = 0.0;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = num10;
                }
                double num17 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num8 - inLow[index5] < Core.Globals.candleSettings[7].factor * num9 / num17 && (inOpen[index5] <= inClose[index5] ? inClose[index5] : inOpen[index5]) < (inOpen[index5 - 1] >= inClose[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1]))
                {
                  outInteger[index6] = 100;
                  ++index6;
                  goto label_90;
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_90:
            double num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num18 = num6;
            }
            double num19;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num19 = num6;
            }
            num2 += num18 - num19;
            double num20;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num20 = num6;
            }
            double num21;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num21 = num6;
            }
            num3 += num20 - num21;
            double num22;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num22 = num6;
            }
            double num23;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num23 = num6;
            }
            num4 += num22 - num23;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlKickingLookback()
    {
      return (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) + 1;
    }

    public static Core.RetCode CdlKicking(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[2];
      double[] numArray2 = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlKickingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray1[1] = numArray1[1] + (double) num4;
            float num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num8 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = (float) ((double) inHigh[index] - (double) num7 + ((double) num8 - (double) inLow[index]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray1[0] = numArray1[0] + (double) num9;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray2[1] = numArray2[1] + (double) num4;
            float num9;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num8 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = (float) ((double) inHigh[index] - (double) num7 + ((double) num8 - (double) inLow[index]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray2[0] = numArray2[0] + (double) num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1))
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = numArray2[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
              {
                float num5 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num9 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num12 - (double) inLow[index1 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index1 - 1] - (double) num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                {
                  float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num14 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num12 = (float) ((double) inHigh[index1 - 1] - (double) num14 + ((double) num15 - (double) inLow[index1 - 1]));
                        }
                        else
                          num12 = 0.0f;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num7 - (double) inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num8 / num16)
                  {
                    double num9;
                    if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                    {
                      num9 = numArray2[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                      {
                        num11 = Math.Abs(inClose[index1] - inOpen[index1]);
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                        {
                          num12 = inHigh[index1] - inLow[index1];
                        }
                        else
                        {
                          float num14;
                          if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                          {
                            float num15 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                            float num17 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                            num14 = (float) ((double) inHigh[index1] - (double) num15 + ((double) num17 - (double) inLow[index1]));
                          }
                          else
                            num14 = 0.0f;
                          num12 = num14;
                        }
                        num11 = num12;
                      }
                      num9 = (double) num11;
                    }
                    double num18 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num9 / num18)
                    {
                      float num11 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                      double num12;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num12 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num14 = Math.Abs(inClose[index1] - inOpen[index1]);
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num15 = inHigh[index1] - inLow[index1];
                          }
                          else
                          {
                            float num17;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              float num19 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                              float num20 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                              num17 = (float) ((double) inHigh[index1] - (double) num19 + ((double) num20 - (double) inLow[index1]));
                            }
                            else
                              num17 = 0.0f;
                            num15 = num17;
                          }
                          num14 = num15;
                        }
                        num12 = (double) num14;
                      }
                      double num21 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) inHigh[index1] - (double) num11 < Core.Globals.candleSettings[7].factor * num12 / num21)
                      {
                        float num14 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                        double num15;
                        if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                        {
                          num15 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index1] - inOpen[index1]);
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                            {
                              num19 = inHigh[index1] - inLow[index1];
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                              {
                                float num22 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                                float num23 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                                num20 = (float) ((double) inHigh[index1] - (double) num22 + ((double) num23 - (double) inLow[index1]));
                              }
                              else
                                num20 = 0.0f;
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          num15 = (double) num17;
                        }
                        double num24 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) num14 - (double) inLow[index1] < Core.Globals.candleSettings[7].factor * num15 / num24 && (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && (double) inLow[index1] > (double) inHigh[index1 - 1] || ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (double) inHigh[index1] < (double) inLow[index1 - 1]))
                        {
                          int num17 = (double) inClose[index1] < (double) inOpen[index1] ? -1 : 1;
                          outInteger[index2] = num17 * 100;
                          ++index2;
                          goto label_136;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_136:
            for (int index3 = 1; index3 >= 0; --index3)
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = (float) ((double) inHigh[index1 - index3] - (double) num7 + ((double) num8 - (double) inLow[index1 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              float num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    float num8 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num6 = (float) ((double) inHigh[num3 - index3] - (double) num7 + ((double) num8 - (double) inLow[num3 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray2[index3] = numArray2[index3] + ((double) num4 - (double) num9);
              float num10;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = (float) ((double) inHigh[index1 - index3] - (double) num7 + ((double) num8 - (double) inLow[index1 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num10 = num5;
              }
              float num11;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num8 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num6 = (float) ((double) inHigh[num2 - index3] - (double) num7 + ((double) num8 - (double) inLow[num2 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num11 = num5;
              }
              numArray1[index3] = numArray1[index3] + ((double) num10 - (double) num11);
            }
            ++index1;
            ++num2;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlKicking(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[2];
      double[] numArray2 = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlKickingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray1[1] = numArray1[1] + num4;
            double num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num8 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = inHigh[index] - num7 + (num8 - inLow[index]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray1[0] = numArray1[0] + num9;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray2[1] = numArray2[1] + num4;
            double num9;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num8 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = inHigh[index] - num7 + (num8 - inLow[index]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray2[0] = numArray2[0] + num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -(inClose[index1] < inOpen[index1] ? -1 : 1))
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = numArray2[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
              {
                double num5 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num9 = inHigh[index1 - 1] - num11 + (num12 - inLow[index1 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index1 - 1] - num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                {
                  double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num14 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num12 = inHigh[index1 - 1] - num14 + (num15 - inLow[index1 - 1]);
                        }
                        else
                          num12 = 0.0;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num7 - inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num8 / num16)
                  {
                    double num9;
                    if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                    {
                      num9 = numArray2[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                      {
                        num11 = Math.Abs(inClose[index1] - inOpen[index1]);
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                        {
                          num12 = inHigh[index1] - inLow[index1];
                        }
                        else
                        {
                          double num14;
                          if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                          {
                            double num15 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                            double num17 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                            num14 = inHigh[index1] - num15 + (num17 - inLow[index1]);
                          }
                          else
                            num14 = 0.0;
                          num12 = num14;
                        }
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    double num18 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num9 / num18)
                    {
                      double num11 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                      double num12;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num12 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num14 = Math.Abs(inClose[index1] - inOpen[index1]);
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num15 = inHigh[index1] - inLow[index1];
                          }
                          else
                          {
                            double num17;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              double num19 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                              double num20 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                              num17 = inHigh[index1] - num19 + (num20 - inLow[index1]);
                            }
                            else
                              num17 = 0.0;
                            num15 = num17;
                          }
                          num14 = num15;
                        }
                        num12 = num14;
                      }
                      double num21 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (inHigh[index1] - num11 < Core.Globals.candleSettings[7].factor * num12 / num21)
                      {
                        double num14 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                        double num15;
                        if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                        {
                          num15 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index1] - inOpen[index1]);
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                            {
                              num19 = inHigh[index1] - inLow[index1];
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                              {
                                double num22 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                                double num23 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                                num20 = inHigh[index1] - num22 + (num23 - inLow[index1]);
                              }
                              else
                                num20 = 0.0;
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        double num24 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (num14 - inLow[index1] < Core.Globals.candleSettings[7].factor * num15 / num24 && ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && inLow[index1] > inHigh[index1 - 1] || (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && inHigh[index1] < inLow[index1 - 1]))
                        {
                          int num17 = inClose[index1] < inOpen[index1] ? -1 : 1;
                          outInteger[index2] = num17 * 100;
                          ++index2;
                          goto label_136;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_136:
            for (int index3 = 1; index3 >= 0; --index3)
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = inHigh[index1 - index3] - num7 + (num8 - inLow[index1 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              double num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num3 - index3] < inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    double num8 = inClose[num3 - index3] < inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num6 = inHigh[num3 - index3] - num7 + (num8 - inLow[num3 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray2[index3] = numArray2[index3] + (num4 - num9);
              double num10;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = inHigh[index1 - index3] - num7 + (num8 - inLow[index1 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num10 = num5;
              }
              double num11;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num8 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num6 = inHigh[num2 - index3] - num7 + (num8 - inLow[num2 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num11 = num5;
              }
              numArray1[index3] = numArray1[index3] + (num10 - num11);
            }
            ++index1;
            ++num2;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlKickingByLengthLookback()
    {
      return (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) + 1;
    }

    public static Core.RetCode CdlKickingByLength(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[2];
      double[] numArray2 = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlKickingByLengthLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray1[1] = numArray1[1] + (double) num4;
            float num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num8 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = (float) ((double) inHigh[index] - (double) num7 + ((double) num8 - (double) inLow[index]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray1[0] = numArray1[0] + (double) num9;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray2[1] = numArray2[1] + (double) num4;
            float num9;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num8 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = (float) ((double) inHigh[index] - (double) num7 + ((double) num8 - (double) inLow[index]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray2[0] = numArray2[0] + (double) num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1))
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = numArray2[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
              {
                float num5 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num9 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num12 - (double) inLow[index1 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index1 - 1] - (double) num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                {
                  float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num14 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num12 = (float) ((double) inHigh[index1 - 1] - (double) num14 + ((double) num15 - (double) inLow[index1 - 1]));
                        }
                        else
                          num12 = 0.0f;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num7 - (double) inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num8 / num16)
                  {
                    double num9;
                    if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                    {
                      num9 = numArray2[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                      {
                        num11 = Math.Abs(inClose[index1] - inOpen[index1]);
                      }
                      else
                      {
                        float num12;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                        {
                          num12 = inHigh[index1] - inLow[index1];
                        }
                        else
                        {
                          float num14;
                          if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                          {
                            float num15 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                            float num17 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                            num14 = (float) ((double) inHigh[index1] - (double) num15 + ((double) num17 - (double) inLow[index1]));
                          }
                          else
                            num14 = 0.0f;
                          num12 = num14;
                        }
                        num11 = num12;
                      }
                      num9 = (double) num11;
                    }
                    double num18 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num9 / num18)
                    {
                      float num11 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                      double num12;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num12 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num14 = Math.Abs(inClose[index1] - inOpen[index1]);
                        }
                        else
                        {
                          float num15;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num15 = inHigh[index1] - inLow[index1];
                          }
                          else
                          {
                            float num17;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              float num19 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                              float num20 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                              num17 = (float) ((double) inHigh[index1] - (double) num19 + ((double) num20 - (double) inLow[index1]));
                            }
                            else
                              num17 = 0.0f;
                            num15 = num17;
                          }
                          num14 = num15;
                        }
                        num12 = (double) num14;
                      }
                      double num21 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) inHigh[index1] - (double) num11 < Core.Globals.candleSettings[7].factor * num12 / num21)
                      {
                        float num14 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                        double num15;
                        if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                        {
                          num15 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                        }
                        else
                        {
                          float num17;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index1] - inOpen[index1]);
                          }
                          else
                          {
                            float num19;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                            {
                              num19 = inHigh[index1] - inLow[index1];
                            }
                            else
                            {
                              float num20;
                              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                              {
                                float num22 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                                float num23 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                                num20 = (float) ((double) inHigh[index1] - (double) num22 + ((double) num23 - (double) inLow[index1]));
                              }
                              else
                                num20 = 0.0f;
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          num15 = (double) num17;
                        }
                        double num24 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) num14 - (double) inLow[index1] < Core.Globals.candleSettings[7].factor * num15 / num24 && (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && (double) inLow[index1] > (double) inHigh[index1 - 1] || ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (double) inHigh[index1] < (double) inLow[index1 - 1]))
                        {
                          int index3 = (double) Math.Abs(inClose[index1] - inOpen[index1]) <= (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) ? index1 - 1 : index1;
                          int index4 = (double) Math.Abs(inClose[index1] - inOpen[index1]) <= (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) ? index1 - 1 : index1;
                          int num17 = (double) inClose[index3] < (double) inOpen[index4] ? -1 : 1;
                          outInteger[index2] = num17 * 100;
                          ++index2;
                          goto label_136;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_136:
            for (int index3 = 1; index3 >= 0; --index3)
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = (float) ((double) inHigh[index1 - index3] - (double) num7 + ((double) num8 - (double) inLow[index1 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              float num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    float num8 = (double) inClose[num3 - index3] < (double) inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num6 = (float) ((double) inHigh[num3 - index3] - (double) num7 + ((double) num8 - (double) inLow[num3 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray2[index3] = numArray2[index3] + ((double) num4 - (double) num9);
              float num10;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = (float) ((double) inHigh[index1 - index3] - (double) num7 + ((double) num8 - (double) inLow[index1 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num10 = num5;
              }
              float num11;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num8 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num6 = (float) ((double) inHigh[num2 - index3] - (double) num7 + ((double) num8 - (double) inLow[num2 - index3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num11 = num5;
              }
              numArray1[index3] = numArray1[index3] + ((double) num10 - (double) num11);
            }
            ++index1;
            ++num2;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlKickingByLength(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[2];
      double[] numArray2 = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlKickingByLengthLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray1[1] = numArray1[1] + num4;
            double num9;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num8 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = inHigh[index] - num7 + (num8 - inLow[index]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray1[0] = numArray1[0] + num9;
          }
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            numArray2[1] = numArray2[1] + num4;
            double num9;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index] - inLow[index];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num8 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num6 = inHigh[index] - num7 + (num8 - inLow[index]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num9 = num5;
            }
            numArray2[0] = numArray2[0] + num9;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -(inClose[index1] < inOpen[index1] ? -1 : 1))
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = numArray2[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num4 / num10)
              {
                double num5 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                double num6;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num6 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num9 = inHigh[index1 - 1] - num11 + (num12 - inLow[index1 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index1 - 1] - num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
                {
                  double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  double num8;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num8 = numArray1[1] / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num11 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num14 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num12 = inHigh[index1 - 1] - num14 + (num15 - inLow[index1 - 1]);
                        }
                        else
                          num12 = 0.0;
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num7 - inLow[index1 - 1] < Core.Globals.candleSettings[7].factor * num8 / num16)
                  {
                    double num9;
                    if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                    {
                      num9 = numArray2[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                      {
                        num11 = Math.Abs(inClose[index1] - inOpen[index1]);
                      }
                      else
                      {
                        double num12;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                        {
                          num12 = inHigh[index1] - inLow[index1];
                        }
                        else
                        {
                          double num14;
                          if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                          {
                            double num15 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                            double num17 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                            num14 = inHigh[index1] - num15 + (num17 - inLow[index1]);
                          }
                          else
                            num14 = 0.0;
                          num12 = num14;
                        }
                        num11 = num12;
                      }
                      num9 = num11;
                    }
                    double num18 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num9 / num18)
                    {
                      double num11 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                      double num12;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num12 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num14 = Math.Abs(inClose[index1] - inOpen[index1]);
                        }
                        else
                        {
                          double num15;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num15 = inHigh[index1] - inLow[index1];
                          }
                          else
                          {
                            double num17;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              double num19 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                              double num20 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                              num17 = inHigh[index1] - num19 + (num20 - inLow[index1]);
                            }
                            else
                              num17 = 0.0;
                            num15 = num17;
                          }
                          num14 = num15;
                        }
                        num12 = num14;
                      }
                      double num21 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (inHigh[index1] - num11 < Core.Globals.candleSettings[7].factor * num12 / num21)
                      {
                        double num14 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                        double num15;
                        if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                        {
                          num15 = numArray1[0] / (double) Core.Globals.candleSettings[7].avgPeriod;
                        }
                        else
                        {
                          double num17;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                          {
                            num17 = Math.Abs(inClose[index1] - inOpen[index1]);
                          }
                          else
                          {
                            double num19;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                            {
                              num19 = inHigh[index1] - inLow[index1];
                            }
                            else
                            {
                              double num20;
                              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                              {
                                double num22 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                                double num23 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                                num20 = inHigh[index1] - num22 + (num23 - inLow[index1]);
                              }
                              else
                                num20 = 0.0;
                              num19 = num20;
                            }
                            num17 = num19;
                          }
                          num15 = num17;
                        }
                        double num24 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (num14 - inLow[index1] < Core.Globals.candleSettings[7].factor * num15 / num24 && ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && inLow[index1] > inHigh[index1 - 1] || (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && inHigh[index1] < inLow[index1 - 1]))
                        {
                          int index3 = Math.Abs(inClose[index1] - inOpen[index1]) <= Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) ? index1 - 1 : index1;
                          int index4 = Math.Abs(inClose[index1] - inOpen[index1]) <= Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) ? index1 - 1 : index1;
                          int num17 = inClose[index3] < inOpen[index4] ? -1 : 1;
                          outInteger[index2] = num17 * 100;
                          ++index2;
                          goto label_136;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_136:
            for (int index3 = 1; index3 >= 0; --index3)
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = inHigh[index1 - index3] - num7 + (num8 - inLow[index1 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              double num9;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[num3 - index3] - inOpen[num3 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - index3] - inLow[num3 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num3 - index3] < inOpen[num3 - index3] ? inOpen[num3 - index3] : inClose[num3 - index3];
                    double num8 = inClose[num3 - index3] < inOpen[num3 - index3] ? inClose[num3 - index3] : inOpen[num3 - index3];
                    num6 = inHigh[num3 - index3] - num7 + (num8 - inLow[num3 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray2[index3] = numArray2[index3] + (num4 - num9);
              double num10;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num6 = inHigh[index1 - index3] - num7 + (num8 - inLow[index1 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num10 = num5;
              }
              double num11;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
              {
                num11 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num8 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num6 = inHigh[num2 - index3] - num7 + (num8 - inLow[num2 - index3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num11 = num5;
              }
              numArray1[index3] = numArray1[index3] + (num10 - num11);
            }
            ++index1;
            ++num2;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlLadderBottomLookback()
    {
      return Core.Globals.candleSettings[7].avgPeriod + 4;
    }

    public static Core.RetCode CdlLadderBottom(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlLadderBottomLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? -1 : 1) == -1 && ((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) == -1 && (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1 && (double) inOpen[index1 - 4] > (double) inOpen[index1 - 3] && ((double) inOpen[index1 - 3] > (double) inOpen[index1 - 2] && (double) inClose[index1 - 4] > (double) inClose[index1 - 3]) && (double) inClose[index1 - 3] > (double) inClose[index1 - 2] && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1))
            {
              float num4 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
              double num5;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num8 = (float) ((double) inHigh[index1 - 1] - (double) num9 + ((double) num10 - (double) inLow[index1 - 1]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index1 - 1] - (double) num4 > Core.Globals.candleSettings[7].factor * num5 / num11 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (double) inOpen[index1] > (double) inOpen[index1 - 1] && (double) inClose[index1] > (double) inHigh[index1 - 1]))
              {
                outInteger[index2] = 100;
                ++index2;
                goto label_41;
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_41:
            float num12;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num5 = (float) ((double) inHigh[index1 - 1] - (double) num6 + ((double) num7 - (double) inLow[index1 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num12 = num4;
            }
            float num13;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num7 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num5 = (float) ((double) inHigh[num3 - 1] - (double) num6 + ((double) num7 - (double) inLow[num3 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            num2 += (double) num12 - (double) num13;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlLadderBottom(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlLadderBottomLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 4] < inOpen[index1 - 4] ? -1 : 1) == -1 && (inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) == -1 && ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1 && inOpen[index1 - 4] > inOpen[index1 - 3] && (inOpen[index1 - 3] > inOpen[index1 - 2] && inClose[index1 - 4] > inClose[index1 - 3]) && inClose[index1 - 3] > inClose[index1 - 2] && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1))
            {
              double num4 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
              double num5;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num8 = inHigh[index1 - 1] - num9 + (num10 - inLow[index1 - 1]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index1 - 1] - num4 > Core.Globals.candleSettings[7].factor * num5 / num11 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && inOpen[index1] > inOpen[index1 - 1] && inClose[index1] > inHigh[index1 - 1]))
              {
                outInteger[index2] = 100;
                ++index2;
                goto label_41;
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_41:
            double num12;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num5 = inHigh[index1 - 1] - num6 + (num7 - inLow[index1 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num12 = num4;
            }
            double num13;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num7 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num5 = inHigh[num3 - 1] - num6 + (num7 - inLow[num3 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            num2 += num12 - num13;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlLongLeggedDojiLookback()
    {
      return Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[3].avgPeriod;
    }

    public static Core.RetCode CdlLongLeggedDoji(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlLongLeggedDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num5 - (double) inLow[index4] <= Core.Globals.candleSettings[4].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index4] - (double) num7 <= Core.Globals.candleSettings[4].factor * num8 / num16)
                  goto label_77;
              }
              outInteger[index5] = 100;
              ++index5;
              goto label_78;
            }
label_77:
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlLongLeggedDoji(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlLongLeggedDojiLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) <= Core.Globals.candleSettings[3].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num5 - inLow[index4] <= Core.Globals.candleSettings[4].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index4] - num7 <= Core.Globals.candleSettings[4].factor * num8 / num16)
                  goto label_77;
              }
              outInteger[index5] = 100;
              ++index5;
              goto label_78;
            }
label_77:
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlLongLineLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[6].avgPeriod ? Core.Globals.candleSettings[6].avgPeriod : Core.Globals.candleSettings[0].avgPeriod;
    }

    public static Core.RetCode CdlLongLine(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlLongLineLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[6].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index4] - (double) num5 < Core.Globals.candleSettings[6].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num7 - (double) inLow[index4] < Core.Globals.candleSettings[6].factor * num8 / num16)
                {
                  int num9 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlLongLine(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlLongLineLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[6].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index4] - num5 < Core.Globals.candleSettings[6].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num7 - inLow[index4] < Core.Globals.candleSettings[6].factor * num8 / num16)
                {
                  int num9 = inClose[index4] < inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlMarubozuLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[0].avgPeriod;
    }

    public static Core.RetCode CdlMarubozu(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlMarubozuLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index4] - (double) num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num7 - (double) inLow[index4] < Core.Globals.candleSettings[7].factor * num8 / num16)
                {
                  int num9 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlMarubozu(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlMarubozuLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index4] - num5 < Core.Globals.candleSettings[7].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num7 - inLow[index4] < Core.Globals.candleSettings[7].factor * num8 / num16)
                {
                  int num9 = inClose[index4] < inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlMatchingLowLookback()
    {
      return Core.Globals.candleSettings[10].avgPeriod + 1;
    }

    public static Core.RetCode CdlMatchingLow(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlMatchingLowLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inClose[index1] <= (double) inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num4 / num10)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num8 = (float) ((double) inHigh[index1 - 1] - (double) num9 + ((double) num11 - (double) inLow[index1 - 1]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num12 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1] >= (double) inClose[index1 - 1] - Core.Globals.candleSettings[10].factor * num5 / num12)
                {
                  outInteger[index2] = 100;
                  ++index2;
                  goto label_54;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_54:
            float num13;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num5 = (float) ((double) inHigh[index1 - 1] - (double) num6 + ((double) num7 - (double) inLow[index1 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            float num14;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num7 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num5 = (float) ((double) inHigh[num3 - 1] - (double) num6 + ((double) num7 - (double) inLow[num3 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += (double) num13 - (double) num14;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlMatchingLow(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlMatchingLowLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && (inClose[index1] < inOpen[index1] ? -1 : 1) == -1)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inClose[index1] <= inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num4 / num10)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num8 = inHigh[index1 - 1] - num9 + (num11 - inLow[index1 - 1]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num12 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1] >= inClose[index1 - 1] - Core.Globals.candleSettings[10].factor * num5 / num12)
                {
                  outInteger[index2] = 100;
                  ++index2;
                  goto label_54;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_54:
            double num13;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num5 = inHigh[index1 - 1] - num6 + (num7 - inLow[index1 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            double num14;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num7 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num5 = inHigh[num3 - 1] - num6 + (num7 - inLow[num3 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += num13 - num14;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlMatHoldLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.5;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 4;
label_5:
      return num;
    }

    public static Core.RetCode CdlMatHold(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[5];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.5;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_155;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlMatHoldLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            numArray[4] = 0.0;
            numArray[3] = 0.0;
            numArray[2] = 0.0;
            numArray[1] = 0.0;
            numArray[0] = 0.0;
            int num2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
            for (int index = num2; index < startIdx; ++index)
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index - 3] - inOpen[index - 3]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 3] - inLow[index - 3];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index - 3] < (double) inOpen[index - 3] ? inOpen[index - 3] : inClose[index - 3];
                    float num8 = (double) inClose[index - 3] < (double) inOpen[index - 3] ? inClose[index - 3] : inOpen[index - 3];
                    num6 = (float) ((double) inHigh[index - 3] - (double) num7 + ((double) num8 - (double) inLow[index - 3]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              numArray[3] = numArray[3] + (double) num4;
              float num9;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 2] - inLow[index - 2];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                    float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                    num6 = (float) ((double) inHigh[index - 2] - (double) num7 + ((double) num8 - (double) inLow[index - 2]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray[2] = numArray[2] + (double) num9;
              float num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 1] - inLow[index - 1];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                    float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                    num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num10 = num5;
              }
              numArray[1] = numArray[1] + (double) num10;
            }
            for (int index = num3; index < startIdx; ++index)
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index - 4] - inOpen[index - 4]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 4] - inLow[index - 4];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index - 4] < (double) inOpen[index - 4] ? inOpen[index - 4] : inClose[index - 4];
                    float num8 = (double) inClose[index - 4] < (double) inOpen[index - 4] ? inClose[index - 4] : inOpen[index - 4];
                    num6 = (float) ((double) inHigh[index - 4] - (double) num7 + ((double) num8 - (double) inLow[index - 4]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              numArray[4] = numArray[4] + (double) num4;
            }
            int index1 = startIdx;
            int index2 = 0;
            do
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = numArray[4] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 4] - inLow[index1 - 4];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                      float num9 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                      num7 = (float) ((double) inHigh[index1 - 4] - (double) num8 + ((double) num9 - (double) inLow[index1 - 4]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num5 = numArray[3] / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 3] - inLow[index1 - 3];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        float num9 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                        float num11 = (double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                        num8 = (float) ((double) inHigh[index1 - 3] - (double) num9 + ((double) num11 - (double) inLow[index1 - 3]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]) < Core.Globals.candleSettings[2].factor * num5 / num12)
                {
                  double num6;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num6 = numArray[2] / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num7 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num8 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        float num9;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num11 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          float num13 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num9 = (float) ((double) inHigh[index1 - 2] - (double) num11 + ((double) num13 - (double) inLow[index1 - 2]));
                        }
                        else
                          num9 = 0.0f;
                        num8 = num9;
                      }
                      num7 = num8;
                    }
                    num6 = (double) num7;
                  }
                  double num14 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]) < Core.Globals.candleSettings[2].factor * num6 / num14)
                  {
                    double num7;
                    if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                    {
                      num7 = numArray[1] / (double) Core.Globals.candleSettings[2].avgPeriod;
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                      {
                        num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                      }
                      else
                      {
                        float num9;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                        {
                          num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                        }
                        else
                        {
                          float num11;
                          if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                          {
                            float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                            num11 = (float) ((double) inHigh[index1 - 1] - (double) num13 + ((double) num15 - (double) inLow[index1 - 1]));
                          }
                          else
                            num11 = 0.0f;
                          num9 = num11;
                        }
                        num8 = num9;
                      }
                      num7 = (double) num8;
                    }
                    double num16 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) < Core.Globals.candleSettings[2].factor * num7 / num16 && ((double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? -1 : 1) == 1 && (((double) inClose[index1 - 3] < (double) inOpen[index1 - 3] ? -1 : 1) == -1 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && ((double) inOpen[index1 - 3] >= (double) inClose[index1 - 3] ? (double) inClose[index1 - 3] : (double) inOpen[index1 - 3]) > ((double) inOpen[index1 - 4] <= (double) inClose[index1 - 4] ? (double) inClose[index1 - 4] : (double) inOpen[index1 - 4]) && (((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) < (double) inClose[index1 - 4] && ((double) inOpen[index1 - 1] >= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) < (double) inClose[index1 - 4]) && (((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) > (double) inClose[index1 - 4] - (double) Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) * optInPenetration && ((double) inOpen[index1 - 1] >= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) > (double) inClose[index1 - 4] - (double) Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) * optInPenetration && (((double) inClose[index1 - 2] <= (double) inOpen[index1 - 2] ? (double) inOpen[index1 - 2] : (double) inClose[index1 - 2]) < (double) inOpen[index1 - 3] && (((double) inClose[index1 - 1] <= (double) inOpen[index1 - 1] ? (double) inOpen[index1 - 1] : (double) inClose[index1 - 1]) < ((double) inClose[index1 - 2] <= (double) inOpen[index1 - 2] ? (double) inOpen[index1 - 2] : (double) inClose[index1 - 2]) && (double) inOpen[index1] > (double) inClose[index1 - 1]))))))
                    {
                      float num8 = ((double) inHigh[index1 - 3] <= (double) inHigh[index1 - 2] ? (double) inHigh[index1 - 2] : (double) inHigh[index1 - 3]) <= (double) inHigh[index1 - 1] ? inHigh[index1 - 1] : ((double) inHigh[index1 - 3] <= (double) inHigh[index1 - 2] ? inHigh[index1 - 2] : inHigh[index1 - 3]);
                      if ((double) inClose[index1] > (double) num8)
                      {
                        outInteger[index2] = 100;
                        ++index2;
                        goto label_114;
                      }
                    }
                  }
                }
              }
              outInteger[index2] = 0;
              ++index2;
label_114:
              float num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - 4] - inLow[index1 - 4];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                    float num8 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                    num6 = (float) ((double) inHigh[index1 - 4] - (double) num7 + ((double) num8 - (double) inLow[index1 - 4]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num17 = num5;
              }
              float num18;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[num3 - 4] - inOpen[num3 - 4]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - 4] - inLow[num3 - 4];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num3 - 4] < (double) inOpen[num3 - 4] ? inOpen[num3 - 4] : inClose[num3 - 4];
                    float num8 = (double) inClose[num3 - 4] < (double) inOpen[num3 - 4] ? inClose[num3 - 4] : inOpen[num3 - 4];
                    num6 = (float) ((double) inHigh[num3 - 4] - (double) num7 + ((double) num8 - (double) inLow[num3 - 4]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num18 = num5;
              }
              numArray[4] = numArray[4] + ((double) num17 - (double) num18);
              for (int index3 = 3; index3 >= 1; --index3)
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - index3] - inLow[index1 - index3];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                      float num9 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                      num7 = (float) ((double) inHigh[index1 - index3] - (double) num8 + ((double) num9 - (double) inLow[index1 - index3]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                float num11;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num11 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[num2 - index3] - inLow[num2 - index3];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                      float num9 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                      num7 = (float) ((double) inHigh[num2 - index3] - (double) num8 + ((double) num9 - (double) inLow[num2 - index3]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num11 = num6;
                }
                numArray[index3] = numArray[index3] + ((double) num5 - (double) num11);
              }
              ++index1;
              ++num2;
              ++num3;
            }
            while (index1 <= endIdx);
            outNBElement = index2;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_155:
      return retCode;
    }

    public static Core.RetCode CdlMatHold(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[5];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.5;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_155;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlMatHoldLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            numArray[4] = 0.0;
            numArray[3] = 0.0;
            numArray[2] = 0.0;
            numArray[1] = 0.0;
            numArray[0] = 0.0;
            int num2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            int num3 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
            for (int index = num2; index < startIdx; ++index)
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index - 3] - inOpen[index - 3]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 3] - inLow[index - 3];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index - 3] < inOpen[index - 3] ? inOpen[index - 3] : inClose[index - 3];
                    double num8 = inClose[index - 3] < inOpen[index - 3] ? inClose[index - 3] : inOpen[index - 3];
                    num6 = inHigh[index - 3] - num7 + (num8 - inLow[index - 3]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              numArray[3] = numArray[3] + num4;
              double num9;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num9 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 2] - inLow[index - 2];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                    double num8 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                    num6 = inHigh[index - 2] - num7 + (num8 - inLow[index - 2]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num9 = num5;
              }
              numArray[2] = numArray[2] + num9;
              double num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 1] - inLow[index - 1];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                    double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                    num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num10 = num5;
              }
              numArray[1] = numArray[1] + num10;
            }
            for (int index = num3; index < startIdx; ++index)
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index - 4] - inOpen[index - 4]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index - 4] - inLow[index - 4];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index - 4] < inOpen[index - 4] ? inOpen[index - 4] : inClose[index - 4];
                    double num8 = inClose[index - 4] < inOpen[index - 4] ? inClose[index - 4] : inOpen[index - 4];
                    num6 = inHigh[index - 4] - num7 + (num8 - inLow[index - 4]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              numArray[4] = numArray[4] + num4;
            }
            int index1 = startIdx;
            int index2 = 0;
            do
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = numArray[4] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 4] - inLow[index1 - 4];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 4] < inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                      double num9 = inClose[index1 - 4] < inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                      num7 = inHigh[index1 - 4] - num8 + (num9 - inLow[index1 - 4]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) > Core.Globals.candleSettings[0].factor * num4 / num10)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num5 = numArray[3] / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 3] - inLow[index1 - 3];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        double num9 = inClose[index1 - 3] < inOpen[index1 - 3] ? inOpen[index1 - 3] : inClose[index1 - 3];
                        double num11 = inClose[index1 - 3] < inOpen[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3];
                        num8 = inHigh[index1 - 3] - num9 + (num11 - inLow[index1 - 3]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index1 - 3] - inOpen[index1 - 3]) < Core.Globals.candleSettings[2].factor * num5 / num12)
                {
                  double num6;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num6 = numArray[2] / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num7 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num8 = inHigh[index1 - 2] - inLow[index1 - 2];
                      }
                      else
                      {
                        double num9;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num11 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                          double num13 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                          num9 = inHigh[index1 - 2] - num11 + (num13 - inLow[index1 - 2]);
                        }
                        else
                          num9 = 0.0;
                        num8 = num9;
                      }
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  double num14 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]) < Core.Globals.candleSettings[2].factor * num6 / num14)
                  {
                    double num7;
                    if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                    {
                      num7 = numArray[1] / (double) Core.Globals.candleSettings[2].avgPeriod;
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                      {
                        num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                      }
                      else
                      {
                        double num9;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                        {
                          num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                        }
                        else
                        {
                          double num11;
                          if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                          {
                            double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                            double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                            num11 = inHigh[index1 - 1] - num13 + (num15 - inLow[index1 - 1]);
                          }
                          else
                            num11 = 0.0;
                          num9 = num11;
                        }
                        num8 = num9;
                      }
                      num7 = num8;
                    }
                    double num16 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) < Core.Globals.candleSettings[2].factor * num7 / num16 && (inClose[index1 - 4] < inOpen[index1 - 4] ? -1 : 1) == 1 && ((inClose[index1 - 3] < inOpen[index1 - 3] ? -1 : 1) == -1 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && (inOpen[index1 - 3] >= inClose[index1 - 3] ? inClose[index1 - 3] : inOpen[index1 - 3]) > (inOpen[index1 - 4] <= inClose[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4]) && ((inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) < inClose[index1 - 4] && (inOpen[index1 - 1] >= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) < inClose[index1 - 4]) && ((inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) > inClose[index1 - 4] - Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) * optInPenetration && (inOpen[index1 - 1] >= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) > inClose[index1 - 4] - Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]) * optInPenetration && ((inClose[index1 - 2] <= inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2]) < inOpen[index1 - 3] && ((inClose[index1 - 1] <= inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1]) < (inClose[index1 - 2] <= inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2]) && inOpen[index1] > inClose[index1 - 1]))))))
                    {
                      double num8 = (inHigh[index1 - 3] <= inHigh[index1 - 2] ? inHigh[index1 - 2] : inHigh[index1 - 3]) <= inHigh[index1 - 1] ? inHigh[index1 - 1] : (inHigh[index1 - 3] <= inHigh[index1 - 2] ? inHigh[index1 - 2] : inHigh[index1 - 3]);
                      if (inClose[index1] > num8)
                      {
                        outInteger[index2] = 100;
                        ++index2;
                        goto label_114;
                      }
                    }
                  }
                }
              }
              outInteger[index2] = 0;
              ++index2;
label_114:
              double num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index1 - 4] - inLow[index1 - 4];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index1 - 4] < inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                    double num8 = inClose[index1 - 4] < inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                    num6 = inHigh[index1 - 4] - num7 + (num8 - inLow[index1 - 4]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num17 = num5;
              }
              double num18;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[num3 - 4] - inOpen[num3 - 4]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num3 - 4] - inLow[num3 - 4];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num3 - 4] < inOpen[num3 - 4] ? inOpen[num3 - 4] : inClose[num3 - 4];
                    double num8 = inClose[num3 - 4] < inOpen[num3 - 4] ? inClose[num3 - 4] : inOpen[num3 - 4];
                    num6 = inHigh[num3 - 4] - num7 + (num8 - inLow[num3 - 4]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num18 = num5;
              }
              numArray[4] = numArray[4] + (num17 - num18);
              for (int index3 = 3; index3 >= 1; --index3)
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - index3] - inLow[index1 - index3];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                      double num9 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                      num7 = inHigh[index1 - index3] - num8 + (num9 - inLow[index1 - index3]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num11;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num11 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[num2 - index3] - inLow[num2 - index3];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                      double num9 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                      num7 = inHigh[num2 - index3] - num8 + (num9 - inLow[num2 - index3]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num11 = num6;
                }
                numArray[index3] = numArray[index3] + (num5 - num11);
              }
              ++index1;
              ++num2;
              ++num3;
            }
            while (index1 <= endIdx);
            outNBElement = index2;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_155:
      return retCode;
    }

    public static int CdlMorningDojiStarLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.3;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = ((Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[3].avgPeriod)) + 2;
label_5:
      return num;
    }

    public static Core.RetCode CdlMorningDojiStar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_150;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlMorningDojiStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[3].avgPeriod;
            int index3 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            for (int index4 = index1; index4 < startIdx - 2; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += (double) num5;
            }
            for (int index4 = index2; index4 < startIdx - 1; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += (double) num5;
            }
            for (int index4 = index3; index4 < startIdx; ++index4)
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 += (double) num5;
            }
            int index5 = startIdx;
            int index6 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index5 - 2] - inLow[index5 - 2];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                      float num10 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                      num8 = (float) ((double) inHigh[index5 - 2] - (double) num9 + ((double) num10 - (double) inLow[index5 - 2]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && ((double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? -1 : 1) == -1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index5 - 1] - inLow[index5 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                        float num12 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                        num9 = (float) ((double) inHigh[index5 - 1] - (double) num10 + ((double) num12 - (double) inLow[index5 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]) <= Core.Globals.candleSettings[3].factor * num6 / num13 && ((double) inOpen[index5 - 1] <= (double) inClose[index5 - 1] ? (double) inClose[index5 - 1] : (double) inOpen[index5 - 1]) < ((double) inOpen[index5 - 2] >= (double) inClose[index5 - 2] ? (double) inClose[index5 - 2] : (double) inOpen[index5 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                          float num14 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num14 - (double) inLow[index5]));
                        }
                        else
                          num10 = 0.0f;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = (double) num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index5] - inOpen[index5]) > Core.Globals.candleSettings[2].factor * num7 / num15 && (((double) inClose[index5] < (double) inOpen[index5] ? -1 : 1) == 1 && (double) inClose[index5] > (double) inClose[index5 - 2] + (double) Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration))
                  {
                    outInteger[index6] = 100;
                    ++index6;
                    goto label_94;
                  }
                }
              }
              outInteger[index6] = 0;
              ++index6;
label_94:
              float num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 2] - inLow[index5 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                    float num9 = (double) inClose[index5 - 2] < (double) inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                    num7 = (float) ((double) inHigh[index5 - 2] - (double) num8 + ((double) num9 - (double) inLow[index5 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num16 = num6;
              }
              float num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                    float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += (double) num16 - (double) num17;
              float num18;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 1] - inLow[index5 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                    float num9 = (double) inClose[index5 - 1] < (double) inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                    num7 = (float) ((double) inHigh[index5 - 1] - (double) num8 + ((double) num9 - (double) inLow[index5 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num18 = num6;
              }
              float num19;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += (double) num18 - (double) num19;
              float num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num20 = num6;
              }
              float num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += (double) num20 - (double) num21;
              ++index5;
              ++index1;
              ++index2;
              ++index3;
            }
            while (index5 <= endIdx);
            outNBElement = index6;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_150:
      return retCode;
    }

    public static Core.RetCode CdlMorningDojiStar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_150;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlMorningDojiStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[3].avgPeriod;
            int index3 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
            for (int index4 = index1; index4 < startIdx - 2; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += num5;
            }
            for (int index4 = index2; index4 < startIdx - 1; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += num5;
            }
            for (int index4 = index3; index4 < startIdx; ++index4)
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 += num5;
            }
            int index5 = startIdx;
            int index6 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index5 - 2] - inLow[index5 - 2];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index5 - 2] < inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                      double num10 = inClose[index5 - 2] < inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                      num8 = inHigh[index5 - 2] - num9 + (num10 - inLow[index5 - 2]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && (inClose[index5 - 2] < inOpen[index5 - 2] ? -1 : 1) == -1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index5 - 1] - inLow[index5 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index5 - 1] < inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                        double num12 = inClose[index5 - 1] < inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                        num9 = inHigh[index5 - 1] - num10 + (num12 - inLow[index5 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]) <= Core.Globals.candleSettings[3].factor * num6 / num13 && (inOpen[index5 - 1] <= inClose[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1]) < (inOpen[index5 - 2] >= inClose[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                          double num14 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num10 = inHigh[index5] - num12 + (num14 - inLow[index5]);
                        }
                        else
                          num10 = 0.0;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index5] - inOpen[index5]) > Core.Globals.candleSettings[2].factor * num7 / num15 && ((inClose[index5] < inOpen[index5] ? -1 : 1) == 1 && inClose[index5] > inClose[index5 - 2] + Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]) * optInPenetration))
                  {
                    outInteger[index6] = 100;
                    ++index6;
                    goto label_94;
                  }
                }
              }
              outInteger[index6] = 0;
              ++index6;
label_94:
              double num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index5 - 2] - inOpen[index5 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 2] - inLow[index5 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5 - 2] < inOpen[index5 - 2] ? inOpen[index5 - 2] : inClose[index5 - 2];
                    double num9 = inClose[index5 - 2] < inOpen[index5 - 2] ? inClose[index5 - 2] : inOpen[index5 - 2];
                    num7 = inHigh[index5 - 2] - num8 + (num9 - inLow[index5 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num16 = num6;
              }
              double num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                    double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += num16 - num17;
              double num18;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index5 - 1] - inOpen[index5 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5 - 1] - inLow[index5 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5 - 1] < inOpen[index5 - 1] ? inOpen[index5 - 1] : inClose[index5 - 1];
                    double num9 = inClose[index5 - 1] < inOpen[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1];
                    num7 = inHigh[index5 - 1] - num8 + (num9 - inLow[index5 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num18 = num6;
              }
              double num19;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += num18 - num19;
              double num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num20 = num6;
              }
              double num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += num20 - num21;
              ++index5;
              ++index1;
              ++index2;
              ++index3;
            }
            while (index5 <= endIdx);
            outNBElement = index6;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_150:
      return retCode;
    }

    public static int CdlMorningStarLookback(double optInPenetration)
    {
      int num;
      if (optInPenetration == -4E+37)
        optInPenetration = 0.3;
      else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
      {
        num = -1;
        goto label_5;
      }
      num = (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 2;
label_5:
      return num;
    }

    public static Core.RetCode CdlMorningStar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_147;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlMorningStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
            for (int index3 = index1; index3 < startIdx - 2; ++index3)
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += (double) num5;
            }
            for (int index3 = index2; index3 < startIdx - 1; ++index3)
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                    float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += (double) num5;
              float num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index3 + 1] - inOpen[index3 + 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3 + 1] - inLow[index3 + 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index3 + 1] < (double) inOpen[index3 + 1] ? inOpen[index3 + 1] : inClose[index3 + 1];
                    float num9 = (double) inClose[index3 + 1] < (double) inOpen[index3 + 1] ? inClose[index3 + 1] : inOpen[index3 + 1];
                    num7 = (float) ((double) inHigh[index3 + 1] - (double) num8 + ((double) num9 - (double) inLow[index3 + 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num10 = num6;
              }
              num4 += (double) num10;
            }
            int index4 = startIdx;
            int index5 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4 - 2] - inLow[index4 - 2];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                      float num10 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                      num8 = (float) ((double) inHigh[index4 - 2] - (double) num9 + ((double) num10 - (double) inLow[index4 - 2]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && ((double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1) == -1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        float num12 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num9 = (float) ((double) inHigh[index4 - 1] - (double) num10 + ((double) num12 - (double) inLow[index4 - 1]));
                      }
                      else
                        num9 = 0.0f;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = (double) num7;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num6 / num13 && ((double) inOpen[index4 - 1] <= (double) inClose[index4 - 1] ? (double) inClose[index4 - 1] : (double) inOpen[index4 - 1]) < ((double) inOpen[index4 - 2] >= (double) inClose[index4 - 2] ? (double) inClose[index4 - 2] : (double) inOpen[index4 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index4] - inOpen[index4]);
                    }
                    else
                    {
                      float num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index4] - inLow[index4];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                          float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                          num10 = (float) ((double) inHigh[index4] - (double) num12 + ((double) num14 - (double) inLow[index4]));
                        }
                        else
                          num10 = 0.0f;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = (double) num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[2].factor * num7 / num15 && (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == 1 && (double) inClose[index4] > (double) inClose[index4 - 2] + (double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) * optInPenetration))
                  {
                    outInteger[index5] = 100;
                    ++index5;
                    goto label_91;
                  }
                }
              }
              outInteger[index5] = 0;
              ++index5;
label_91:
              float num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = (float) ((double) inHigh[index4 - 2] - (double) num8 + ((double) num9 - (double) inLow[index4 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num16 = num6;
              }
              float num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                    float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += (double) num16 - (double) num17;
              float num18;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = (float) ((double) inHigh[index4 - 1] - (double) num8 + ((double) num9 - (double) inLow[index4 - 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num18 = num6;
              }
              float num19;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += (double) num18 - (double) num19;
              float num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num20 = num6;
              }
              float num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index2 + 1] - inOpen[index2 + 1]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2 + 1] - inLow[index2 + 1];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index2 + 1] < (double) inOpen[index2 + 1] ? inOpen[index2 + 1] : inClose[index2 + 1];
                    float num9 = (double) inClose[index2 + 1] < (double) inOpen[index2 + 1] ? inClose[index2 + 1] : inOpen[index2 + 1];
                    num7 = (float) ((double) inHigh[index2 + 1] - (double) num8 + ((double) num9 - (double) inLow[index2 + 1]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += (double) num20 - (double) num21;
              ++index4;
              ++index1;
              ++index2;
            }
            while (index4 <= endIdx);
            outNBElement = index5;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_147:
      return retCode;
    }

    public static Core.RetCode CdlMorningStar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double optInPenetration,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInPenetration == -4E+37)
          optInPenetration = 0.3;
        else if (optInPenetration < 0.0 || optInPenetration > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_147;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.CdlMorningStarLookback(optInPenetration);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            double num4 = 0.0;
            int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
            int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
            for (int index3 = index1; index3 < startIdx - 2; ++index3)
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num2 += num5;
            }
            for (int index3 = index2; index3 < startIdx - 1; ++index3)
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index3] - inOpen[index3]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3] - inLow[index3];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                    double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                    num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num3 += num5;
              double num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[index3 + 1] - inOpen[index3 + 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index3 + 1] - inLow[index3 + 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index3 + 1] < inOpen[index3 + 1] ? inOpen[index3 + 1] : inClose[index3 + 1];
                    double num9 = inClose[index3 + 1] < inOpen[index3 + 1] ? inClose[index3 + 1] : inOpen[index3 + 1];
                    num7 = inHigh[index3 + 1] - num8 + (num9 - inLow[index3 + 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num10 = num6;
              }
              num4 += num10;
            }
            int index4 = startIdx;
            int index5 = 0;
            do
            {
              double num5;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num5 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4 - 2] - inLow[index4 - 2];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                      double num10 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                      num8 = inHigh[index4 - 2] - num9 + (num10 - inLow[index4 - 2]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num5 / num11 && (inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1) == -1)
              {
                double num6;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num6 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num7 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num8 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        double num12 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num9 = inHigh[index4 - 1] - num10 + (num12 - inLow[index4 - 1]);
                      }
                      else
                        num9 = 0.0;
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  num6 = num7;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num6 / num13 && (inOpen[index4 - 1] <= inClose[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1]) < (inOpen[index4 - 2] >= inClose[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2]))
                {
                  double num7;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num7 = num4 / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num8 = Math.Abs(inClose[index4] - inOpen[index4]);
                    }
                    else
                    {
                      double num9;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num9 = inHigh[index4] - inLow[index4];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                          double num14 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                          num10 = inHigh[index4] - num12 + (num14 - inLow[index4]);
                        }
                        else
                          num10 = 0.0;
                        num9 = num10;
                      }
                      num8 = num9;
                    }
                    num7 = num8;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[2].factor * num7 / num15 && ((inClose[index4] < inOpen[index4] ? -1 : 1) == 1 && inClose[index4] > inClose[index4 - 2] + Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) * optInPenetration))
                  {
                    outInteger[index5] = 100;
                    ++index5;
                    goto label_91;
                  }
                }
              }
              outInteger[index5] = 0;
              ++index5;
label_91:
              double num16;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num16 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = inHigh[index4 - 2] - num8 + (num9 - inLow[index4 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num16 = num6;
              }
              double num17;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num17 = Math.Abs(inClose[index1] - inOpen[index1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index1] - inLow[index1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                    double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                    num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num17 = num6;
              }
              num2 += num16 - num17;
              double num18;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num18 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 1] - inLow[index4 - 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                    double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                    num7 = inHigh[index4 - 1] - num8 + (num9 - inLow[index4 - 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num18 = num6;
              }
              double num19;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num19 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num19 = num6;
              }
              num3 += num18 - num19;
              double num20;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num20 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num20 = num6;
              }
              double num21;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num21 = Math.Abs(inClose[index2 + 1] - inOpen[index2 + 1]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index2 + 1] - inLow[index2 + 1];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index2 + 1] < inOpen[index2 + 1] ? inOpen[index2 + 1] : inClose[index2 + 1];
                    double num9 = inClose[index2 + 1] < inOpen[index2 + 1] ? inClose[index2 + 1] : inOpen[index2 + 1];
                    num7 = inHigh[index2 + 1] - num8 + (num9 - inLow[index2 + 1]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num21 = num6;
              }
              num4 += num20 - num21;
              ++index4;
              ++index1;
              ++index2;
            }
            while (index4 <= endIdx);
            outNBElement = index5;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_147:
      return retCode;
    }

    public static int CdlOnNeckLookback()
    {
      return (Core.Globals.candleSettings[10].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[10].avgPeriod) + 1;
    }

    public static Core.RetCode CdlOnNeck(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlOnNeckLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += (double) num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = (float) ((double) inHigh[index1 - 1] - (double) num10 + ((double) num11 - (double) inLow[index1 - 1]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num12 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num6 / num12 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (double) inOpen[index1] < (double) inLow[index1 - 1]))
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num13 - (double) inLow[index1 - 1]));
                      }
                      else
                        num10 = 0.0f;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = (double) num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1] <= (double) inLow[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num14)
                {
                  double num8;
                  if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                  {
                    num8 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                      {
                        num10 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        float num11;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                        {
                          float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          float num15 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num11 = (float) ((double) inHigh[index1 - 1] - (double) num13 + ((double) num15 - (double) inLow[index1 - 1]));
                        }
                        else
                          num11 = 0.0f;
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) inClose[index1] >= (double) inLow[index1 - 1] - Core.Globals.candleSettings[10].factor * num8 / num16)
                  {
                    outInteger[index2] = -100;
                    ++index2;
                    goto label_79;
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_79:
            float num17;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num17 = num6;
            }
            float num18;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num9 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num7 = (float) ((double) inHigh[num3 - 1] - (double) num8 + ((double) num9 - (double) inLow[num3 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num18 = num6;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num19 = num6;
            }
            float num20;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  float num9 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = (float) ((double) inHigh[num5 - 1] - (double) num8 + ((double) num9 - (double) inLow[num5 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num20 = num6;
            }
            num4 += (double) num19 - (double) num20;
            ++index1;
            ++num3;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlOnNeck(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlOnNeckLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = inHigh[index1 - 1] - num10 + (num11 - inLow[index1 - 1]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num12 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num6 / num12 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && inOpen[index1] < inLow[index1 - 1]))
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = inHigh[index1 - 1] - num11 + (num13 - inLow[index1 - 1]);
                      }
                      else
                        num10 = 0.0;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1] <= inLow[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num14)
                {
                  double num8;
                  if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                  {
                    num8 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                      {
                        num10 = inHigh[index1 - 1] - inLow[index1 - 1];
                      }
                      else
                      {
                        double num11;
                        if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                        {
                          double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                          double num15 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                          num11 = inHigh[index1 - 1] - num13 + (num15 - inLow[index1 - 1]);
                        }
                        else
                          num11 = 0.0;
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (inClose[index1] >= inLow[index1 - 1] - Core.Globals.candleSettings[10].factor * num8 / num16)
                  {
                    outInteger[index2] = -100;
                    ++index2;
                    goto label_79;
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_79:
            double num17;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num17 = num6;
            }
            double num18;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num9 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num7 = inHigh[num3 - 1] - num8 + (num9 - inLow[num3 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num18 = num6;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num19 = num6;
            }
            double num20;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num5 - 1] < inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  double num9 = inClose[num5 - 1] < inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = inHigh[num5 - 1] - num8 + (num9 - inLow[num5 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num20 = num6;
            }
            num4 += num19 - num20;
            ++index1;
            ++num3;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlPiercingLookback()
    {
      return Core.Globals.candleSettings[0].avgPeriod + 1;
    }

    public static Core.RetCode CdlPiercing(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlPiercingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            float num3;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num5 = (float) ((double) inHigh[index - 1] - (double) num6 + ((double) num7 - (double) inLow[index - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[1] = numArray[1] + (double) num3;
            float num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index] - inLow[index];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index] < (double) inOpen[index] ? inOpen[index] : inClose[index];
                  float num7 = (double) inClose[index] < (double) inOpen[index] ? inClose[index] : inOpen[index];
                  num5 = (float) ((double) inHigh[index] - (double) num6 + ((double) num7 - (double) inLow[index]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[0] = numArray[0] + (double) num8;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num3;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num3 = numArray[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num4 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num5 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num6 = (float) ((double) inHigh[index1 - 1] - (double) num7 + ((double) num8 - (double) inLow[index1 - 1]));
                    }
                    else
                      num6 = 0.0f;
                    num5 = num6;
                  }
                  num4 = num5;
                }
                num3 = (double) num4;
              }
              double num9 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num3 / num9 && ((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1)
              {
                double num4;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num4 = numArray[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1] - inOpen[index1]);
                  }
                  else
                  {
                    float num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1] - inLow[index1];
                    }
                    else
                    {
                      float num7;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                        float num10 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                        num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num10 - (double) inLow[index1]));
                      }
                      else
                        num7 = 0.0f;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = (double) num5;
                }
                double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num4 / num11 && (double) inOpen[index1] < (double) inLow[index1 - 1] && ((double) inClose[index1] < (double) inOpen[index1 - 1] && (double) inClose[index1] > (double) inClose[index1 - 1] + (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) * 0.5))
                {
                  outInteger[index2] = 100;
                  ++index2;
                  goto label_63;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_63:
            for (int index3 = 1; index3 >= 0; --index3)
            {
              float num3;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    float num7 = (double) inClose[index1 - index3] < (double) inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = (float) ((double) inHigh[index1 - index3] - (double) num6 + ((double) num7 - (double) inLow[index1 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num3 = num4;
              }
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                float num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  float num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num6 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    float num7 = (double) inClose[num2 - index3] < (double) inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = (float) ((double) inHigh[num2 - index3] - (double) num6 + ((double) num7 - (double) inLow[num2 - index3]));
                  }
                  else
                    num5 = 0.0f;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + ((double) num3 - (double) num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlPiercing(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[2];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlPiercingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num2; index < startIdx; ++index)
          {
            double num3;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num5 = inHigh[index - 1] - num6 + (num7 - inLow[index - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[1] = numArray[1] + num3;
            double num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index] - inOpen[index]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index] - inLow[index];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index] < inOpen[index] ? inOpen[index] : inClose[index];
                  double num7 = inClose[index] < inOpen[index] ? inClose[index] : inOpen[index];
                  num5 = inHigh[index] - num6 + (num7 - inLow[index]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[0] = numArray[0] + num8;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num3;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num3 = numArray[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num4 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num5 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num6 = inHigh[index1 - 1] - num7 + (num8 - inLow[index1 - 1]);
                    }
                    else
                      num6 = 0.0;
                    num5 = num6;
                  }
                  num4 = num5;
                }
                num3 = num4;
              }
              double num9 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num3 / num9 && (inClose[index1] < inOpen[index1] ? -1 : 1) == 1)
              {
                double num4;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num4 = numArray[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num5 = Math.Abs(inClose[index1] - inOpen[index1]);
                  }
                  else
                  {
                    double num6;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num6 = inHigh[index1] - inLow[index1];
                    }
                    else
                    {
                      double num7;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                        double num10 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                        num7 = inHigh[index1] - num8 + (num10 - inLow[index1]);
                      }
                      else
                        num7 = 0.0;
                      num6 = num7;
                    }
                    num5 = num6;
                  }
                  num4 = num5;
                }
                double num11 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index1] - inOpen[index1]) > Core.Globals.candleSettings[0].factor * num4 / num11 && inOpen[index1] < inLow[index1 - 1] && (inClose[index1] < inOpen[index1 - 1] && inClose[index1] > inClose[index1 - 1] + Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) * 0.5))
                {
                  outInteger[index2] = 100;
                  ++index2;
                  goto label_63;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_63:
            for (int index3 = 1; index3 >= 0; --index3)
            {
              double num3;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num3 = Math.Abs(inClose[index1 - index3] - inOpen[index1 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[index1 - index3] - inLow[index1 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[index1 - index3] < inOpen[index1 - index3] ? inOpen[index1 - index3] : inClose[index1 - index3];
                    double num7 = inClose[index1 - index3] < inOpen[index1 - index3] ? inClose[index1 - index3] : inOpen[index1 - index3];
                    num5 = inHigh[index1 - index3] - num6 + (num7 - inLow[index1 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num3 = num4;
              }
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num8 = Math.Abs(inClose[num2 - index3] - inOpen[num2 - index3]);
              }
              else
              {
                double num4;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num4 = inHigh[num2 - index3] - inLow[num2 - index3];
                }
                else
                {
                  double num5;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num6 = inClose[num2 - index3] < inOpen[num2 - index3] ? inOpen[num2 - index3] : inClose[num2 - index3];
                    double num7 = inClose[num2 - index3] < inOpen[num2 - index3] ? inClose[num2 - index3] : inOpen[num2 - index3];
                    num5 = inHigh[num2 - index3] - num6 + (num7 - inLow[num2 - index3]);
                  }
                  else
                    num5 = 0.0;
                  num4 = num5;
                }
                num8 = num4;
              }
              numArray[index3] = numArray[index3] + (num3 - num8);
            }
            ++index1;
            ++num2;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlRickshawManLookback()
    {
      return (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[3].avgPeriod);
    }

    public static Core.RetCode CdlRickshawMan(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlRickshawManLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += (double) num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += (double) num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            float num5;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += (double) num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = (double) num6;
            }
            double num11 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index5] - inOpen[index5]) <= Core.Globals.candleSettings[3].factor * num5 / num11)
            {
              float num6 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                      float num13 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num13 - (double) inLow[index5]));
                    }
                    else
                      num10 = 0.0f;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = (double) num8;
              }
              double num14 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) num6 - (double) inLow[index5] > Core.Globals.candleSettings[4].factor * num7 / num14)
              {
                float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                {
                  num9 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    float num12;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      float num13;
                      if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                      {
                        float num15 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                        float num16 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = (float) ((double) inHigh[index5] - (double) num15 + ((double) num16 - (double) inLow[index5]));
                      }
                      else
                        num13 = 0.0f;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = (double) num10;
                }
                double num17 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inHigh[index5] - (double) num8 > Core.Globals.candleSettings[4].factor * num9 / num17)
                {
                  float num10 = (double) inOpen[index5] >= (double) inClose[index5] ? inClose[index5] : inOpen[index5];
                  double num12;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num12 = num4 / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    float num13;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num13 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      float num15;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num15 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        float num16;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          float num18 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                          float num19 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num16 = (float) ((double) inHigh[index5] - (double) num18 + ((double) num19 - (double) inLow[index5]));
                        }
                        else
                          num16 = 0.0f;
                        num15 = num16;
                      }
                      num13 = num15;
                    }
                    num12 = (double) num13;
                  }
                  double num20 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) num10 <= (double) inLow[index5] + ((double) inHigh[index5] - (double) inLow[index5]) / 2.0 + Core.Globals.candleSettings[8].factor * num12 / num20)
                  {
                    float num13 = (double) inOpen[index5] <= (double) inClose[index5] ? inClose[index5] : inOpen[index5];
                    double num15;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num15 = num4 / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      float num16;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num16 = Math.Abs(inClose[index5] - inOpen[index5]);
                      }
                      else
                      {
                        float num18;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num18 = inHigh[index5] - inLow[index5];
                        }
                        else
                        {
                          float num19;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            float num21 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                            float num22 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                            num19 = (float) ((double) inHigh[index5] - (double) num21 + ((double) num22 - (double) inLow[index5]));
                          }
                          else
                            num19 = 0.0f;
                          num18 = num19;
                        }
                        num16 = num18;
                      }
                      num15 = (double) num16;
                    }
                    double num23 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) num13 >= (double) inLow[index5] + ((double) inHigh[index5] - (double) inLow[index5]) / 2.0 - Core.Globals.candleSettings[8].factor * num15 / num23)
                    {
                      outInteger[index6] = 100;
                      ++index6;
                      goto label_116;
                    }
                  }
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_116:
            float num24;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num24 = num6;
            }
            float num25;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num25 = num6;
            }
            num2 += (double) num24 - (double) num25;
            float num26;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num26 = num6;
            }
            float num27;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num27 = num6;
            }
            num3 += (double) num26 - (double) num27;
            float num28;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num28 = num6;
            }
            float num29;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num29 = num6;
            }
            num4 += (double) num28 - (double) num29;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlRickshawMan(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlRickshawManLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            double num5;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = num6;
            }
            double num11 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index5] - inOpen[index5]) <= Core.Globals.candleSettings[3].factor * num5 / num11)
            {
              double num6 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                      double num13 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = inHigh[index5] - num12 + (num13 - inLow[index5]);
                    }
                    else
                      num10 = 0.0;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = num8;
              }
              double num14 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (num6 - inLow[index5] > Core.Globals.candleSettings[4].factor * num7 / num14)
              {
                double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
                {
                  num9 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    double num12;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      double num13;
                      if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                      {
                        double num15 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                        double num16 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = inHigh[index5] - num15 + (num16 - inLow[index5]);
                      }
                      else
                        num13 = 0.0;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = num10;
                }
                double num17 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inHigh[index5] - num8 > Core.Globals.candleSettings[4].factor * num9 / num17)
                {
                  double num10 = inOpen[index5] >= inClose[index5] ? inClose[index5] : inOpen[index5];
                  double num12;
                  if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                  {
                    num12 = num4 / (double) Core.Globals.candleSettings[8].avgPeriod;
                  }
                  else
                  {
                    double num13;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                    {
                      num13 = Math.Abs(inClose[index5] - inOpen[index5]);
                    }
                    else
                    {
                      double num15;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                      {
                        num15 = inHigh[index5] - inLow[index5];
                      }
                      else
                      {
                        double num16;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                        {
                          double num18 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                          double num19 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                          num16 = inHigh[index5] - num18 + (num19 - inLow[index5]);
                        }
                        else
                          num16 = 0.0;
                        num15 = num16;
                      }
                      num13 = num15;
                    }
                    num12 = num13;
                  }
                  double num20 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (num10 <= inLow[index5] + (inHigh[index5] - inLow[index5]) / 2.0 + Core.Globals.candleSettings[8].factor * num12 / num20)
                  {
                    double num13 = inOpen[index5] <= inClose[index5] ? inClose[index5] : inOpen[index5];
                    double num15;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num15 = num4 / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      double num16;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num16 = Math.Abs(inClose[index5] - inOpen[index5]);
                      }
                      else
                      {
                        double num18;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num18 = inHigh[index5] - inLow[index5];
                        }
                        else
                        {
                          double num19;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            double num21 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                            double num22 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                            num19 = inHigh[index5] - num21 + (num22 - inLow[index5]);
                          }
                          else
                            num19 = 0.0;
                          num18 = num19;
                        }
                        num16 = num18;
                      }
                      num15 = num16;
                    }
                    double num23 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (num13 >= inLow[index5] + (inHigh[index5] - inLow[index5]) / 2.0 - Core.Globals.candleSettings[8].factor * num15 / num23)
                    {
                      outInteger[index6] = 100;
                      ++index6;
                      goto label_116;
                    }
                  }
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_116:
            double num24;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num24 = num6;
            }
            double num25;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num25 = num6;
            }
            num2 += num24 - num25;
            double num26;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num26 = num6;
            }
            double num27;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num27 = num6;
            }
            num3 += num26 - num27;
            double num28;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num28 = num6;
            }
            double num29;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num29 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num29 = num6;
            }
            num4 += num28 - num29;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlRiseFall3MethodsLookback()
    {
      return (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 4;
    }

    public static Core.RetCode CdlRiseFall3Methods(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[5];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlRiseFall3MethodsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[4] = 0.0;
          numArray[3] = 0.0;
          numArray[2] = 0.0;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index2 = num2; index2 < startIdx; ++index2)
          {
            float num3;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2 - 3] - inOpen[index2 - 3]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 3] - inLow[index2 - 3];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2 - 3] < (double) inOpen[index2 - 3] ? inOpen[index2 - 3] : inClose[index2 - 3];
                  float num7 = (double) inClose[index2 - 3] < (double) inOpen[index2 - 3] ? inClose[index2 - 3] : inOpen[index2 - 3];
                  num5 = (float) ((double) inHigh[index2 - 3] - (double) num6 + ((double) num7 - (double) inLow[index2 - 3]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[3] = numArray[3] + (double) num3;
            float num8;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num7 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num5 = (float) ((double) inHigh[index2 - 2] - (double) num6 + ((double) num7 - (double) inLow[index2 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[2] = numArray[2] + (double) num8;
            float num9;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num7 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num5 = (float) ((double) inHigh[index2 - 1] - (double) num6 + ((double) num7 - (double) inLow[index2 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num9 = num4;
            }
            numArray[1] = numArray[1] + (double) num9;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            float num3;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2 - 4] - inOpen[index2 - 4]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 4] - inLow[index2 - 4];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2 - 4] < (double) inOpen[index2 - 4] ? inOpen[index2 - 4] : inClose[index2 - 4];
                  float num7 = (double) inClose[index2 - 4] < (double) inOpen[index2 - 4] ? inClose[index2 - 4] : inOpen[index2 - 4];
                  num5 = (float) ((double) inHigh[index2 - 4] - (double) num6 + ((double) num7 - (double) inLow[index2 - 4]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[4] = numArray[4] + (double) num3;
            float num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[0] = numArray[0] + (double) num8;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num3 = numArray[4] / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index3 - 4] - inOpen[index3 - 4]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index3 - 4] - inLow[index3 - 4];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? inOpen[index3 - 4] : inClose[index3 - 4];
                    float num8 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? inClose[index3 - 4] : inOpen[index3 - 4];
                    num6 = (float) ((double) inHigh[index3 - 4] - (double) num7 + ((double) num8 - (double) inLow[index3 - 4]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = (double) num4;
            }
            double num9 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index3 - 4] - inOpen[index3 - 4]) > Core.Globals.candleSettings[0].factor * num3 / num9)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num4 = numArray[3] / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index3 - 3] - inOpen[index3 - 3]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index3 - 3] - inLow[index3 - 3];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index3 - 3] < (double) inOpen[index3 - 3] ? inOpen[index3 - 3] : inClose[index3 - 3];
                      float num10 = (double) inClose[index3 - 3] < (double) inOpen[index3 - 3] ? inClose[index3 - 3] : inOpen[index3 - 3];
                      num7 = (float) ((double) inHigh[index3 - 3] - (double) num8 + ((double) num10 - (double) inLow[index3 - 3]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num11 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index3 - 3] - inOpen[index3 - 3]) < Core.Globals.candleSettings[2].factor * num4 / num11)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num5 = numArray[2] / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index3 - 2] - inLow[index3 - 2];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                        float num12 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                        num8 = (float) ((double) inHigh[index3 - 2] - (double) num10 + ((double) num12 - (double) inLow[index3 - 2]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) < Core.Globals.candleSettings[2].factor * num5 / num13)
                {
                  double num6;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num6 = numArray[1] / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num7 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num8 = inHigh[index3 - 1] - inLow[index3 - 1];
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          float num12 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                          float num14 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                          num10 = (float) ((double) inHigh[index3 - 1] - (double) num12 + ((double) num14 - (double) inLow[index3 - 1]));
                        }
                        else
                          num10 = 0.0f;
                        num8 = num10;
                      }
                      num7 = num8;
                    }
                    num6 = (double) num7;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) < Core.Globals.candleSettings[2].factor * num6 / num15)
                  {
                    double num7;
                    if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                    {
                      num7 = numArray[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                      {
                        num8 = Math.Abs(inClose[index3] - inOpen[index3]);
                      }
                      else
                      {
                        float num10;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                        {
                          num10 = inHigh[index3] - inLow[index3];
                        }
                        else
                        {
                          float num12;
                          if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                          {
                            float num14 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                            float num16 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                            num12 = (float) ((double) inHigh[index3] - (double) num14 + ((double) num16 - (double) inLow[index3]));
                          }
                          else
                            num12 = 0.0f;
                          num10 = num12;
                        }
                        num8 = num10;
                      }
                      num7 = (double) num8;
                    }
                    double num17 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) Math.Abs(inClose[index3] - inOpen[index3]) > Core.Globals.candleSettings[0].factor * num7 / num17 && ((double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1) == -((double) inClose[index3 - 3] < (double) inOpen[index3 - 3] ? -1 : 1) && (((double) inClose[index3 - 3] < (double) inOpen[index3 - 3] ? -1 : 1) == ((double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? -1 : 1) && ((double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? -1 : 1) == ((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1)) && (((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1) == -((double) inClose[index3] < (double) inOpen[index3] ? -1 : 1) && ((double) inOpen[index3 - 3] >= (double) inClose[index3 - 3] ? (double) inClose[index3 - 3] : (double) inOpen[index3 - 3]) < (double) inHigh[index3 - 4] && (((double) inOpen[index3 - 3] <= (double) inClose[index3 - 3] ? (double) inClose[index3 - 3] : (double) inOpen[index3 - 3]) > (double) inLow[index3 - 4] && ((double) inOpen[index3 - 2] >= (double) inClose[index3 - 2] ? (double) inClose[index3 - 2] : (double) inOpen[index3 - 2]) < (double) inHigh[index3 - 4]) && (((double) inOpen[index3 - 2] <= (double) inClose[index3 - 2] ? (double) inClose[index3 - 2] : (double) inOpen[index3 - 2]) > (double) inLow[index3 - 4] && ((double) inOpen[index3 - 1] >= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]) < (double) inHigh[index3 - 4] && ((double) inOpen[index3 - 1] <= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]) > (double) inLow[index3 - 4])))
                    {
                      int num8 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                      int num10 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                      if ((double) inClose[index3 - 2] * (double) num8 < (double) inClose[index3 - 3] * (double) num10)
                      {
                        int num12 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                        int num14 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                        if ((double) inClose[index3 - 1] * (double) num12 < (double) inClose[index3 - 2] * (double) num14)
                        {
                          int num16 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                          int num18 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                          if ((double) inOpen[index3] * (double) num16 > (double) inClose[index3 - 1] * (double) num18)
                          {
                            int num19 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                            int num20 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                            if ((double) inClose[index3] * (double) num19 > (double) inClose[index3 - 4] * (double) num20)
                            {
                              int num21 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? -1 : 1;
                              outInteger[index4] = num21 * 100;
                              ++index4;
                              goto label_135;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_135:
            float num22;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index3 - 4] - inOpen[index3 - 4]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index3 - 4] - inLow[index3 - 4];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? inOpen[index3 - 4] : inClose[index3 - 4];
                  float num7 = (double) inClose[index3 - 4] < (double) inOpen[index3 - 4] ? inClose[index3 - 4] : inOpen[index3 - 4];
                  num5 = (float) ((double) inHigh[index3 - 4] - (double) num6 + ((double) num7 - (double) inLow[index3 - 4]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num22 = num4;
            }
            float num23;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 4] - inLow[index1 - 4];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                  float num7 = (double) inClose[index1 - 4] < (double) inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                  num5 = (float) ((double) inHigh[index1 - 4] - (double) num6 + ((double) num7 - (double) inLow[index1 - 4]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num23 = num4;
            }
            numArray[4] = numArray[4] + ((double) num22 - (double) num23);
            for (int index2 = 3; index2 >= 1; --index2)
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num8 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num6 = (float) ((double) inHigh[index3 - index2] - (double) num7 + ((double) num8 - (double) inLow[index3 - index2]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              float num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[num2 - index2] - inOpen[num2 - index2]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index2] - inLow[num2 - index2];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[num2 - index2] < (double) inOpen[num2 - index2] ? inOpen[num2 - index2] : inClose[num2 - index2];
                    float num8 = (double) inClose[num2 - index2] < (double) inOpen[num2 - index2] ? inClose[num2 - index2] : inOpen[num2 - index2];
                    num6 = (float) ((double) inHigh[num2 - index2] - (double) num7 + ((double) num8 - (double) inLow[num2 - index2]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num10 = num5;
              }
              numArray[index2] = numArray[index2] + ((double) num4 - (double) num10);
            }
            float num24;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num5 = (float) ((double) inHigh[index3] - (double) num6 + ((double) num7 - (double) inLow[index3]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num24 = num4;
            }
            float num25;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = (float) ((double) inHigh[index1] - (double) num6 + ((double) num7 - (double) inLow[index1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num25 = num4;
            }
            numArray[0] = numArray[0] + ((double) num24 - (double) num25);
            ++index3;
            ++num2;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlRiseFall3Methods(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray = new double[5];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlRiseFall3MethodsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray[4] = 0.0;
          numArray[3] = 0.0;
          numArray[2] = 0.0;
          numArray[1] = 0.0;
          numArray[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          int index1 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index2 = num2; index2 < startIdx; ++index2)
          {
            double num3;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2 - 3] - inOpen[index2 - 3]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 3] - inLow[index2 - 3];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2 - 3] < inOpen[index2 - 3] ? inOpen[index2 - 3] : inClose[index2 - 3];
                  double num7 = inClose[index2 - 3] < inOpen[index2 - 3] ? inClose[index2 - 3] : inOpen[index2 - 3];
                  num5 = inHigh[index2 - 3] - num6 + (num7 - inLow[index2 - 3]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[3] = numArray[3] + num3;
            double num8;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num7 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num5 = inHigh[index2 - 2] - num6 + (num7 - inLow[index2 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[2] = numArray[2] + num8;
            double num9;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num9 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num7 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num5 = inHigh[index2 - 1] - num6 + (num7 - inLow[index2 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num9 = num4;
            }
            numArray[1] = numArray[1] + num9;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            double num3;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2 - 4] - inOpen[index2 - 4]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2 - 4] - inLow[index2 - 4];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2 - 4] < inOpen[index2 - 4] ? inOpen[index2 - 4] : inClose[index2 - 4];
                  double num7 = inClose[index2 - 4] < inOpen[index2 - 4] ? inClose[index2 - 4] : inOpen[index2 - 4];
                  num5 = inHigh[index2 - 4] - num6 + (num7 - inLow[index2 - 4]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            numArray[4] = numArray[4] + num3;
            double num8;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num8 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num8 = num4;
            }
            numArray[0] = numArray[0] + num8;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num3 = numArray[4] / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index3 - 4] - inOpen[index3 - 4]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index3 - 4] - inLow[index3 - 4];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index3 - 4] < inOpen[index3 - 4] ? inOpen[index3 - 4] : inClose[index3 - 4];
                    double num8 = inClose[index3 - 4] < inOpen[index3 - 4] ? inClose[index3 - 4] : inOpen[index3 - 4];
                    num6 = inHigh[index3 - 4] - num7 + (num8 - inLow[index3 - 4]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = num4;
            }
            double num9 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index3 - 4] - inOpen[index3 - 4]) > Core.Globals.candleSettings[0].factor * num3 / num9)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num4 = numArray[3] / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index3 - 3] - inOpen[index3 - 3]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index3 - 3] - inLow[index3 - 3];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index3 - 3] < inOpen[index3 - 3] ? inOpen[index3 - 3] : inClose[index3 - 3];
                      double num10 = inClose[index3 - 3] < inOpen[index3 - 3] ? inClose[index3 - 3] : inOpen[index3 - 3];
                      num7 = inHigh[index3 - 3] - num8 + (num10 - inLow[index3 - 3]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num11 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index3 - 3] - inOpen[index3 - 3]) < Core.Globals.candleSettings[2].factor * num4 / num11)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num5 = numArray[2] / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index3 - 2] - inLow[index3 - 2];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                        double num12 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                        num8 = inHigh[index3 - 2] - num10 + (num12 - inLow[index3 - 2]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num13 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) < Core.Globals.candleSettings[2].factor * num5 / num13)
                {
                  double num6;
                  if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                  {
                    num6 = numArray[1] / (double) Core.Globals.candleSettings[2].avgPeriod;
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                    {
                      num7 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                      {
                        num8 = inHigh[index3 - 1] - inLow[index3 - 1];
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                        {
                          double num12 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                          double num14 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                          num10 = inHigh[index3 - 1] - num12 + (num14 - inLow[index3 - 1]);
                        }
                        else
                          num10 = 0.0;
                        num8 = num10;
                      }
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  double num15 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) < Core.Globals.candleSettings[2].factor * num6 / num15)
                  {
                    double num7;
                    if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                    {
                      num7 = numArray[0] / (double) Core.Globals.candleSettings[0].avgPeriod;
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                      {
                        num8 = Math.Abs(inClose[index3] - inOpen[index3]);
                      }
                      else
                      {
                        double num10;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                        {
                          num10 = inHigh[index3] - inLow[index3];
                        }
                        else
                        {
                          double num12;
                          if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                          {
                            double num14 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                            double num16 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                            num12 = inHigh[index3] - num14 + (num16 - inLow[index3]);
                          }
                          else
                            num12 = 0.0;
                          num10 = num12;
                        }
                        num8 = num10;
                      }
                      num7 = num8;
                    }
                    double num17 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (Math.Abs(inClose[index3] - inOpen[index3]) > Core.Globals.candleSettings[0].factor * num7 / num17 && (inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1) == -(inClose[index3 - 3] < inOpen[index3 - 3] ? -1 : 1) && ((inClose[index3 - 3] < inOpen[index3 - 3] ? -1 : 1) == (inClose[index3 - 2] < inOpen[index3 - 2] ? -1 : 1) && (inClose[index3 - 2] < inOpen[index3 - 2] ? -1 : 1) == (inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1)) && ((inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1) == -(inClose[index3] < inOpen[index3] ? -1 : 1) && (inOpen[index3 - 3] >= inClose[index3 - 3] ? inClose[index3 - 3] : inOpen[index3 - 3]) < inHigh[index3 - 4] && ((inOpen[index3 - 3] <= inClose[index3 - 3] ? inClose[index3 - 3] : inOpen[index3 - 3]) > inLow[index3 - 4] && (inOpen[index3 - 2] >= inClose[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2]) < inHigh[index3 - 4]) && ((inOpen[index3 - 2] <= inClose[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2]) > inLow[index3 - 4] && (inOpen[index3 - 1] >= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]) < inHigh[index3 - 4] && (inOpen[index3 - 1] <= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]) > inLow[index3 - 4])))
                    {
                      int num8 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                      int num10 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                      if (inClose[index3 - 2] * (double) num8 < inClose[index3 - 3] * (double) num10)
                      {
                        int num12 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                        int num14 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                        if (inClose[index3 - 1] * (double) num12 < inClose[index3 - 2] * (double) num14)
                        {
                          int num16 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                          int num18 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                          if (inOpen[index3] * (double) num16 > inClose[index3 - 1] * (double) num18)
                          {
                            int num19 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                            int num20 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                            if (inClose[index3] * (double) num19 > inClose[index3 - 4] * (double) num20)
                            {
                              int num21 = inClose[index3 - 4] < inOpen[index3 - 4] ? -1 : 1;
                              outInteger[index4] = num21 * 100;
                              ++index4;
                              goto label_135;
                            }
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_135:
            double num22;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index3 - 4] - inOpen[index3 - 4]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index3 - 4] - inLow[index3 - 4];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index3 - 4] < inOpen[index3 - 4] ? inOpen[index3 - 4] : inClose[index3 - 4];
                  double num7 = inClose[index3 - 4] < inOpen[index3 - 4] ? inClose[index3 - 4] : inOpen[index3 - 4];
                  num5 = inHigh[index3 - 4] - num6 + (num7 - inLow[index3 - 4]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num22 = num4;
            }
            double num23;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index1 - 4] - inOpen[index1 - 4]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 4] - inLow[index1 - 4];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1 - 4] < inOpen[index1 - 4] ? inOpen[index1 - 4] : inClose[index1 - 4];
                  double num7 = inClose[index1 - 4] < inOpen[index1 - 4] ? inClose[index1 - 4] : inOpen[index1 - 4];
                  num5 = inHigh[index1 - 4] - num6 + (num7 - inLow[index1 - 4]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num23 = num4;
            }
            numArray[4] = numArray[4] + (num22 - num23);
            for (int index2 = 3; index2 >= 1; --index2)
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num8 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num6 = inHigh[index3 - index2] - num7 + (num8 - inLow[index3 - index2]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num10 = Math.Abs(inClose[num2 - index2] - inOpen[num2 - index2]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[num2 - index2] - inLow[num2 - index2];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[num2 - index2] < inOpen[num2 - index2] ? inOpen[num2 - index2] : inClose[num2 - index2];
                    double num8 = inClose[num2 - index2] < inOpen[num2 - index2] ? inClose[num2 - index2] : inOpen[num2 - index2];
                    num6 = inHigh[num2 - index2] - num7 + (num8 - inLow[num2 - index2]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num10 = num5;
              }
              numArray[index2] = numArray[index2] + (num4 - num10);
            }
            double num24;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num7 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num5 = inHigh[index3] - num6 + (num7 - inLow[index3]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num24 = num4;
            }
            double num25;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num7 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = inHigh[index1] - num6 + (num7 - inLow[index1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num25 = num4;
            }
            numArray[0] = numArray[0] + (num24 - num25);
            ++index3;
            ++num2;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlSeperatingLinesLookback()
    {
      return ((Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) <= Core.Globals.candleSettings[10].avgPeriod ? Core.Globals.candleSettings[10].avgPeriod : (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[7].avgPeriod)) + 1;
    }

    public static Core.RetCode CdlSeperatingLines(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlSeperatingLinesLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = (float) ((double) inHigh[index3] - (double) num9 + ((double) num10 - (double) inLow[index3]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            float num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = (float) ((double) inHigh[index3] - (double) num9 + ((double) num10 - (double) inLow[index3]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += (double) num6;
          }
          for (int index3 = num5; index3 < startIdx; ++index3)
          {
            float num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3 - 1] - inLow[index3 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  float num10 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  num8 = (float) ((double) inHigh[index3 - 1] - (double) num9 + ((double) num10 - (double) inLow[index3 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += (double) num6;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            if (((double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1) == -((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1))
            {
              double num6;
              if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[10].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4 - 1] - inLow[index4 - 1];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                    {
                      float num10 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                      float num11 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                      num9 = (float) ((double) inHigh[index4 - 1] - (double) num10 + ((double) num11 - (double) inLow[index4 - 1]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num12 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inOpen[index4] <= (double) inOpen[index4 - 1] + Core.Globals.candleSettings[10].factor * num6 / num12)
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num4 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        float num13 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num10 = (float) ((double) inHigh[index4 - 1] - (double) num11 + ((double) num13 - (double) inLow[index4 - 1]));
                      }
                      else
                        num10 = 0.0f;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = (double) num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inOpen[index4] >= (double) inOpen[index4 - 1] - Core.Globals.candleSettings[10].factor * num7 / num14)
                {
                  double num8;
                  if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                  {
                    num8 = num3 / (double) Core.Globals.candleSettings[0].avgPeriod;
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                      {
                        num10 = inHigh[index4] - inLow[index4];
                      }
                      else
                      {
                        float num11;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                        {
                          float num13 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                          float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                          num11 = (float) ((double) inHigh[index4] - (double) num13 + ((double) num15 - (double) inLow[index4]));
                        }
                        else
                          num11 = 0.0f;
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    num8 = (double) num9;
                  }
                  double num16 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num8 / num16)
                  {
                    if (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == 1)
                    {
                      float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      double num10;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num10 = num2 / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        float num11;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num11 = Math.Abs(inClose[index4] - inOpen[index4]);
                        }
                        else
                        {
                          float num13;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num13 = inHigh[index4] - inLow[index4];
                          }
                          else
                          {
                            float num15;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              float num17 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                              float num18 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                              num15 = (float) ((double) inHigh[index4] - (double) num17 + ((double) num18 - (double) inLow[index4]));
                            }
                            else
                              num15 = 0.0f;
                            num13 = num15;
                          }
                          num11 = num13;
                        }
                        num10 = (double) num11;
                      }
                      double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) num9 - (double) inLow[index4] < Core.Globals.candleSettings[7].factor * num10 / num19)
                        goto label_117;
                    }
                    if (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == -1)
                    {
                      float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num10;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num10 = num2 / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        float num11;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num11 = Math.Abs(inClose[index4] - inOpen[index4]);
                        }
                        else
                        {
                          float num13;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num13 = inHigh[index4] - inLow[index4];
                          }
                          else
                          {
                            float num15;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              float num17 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                              float num18 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                              num15 = (float) ((double) inHigh[index4] - (double) num17 + ((double) num18 - (double) inLow[index4]));
                            }
                            else
                              num15 = 0.0f;
                            num13 = num15;
                          }
                          num11 = num13;
                        }
                        num10 = (double) num11;
                      }
                      double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) inHigh[index4] - (double) num9 >= Core.Globals.candleSettings[7].factor * num10 / num19)
                        goto label_118;
                    }
                    else
                      goto label_118;
label_117:
                    int num20 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
                    outInteger[index5] = num20 * 100;
                    ++index5;
                    goto label_119;
                  }
                }
              }
            }
label_118:
            outInteger[index5] = 0;
            ++index5;
label_119:
            float num21;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num21 = num6;
            }
            float num22;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num22 = num6;
            }
            num2 += (double) num21 - (double) num22;
            float num23;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num23 = num6;
            }
            float num24;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num24 = num6;
            }
            num3 += (double) num23 - (double) num24;
            float num25;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num7 = (float) ((double) inHigh[index4 - 1] - (double) num8 + ((double) num9 - (double) inLow[index4 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num25 = num6;
            }
            float num26;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  float num9 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = (float) ((double) inHigh[num5 - 1] - (double) num8 + ((double) num9 - (double) inLow[num5 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num26 = num6;
            }
            num4 += (double) num25 - (double) num26;
            ++index4;
            ++index1;
            ++index2;
            ++num5;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlSeperatingLines(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlSeperatingLinesLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num6;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num10 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = inHigh[index3] - num9 + (num10 - inLow[index3]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            double num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num10 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = inHigh[index3] - num9 + (num10 - inLow[index3]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num3 += num6;
          }
          for (int index3 = num5; index3 < startIdx; ++index3)
          {
            double num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3 - 1] - inLow[index3 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  double num10 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  num8 = inHigh[index3 - 1] - num9 + (num10 - inLow[index3 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += num6;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            if ((inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1) == -(inClose[index4] < inOpen[index4] ? -1 : 1))
            {
              double num6;
              if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[10].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4 - 1] - inLow[index4 - 1];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                    {
                      double num10 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                      double num11 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                      num9 = inHigh[index4 - 1] - num10 + (num11 - inLow[index4 - 1]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num12 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inOpen[index4] <= inOpen[index4 - 1] + Core.Globals.candleSettings[10].factor * num6 / num12)
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num4 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        double num13 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num10 = inHigh[index4 - 1] - num11 + (num13 - inLow[index4 - 1]);
                      }
                      else
                        num10 = 0.0;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inOpen[index4] >= inOpen[index4 - 1] - Core.Globals.candleSettings[10].factor * num7 / num14)
                {
                  double num8;
                  if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                  {
                    num8 = num3 / (double) Core.Globals.candleSettings[0].avgPeriod;
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                    {
                      num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                      {
                        num10 = inHigh[index4] - inLow[index4];
                      }
                      else
                      {
                        double num11;
                        if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                        {
                          double num13 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                          double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                          num11 = inHigh[index4] - num13 + (num15 - inLow[index4]);
                        }
                        else
                          num11 = 0.0;
                        num10 = num11;
                      }
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  double num16 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (Math.Abs(inClose[index4] - inOpen[index4]) > Core.Globals.candleSettings[0].factor * num8 / num16)
                  {
                    if ((inClose[index4] < inOpen[index4] ? -1 : 1) == 1)
                    {
                      double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      double num10;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num10 = num2 / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        double num11;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num11 = Math.Abs(inClose[index4] - inOpen[index4]);
                        }
                        else
                        {
                          double num13;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num13 = inHigh[index4] - inLow[index4];
                          }
                          else
                          {
                            double num15;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              double num17 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                              double num18 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                              num15 = inHigh[index4] - num17 + (num18 - inLow[index4]);
                            }
                            else
                              num15 = 0.0;
                            num13 = num15;
                          }
                          num11 = num13;
                        }
                        num10 = num11;
                      }
                      double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (num9 - inLow[index4] < Core.Globals.candleSettings[7].factor * num10 / num19)
                        goto label_117;
                    }
                    if ((inClose[index4] < inOpen[index4] ? -1 : 1) == -1)
                    {
                      double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num10;
                      if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                      {
                        num10 = num2 / (double) Core.Globals.candleSettings[7].avgPeriod;
                      }
                      else
                      {
                        double num11;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                        {
                          num11 = Math.Abs(inClose[index4] - inOpen[index4]);
                        }
                        else
                        {
                          double num13;
                          if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                          {
                            num13 = inHigh[index4] - inLow[index4];
                          }
                          else
                          {
                            double num15;
                            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                            {
                              double num17 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                              double num18 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                              num15 = inHigh[index4] - num17 + (num18 - inLow[index4]);
                            }
                            else
                              num15 = 0.0;
                            num13 = num15;
                          }
                          num11 = num13;
                        }
                        num10 = num11;
                      }
                      double num19 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (inHigh[index4] - num9 >= Core.Globals.candleSettings[7].factor * num10 / num19)
                        goto label_118;
                    }
                    else
                      goto label_118;
label_117:
                    int num20 = inClose[index4] < inOpen[index4] ? -1 : 1;
                    outInteger[index5] = num20 * 100;
                    ++index5;
                    goto label_119;
                  }
                }
              }
            }
label_118:
            outInteger[index5] = 0;
            ++index5;
label_119:
            double num21;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num21 = num6;
            }
            double num22;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num22 = num6;
            }
            num2 += num21 - num22;
            double num23;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num23 = num6;
            }
            double num24;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num24 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num24 = num6;
            }
            num3 += num23 - num24;
            double num25;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num7 = inHigh[index4 - 1] - num8 + (num9 - inLow[index4 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num25 = num6;
            }
            double num26;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num5 - 1] < inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  double num9 = inClose[num5 - 1] < inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = inHigh[num5 - 1] - num8 + (num9 - inLow[num5 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num26 = num6;
            }
            num4 += num25 - num26;
            ++index4;
            ++index1;
            ++index2;
            ++num5;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlShootingStarLookback()
    {
      return ((Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[4].avgPeriod ? Core.Globals.candleSettings[4].avgPeriod : Core.Globals.candleSettings[2].avgPeriod)) + 1;
    }

    public static Core.RetCode CdlShootingStar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlShootingStarLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += (double) num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += (double) num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            float num5;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += (double) num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = (double) num6;
            }
            double num11 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index5] - inOpen[index5]) < Core.Globals.candleSettings[2].factor * num5 / num11)
            {
              float num6 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                      float num13 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num13 - (double) inLow[index5]));
                    }
                    else
                      num10 = 0.0f;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = (double) num8;
              }
              double num14 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index5] - (double) num6 > Core.Globals.candleSettings[4].factor * num7 / num14)
              {
                float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num9 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    float num12;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      float num13;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        float num15 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                        float num16 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = (float) ((double) inHigh[index5] - (double) num15 + ((double) num16 - (double) inLow[index5]));
                      }
                      else
                        num13 = 0.0f;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = (double) num10;
                }
                double num17 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num8 - (double) inLow[index5] < Core.Globals.candleSettings[7].factor * num9 / num17 && ((double) inOpen[index5] >= (double) inClose[index5] ? (double) inClose[index5] : (double) inOpen[index5]) > ((double) inOpen[index5 - 1] <= (double) inClose[index5 - 1] ? (double) inClose[index5 - 1] : (double) inOpen[index5 - 1]))
                {
                  outInteger[index6] = -100;
                  ++index6;
                  goto label_90;
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_90:
            float num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num18 = num6;
            }
            float num19;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num19 = num6;
            }
            num2 += (double) num18 - (double) num19;
            float num20;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num20 = num6;
            }
            float num21;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num21 = num6;
            }
            num3 += (double) num20 - (double) num21;
            float num22;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num22 = num6;
            }
            float num23;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num23 = num6;
            }
            num4 += (double) num22 - (double) num23;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlShootingStar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlShootingStarLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[4].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            double num5;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = num6;
            }
            double num11 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index5] - inOpen[index5]) < Core.Globals.candleSettings[2].factor * num5 / num11)
            {
              double num6 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[4].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[4].avgPeriod;
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                    {
                      double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                      double num13 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = inHigh[index5] - num12 + (num13 - inLow[index5]);
                    }
                    else
                      num10 = 0.0;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = num8;
              }
              double num14 = Core.Globals.candleSettings[4].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index5] - num6 > Core.Globals.candleSettings[4].factor * num7 / num14)
              {
                double num8 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                {
                  num9 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    double num12;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      double num13;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                      {
                        double num15 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                        double num16 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = inHigh[index5] - num15 + (num16 - inLow[index5]);
                      }
                      else
                        num13 = 0.0;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = num10;
                }
                double num17 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num8 - inLow[index5] < Core.Globals.candleSettings[7].factor * num9 / num17 && (inOpen[index5] >= inClose[index5] ? inClose[index5] : inOpen[index5]) > (inOpen[index5 - 1] <= inClose[index5 - 1] ? inClose[index5 - 1] : inOpen[index5 - 1]))
                {
                  outInteger[index6] = -100;
                  ++index6;
                  goto label_90;
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_90:
            double num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num18 = num6;
            }
            double num19;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num19 = num6;
            }
            num2 += num18 - num19;
            double num20;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num20 = num6;
            }
            double num21;
            if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[4].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num21 = num6;
            }
            num3 += num20 - num21;
            double num22;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num22 = num6;
            }
            double num23;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num23 = num6;
            }
            num4 += num22 - num23;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlShortLineLookback()
    {
      return Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[6].avgPeriod ? Core.Globals.candleSettings[6].avgPeriod : Core.Globals.candleSettings[2].avgPeriod;
    }

    public static Core.RetCode CdlShortLine(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlShortLineLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[6].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            float num4;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                    float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4] - inOpen[index4]) < Core.Globals.candleSettings[2].factor * num4 / num10)
            {
              float num5 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num12 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = (float) ((double) inHigh[index4] - (double) num11 + ((double) num12 - (double) inLow[index4]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num13 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index4] - (double) num5 < Core.Globals.candleSettings[6].factor * num6 / num13)
              {
                float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                      {
                        float num14 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                        float num15 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = (float) ((double) inHigh[index4] - (double) num14 + ((double) num15 - (double) inLow[index4]));
                      }
                      else
                        num12 = 0.0f;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = (double) num9;
                }
                double num16 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num7 - (double) inLow[index4] < Core.Globals.candleSettings[6].factor * num8 / num16)
                {
                  int num9 = (double) inClose[index4] < (double) inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            float num17;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num17 = num5;
            }
            float num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += (double) num17 - (double) num18;
            float num19;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num19 = num5;
            }
            float num20;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += (double) num19 - (double) num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlShortLine(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlShortLineLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[6].avgPeriod;
          for (int index3 = index1; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index4;
          for (index4 = index2; index4 < startIdx; ++index4)
          {
            double num4;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4] - inOpen[index4]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4] - inLow[index4];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                    double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                    num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4] - inOpen[index4]) < Core.Globals.candleSettings[2].factor * num4 / num10)
            {
              double num5 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
              double num6;
              if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
              {
                num6 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num12 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num9 = inHigh[index4] - num11 + (num12 - inLow[index4]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num13 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index4] - num5 < Core.Globals.candleSettings[6].factor * num6 / num13)
              {
                double num7 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                double num8;
                if ((double) Core.Globals.candleSettings[6].avgPeriod != 0.0)
                {
                  num8 = num3 / (double) Core.Globals.candleSettings[6].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index4] - inOpen[index4]);
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
                    {
                      num11 = inHigh[index4] - inLow[index4];
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                      {
                        double num14 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                        double num15 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                        num12 = inHigh[index4] - num14 + (num15 - inLow[index4]);
                      }
                      else
                        num12 = 0.0;
                      num11 = num12;
                    }
                    num9 = num11;
                  }
                  num8 = num9;
                }
                double num16 = Core.Globals.candleSettings[6].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num7 - inLow[index4] < Core.Globals.candleSettings[6].factor * num8 / num16)
                {
                  int num9 = inClose[index4] < inOpen[index4] ? -1 : 1;
                  outInteger[index5] = num9 * 100;
                  ++index5;
                  goto label_78;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_78:
            double num17;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num17 = num5;
            }
            double num18;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num18 = num5;
            }
            num2 += num17 - num18;
            double num19;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num19 = num5;
            }
            double num20;
            if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[6].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num20 = num5;
            }
            num3 += num19 - num20;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlSpinningTopLookback()
    {
      return Core.Globals.candleSettings[2].avgPeriod;
    }

    public static Core.RetCode CdlSpinningTop(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlSpinningTopLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          int index2;
          for (index2 = index1; index2 < startIdx; ++index2)
          {
            float num3;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += (double) num3;
          }
          int index3 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num3 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                    float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = (double) num4;
            }
            double num9 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index2] - inOpen[index2]) < Core.Globals.candleSettings[2].factor * num3 / num9)
            {
              float num4 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
              if ((double) inHigh[index2] - (double) num4 > (double) Math.Abs(inClose[index2] - inOpen[index2]) && ((double) inClose[index2] < (double) inOpen[index2] ? (double) inClose[index2] : (double) inOpen[index2]) - (double) inLow[index2] > (double) Math.Abs(inClose[index2] - inOpen[index2]))
              {
                int num5 = (double) inClose[index2] < (double) inOpen[index2] ? -1 : 1;
                outInteger[index3] = num5 * 100;
                ++index3;
                goto label_41;
              }
            }
            outInteger[index3] = 0;
            ++index3;
label_41:
            float num10;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num10 = num4;
            }
            float num11;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = (float) ((double) inHigh[index1] - (double) num6 + ((double) num7 - (double) inLow[index1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num11 = num4;
            }
            num2 += (double) num10 - (double) num11;
            ++index2;
            ++index1;
          }
          while (index2 <= endIdx);
          outNBElement = index3;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlSpinningTop(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlSpinningTopLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          int index2;
          for (index2 = index1; index2 < startIdx; ++index2)
          {
            double num3;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += num3;
          }
          int index3 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
            {
              num3 = num2 / (double) Core.Globals.candleSettings[2].avgPeriod;
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index2] - inOpen[index2]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index2] - inLow[index2];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                    double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                    num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = num4;
            }
            double num9 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index2] - inOpen[index2]) < Core.Globals.candleSettings[2].factor * num3 / num9)
            {
              double num4 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
              if (inHigh[index2] - num4 > Math.Abs(inClose[index2] - inOpen[index2]) && (inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2]) - inLow[index2] > Math.Abs(inClose[index2] - inOpen[index2]))
              {
                int num5 = inClose[index2] < inOpen[index2] ? -1 : 1;
                outInteger[index3] = num5 * 100;
                ++index3;
                goto label_41;
              }
            }
            outInteger[index3] = 0;
            ++index3;
label_41:
            double num10;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num10 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num10 = num4;
            }
            double num11;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num11 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num7 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = inHigh[index1] - num6 + (num7 - inLow[index1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num11 = num4;
            }
            num2 += num10 - num11;
            ++index2;
            ++index1;
          }
          while (index2 <= endIdx);
          outNBElement = index3;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlStalledPatternLookback()
    {
      return ((Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : Core.Globals.candleSettings[0].avgPeriod) <= (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) ? (Core.Globals.candleSettings[7].avgPeriod <= Core.Globals.candleSettings[8].avgPeriod ? Core.Globals.candleSettings[8].avgPeriod : Core.Globals.candleSettings[7].avgPeriod) : (Core.Globals.candleSettings[0].avgPeriod <= Core.Globals.candleSettings[2].avgPeriod ? Core.Globals.candleSettings[2].avgPeriod : Core.Globals.candleSettings[0].avgPeriod)) + 2;
    }

    public static Core.RetCode CdlStalledPattern(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlStalledPatternLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[2] = 0.0;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num6 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index2 = num2; index2 < startIdx; ++index2)
          {
            float num7;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num11 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num9 = (float) ((double) inHigh[index2 - 2] - (double) num10 + ((double) num11 - (double) inLow[index2 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num7 = num8;
            }
            numArray1[2] = numArray1[2] + (double) num7;
            float num12;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num11 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num9 = (float) ((double) inHigh[index2 - 1] - (double) num10 + ((double) num11 - (double) inLow[index2 - 1]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num12 = num8;
            }
            numArray1[1] = numArray1[1] + (double) num12;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            float num7;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num11 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num9 = (float) ((double) inHigh[index2] - (double) num10 + ((double) num11 - (double) inLow[index2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num7 = num8;
            }
            num3 += (double) num7;
          }
          for (int index2 = num5; index2 < startIdx; ++index2)
          {
            float num7;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num11 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num9 = (float) ((double) inHigh[index2 - 1] - (double) num10 + ((double) num11 - (double) inLow[index2 - 1]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num7 = num8;
            }
            num4 += (double) num7;
          }
          for (int index2 = num6; index2 < startIdx; ++index2)
          {
            float num7;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  float num11 = (double) inClose[index2 - 2] < (double) inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num9 = (float) ((double) inHigh[index2 - 2] - (double) num10 + ((double) num11 - (double) inLow[index2 - 2]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num7 = num8;
            }
            numArray2[2] = numArray2[2] + (double) num7;
            float num12;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              float num8;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                float num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num10 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  float num11 = (double) inClose[index2 - 1] < (double) inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num9 = (float) ((double) inHigh[index2 - 1] - (double) num10 + ((double) num11 - (double) inLow[index2 - 1]));
                }
                else
                  num9 = 0.0f;
                num8 = num9;
              }
              num12 = num8;
            }
            numArray2[1] = numArray2[1] + (double) num12;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if (((double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? -1 : 1) == 1 && ((double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? -1 : 1) == 1 && (((double) inClose[index3] < (double) inOpen[index3] ? -1 : 1) == 1 && (double) inClose[index3] > (double) inClose[index3 - 1] && (double) inClose[index3 - 1] > (double) inClose[index3 - 2]))
            {
              double num7;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num7 = numArray1[2] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num11 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      float num12 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num10 = (float) ((double) inHigh[index3 - 2] - (double) num11 + ((double) num12 - (double) inLow[index3 - 2]));
                    }
                    else
                      num10 = 0.0f;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = (double) num8;
              }
              double num13 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) > Core.Globals.candleSettings[0].factor * num7 / num13)
              {
                double num8;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num8 = numArray1[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num10 = inHigh[index3 - 1] - inLow[index3 - 1];
                    }
                    else
                    {
                      float num11;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        float num12 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                        float num14 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                        num11 = (float) ((double) inHigh[index3 - 1] - (double) num12 + ((double) num14 - (double) inLow[index3 - 1]));
                      }
                      else
                        num11 = 0.0f;
                      num10 = num11;
                    }
                    num9 = num10;
                  }
                  num8 = (double) num9;
                }
                double num15 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) > Core.Globals.candleSettings[0].factor * num8 / num15)
                {
                  float num9 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  double num10;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num10 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    float num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num11 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num12 = inHigh[index3 - 1] - inLow[index3 - 1];
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          float num16 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                          float num17 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                          num14 = (float) ((double) inHigh[index3 - 1] - (double) num16 + ((double) num17 - (double) inLow[index3 - 1]));
                        }
                        else
                          num14 = 0.0f;
                        num12 = num14;
                      }
                      num11 = num12;
                    }
                    num10 = (double) num11;
                  }
                  double num18 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if ((double) inHigh[index3 - 1] - (double) num9 < Core.Globals.candleSettings[7].factor * num10 / num18 && (double) inOpen[index3 - 1] > (double) inOpen[index3 - 2])
                  {
                    double num11;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num11 = numArray2[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      float num12;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num14 = inHigh[index3 - 2] - inLow[index3 - 2];
                        }
                        else
                        {
                          float num16;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            float num17 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                            float num19 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                            num16 = (float) ((double) inHigh[index3 - 2] - (double) num17 + ((double) num19 - (double) inLow[index3 - 2]));
                          }
                          else
                            num16 = 0.0f;
                          num14 = num16;
                        }
                        num12 = num14;
                      }
                      num11 = (double) num12;
                    }
                    double num20 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if ((double) inOpen[index3 - 1] <= (double) inClose[index3 - 2] + Core.Globals.candleSettings[8].factor * num11 / num20)
                    {
                      double num12;
                      if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                      {
                        num12 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                      }
                      else
                      {
                        float num14;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                        {
                          num14 = Math.Abs(inClose[index3] - inOpen[index3]);
                        }
                        else
                        {
                          float num16;
                          if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                          {
                            num16 = inHigh[index3] - inLow[index3];
                          }
                          else
                          {
                            float num17;
                            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                            {
                              float num19 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                              float num21 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                              num17 = (float) ((double) inHigh[index3] - (double) num19 + ((double) num21 - (double) inLow[index3]));
                            }
                            else
                              num17 = 0.0f;
                            num16 = num17;
                          }
                          num14 = num16;
                        }
                        num12 = (double) num14;
                      }
                      double num22 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if ((double) Math.Abs(inClose[index3] - inOpen[index3]) < Core.Globals.candleSettings[2].factor * num12 / num22)
                      {
                        double num14;
                        if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                        {
                          num14 = numArray2[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                        }
                        else
                        {
                          float num16;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                          {
                            num16 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                          }
                          else
                          {
                            float num17;
                            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                            {
                              num17 = inHigh[index3 - 1] - inLow[index3 - 1];
                            }
                            else
                            {
                              float num19;
                              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                              {
                                float num21 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                                float num23 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                                num19 = (float) ((double) inHigh[index3 - 1] - (double) num21 + ((double) num23 - (double) inLow[index3 - 1]));
                              }
                              else
                                num19 = 0.0f;
                              num17 = num19;
                            }
                            num16 = num17;
                          }
                          num14 = (double) num16;
                        }
                        double num24 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if ((double) inOpen[index3] >= (double) inClose[index3 - 1] - (double) Math.Abs(inClose[index3] - inOpen[index3]) - Core.Globals.candleSettings[8].factor * num14 / num24)
                        {
                          outInteger[index4] = -100;
                          ++index4;
                          goto label_160;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_160:
            for (int index2 = 2; index2 >= 1; --index2)
            {
              float num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num7 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num10 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num11 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num9 = (float) ((double) inHigh[index3 - index2] - (double) num10 + ((double) num11 - (double) inLow[index3 - index2]));
                  }
                  else
                    num9 = 0.0f;
                  num8 = num9;
                }
                num7 = num8;
              }
              float num12;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num12 = Math.Abs(inClose[num2 - index2] - inOpen[num2 - index2]);
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[num2 - index2] - inLow[num2 - index2];
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num10 = (double) inClose[num2 - index2] < (double) inOpen[num2 - index2] ? inOpen[num2 - index2] : inClose[num2 - index2];
                    float num11 = (double) inClose[num2 - index2] < (double) inOpen[num2 - index2] ? inClose[num2 - index2] : inOpen[num2 - index2];
                    num9 = (float) ((double) inHigh[num2 - index2] - (double) num10 + ((double) num11 - (double) inLow[num2 - index2]));
                  }
                  else
                    num9 = 0.0f;
                  num8 = num9;
                }
                num12 = num8;
              }
              numArray1[index2] = numArray1[index2] + ((double) num7 - (double) num12);
              float num13;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num10 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    float num11 = (double) inClose[index3 - index2] < (double) inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num9 = (float) ((double) inHigh[index3 - index2] - (double) num10 + ((double) num11 - (double) inLow[index3 - index2]));
                  }
                  else
                    num9 = 0.0f;
                  num8 = num9;
                }
                num13 = num8;
              }
              float num14;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num14 = Math.Abs(inClose[num6 - index2] - inOpen[num6 - index2]);
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[num6 - index2] - inLow[num6 - index2];
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    float num10 = (double) inClose[num6 - index2] < (double) inOpen[num6 - index2] ? inOpen[num6 - index2] : inClose[num6 - index2];
                    float num11 = (double) inClose[num6 - index2] < (double) inOpen[num6 - index2] ? inClose[num6 - index2] : inOpen[num6 - index2];
                    num9 = (float) ((double) inHigh[num6 - index2] - (double) num10 + ((double) num11 - (double) inLow[num6 - index2]));
                  }
                  else
                    num9 = 0.0f;
                  num8 = num9;
                }
                num14 = num8;
              }
              numArray2[index2] = numArray2[index2] + ((double) num13 - (double) num14);
            }
            float num25;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num10 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = (float) ((double) inHigh[index3] - (double) num9 + ((double) num10 - (double) inLow[index3]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num25 = num7;
            }
            float num26;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num10 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num8 = (float) ((double) inHigh[index1] - (double) num9 + ((double) num10 - (double) inLow[index1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num26 = num7;
            }
            num3 += (double) num25 - (double) num26;
            float num27;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3 - 1] - inLow[index3 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  float num10 = (double) inClose[index3 - 1] < (double) inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  num8 = (float) ((double) inHigh[index3 - 1] - (double) num9 + ((double) num10 - (double) inLow[index3 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num27 = num7;
            }
            float num28;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  float num10 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num8 = (float) ((double) inHigh[num5 - 1] - (double) num9 + ((double) num10 - (double) inLow[num5 - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num28 = num7;
            }
            num4 += (double) num27 - (double) num28;
            ++index3;
            ++num2;
            ++index1;
            ++num5;
            ++num6;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlStalledPattern(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlStalledPatternLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          numArray1[2] = 0.0;
          numArray1[1] = 0.0;
          numArray1[0] = 0.0;
          int num2 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          double num3 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          numArray2[2] = 0.0;
          numArray2[1] = 0.0;
          numArray2[0] = 0.0;
          int num6 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index2 = num2; index2 < startIdx; ++index2)
          {
            double num7;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num11 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num9 = inHigh[index2 - 2] - num10 + (num11 - inLow[index2 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num7 = num8;
            }
            numArray1[2] = numArray1[2] + num7;
            double num12;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num11 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num9 = inHigh[index2 - 1] - num10 + (num11 - inLow[index2 - 1]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num12 = num8;
            }
            numArray1[1] = numArray1[1] + num12;
          }
          for (int index2 = index1; index2 < startIdx; ++index2)
          {
            double num7;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num11 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num9 = inHigh[index2] - num10 + (num11 - inLow[index2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num7 = num8;
            }
            num3 += num7;
          }
          for (int index2 = num5; index2 < startIdx; ++index2)
          {
            double num7;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num11 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num9 = inHigh[index2 - 1] - num10 + (num11 - inLow[index2 - 1]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num7 = num8;
            }
            num4 += num7;
          }
          for (int index2 = num6; index2 < startIdx; ++index2)
          {
            double num7;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num7 = Math.Abs(inClose[index2 - 2] - inOpen[index2 - 2]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 2] - inLow[index2 - 2];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index2 - 2] < inOpen[index2 - 2] ? inOpen[index2 - 2] : inClose[index2 - 2];
                  double num11 = inClose[index2 - 2] < inOpen[index2 - 2] ? inClose[index2 - 2] : inOpen[index2 - 2];
                  num9 = inHigh[index2 - 2] - num10 + (num11 - inLow[index2 - 2]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num7 = num8;
            }
            numArray2[2] = numArray2[2] + num7;
            double num12;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num12 = Math.Abs(inClose[index2 - 1] - inOpen[index2 - 1]);
            }
            else
            {
              double num8;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num8 = inHigh[index2 - 1] - inLow[index2 - 1];
              }
              else
              {
                double num9;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num10 = inClose[index2 - 1] < inOpen[index2 - 1] ? inOpen[index2 - 1] : inClose[index2 - 1];
                  double num11 = inClose[index2 - 1] < inOpen[index2 - 1] ? inClose[index2 - 1] : inOpen[index2 - 1];
                  num9 = inHigh[index2 - 1] - num10 + (num11 - inLow[index2 - 1]);
                }
                else
                  num9 = 0.0;
                num8 = num9;
              }
              num12 = num8;
            }
            numArray2[1] = numArray2[1] + num12;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            if ((inClose[index3 - 2] < inOpen[index3 - 2] ? -1 : 1) == 1 && (inClose[index3 - 1] < inOpen[index3 - 1] ? -1 : 1) == 1 && ((inClose[index3] < inOpen[index3] ? -1 : 1) == 1 && inClose[index3] > inClose[index3 - 1] && inClose[index3 - 1] > inClose[index3 - 2]))
            {
              double num7;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num7 = numArray1[2] / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num11 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      double num12 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num10 = inHigh[index3 - 2] - num11 + (num12 - inLow[index3 - 2]);
                    }
                    else
                      num10 = 0.0;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = num8;
              }
              double num13 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) > Core.Globals.candleSettings[0].factor * num7 / num13)
              {
                double num8;
                if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
                {
                  num8 = numArray1[1] / (double) Core.Globals.candleSettings[0].avgPeriod;
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                  {
                    num9 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                    {
                      num10 = inHigh[index3 - 1] - inLow[index3 - 1];
                    }
                    else
                    {
                      double num11;
                      if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                      {
                        double num12 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                        double num14 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                        num11 = inHigh[index3 - 1] - num12 + (num14 - inLow[index3 - 1]);
                      }
                      else
                        num11 = 0.0;
                      num10 = num11;
                    }
                    num9 = num10;
                  }
                  num8 = num9;
                }
                double num15 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) > Core.Globals.candleSettings[0].factor * num8 / num15)
                {
                  double num9 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  double num10;
                  if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
                  {
                    num10 = num4 / (double) Core.Globals.candleSettings[7].avgPeriod;
                  }
                  else
                  {
                    double num11;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                    {
                      num11 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                      {
                        num12 = inHigh[index3 - 1] - inLow[index3 - 1];
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                        {
                          double num16 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                          double num17 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                          num14 = inHigh[index3 - 1] - num16 + (num17 - inLow[index3 - 1]);
                        }
                        else
                          num14 = 0.0;
                        num12 = num14;
                      }
                      num11 = num12;
                    }
                    num10 = num11;
                  }
                  double num18 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                  if (inHigh[index3 - 1] - num9 < Core.Globals.candleSettings[7].factor * num10 / num18 && inOpen[index3 - 1] > inOpen[index3 - 2])
                  {
                    double num11;
                    if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                    {
                      num11 = numArray2[2] / (double) Core.Globals.candleSettings[8].avgPeriod;
                    }
                    else
                    {
                      double num12;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                      {
                        num12 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                        {
                          num14 = inHigh[index3 - 2] - inLow[index3 - 2];
                        }
                        else
                        {
                          double num16;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                          {
                            double num17 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                            double num19 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                            num16 = inHigh[index3 - 2] - num17 + (num19 - inLow[index3 - 2]);
                          }
                          else
                            num16 = 0.0;
                          num14 = num16;
                        }
                        num12 = num14;
                      }
                      num11 = num12;
                    }
                    double num20 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                    if (inOpen[index3 - 1] <= inClose[index3 - 2] + Core.Globals.candleSettings[8].factor * num11 / num20)
                    {
                      double num12;
                      if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                      {
                        num12 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                      }
                      else
                      {
                        double num14;
                        if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                        {
                          num14 = Math.Abs(inClose[index3] - inOpen[index3]);
                        }
                        else
                        {
                          double num16;
                          if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                          {
                            num16 = inHigh[index3] - inLow[index3];
                          }
                          else
                          {
                            double num17;
                            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                            {
                              double num19 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                              double num21 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                              num17 = inHigh[index3] - num19 + (num21 - inLow[index3]);
                            }
                            else
                              num17 = 0.0;
                            num16 = num17;
                          }
                          num14 = num16;
                        }
                        num12 = num14;
                      }
                      double num22 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                      if (Math.Abs(inClose[index3] - inOpen[index3]) < Core.Globals.candleSettings[2].factor * num12 / num22)
                      {
                        double num14;
                        if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                        {
                          num14 = numArray2[1] / (double) Core.Globals.candleSettings[8].avgPeriod;
                        }
                        else
                        {
                          double num16;
                          if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                          {
                            num16 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
                          }
                          else
                          {
                            double num17;
                            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                            {
                              num17 = inHigh[index3 - 1] - inLow[index3 - 1];
                            }
                            else
                            {
                              double num19;
                              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                              {
                                double num21 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                                double num23 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                                num19 = inHigh[index3 - 1] - num21 + (num23 - inLow[index3 - 1]);
                              }
                              else
                                num19 = 0.0;
                              num17 = num19;
                            }
                            num16 = num17;
                          }
                          num14 = num16;
                        }
                        double num24 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                        if (inOpen[index3] >= inClose[index3 - 1] - Math.Abs(inClose[index3] - inOpen[index3]) - Core.Globals.candleSettings[8].factor * num14 / num24)
                        {
                          outInteger[index4] = -100;
                          ++index4;
                          goto label_160;
                        }
                      }
                    }
                  }
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_160:
            for (int index2 = 2; index2 >= 1; --index2)
            {
              double num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num7 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num10 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num11 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num9 = inHigh[index3 - index2] - num10 + (num11 - inLow[index3 - index2]);
                  }
                  else
                    num9 = 0.0;
                  num8 = num9;
                }
                num7 = num8;
              }
              double num12;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num12 = Math.Abs(inClose[num2 - index2] - inOpen[num2 - index2]);
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[num2 - index2] - inLow[num2 - index2];
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num10 = inClose[num2 - index2] < inOpen[num2 - index2] ? inOpen[num2 - index2] : inClose[num2 - index2];
                    double num11 = inClose[num2 - index2] < inOpen[num2 - index2] ? inClose[num2 - index2] : inOpen[num2 - index2];
                    num9 = inHigh[num2 - index2] - num10 + (num11 - inLow[num2 - index2]);
                  }
                  else
                    num9 = 0.0;
                  num8 = num9;
                }
                num12 = num8;
              }
              numArray1[index2] = numArray1[index2] + (num7 - num12);
              double num13;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num13 = Math.Abs(inClose[index3 - index2] - inOpen[index3 - index2]);
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[index3 - index2] - inLow[index3 - index2];
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num10 = inClose[index3 - index2] < inOpen[index3 - index2] ? inOpen[index3 - index2] : inClose[index3 - index2];
                    double num11 = inClose[index3 - index2] < inOpen[index3 - index2] ? inClose[index3 - index2] : inOpen[index3 - index2];
                    num9 = inHigh[index3 - index2] - num10 + (num11 - inLow[index3 - index2]);
                  }
                  else
                    num9 = 0.0;
                  num8 = num9;
                }
                num13 = num8;
              }
              double num14;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
              {
                num14 = Math.Abs(inClose[num6 - index2] - inOpen[num6 - index2]);
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                {
                  num8 = inHigh[num6 - index2] - inLow[num6 - index2];
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                  {
                    double num10 = inClose[num6 - index2] < inOpen[num6 - index2] ? inOpen[num6 - index2] : inClose[num6 - index2];
                    double num11 = inClose[num6 - index2] < inOpen[num6 - index2] ? inClose[num6 - index2] : inOpen[num6 - index2];
                    num9 = inHigh[num6 - index2] - num10 + (num11 - inLow[num6 - index2]);
                  }
                  else
                    num9 = 0.0;
                  num8 = num9;
                }
                num14 = num8;
              }
              numArray2[index2] = numArray2[index2] + (num13 - num14);
            }
            double num25;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num25 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num10 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num8 = inHigh[index3] - num9 + (num10 - inLow[index3]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num25 = num7;
            }
            double num26;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num26 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num10 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num8 = inHigh[index1] - num9 + (num10 - inLow[index1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num26 = num7;
            }
            num3 += num25 - num26;
            double num27;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num27 = Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index3 - 1] - inLow[index3 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index3 - 1] < inOpen[index3 - 1] ? inOpen[index3 - 1] : inClose[index3 - 1];
                  double num10 = inClose[index3 - 1] < inOpen[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1];
                  num8 = inHigh[index3 - 1] - num9 + (num10 - inLow[index3 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num27 = num7;
            }
            double num28;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num28 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[num5 - 1] < inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  double num10 = inClose[num5 - 1] < inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num8 = inHigh[num5 - 1] - num9 + (num10 - inLow[num5 - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num28 = num7;
            }
            num4 += num27 - num28;
            ++index3;
            ++num2;
            ++index1;
            ++num5;
            ++num6;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlStickSandwhichLookback()
    {
      return Core.Globals.candleSettings[10].avgPeriod + 2;
    }

    public static Core.RetCode CdlStickSandwhich(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlStickSandwhichLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  float num8 = (double) inClose[index - 2] < (double) inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = (float) ((double) inHigh[index - 2] - (double) num7 + ((double) num8 - (double) inLow[index - 2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1 && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1 && (double) inLow[index1 - 1] > (double) inClose[index1 - 2]))
            {
              double num4;
              if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      float num9 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num7 = (float) ((double) inHigh[index1 - 2] - (double) num8 + ((double) num9 - (double) inLow[index1 - 2]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inClose[index1] <= (double) inClose[index1 - 2] + Core.Globals.candleSettings[10].factor * num4 / num10)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 2] - inLow[index1 - 2];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        float num9 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                        float num11 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                        num8 = (float) ((double) inHigh[index1 - 2] - (double) num9 + ((double) num11 - (double) inLow[index1 - 2]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num12 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1] >= (double) inClose[index1 - 2] - Core.Globals.candleSettings[10].factor * num5 / num12)
                {
                  outInteger[index2] = 100;
                  ++index2;
                  goto label_54;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_54:
            float num13;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 2] - inLow[index1 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  float num7 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  num5 = (float) ((double) inHigh[index1 - 2] - (double) num6 + ((double) num7 - (double) inLow[index1 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            float num14;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  float num7 = (double) inClose[num3 - 2] < (double) inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num5 = (float) ((double) inHigh[num3 - 2] - (double) num6 + ((double) num7 - (double) inLow[num3 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += (double) num13 - (double) num14;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlStickSandwhich(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlStickSandwhichLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 2] - inOpen[index - 2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 2] - inLow[index - 2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 2] < inOpen[index - 2] ? inOpen[index - 2] : inClose[index - 2];
                  double num8 = inClose[index - 2] < inOpen[index - 2] ? inClose[index - 2] : inOpen[index - 2];
                  num6 = inHigh[index - 2] - num7 + (num8 - inLow[index - 2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1 && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == -1 && inLow[index1 - 1] > inClose[index1 - 2]))
            {
              double num4;
              if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index1 - 2] - inLow[index1 - 2];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                      double num9 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                      num7 = inHigh[index1 - 2] - num8 + (num9 - inLow[index1 - 2]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inClose[index1] <= inClose[index1 - 2] + Core.Globals.candleSettings[10].factor * num4 / num10)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 2] - inLow[index1 - 2];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        double num9 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                        double num11 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                        num8 = inHigh[index1 - 2] - num9 + (num11 - inLow[index1 - 2]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num12 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1] >= inClose[index1 - 2] - Core.Globals.candleSettings[10].factor * num5 / num12)
                {
                  outInteger[index2] = 100;
                  ++index2;
                  goto label_54;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_54:
            double num13;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 2] - inOpen[index1 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 2] - inLow[index1 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1 - 2] < inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  double num7 = inClose[index1 - 2] < inOpen[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2];
                  num5 = inHigh[index1 - 2] - num6 + (num7 - inLow[index1 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            double num14;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 2] - inOpen[num3 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 2] - inLow[num3 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[num3 - 2] < inOpen[num3 - 2] ? inOpen[num3 - 2] : inClose[num3 - 2];
                  double num7 = inClose[num3 - 2] < inOpen[num3 - 2] ? inClose[num3 - 2] : inOpen[num3 - 2];
                  num5 = inHigh[num3 - 2] - num6 + (num7 - inLow[num3 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += num13 - num14;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlTakuriLookback()
    {
      return (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[3].avgPeriod) <= Core.Globals.candleSettings[5].avgPeriod ? Core.Globals.candleSettings[5].avgPeriod : (Core.Globals.candleSettings[3].avgPeriod <= Core.Globals.candleSettings[7].avgPeriod ? Core.Globals.candleSettings[7].avgPeriod : Core.Globals.candleSettings[3].avgPeriod);
    }

    public static Core.RetCode CdlTakuri(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlTakuriLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[5].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += (double) num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            float num5;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = (float) ((double) inHigh[index4] - (double) num8 + ((double) num9 - (double) inLow[index4]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += (double) num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            float num5;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += (double) num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                    float num10 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = (float) ((double) inHigh[index5] - (double) num9 + ((double) num10 - (double) inLow[index5]));
                  }
                  else
                    num8 = 0.0f;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = (double) num6;
            }
            double num11 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index5] - inOpen[index5]) <= Core.Globals.candleSettings[3].factor * num5 / num11)
            {
              float num6 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  float num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    float num10;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      float num12 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                      float num13 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = (float) ((double) inHigh[index5] - (double) num12 + ((double) num13 - (double) inLow[index5]));
                    }
                    else
                      num10 = 0.0f;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = (double) num8;
              }
              double num14 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) inHigh[index5] - (double) num6 < Core.Globals.candleSettings[7].factor * num7 / num14)
              {
                float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[5].avgPeriod != 0.0)
                {
                  num9 = num4 / (double) Core.Globals.candleSettings[5].avgPeriod;
                }
                else
                {
                  float num10;
                  if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    float num12;
                    if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      float num13;
                      if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                      {
                        float num15 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                        float num16 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = (float) ((double) inHigh[index5] - (double) num15 + ((double) num16 - (double) inLow[index5]));
                      }
                      else
                        num13 = 0.0f;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = (double) num10;
                }
                double num17 = Core.Globals.candleSettings[5].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) num8 - (double) inLow[index5] > Core.Globals.candleSettings[5].factor * num9 / num17)
                {
                  outInteger[index6] = 100;
                  ++index6;
                  goto label_90;
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_90:
            float num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num18 = num6;
            }
            float num19;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num9 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = (float) ((double) inHigh[index1] - (double) num8 + ((double) num9 - (double) inLow[index1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num19 = num6;
            }
            num2 += (double) num18 - (double) num19;
            float num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num20 = num6;
            }
            float num21;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num9 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = (float) ((double) inHigh[index2] - (double) num8 + ((double) num9 - (double) inLow[index2]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num21 = num6;
            }
            num3 += (double) num20 - (double) num21;
            float num22;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index5] < (double) inOpen[index5] ? inOpen[index5] : inClose[index5];
                  float num9 = (double) inClose[index5] < (double) inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = (float) ((double) inHigh[index5] - (double) num8 + ((double) num9 - (double) inLow[index5]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num22 = num6;
            }
            float num23;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num9 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = (float) ((double) inHigh[index3] - (double) num8 + ((double) num9 - (double) inLow[index3]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num23 = num6;
            }
            num4 += (double) num22 - (double) num23;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlTakuri(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlTakuriLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - Core.Globals.candleSettings[3].avgPeriod;
          double num3 = 0.0;
          int index2 = startIdx - Core.Globals.candleSettings[7].avgPeriod;
          double num4 = 0.0;
          int index3 = startIdx - Core.Globals.candleSettings[5].avgPeriod;
          for (int index4 = index1; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num2 += num5;
          }
          for (int index4 = index2; index4 < startIdx; ++index4)
          {
            double num5;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num9 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num7 = inHigh[index4] - num8 + (num9 - inLow[index4]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num3 += num5;
          }
          int index5;
          for (index5 = index3; index5 < startIdx; ++index5)
          {
            double num5;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num5 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num5 = num6;
            }
            num4 += num5;
          }
          int index6 = 0;
          do
          {
            double num5;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num5 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num6 = Math.Abs(inClose[index5] - inOpen[index5]);
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num7 = inHigh[index5] - inLow[index5];
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num9 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                    double num10 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                    num8 = inHigh[index5] - num9 + (num10 - inLow[index5]);
                  }
                  else
                    num8 = 0.0;
                  num7 = num8;
                }
                num6 = num7;
              }
              num5 = num6;
            }
            double num11 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index5] - inOpen[index5]) <= Core.Globals.candleSettings[3].factor * num5 / num11)
            {
              double num6 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
              double num7;
              if ((double) Core.Globals.candleSettings[7].avgPeriod != 0.0)
              {
                num7 = num3 / (double) Core.Globals.candleSettings[7].avgPeriod;
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
                {
                  num8 = Math.Abs(inClose[index5] - inOpen[index5]);
                }
                else
                {
                  double num9;
                  if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
                  {
                    num9 = inHigh[index5] - inLow[index5];
                  }
                  else
                  {
                    double num10;
                    if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                    {
                      double num12 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                      double num13 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                      num10 = inHigh[index5] - num12 + (num13 - inLow[index5]);
                    }
                    else
                      num10 = 0.0;
                    num9 = num10;
                  }
                  num8 = num9;
                }
                num7 = num8;
              }
              double num14 = Core.Globals.candleSettings[7].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (inHigh[index5] - num6 < Core.Globals.candleSettings[7].factor * num7 / num14)
              {
                double num8 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                double num9;
                if ((double) Core.Globals.candleSettings[5].avgPeriod != 0.0)
                {
                  num9 = num4 / (double) Core.Globals.candleSettings[5].avgPeriod;
                }
                else
                {
                  double num10;
                  if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
                  {
                    num10 = Math.Abs(inClose[index5] - inOpen[index5]);
                  }
                  else
                  {
                    double num12;
                    if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
                    {
                      num12 = inHigh[index5] - inLow[index5];
                    }
                    else
                    {
                      double num13;
                      if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                      {
                        double num15 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                        double num16 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                        num13 = inHigh[index5] - num15 + (num16 - inLow[index5]);
                      }
                      else
                        num13 = 0.0;
                      num12 = num13;
                    }
                    num10 = num12;
                  }
                  num9 = num10;
                }
                double num17 = Core.Globals.candleSettings[5].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (num8 - inLow[index5] > Core.Globals.candleSettings[5].factor * num9 / num17)
                {
                  outInteger[index6] = 100;
                  ++index6;
                  goto label_90;
                }
              }
            }
            outInteger[index6] = 0;
            ++index6;
label_90:
            double num18;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num18 = num6;
            }
            double num19;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num19 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num9 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num7 = inHigh[index1] - num8 + (num9 - inLow[index1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num19 = num6;
            }
            num2 += num18 - num19;
            double num20;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num20 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num20 = num6;
            }
            double num21;
            if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.RealBody)
            {
              num21 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[7].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num9 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num7 = inHigh[index2] - num8 + (num9 - inLow[index2]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num21 = num6;
            }
            num3 += num20 - num21;
            double num22;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num22 = Math.Abs(inClose[index5] - inOpen[index5]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index5] - inLow[index5];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index5] < inOpen[index5] ? inOpen[index5] : inClose[index5];
                  double num9 = inClose[index5] < inOpen[index5] ? inClose[index5] : inOpen[index5];
                  num7 = inHigh[index5] - num8 + (num9 - inLow[index5]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num22 = num6;
            }
            double num23;
            if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.RealBody)
            {
              num23 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[5].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num9 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num7 = inHigh[index3] - num8 + (num9 - inLow[index3]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num23 = num6;
            }
            num4 += num22 - num23;
            ++index5;
            ++index1;
            ++index2;
            ++index3;
          }
          while (index5 <= endIdx);
          outNBElement = index6;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlTasukiGapLookback()
    {
      return Core.Globals.candleSettings[8].avgPeriod + 2;
    }

    public static Core.RetCode CdlTasukiGap(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlTasukiGapLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num4;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num8 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = (float) ((double) inHigh[index - 1] - (double) num7 + ((double) num8 - (double) inLow[index - 1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inOpen[index1 - 1] >= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) > ((double) inOpen[index1 - 2] <= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == 1 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == -1 && (double) inOpen[index1] < (double) inClose[index1 - 1] && ((double) inOpen[index1] > (double) inOpen[index1 - 1] && (double) inClose[index1] < (double) inOpen[index1 - 1])))
            {
              float num4 = (double) inClose[index1 - 2] <= (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
              if ((double) inClose[index1] > (double) num4)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num8 = (float) ((double) inHigh[index1 - 1] - (double) num9 + ((double) num10 - (double) inLow[index1 - 1]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num11 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Math.Abs(inClose[index1] - inOpen[index1])) < Core.Globals.candleSettings[8].factor * num5 / num11)
                  goto label_55;
              }
            }
            if (((double) inOpen[index1 - 1] <= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) < ((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (double) inOpen[index1] < (double) inOpen[index1 - 1] && ((double) inOpen[index1] > (double) inClose[index1 - 1] && (double) inClose[index1] > (double) inOpen[index1 - 1])))
            {
              float num4 = (double) inClose[index1 - 2] >= (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
              if ((double) inClose[index1] < (double) num4)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num8 = (float) ((double) inHigh[index1 - 1] - (double) num9 + ((double) num10 - (double) inLow[index1 - 1]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num11 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Math.Abs(inClose[index1] - inOpen[index1])) < Core.Globals.candleSettings[8].factor * num5 / num11)
                  goto label_55;
              }
            }
            outInteger[index2] = 0;
            ++index2;
            goto label_57;
label_55:
            int num12 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1;
            outInteger[index2] = num12 * 100;
            ++index2;
label_57:
            float num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num7 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num5 = (float) ((double) inHigh[index1 - 1] - (double) num6 + ((double) num7 - (double) inLow[index1 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            float num14;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num7 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num5 = (float) ((double) inHigh[num3 - 1] - (double) num6 + ((double) num7 - (double) inLow[num3 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += (double) num13 - (double) num14;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlTasukiGap(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlTasukiGapLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[8].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num4;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num8 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num6 = inHigh[index - 1] - num7 + (num8 - inLow[index - 1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inOpen[index1 - 1] >= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) > (inOpen[index1 - 2] <= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == 1 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == -1 && inOpen[index1] < inClose[index1 - 1] && (inOpen[index1] > inOpen[index1 - 1] && inClose[index1] < inOpen[index1 - 1])))
            {
              double num4 = inClose[index1 - 2] <= inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
              if (inClose[index1] > num4)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num8 = inHigh[index1 - 1] - num9 + (num10 - inLow[index1 - 1]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num11 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Math.Abs(inClose[index1] - inOpen[index1])) < Core.Globals.candleSettings[8].factor * num5 / num11)
                  goto label_55;
              }
            }
            if ((inOpen[index1 - 1] <= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) < (inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && inOpen[index1] < inOpen[index1 - 1] && (inOpen[index1] > inClose[index1 - 1] && inClose[index1] > inOpen[index1 - 1])))
            {
              double num4 = inClose[index1 - 2] >= inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
              if (inClose[index1] < num4)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[8].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[8].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                      {
                        double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num8 = inHigh[index1 - 1] - num9 + (num10 - inLow[index1 - 1]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num11 = Core.Globals.candleSettings[8].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) - Math.Abs(inClose[index1] - inOpen[index1])) < Core.Globals.candleSettings[8].factor * num5 / num11)
                  goto label_55;
              }
            }
            outInteger[index2] = 0;
            ++index2;
            goto label_57;
label_55:
            int num12 = inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1;
            outInteger[index2] = num12 * 100;
            ++index2;
label_57:
            double num13;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num7 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num5 = inHigh[index1 - 1] - num6 + (num7 - inLow[index1 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            double num14;
            if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[8].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num7 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num5 = inHigh[num3 - 1] - num6 + (num7 - inLow[num3 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += num13 - num14;
            ++index1;
            ++num3;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlThrustingLookback()
    {
      return (Core.Globals.candleSettings[10].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[10].avgPeriod) + 1;
    }

    public static Core.RetCode CdlThrusting(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlThrustingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += (double) num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            float num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              float num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                float num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num9 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  float num10 = (double) inClose[index - 1] < (double) inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = (float) ((double) inHigh[index - 1] - (double) num9 + ((double) num10 - (double) inLow[index - 1]));
                }
                else
                  num8 = 0.0f;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += (double) num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num10 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = (float) ((double) inHigh[index1 - 1] - (double) num10 + ((double) num11 - (double) inLow[index1 - 1]));
                    }
                    else
                      num9 = 0.0f;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = (double) num7;
              }
              double num12 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num6 / num12 && (((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1) == 1 && (double) inOpen[index1] < (double) inLow[index1 - 1]))
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  float num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    float num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      float num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        float num11 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        float num13 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = (float) ((double) inHigh[index1 - 1] - (double) num11 + ((double) num13 - (double) inLow[index1 - 1]));
                      }
                      else
                        num10 = 0.0f;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = (double) num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) inClose[index1] > (double) inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num14 && (double) inClose[index1] <= (double) inClose[index1 - 1] + (double) Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) * 0.5)
                {
                  outInteger[index2] = -100;
                  ++index2;
                  goto label_66;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_66:
            float num15;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num15 = num6;
            }
            float num16;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  float num9 = (double) inClose[num3 - 1] < (double) inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num7 = (float) ((double) inHigh[num3 - 1] - (double) num8 + ((double) num9 - (double) inLow[num3 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num16 = num6;
            }
            num2 += (double) num15 - (double) num16;
            float num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  float num9 = (double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = (float) ((double) inHigh[index1 - 1] - (double) num8 + ((double) num9 - (double) inLow[index1 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num17 = num6;
            }
            float num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              float num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                float num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num8 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  float num9 = (double) inClose[num5 - 1] < (double) inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = (float) ((double) inHigh[num5 - 1] - (double) num8 + ((double) num9 - (double) inLow[num5 - 1]));
                }
                else
                  num7 = 0.0f;
                num6 = num7;
              }
              num18 = num6;
            }
            num4 += (double) num17 - (double) num18;
            ++index1;
            ++num3;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlThrusting(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlThrustingLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int num3 = startIdx - Core.Globals.candleSettings[10].avgPeriod;
          double num4 = 0.0;
          int num5 = startIdx - Core.Globals.candleSettings[0].avgPeriod;
          for (int index = num3; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num2 += num6;
          }
          for (int index = num5; index < startIdx; ++index)
          {
            double num6;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num6 = Math.Abs(inClose[index - 1] - inOpen[index - 1]);
            }
            else
            {
              double num7;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num7 = inHigh[index - 1] - inLow[index - 1];
              }
              else
              {
                double num8;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num9 = inClose[index - 1] < inOpen[index - 1] ? inOpen[index - 1] : inClose[index - 1];
                  double num10 = inClose[index - 1] < inOpen[index - 1] ? inClose[index - 1] : inOpen[index - 1];
                  num8 = inHigh[index - 1] - num9 + (num10 - inLow[index - 1]);
                }
                else
                  num8 = 0.0;
                num7 = num8;
              }
              num6 = num7;
            }
            num4 += num6;
          }
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -1)
            {
              double num6;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num6 = num4 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num7 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num8 = inHigh[index1 - 1] - inLow[index1 - 1];
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num10 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                      double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                      num9 = inHigh[index1 - 1] - num10 + (num11 - inLow[index1 - 1]);
                    }
                    else
                      num9 = 0.0;
                    num8 = num9;
                  }
                  num7 = num8;
                }
                num6 = num7;
              }
              double num12 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) > Core.Globals.candleSettings[0].factor * num6 / num12 && ((inClose[index1] < inOpen[index1] ? -1 : 1) == 1 && inOpen[index1] < inLow[index1 - 1]))
              {
                double num7;
                if ((double) Core.Globals.candleSettings[10].avgPeriod != 0.0)
                {
                  num7 = num2 / (double) Core.Globals.candleSettings[10].avgPeriod;
                }
                else
                {
                  double num8;
                  if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
                  {
                    num8 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
                  }
                  else
                  {
                    double num9;
                    if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
                    {
                      num9 = inHigh[index1 - 1] - inLow[index1 - 1];
                    }
                    else
                    {
                      double num10;
                      if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                      {
                        double num11 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                        double num13 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                        num10 = inHigh[index1 - 1] - num11 + (num13 - inLow[index1 - 1]);
                      }
                      else
                        num10 = 0.0;
                      num9 = num10;
                    }
                    num8 = num9;
                  }
                  num7 = num8;
                }
                double num14 = Core.Globals.candleSettings[10].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (inClose[index1] > inClose[index1 - 1] + Core.Globals.candleSettings[10].factor * num7 / num14 && inClose[index1] <= inClose[index1 - 1] + Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]) * 0.5)
                {
                  outInteger[index2] = -100;
                  ++index2;
                  goto label_66;
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_66:
            double num15;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num15 = num6;
            }
            double num16;
            if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[num3 - 1] - inOpen[num3 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num3 - 1] - inLow[num3 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[10].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num3 - 1] < inOpen[num3 - 1] ? inOpen[num3 - 1] : inClose[num3 - 1];
                  double num9 = inClose[num3 - 1] < inOpen[num3 - 1] ? inClose[num3 - 1] : inOpen[num3 - 1];
                  num7 = inHigh[num3 - 1] - num8 + (num9 - inLow[num3 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num16 = num6;
            }
            num2 += num15 - num16;
            double num17;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num17 = Math.Abs(inClose[index1 - 1] - inOpen[index1 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[index1 - 1] - inLow[index1 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[index1 - 1] < inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                  double num9 = inClose[index1 - 1] < inOpen[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1];
                  num7 = inHigh[index1 - 1] - num8 + (num9 - inLow[index1 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num17 = num6;
            }
            double num18;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num18 = Math.Abs(inClose[num5 - 1] - inOpen[num5 - 1]);
            }
            else
            {
              double num6;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num6 = inHigh[num5 - 1] - inLow[num5 - 1];
              }
              else
              {
                double num7;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num8 = inClose[num5 - 1] < inOpen[num5 - 1] ? inOpen[num5 - 1] : inClose[num5 - 1];
                  double num9 = inClose[num5 - 1] < inOpen[num5 - 1] ? inClose[num5 - 1] : inOpen[num5 - 1];
                  num7 = inHigh[num5 - 1] - num8 + (num9 - inLow[num5 - 1]);
                }
                else
                  num7 = 0.0;
                num6 = num7;
              }
              num18 = num6;
            }
            num4 += num17 - num18;
            ++index1;
            ++num3;
            ++num5;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlTristarLookback()
    {
      return Core.Globals.candleSettings[3].avgPeriod + 2;
    }

    public static Core.RetCode CdlTristar(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlTristarLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[3].avgPeriod;
          for (int index2 = index1; index2 < startIdx - 2; ++index2)
          {
            float num3;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += (double) num3;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num3 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index3 - 2] - inLow[index3 - 2];
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    float num7 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                    float num8 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                    num6 = (float) ((double) inHigh[index3 - 2] - (double) num7 + ((double) num8 - (double) inLow[index3 - 2]));
                  }
                  else
                    num6 = 0.0f;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = (double) num4;
            }
            double num9 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) <= Core.Globals.candleSettings[3].factor * num3 / num9)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      float num10 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num7 = (float) ((double) inHigh[index3 - 2] - (double) num8 + ((double) num10 - (double) inLow[index3 - 2]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num11 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) <= Core.Globals.candleSettings[3].factor * num4 / num11)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index3 - 2] - inLow[index3 - 2];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        float num10 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                        float num12 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                        num8 = (float) ((double) inHigh[index3 - 2] - (double) num10 + ((double) num12 - (double) inLow[index3 - 2]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index3] - inOpen[index3]) <= Core.Globals.candleSettings[3].factor * num5 / num13)
                {
                  outInteger[index4] = 0;
                  if (((double) inOpen[index3 - 1] >= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]) > ((double) inOpen[index3 - 2] <= (double) inClose[index3 - 2] ? (double) inClose[index3 - 2] : (double) inOpen[index3 - 2]) && ((double) inOpen[index3] <= (double) inClose[index3] ? (double) inClose[index3] : (double) inOpen[index3]) < ((double) inOpen[index3 - 1] <= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]))
                    outInteger[index4] = -100;
                  if (((double) inOpen[index3 - 1] <= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]) < ((double) inOpen[index3 - 2] >= (double) inClose[index3 - 2] ? (double) inClose[index3 - 2] : (double) inOpen[index3 - 2]) && ((double) inOpen[index3] >= (double) inClose[index3] ? (double) inClose[index3] : (double) inOpen[index3]) > ((double) inOpen[index3 - 1] >= (double) inClose[index3 - 1] ? (double) inClose[index3 - 1] : (double) inOpen[index3 - 1]))
                    outInteger[index4] = 100;
                  ++index4;
                  goto label_70;
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_70:
            float num14;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  float num7 = (double) inClose[index3 - 2] < (double) inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num5 = (float) ((double) inHigh[index3 - 2] - (double) num6 + ((double) num7 - (double) inLow[index3 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            float num15;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = (float) ((double) inHigh[index1] - (double) num6 + ((double) num7 - (double) inLow[index1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num15 = num4;
            }
            num2 += (double) num14 - (double) num15;
            ++index3;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlTristar(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlTristarLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[3].avgPeriod;
          for (int index2 = index1; index2 < startIdx - 2; ++index2)
          {
            double num3;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num3 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num3 = num4;
            }
            num2 += num3;
          }
          int index3 = startIdx;
          int index4 = 0;
          do
          {
            double num3;
            if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
            {
              num3 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
              {
                num4 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                {
                  num5 = inHigh[index3 - 2] - inLow[index3 - 2];
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                  {
                    double num7 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                    double num8 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                    num6 = inHigh[index3 - 2] - num7 + (num8 - inLow[index3 - 2]);
                  }
                  else
                    num6 = 0.0;
                  num5 = num6;
                }
                num4 = num5;
              }
              num3 = num4;
            }
            double num9 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]) <= Core.Globals.candleSettings[3].factor * num3 / num9)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index3 - 2] - inLow[index3 - 2];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                      double num10 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                      num7 = inHigh[index3 - 2] - num8 + (num10 - inLow[index3 - 2]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num11 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index3 - 1] - inOpen[index3 - 1]) <= Core.Globals.candleSettings[3].factor * num4 / num11)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[3].avgPeriod != 0.0)
                {
                  num5 = num2 / (double) Core.Globals.candleSettings[3].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index3 - 2] - inLow[index3 - 2];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                      {
                        double num10 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                        double num12 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                        num8 = inHigh[index3 - 2] - num10 + (num12 - inLow[index3 - 2]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num13 = Core.Globals.candleSettings[3].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index3] - inOpen[index3]) <= Core.Globals.candleSettings[3].factor * num5 / num13)
                {
                  outInteger[index4] = 0;
                  if ((inOpen[index3 - 1] >= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]) > (inOpen[index3 - 2] <= inClose[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2]) && (inOpen[index3] <= inClose[index3] ? inClose[index3] : inOpen[index3]) < (inOpen[index3 - 1] <= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]))
                    outInteger[index4] = -100;
                  if ((inOpen[index3 - 1] <= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]) < (inOpen[index3 - 2] >= inClose[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2]) && (inOpen[index3] >= inClose[index3] ? inClose[index3] : inOpen[index3]) > (inOpen[index3 - 1] >= inClose[index3 - 1] ? inClose[index3 - 1] : inOpen[index3 - 1]))
                    outInteger[index4] = 100;
                  ++index4;
                  goto label_70;
                }
              }
            }
            outInteger[index4] = 0;
            ++index4;
label_70:
            double num14;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index3 - 2] - inOpen[index3 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index3 - 2] - inLow[index3 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index3 - 2] < inOpen[index3 - 2] ? inOpen[index3 - 2] : inClose[index3 - 2];
                  double num7 = inClose[index3 - 2] < inOpen[index3 - 2] ? inClose[index3 - 2] : inOpen[index3 - 2];
                  num5 = inHigh[index3 - 2] - num6 + (num7 - inLow[index3 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            double num15;
            if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[3].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num7 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = inHigh[index1] - num6 + (num7 - inLow[index1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num15 = num4;
            }
            num2 += num14 - num15;
            ++index3;
            ++index1;
          }
          while (index3 <= endIdx);
          outNBElement = index4;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlUnique3RiverLookback()
    {
      return (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 2;
    }

    public static Core.RetCode CdlUnique3River(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlUnique3RiverLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 2; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = (float) ((double) inHigh[index4 - 2] - (double) num8 + ((double) num9 - (double) inLow[index4 - 2]));
                  }
                  else
                    num7 = 0.0f;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = (double) num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if ((double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num4 / num10 && ((double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1) == -1 && (((double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1) == -1 && (double) inClose[index4 - 1] > (double) inClose[index4 - 2] && ((double) inOpen[index4 - 1] <= (double) inOpen[index4 - 2] && (double) inLow[index4 - 1] < (double) inLow[index4 - 2])))
            {
              double num5;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  float num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    float num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      float num9 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                      float num11 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = (float) ((double) inHigh[index4] - (double) num9 + ((double) num11 - (double) inLow[index4]));
                    }
                    else
                      num8 = 0.0f;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = (double) num6;
              }
              double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4] - inOpen[index4]) < Core.Globals.candleSettings[2].factor * num5 / num12 && (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == 1 && (double) inOpen[index4] > (double) inLow[index4 - 1]))
              {
                outInteger[index5] = 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            float num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 2] - inLow[index4 - 2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                  float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                  num6 = (float) ((double) inHigh[index4 - 2] - (double) num7 + ((double) num8 - (double) inLow[index4 - 2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num13 = num5;
            }
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num8 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = (float) ((double) inHigh[index1] - (double) num7 + ((double) num8 - (double) inLow[index1]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += (double) num13 - (double) num14;
            float num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index4] < (double) inOpen[index4] ? inOpen[index4] : inClose[index4];
                  float num8 = (double) inClose[index4] < (double) inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = (float) ((double) inHigh[index4] - (double) num7 + ((double) num8 - (double) inLow[index4]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num15 = num5;
            }
            float num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num8 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = (float) ((double) inHigh[index2] - (double) num7 + ((double) num8 - (double) inLow[index2]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += (double) num15 - (double) num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlUnique3River(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlUnique3RiverLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 2; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          for (int index3 = index2; index3 < startIdx; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            double num4;
            if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
            {
              num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
              {
                num5 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                {
                  num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                  {
                    double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                    double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                    num7 = inHigh[index4 - 2] - num8 + (num9 - inLow[index4 - 2]);
                  }
                  else
                    num7 = 0.0;
                  num6 = num7;
                }
                num5 = num6;
              }
              num4 = num5;
            }
            double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
            if (Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num4 / num10 && (inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1) == -1 && ((inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1) == -1 && inClose[index4 - 1] > inClose[index4 - 2] && (inOpen[index4 - 1] <= inOpen[index4 - 2] && inLow[index4 - 1] < inLow[index4 - 2])))
            {
              double num5;
              if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
              {
                num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                {
                  num6 = Math.Abs(inClose[index4] - inOpen[index4]);
                }
                else
                {
                  double num7;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                  {
                    num7 = inHigh[index4] - inLow[index4];
                  }
                  else
                  {
                    double num8;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                    {
                      double num9 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                      double num11 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                      num8 = inHigh[index4] - num9 + (num11 - inLow[index4]);
                    }
                    else
                      num8 = 0.0;
                    num7 = num8;
                  }
                  num6 = num7;
                }
                num5 = num6;
              }
              double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4] - inOpen[index4]) < Core.Globals.candleSettings[2].factor * num5 / num12 && ((inClose[index4] < inOpen[index4] ? -1 : 1) == 1 && inOpen[index4] > inLow[index4 - 1]))
              {
                outInteger[index5] = 100;
                ++index5;
                goto label_65;
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_65:
            double num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4 - 2] - inLow[index4 - 2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                  double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                  num6 = inHigh[index4 - 2] - num7 + (num8 - inLow[index4 - 2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num13 = num5;
            }
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num8 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num6 = inHigh[index1] - num7 + (num8 - inLow[index1]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num14 = num5;
            }
            num2 += num13 - num14;
            double num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4] - inOpen[index4]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index4] - inLow[index4];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index4] < inOpen[index4] ? inOpen[index4] : inClose[index4];
                  double num8 = inClose[index4] < inOpen[index4] ? inClose[index4] : inOpen[index4];
                  num6 = inHigh[index4] - num7 + (num8 - inLow[index4]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num15 = num5;
            }
            double num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num8 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num6 = inHigh[index2] - num7 + (num8 - inLow[index2]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num16 = num5;
            }
            num3 += num15 - num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlUpsideGap2CrowsLookback()
    {
      return (Core.Globals.candleSettings[2].avgPeriod <= Core.Globals.candleSettings[0].avgPeriod ? Core.Globals.candleSettings[0].avgPeriod : Core.Globals.candleSettings[2].avgPeriod) + 2;
    }

    public static Core.RetCode CdlUpsideGap2Crows(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlUpsideGap2CrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 2; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += (double) num4;
          }
          for (int index3 = index2; index3 < startIdx - 1; ++index3)
          {
            float num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              float num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                float num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num7 = (double) inClose[index3] < (double) inOpen[index3] ? inOpen[index3] : inClose[index3];
                  float num8 = (double) inClose[index3] < (double) inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = (float) ((double) inHigh[index3] - (double) num7 + ((double) num8 - (double) inLow[index3]));
                }
                else
                  num6 = 0.0f;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += (double) num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            if (((double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? -1 : 1) == 1)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      float num8 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                      float num9 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                      num7 = (float) ((double) inHigh[index4 - 2] - (double) num8 + ((double) num9 - (double) inLow[index4 - 2]));
                    }
                    else
                      num7 = 0.0f;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = (double) num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if ((double) Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num4 / num10 && ((double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? -1 : 1) == -1)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  float num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    float num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      float num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        float num9 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        float num11 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num8 = (float) ((double) inHigh[index4 - 1] - (double) num9 + ((double) num11 - (double) inLow[index4 - 1]));
                      }
                      else
                        num8 = 0.0f;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = (double) num6;
                }
                double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if ((double) Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num5 / num12 && ((double) inOpen[index4 - 1] >= (double) inClose[index4 - 1] ? (double) inClose[index4 - 1] : (double) inOpen[index4 - 1]) > ((double) inOpen[index4 - 2] <= (double) inClose[index4 - 2] ? (double) inClose[index4 - 2] : (double) inOpen[index4 - 2]) && (((double) inClose[index4] < (double) inOpen[index4] ? -1 : 1) == -1 && (double) inOpen[index4] > (double) inOpen[index4 - 1] && ((double) inClose[index4] < (double) inClose[index4 - 1] && (double) inClose[index4] > (double) inClose[index4 - 2])))
                {
                  outInteger[index5] = -100;
                  ++index5;
                  goto label_66;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_66:
            float num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index4 - 2] - inLow[index4 - 2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                  float num7 = (double) inClose[index4 - 2] < (double) inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                  num5 = (float) ((double) inHigh[index4 - 2] - (double) num6 + ((double) num7 - (double) inLow[index4 - 2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num13 = num4;
            }
            float num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index1] < (double) inOpen[index1] ? inOpen[index1] : inClose[index1];
                  float num7 = (double) inClose[index1] < (double) inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = (float) ((double) inHigh[index1] - (double) num6 + ((double) num7 - (double) inLow[index1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += (double) num13 - (double) num14;
            float num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  float num7 = (double) inClose[index4 - 1] < (double) inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num5 = (float) ((double) inHigh[index4 - 1] - (double) num6 + ((double) num7 - (double) inLow[index4 - 1]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num15 = num4;
            }
            float num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              float num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                float num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  float num6 = (double) inClose[index2] < (double) inOpen[index2] ? inOpen[index2] : inClose[index2];
                  float num7 = (double) inClose[index2] < (double) inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = (float) ((double) inHigh[index2] - (double) num6 + ((double) num7 - (double) inLow[index2]));
                }
                else
                  num5 = 0.0f;
                num4 = num5;
              }
              num16 = num4;
            }
            num3 += (double) num15 - (double) num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlUpsideGap2Crows(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlUpsideGap2CrowsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          double num2 = 0.0;
          double num3 = 0.0;
          int index1 = startIdx - 2 - Core.Globals.candleSettings[0].avgPeriod;
          int index2 = startIdx - 1 - Core.Globals.candleSettings[2].avgPeriod;
          for (int index3 = index1; index3 < startIdx - 2; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num2 += num4;
          }
          for (int index3 = index2; index3 < startIdx - 1; ++index3)
          {
            double num4;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num4 = Math.Abs(inClose[index3] - inOpen[index3]);
            }
            else
            {
              double num5;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num5 = inHigh[index3] - inLow[index3];
              }
              else
              {
                double num6;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num7 = inClose[index3] < inOpen[index3] ? inOpen[index3] : inClose[index3];
                  double num8 = inClose[index3] < inOpen[index3] ? inClose[index3] : inOpen[index3];
                  num6 = inHigh[index3] - num7 + (num8 - inLow[index3]);
                }
                else
                  num6 = 0.0;
                num5 = num6;
              }
              num4 = num5;
            }
            num3 += num4;
          }
          int index4 = startIdx;
          int index5 = 0;
          do
          {
            if ((inClose[index4 - 2] < inOpen[index4 - 2] ? -1 : 1) == 1)
            {
              double num4;
              if ((double) Core.Globals.candleSettings[0].avgPeriod != 0.0)
              {
                num4 = num2 / (double) Core.Globals.candleSettings[0].avgPeriod;
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
                {
                  num5 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
                  {
                    num6 = inHigh[index4 - 2] - inLow[index4 - 2];
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                    {
                      double num8 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                      double num9 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                      num7 = inHigh[index4 - 2] - num8 + (num9 - inLow[index4 - 2]);
                    }
                    else
                      num7 = 0.0;
                    num6 = num7;
                  }
                  num5 = num6;
                }
                num4 = num5;
              }
              double num10 = Core.Globals.candleSettings[0].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
              if (Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]) > Core.Globals.candleSettings[0].factor * num4 / num10 && (inClose[index4 - 1] < inOpen[index4 - 1] ? -1 : 1) == -1)
              {
                double num5;
                if ((double) Core.Globals.candleSettings[2].avgPeriod != 0.0)
                {
                  num5 = num3 / (double) Core.Globals.candleSettings[2].avgPeriod;
                }
                else
                {
                  double num6;
                  if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
                  {
                    num6 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
                  }
                  else
                  {
                    double num7;
                    if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
                    {
                      num7 = inHigh[index4 - 1] - inLow[index4 - 1];
                    }
                    else
                    {
                      double num8;
                      if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                      {
                        double num9 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                        double num11 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                        num8 = inHigh[index4 - 1] - num9 + (num11 - inLow[index4 - 1]);
                      }
                      else
                        num8 = 0.0;
                      num7 = num8;
                    }
                    num6 = num7;
                  }
                  num5 = num6;
                }
                double num12 = Core.Globals.candleSettings[2].rangeType != Core.RangeType.Shadows ? 1.0 : 2.0;
                if (Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]) <= Core.Globals.candleSettings[2].factor * num5 / num12 && (inOpen[index4 - 1] >= inClose[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1]) > (inOpen[index4 - 2] <= inClose[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2]) && ((inClose[index4] < inOpen[index4] ? -1 : 1) == -1 && inOpen[index4] > inOpen[index4 - 1] && (inClose[index4] < inClose[index4 - 1] && inClose[index4] > inClose[index4 - 2])))
                {
                  outInteger[index5] = -100;
                  ++index5;
                  goto label_66;
                }
              }
            }
            outInteger[index5] = 0;
            ++index5;
label_66:
            double num13;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num13 = Math.Abs(inClose[index4 - 2] - inOpen[index4 - 2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index4 - 2] - inLow[index4 - 2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index4 - 2] < inOpen[index4 - 2] ? inOpen[index4 - 2] : inClose[index4 - 2];
                  double num7 = inClose[index4 - 2] < inOpen[index4 - 2] ? inClose[index4 - 2] : inOpen[index4 - 2];
                  num5 = inHigh[index4 - 2] - num6 + (num7 - inLow[index4 - 2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num13 = num4;
            }
            double num14;
            if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.RealBody)
            {
              num14 = Math.Abs(inClose[index1] - inOpen[index1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index1] - inLow[index1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[0].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index1] < inOpen[index1] ? inOpen[index1] : inClose[index1];
                  double num7 = inClose[index1] < inOpen[index1] ? inClose[index1] : inOpen[index1];
                  num5 = inHigh[index1] - num6 + (num7 - inLow[index1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num14 = num4;
            }
            num2 += num13 - num14;
            double num15;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num15 = Math.Abs(inClose[index4 - 1] - inOpen[index4 - 1]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index4 - 1] - inLow[index4 - 1];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index4 - 1] < inOpen[index4 - 1] ? inOpen[index4 - 1] : inClose[index4 - 1];
                  double num7 = inClose[index4 - 1] < inOpen[index4 - 1] ? inClose[index4 - 1] : inOpen[index4 - 1];
                  num5 = inHigh[index4 - 1] - num6 + (num7 - inLow[index4 - 1]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num15 = num4;
            }
            double num16;
            if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.RealBody)
            {
              num16 = Math.Abs(inClose[index2] - inOpen[index2]);
            }
            else
            {
              double num4;
              if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.HighLow)
              {
                num4 = inHigh[index2] - inLow[index2];
              }
              else
              {
                double num5;
                if (Core.Globals.candleSettings[2].rangeType == Core.RangeType.Shadows)
                {
                  double num6 = inClose[index2] < inOpen[index2] ? inOpen[index2] : inClose[index2];
                  double num7 = inClose[index2] < inOpen[index2] ? inClose[index2] : inOpen[index2];
                  num5 = inHigh[index2] - num6 + (num7 - inLow[index2]);
                }
                else
                  num5 = 0.0;
                num4 = num5;
              }
              num16 = num4;
            }
            num3 += num15 - num16;
            ++index4;
            ++index1;
            ++index2;
          }
          while (index4 <= endIdx);
          outNBElement = index5;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CdlXSideGap3MethodsLookback()
    {
      return 2;
    }

    public static Core.RetCode CdlXSideGap3Methods(
      int startIdx,
      int endIdx,
      float[] inOpen,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlXSideGap3MethodsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) && ((double) inClose[index1 - 1] < (double) inOpen[index1 - 1] ? -1 : 1) == -((double) inClose[index1] < (double) inOpen[index1] ? -1 : 1))
            {
              float num2 = (double) inClose[index1 - 1] <= (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
              if ((double) inOpen[index1] < (double) num2)
              {
                float num3 = (double) inClose[index1 - 1] >= (double) inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                if ((double) inOpen[index1] > (double) num3)
                {
                  float num4 = (double) inClose[index1 - 2] <= (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  if ((double) inClose[index1] < (double) num4)
                  {
                    float num5 = (double) inClose[index1 - 2] >= (double) inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                    if ((double) inClose[index1] > (double) num5 && (((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == 1 && ((double) inOpen[index1 - 1] >= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) > ((double) inOpen[index1 - 2] <= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2]) || ((double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1) == -1 && ((double) inOpen[index1 - 1] <= (double) inClose[index1 - 1] ? (double) inClose[index1 - 1] : (double) inOpen[index1 - 1]) < ((double) inOpen[index1 - 2] >= (double) inClose[index1 - 2] ? (double) inClose[index1 - 2] : (double) inOpen[index1 - 2])))
                    {
                      int num6 = (double) inClose[index1 - 2] < (double) inOpen[index1 - 2] ? -1 : 1;
                      outInteger[index2] = num6 * 100;
                      ++index2;
                      goto label_20;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_20:
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode CdlXSideGap3Methods(
      int startIdx,
      int endIdx,
      double[] inOpen,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inOpen == null || inHigh == null || (inLow == null || inClose == null))
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int num1 = Core.CdlXSideGap3MethodsLookback();
        if (startIdx < num1)
          startIdx = num1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = startIdx;
          int index2 = 0;
          do
          {
            if ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) && (inClose[index1 - 1] < inOpen[index1 - 1] ? -1 : 1) == -(inClose[index1] < inOpen[index1] ? -1 : 1))
            {
              double num2 = inClose[index1 - 1] <= inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
              if (inOpen[index1] < num2)
              {
                double num3 = inClose[index1 - 1] >= inOpen[index1 - 1] ? inOpen[index1 - 1] : inClose[index1 - 1];
                if (inOpen[index1] > num3)
                {
                  double num4 = inClose[index1 - 2] <= inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                  if (inClose[index1] < num4)
                  {
                    double num5 = inClose[index1 - 2] >= inOpen[index1 - 2] ? inOpen[index1 - 2] : inClose[index1 - 2];
                    if (inClose[index1] > num5 && ((inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == 1 && (inOpen[index1 - 1] >= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) > (inOpen[index1 - 2] <= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2]) || (inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1) == -1 && (inOpen[index1 - 1] <= inClose[index1 - 1] ? inClose[index1 - 1] : inOpen[index1 - 1]) < (inOpen[index1 - 2] >= inClose[index1 - 2] ? inClose[index1 - 2] : inOpen[index1 - 2])))
                    {
                      int num6 = inClose[index1 - 2] < inOpen[index1 - 2] ? -1 : 1;
                      outInteger[index2] = num6 * 100;
                      ++index2;
                      goto label_20;
                    }
                  }
                }
              }
            }
            outInteger[index2] = 0;
            ++index2;
label_20:
            ++index1;
          }
          while (index1 <= endIdx);
          outNBElement = index2;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int CeilLookback()
    {
      return 0;
    }

    public static Core.RetCode Ceil(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Ceiling((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Ceil(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Ceiling(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int CmoLookback(int optInTimePeriod)
    {
      int num1;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num1 = -1;
        goto label_7;
      }
      int num2 = optInTimePeriod + (int) Core.Globals.unstablePeriod[3];
      if (Core.Globals.compatibility == Core.Compatibility.Metastock)
        --num2;
      num1 = num2;
label_7:
      return num1;
    }

    public static Core.RetCode Cmo(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_54;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.CmoLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod == 1)
            {
              outBegIdx = startIdx;
              int length = endIdx - startIdx + 1;
              outNBElement = length;
              Array.Copy((Array) inReal, startIdx, (Array) outReal, 0, length);
              retCode = Core.RetCode.Success;
            }
            else
            {
              int index2 = startIdx - num1;
              double num2 = (double) inReal[index2];
              if (Core.Globals.unstablePeriod[3] == 0U && Core.Globals.compatibility == Core.Compatibility.Metastock)
              {
                double num3 = num2;
                double num4 = 0.0;
                double num5 = 0.0;
                for (int index3 = optInTimePeriod; index3 > 0; --index3)
                {
                  double num6 = (double) inReal[index2];
                  ++index2;
                  double num7 = num6 - num2;
                  num2 = num6;
                  if (num7 >= 0.0)
                    goto label_24;
                  num5 -= num7;
                  continue;
label_24:
                  num4 += num7;
                }
                double num8 = num5 / (double) optInTimePeriod;
                double num9 = num4 / (double) optInTimePeriod;
                double num10 = num9 - num8;
                double num11 = num8 + num9;
                if (-1E-08 >= num11 || num11 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num10 / num11);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                if (index2 > endIdx)
                {
                  outBegIdx = startIdx;
                  outNBElement = index1;
                  retCode = Core.RetCode.Success;
                  goto label_54;
                }
                else
                {
                  index2 -= optInTimePeriod;
                  num2 = num3;
                }
              }
              double num12 = 0.0;
              double num13 = 0.0;
              int index4 = index2 + 1;
              for (int index3 = optInTimePeriod; index3 > 0; --index3)
              {
                double num3 = (double) inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                if (num4 >= 0.0)
                  goto label_36;
                num13 -= num4;
                continue;
label_36:
                num12 += num4;
              }
              double num14 = num13 / (double) optInTimePeriod;
              double num15 = num12 / (double) optInTimePeriod;
              if (index4 > startIdx)
              {
                double num3 = num15 + num14;
                if (-1E-08 >= num3 || num3 >= 1E-08)
                {
                  outReal[index1] = 100.0 * ((num15 - num14) / num3);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              else
              {
                for (; index4 < startIdx; ++index4)
                {
                  double num3 = (double) inReal[index4];
                  double num4 = num3 - num2;
                  num2 = num3;
                  double num5 = num14 * (double) (optInTimePeriod - 1);
                  double num6 = num15 * (double) (optInTimePeriod - 1);
                  if (num4 < 0.0)
                    num5 -= num4;
                  else
                    num6 += num4;
                  num14 = num5 / (double) optInTimePeriod;
                  num15 = num6 / (double) optInTimePeriod;
                }
              }
              while (index4 <= endIdx)
              {
                double num3 = (double) inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                double num5 = num14 * (double) (optInTimePeriod - 1);
                double num6 = num15 * (double) (optInTimePeriod - 1);
                if (num4 < 0.0)
                  num5 -= num4;
                else
                  num6 += num4;
                num14 = num5 / (double) optInTimePeriod;
                num15 = num6 / (double) optInTimePeriod;
                double num7 = num15 + num14;
                if (-1E-08 >= num7 || num7 >= 1E-08)
                {
                  outReal[index1] = 100.0 * ((num15 - num14) / num7);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outBegIdx = startIdx;
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_54:
      return retCode;
    }

    public static Core.RetCode Cmo(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_54;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.CmoLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod == 1)
            {
              outBegIdx = startIdx;
              int length = endIdx - startIdx + 1;
              outNBElement = length;
              Array.Copy((Array) inReal, startIdx, (Array) outReal, 0, length);
              retCode = Core.RetCode.Success;
            }
            else
            {
              int index2 = startIdx - num1;
              double num2 = inReal[index2];
              if (Core.Globals.unstablePeriod[3] == 0U && Core.Globals.compatibility == Core.Compatibility.Metastock)
              {
                double num3 = num2;
                double num4 = 0.0;
                double num5 = 0.0;
                for (int index3 = optInTimePeriod; index3 > 0; --index3)
                {
                  double num6 = inReal[index2];
                  ++index2;
                  double num7 = num6 - num2;
                  num2 = num6;
                  if (num7 >= 0.0)
                    goto label_24;
                  num5 -= num7;
                  continue;
label_24:
                  num4 += num7;
                }
                double num8 = num5 / (double) optInTimePeriod;
                double num9 = num4 / (double) optInTimePeriod;
                double num10 = num9 - num8;
                double num11 = num8 + num9;
                if (-1E-08 >= num11 || num11 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num10 / num11);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                if (index2 > endIdx)
                {
                  outBegIdx = startIdx;
                  outNBElement = index1;
                  retCode = Core.RetCode.Success;
                  goto label_54;
                }
                else
                {
                  index2 -= optInTimePeriod;
                  num2 = num3;
                }
              }
              double num12 = 0.0;
              double num13 = 0.0;
              int index4 = index2 + 1;
              for (int index3 = optInTimePeriod; index3 > 0; --index3)
              {
                double num3 = inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                if (num4 >= 0.0)
                  goto label_36;
                num13 -= num4;
                continue;
label_36:
                num12 += num4;
              }
              double num14 = num13 / (double) optInTimePeriod;
              double num15 = num12 / (double) optInTimePeriod;
              if (index4 > startIdx)
              {
                double num3 = num15 + num14;
                if (-1E-08 >= num3 || num3 >= 1E-08)
                {
                  outReal[index1] = 100.0 * ((num15 - num14) / num3);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              else
              {
                for (; index4 < startIdx; ++index4)
                {
                  double num3 = inReal[index4];
                  double num4 = num3 - num2;
                  num2 = num3;
                  double num5 = num14 * (double) (optInTimePeriod - 1);
                  double num6 = num15 * (double) (optInTimePeriod - 1);
                  if (num4 < 0.0)
                    num5 -= num4;
                  else
                    num6 += num4;
                  num14 = num5 / (double) optInTimePeriod;
                  num15 = num6 / (double) optInTimePeriod;
                }
              }
              while (index4 <= endIdx)
              {
                double num3 = inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                double num5 = num14 * (double) (optInTimePeriod - 1);
                double num6 = num15 * (double) (optInTimePeriod - 1);
                if (num4 < 0.0)
                  num5 -= num4;
                else
                  num6 += num4;
                num14 = num5 / (double) optInTimePeriod;
                num15 = num6 / (double) optInTimePeriod;
                double num7 = num15 + num14;
                if (-1E-08 >= num7 || num7 >= 1E-08)
                {
                  outReal[index1] = 100.0 * ((num15 - num14) / num7);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outBegIdx = startIdx;
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_54:
      return retCode;
    }

    public static int CorrelLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Correl(
      int startIdx,
      int endIdx,
      float[] inReal0,
      float[] inReal1,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num1;
            double num2 = 0.0;
            double num3 = num2;
            double num4 = num3;
            double num5 = num4;
            double num6 = num5;
            int index2;
            for (index2 = index1; index2 <= startIdx; ++index2)
            {
              double num7 = (double) inReal0[index2];
              num5 += num7;
              double num8 = num3;
              double num9 = num7;
              double num10 = num9 * num9;
              num3 = num8 + num10;
              double num11 = (double) inReal1[index2];
              num6 += num7 * num11;
              num4 += num11;
              double num12 = num2;
              double num13 = num11;
              double num14 = num13 * num13;
              num2 = num12 + num14;
            }
            double num15 = (double) inReal0[index1];
            double num16 = (double) inReal1[index1];
            int index3 = index1 + 1;
            double num17 = num3;
            double num18 = num5;
            double num19 = num18 * num18 / (double) optInTimePeriod;
            double num20 = num17 - num19;
            double num21 = num2;
            double num22 = num4;
            double num23 = num22 * num22 / (double) optInTimePeriod;
            double num24 = num21 - num23;
            double d1 = num20 * num24;
            outReal[0] = d1 < 1E-08 ? 0.0 : (num6 - num5 * num4 / (double) optInTimePeriod) / Math.Sqrt(d1);
            int index4 = 1;
            while (index2 <= endIdx)
            {
              double num7 = num5 - num15;
              double num8 = num3;
              double num9 = num15;
              double num10 = num9 * num9;
              double num11 = num8 - num10;
              double num12 = num6 - num15 * num16;
              double num13 = num4 - num16;
              double num14 = num2;
              double num25 = num16;
              double num26 = num25 * num25;
              double num27 = num14 - num26;
              double num28 = (double) inReal0[index2];
              num5 = num7 + num28;
              double num29 = num11;
              double num30 = num28;
              double num31 = num30 * num30;
              num3 = num29 + num31;
              double num32 = (double) inReal1[index2];
              ++index2;
              num6 = num12 + num28 * num32;
              num4 = num13 + num32;
              double num33 = num27;
              double num34 = num32;
              double num35 = num34 * num34;
              num2 = num33 + num35;
              num15 = (double) inReal0[index3];
              num16 = (double) inReal1[index3];
              ++index3;
              double num36 = num3;
              double num37 = num5;
              double num38 = num37 * num37 / (double) optInTimePeriod;
              double num39 = num36 - num38;
              double num40 = num2;
              double num41 = num4;
              double num42 = num41 * num41 / (double) optInTimePeriod;
              double num43 = num40 - num42;
              double d2 = num39 * num43;
              if (d2 >= 1E-08)
              {
                outReal[index4] = (num6 - num5 * num4 / (double) optInTimePeriod) / Math.Sqrt(d2);
                ++index4;
              }
              else
              {
                outReal[index4] = 0.0;
                ++index4;
              }
            }
            outNBElement = index4;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode Correl(
      int startIdx,
      int endIdx,
      double[] inReal0,
      double[] inReal1,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num1;
            double num2 = 0.0;
            double num3 = num2;
            double num4 = num3;
            double num5 = num4;
            double num6 = num5;
            int index2;
            for (index2 = index1; index2 <= startIdx; ++index2)
            {
              double num7 = inReal0[index2];
              num5 += num7;
              double num8 = num3;
              double num9 = num7;
              double num10 = num9 * num9;
              num3 = num8 + num10;
              double num11 = inReal1[index2];
              num6 += num7 * num11;
              num4 += num11;
              double num12 = num2;
              double num13 = num11;
              double num14 = num13 * num13;
              num2 = num12 + num14;
            }
            double num15 = inReal0[index1];
            double num16 = inReal1[index1];
            int index3 = index1 + 1;
            double num17 = num3;
            double num18 = num5;
            double num19 = num18 * num18 / (double) optInTimePeriod;
            double num20 = num17 - num19;
            double num21 = num2;
            double num22 = num4;
            double num23 = num22 * num22 / (double) optInTimePeriod;
            double num24 = num21 - num23;
            double d1 = num20 * num24;
            outReal[0] = d1 < 1E-08 ? 0.0 : (num6 - num5 * num4 / (double) optInTimePeriod) / Math.Sqrt(d1);
            int index4 = 1;
            while (index2 <= endIdx)
            {
              double num7 = num5 - num15;
              double num8 = num3;
              double num9 = num15;
              double num10 = num9 * num9;
              double num11 = num8 - num10;
              double num12 = num6 - num15 * num16;
              double num13 = num4 - num16;
              double num14 = num2;
              double num25 = num16;
              double num26 = num25 * num25;
              double num27 = num14 - num26;
              double num28 = inReal0[index2];
              num5 = num7 + num28;
              double num29 = num11;
              double num30 = num28;
              double num31 = num30 * num30;
              num3 = num29 + num31;
              double num32 = inReal1[index2];
              ++index2;
              num6 = num12 + num28 * num32;
              num4 = num13 + num32;
              double num33 = num27;
              double num34 = num32;
              double num35 = num34 * num34;
              num2 = num33 + num35;
              num15 = inReal0[index3];
              num16 = inReal1[index3];
              ++index3;
              double num36 = num3;
              double num37 = num5;
              double num38 = num37 * num37 / (double) optInTimePeriod;
              double num39 = num36 - num38;
              double num40 = num2;
              double num41 = num4;
              double num42 = num41 * num41 / (double) optInTimePeriod;
              double num43 = num40 - num42;
              double d2 = num39 * num43;
              if (d2 >= 1E-08)
              {
                outReal[index4] = (num6 - num5 * num4 / (double) optInTimePeriod) / Math.Sqrt(d2);
                ++index4;
              }
              else
              {
                outReal[index4] = 0.0;
                ++index4;
              }
            }
            outNBElement = index4;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int CosLookback()
    {
      return 0;
    }

    public static Core.RetCode Cos(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Cos((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Cos(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Cos(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int CoshLookback()
    {
      return 0;
    }

    public static Core.RetCode Cosh(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Cosh((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Cosh(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Cosh(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int DemaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = Core.EmaLookback(optInTimePeriod) * 2;
label_5:
      return num;
    }

    public static Core.RetCode Dema(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_28;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outNBElement = 0;
          outBegIdx = 0;
          int num1 = Core.EmaLookback(optInTimePeriod);
          int num2 = num1 * 2;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double[] numArray = new double[num2 + (endIdx - startIdx) + 1];
            if (numArray == null)
            {
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double optInK_1 = 2.0 / (double) (optInTimePeriod + 1);
              int outBegIdx1;
              int outNbElement1;
              Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx - num1, endIdx, inReal, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement1, numArray);
              if (retCode2 != Core.RetCode.Success || outNbElement1 == 0)
              {
                retCode1 = retCode2;
              }
              else
              {
                double[] outReal_0 = new double[outNbElement1];
                if (outReal_0 == null)
                {
                  retCode1 = Core.RetCode.AllocErr;
                }
                else
                {
                  int outBegIdx2;
                  int outNbElement2;
                  Core.RetCode retCode3 = Core.TA_INT_EMA(0, outNbElement1 - 1, numArray, optInTimePeriod, optInK_1, out outBegIdx2, out outNbElement2, outReal_0);
                  if (retCode3 != Core.RetCode.Success || outNbElement2 == 0)
                  {
                    retCode1 = retCode3;
                  }
                  else
                  {
                    int index1 = outBegIdx2;
                    int index2;
                    for (index2 = 0; index2 < outNbElement2; ++index2)
                    {
                      outReal[index2] = 2.0 * numArray[index1] - outReal_0[index2];
                      ++index1;
                    }
                    outBegIdx = outBegIdx1 + outBegIdx2;
                    outNBElement = index2;
                    retCode1 = Core.RetCode.Success;
                  }
                }
              }
            }
          }
        }
      }
label_28:
      return retCode1;
    }

    public static Core.RetCode Dema(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_30;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outNBElement = 0;
          outBegIdx = 0;
          int num1 = Core.EmaLookback(optInTimePeriod);
          int num2 = num1 * 2;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double[] numArray;
            if (inReal == outReal)
            {
              numArray = outReal;
            }
            else
            {
              numArray = new double[num2 + (endIdx - startIdx) + 1];
              if (numArray == null)
              {
                retCode1 = Core.RetCode.AllocErr;
                goto label_30;
              }
            }
            double optInK_1 = 2.0 / (double) (optInTimePeriod + 1);
            int outBegIdx1;
            int outNbElement1;
            Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx - num1, endIdx, inReal, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement1, numArray);
            if (retCode2 != Core.RetCode.Success || outNbElement1 == 0)
            {
              retCode1 = retCode2;
            }
            else
            {
              double[] outReal_0 = new double[outNbElement1];
              if (outReal_0 == null)
              {
                retCode1 = Core.RetCode.AllocErr;
              }
              else
              {
                int outBegIdx2;
                int outNbElement2;
                Core.RetCode retCode3 = Core.TA_INT_EMA(0, outNbElement1 - 1, numArray, optInTimePeriod, optInK_1, out outBegIdx2, out outNbElement2, outReal_0);
                if (retCode3 != Core.RetCode.Success || outNbElement2 == 0)
                {
                  retCode1 = retCode3;
                }
                else
                {
                  int index1 = outBegIdx2;
                  int index2;
                  for (index2 = 0; index2 < outNbElement2; ++index2)
                  {
                    outReal[index2] = 2.0 * numArray[index1] - outReal_0[index2];
                    ++index1;
                  }
                  outBegIdx = outBegIdx1 + outBegIdx2;
                  outNBElement = index2;
                  retCode1 = Core.RetCode.Success;
                }
              }
            }
          }
        }
      }
label_30:
      return retCode1;
    }

    public static int DivLookback()
    {
      return 0;
    }

    public static Core.RetCode Div(
      int startIdx,
      int endIdx,
      float[] inReal0,
      float[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = (double) inReal0[index1] / (double) inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Div(
      int startIdx,
      int endIdx,
      double[] inReal0,
      double[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = inReal0[index1] / inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int DxLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod <= 1 ? 2 : optInTimePeriod + (int) Core.Globals.unstablePeriod[4];
label_5:
      return num;
    }

    public static Core.RetCode Dx(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_56;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 2 : optInTimePeriod + (int) Core.Globals.unstablePeriod[4];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int num2 = startIdx;
            outBegIdx = num2;
            double num3 = 0.0;
            double num4 = 0.0;
            double num5 = 0.0;
            int index1 = startIdx - num1;
            double num6 = (double) inHigh[index1];
            double num7 = (double) inLow[index1];
            double num8 = (double) inClose[index1];
            int num9 = optInTimePeriod - 1;
            while (true)
            {
              int num10 = num9;
              --num9;
              if (num10 > 0)
              {
                ++index1;
                double num11 = (double) inHigh[index1];
                double num12 = num11 - num6;
                num6 = num11;
                double num13 = (double) inLow[index1];
                double num14 = num7 - num13;
                num7 = num13;
                if (num14 > 0.0 && num12 < num14)
                  num3 += num14;
                else if (num12 > 0.0 && num12 > num14)
                  num4 += num12;
                double num15 = num6 - num7;
                double num16 = Math.Abs(num6 - num8);
                if (num16 > num15)
                  num15 = num16;
                double num17 = Math.Abs(num7 - num8);
                if (num17 > num15)
                  num15 = num17;
                num5 += num15;
                num8 = (double) inClose[index1];
              }
              else
                break;
            }
            int num18 = (int) Core.Globals.unstablePeriod[4] + 1;
            while (true)
            {
              int num10 = num18;
              --num18;
              if (num10 != 0)
              {
                ++index1;
                double num11 = (double) inHigh[index1];
                double num12 = num11 - num6;
                num6 = num11;
                double num13 = (double) inLow[index1];
                double num14 = num7 - num13;
                num7 = num13;
                double num15 = num3;
                num3 = num15 - num15 / (double) optInTimePeriod;
                double num16 = num4;
                num4 = num16 - num16 / (double) optInTimePeriod;
                if (num14 > 0.0 && num12 < num14)
                  num3 += num14;
                else if (num12 > 0.0 && num12 > num14)
                  num4 += num12;
                double num17 = num6 - num7;
                double num19 = Math.Abs(num6 - num8);
                if (num19 > num17)
                  num17 = num19;
                double num20 = Math.Abs(num7 - num8);
                if (num20 > num17)
                  num17 = num20;
                double num21 = num5;
                num5 = num21 - num21 / (double) optInTimePeriod + num17;
                num8 = (double) inClose[index1];
              }
              else
                break;
            }
            if (-1E-08 >= num5 || num5 >= 1E-08)
            {
              double num10 = 100.0 * (num3 / num5);
              double num11 = 100.0 * (num4 / num5);
              double num12 = num10 + num11;
              outReal[0] = -1E-08 >= num12 || num12 >= 1E-08 ? 100.0 * (Math.Abs(num10 - num11) / num12) : 0.0;
            }
            else
              outReal[0] = 0.0;
            int index2 = 1;
            while (index1 < endIdx)
            {
              ++index1;
              double num10 = (double) inHigh[index1];
              double num11 = num10 - num6;
              num6 = num10;
              double num12 = (double) inLow[index1];
              double num13 = num7 - num12;
              num7 = num12;
              double num14 = num3;
              num3 = num14 - num14 / (double) optInTimePeriod;
              double num15 = num4;
              num4 = num15 - num15 / (double) optInTimePeriod;
              if (num13 > 0.0 && num11 < num13)
                num3 += num13;
              else if (num11 > 0.0 && num11 > num13)
                num4 += num11;
              double num16 = num6 - num7;
              double num17 = Math.Abs(num6 - num8);
              if (num17 > num16)
                num16 = num17;
              double num19 = Math.Abs(num7 - num8);
              if (num19 > num16)
                num16 = num19;
              double num20 = num5;
              num5 = num20 - num20 / (double) optInTimePeriod + num16;
              num8 = (double) inClose[index1];
              if (-1E-08 >= num5 || num5 >= 1E-08)
              {
                double num21 = 100.0 * (num3 / num5);
                double num22 = 100.0 * (num4 / num5);
                double num23 = num21 + num22;
                outReal[index2] = -1E-08 >= num23 || num23 >= 1E-08 ? 100.0 * (Math.Abs(num21 - num22) / num23) : outReal[index2 - 1];
              }
              else
                outReal[index2] = outReal[index2 - 1];
              ++index2;
            }
            outNBElement = index2;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_56:
      return retCode;
    }

    public static Core.RetCode Dx(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_56;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 2 : optInTimePeriod + (int) Core.Globals.unstablePeriod[4];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int num2 = startIdx;
            outBegIdx = num2;
            double num3 = 0.0;
            double num4 = 0.0;
            double num5 = 0.0;
            int index1 = startIdx - num1;
            double num6 = inHigh[index1];
            double num7 = inLow[index1];
            double num8 = inClose[index1];
            int num9 = optInTimePeriod - 1;
            while (true)
            {
              int num10 = num9;
              --num9;
              if (num10 > 0)
              {
                ++index1;
                double num11 = inHigh[index1];
                double num12 = num11 - num6;
                num6 = num11;
                double num13 = inLow[index1];
                double num14 = num7 - num13;
                num7 = num13;
                if (num14 > 0.0 && num12 < num14)
                  num3 += num14;
                else if (num12 > 0.0 && num12 > num14)
                  num4 += num12;
                double num15 = num6 - num7;
                double num16 = Math.Abs(num6 - num8);
                if (num16 > num15)
                  num15 = num16;
                double num17 = Math.Abs(num7 - num8);
                if (num17 > num15)
                  num15 = num17;
                num5 += num15;
                num8 = inClose[index1];
              }
              else
                break;
            }
            int num18 = (int) Core.Globals.unstablePeriod[4] + 1;
            while (true)
            {
              int num10 = num18;
              --num18;
              if (num10 != 0)
              {
                ++index1;
                double num11 = inHigh[index1];
                double num12 = num11 - num6;
                num6 = num11;
                double num13 = inLow[index1];
                double num14 = num7 - num13;
                num7 = num13;
                double num15 = num3;
                num3 = num15 - num15 / (double) optInTimePeriod;
                double num16 = num4;
                num4 = num16 - num16 / (double) optInTimePeriod;
                if (num14 > 0.0 && num12 < num14)
                  num3 += num14;
                else if (num12 > 0.0 && num12 > num14)
                  num4 += num12;
                double num17 = num6 - num7;
                double num19 = Math.Abs(num6 - num8);
                if (num19 > num17)
                  num17 = num19;
                double num20 = Math.Abs(num7 - num8);
                if (num20 > num17)
                  num17 = num20;
                double num21 = num5;
                num5 = num21 - num21 / (double) optInTimePeriod + num17;
                num8 = inClose[index1];
              }
              else
                break;
            }
            if (-1E-08 >= num5 || num5 >= 1E-08)
            {
              double num10 = 100.0 * (num3 / num5);
              double num11 = 100.0 * (num4 / num5);
              double num12 = num10 + num11;
              outReal[0] = -1E-08 >= num12 || num12 >= 1E-08 ? 100.0 * (Math.Abs(num10 - num11) / num12) : 0.0;
            }
            else
              outReal[0] = 0.0;
            int index2 = 1;
            while (index1 < endIdx)
            {
              ++index1;
              double num10 = inHigh[index1];
              double num11 = num10 - num6;
              num6 = num10;
              double num12 = inLow[index1];
              double num13 = num7 - num12;
              num7 = num12;
              double num14 = num3;
              num3 = num14 - num14 / (double) optInTimePeriod;
              double num15 = num4;
              num4 = num15 - num15 / (double) optInTimePeriod;
              if (num13 > 0.0 && num11 < num13)
                num3 += num13;
              else if (num11 > 0.0 && num11 > num13)
                num4 += num11;
              double num16 = num6 - num7;
              double num17 = Math.Abs(num6 - num8);
              if (num17 > num16)
                num16 = num17;
              double num19 = Math.Abs(num7 - num8);
              if (num19 > num16)
                num16 = num19;
              double num20 = num5;
              num5 = num20 - num20 / (double) optInTimePeriod + num16;
              num8 = inClose[index1];
              if (-1E-08 >= num5 || num5 >= 1E-08)
              {
                double num21 = 100.0 * (num3 / num5);
                double num22 = 100.0 * (num4 / num5);
                double num23 = num21 + num22;
                outReal[index2] = -1E-08 >= num23 || num23 >= 1E-08 ? 100.0 * (Math.Abs(num21 - num22) / num23) : outReal[index2 - 1];
              }
              else
                outReal[index2] = outReal[index2 - 1];
              ++index2;
            }
            outNBElement = index2;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_56:
      return retCode;
    }

    public static int EmaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1 + (int) Core.Globals.unstablePeriod[5];
label_5:
      return num;
    }

    public static Core.RetCode Ema(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_11;
        }
        retCode = outReal != null ? Core.TA_INT_EMA(startIdx, endIdx, inReal, optInTimePeriod, 2.0 / (double) (optInTimePeriod + 1), out outBegIdx, out outNBElement, outReal) : Core.RetCode.BadParam;
      }
label_11:
      return retCode;
    }

    public static Core.RetCode Ema(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_11;
        }
        retCode = outReal != null ? Core.TA_INT_EMA(startIdx, endIdx, inReal, optInTimePeriod, 2.0 / (double) (optInTimePeriod + 1), out outBegIdx, out outNBElement, outReal) : Core.RetCode.BadParam;
      }
label_11:
      return retCode;
    }

    public static int ExpLookback()
    {
      return 0;
    }

    public static Core.RetCode Exp(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Exp((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Exp(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Exp(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int FloorLookback()
    {
      return 0;
    }

    public static Core.RetCode Floor(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Floor((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Floor(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Floor(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int HtDcPeriodLookback()
    {
      return (int) Core.Globals.unstablePeriod[6] + 32;
    }

    public static Core.RetCode HtDcPeriod(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double num1 = 180.0 / (4.0 * Math.Atan(1.0));
        int num2 = (int) Core.Globals.unstablePeriod[6] + 32;
        if (startIdx < num2)
          startIdx = num2;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          outBegIdx = startIdx;
          int index1 = startIdx - num2;
          int index2 = index1;
          double num3 = (double) inReal[index2];
          int index3 = index2 + 1;
          double num4 = num3;
          double num5 = num3;
          double num6 = (double) inReal[index3];
          int index4 = index3 + 1;
          double num7 = num4 + num6;
          double num8 = num5 + num6 * 2.0;
          double num9 = (double) inReal[index4];
          int index5 = index4 + 1;
          double num10 = num7 + num9;
          double num11 = num8 + num9 * 3.0;
          double num12 = 0.0;
          int num13 = 9;
          do
          {
            double num14 = (double) inReal[index5];
            ++index5;
            num10 = num10 + num14 - num12;
            double num15 = num11 + num14 * 4.0;
            num12 = (double) inReal[index1];
            ++index1;
            double num16 = num15 * 0.1;
            num11 = num15 - num10;
            --num13;
          }
          while (num13 != 0);
          int index6 = 0;
          numArray1[0] = 0.0;
          numArray1[1] = 0.0;
          numArray1[2] = 0.0;
          numArray2[0] = 0.0;
          numArray2[1] = 0.0;
          numArray2[2] = 0.0;
          double num17 = 0.0;
          double num18 = 0.0;
          double num19 = 0.0;
          double num20 = 0.0;
          numArray3[0] = 0.0;
          numArray3[1] = 0.0;
          numArray3[2] = 0.0;
          numArray4[0] = 0.0;
          numArray4[1] = 0.0;
          numArray4[2] = 0.0;
          double num21 = 0.0;
          double num22 = 0.0;
          double num23 = 0.0;
          double num24 = 0.0;
          numArray5[0] = 0.0;
          numArray5[1] = 0.0;
          numArray5[2] = 0.0;
          numArray6[0] = 0.0;
          numArray6[1] = 0.0;
          numArray6[2] = 0.0;
          double num25 = 0.0;
          double num26 = 0.0;
          double num27 = 0.0;
          double num28 = 0.0;
          numArray7[0] = 0.0;
          numArray7[1] = 0.0;
          numArray7[2] = 0.0;
          numArray8[0] = 0.0;
          numArray8[1] = 0.0;
          numArray8[2] = 0.0;
          double num29 = 0.0;
          double num30 = 0.0;
          double num31 = 0.0;
          double num32 = 0.0;
          double num33 = 0.0;
          int index7 = 0;
          double num34 = 0.0;
          double num35 = num34;
          double num36 = 0.0;
          double num37 = num36;
          double num38 = 0.0;
          double num39 = num38;
          double num40 = 0.0;
          double num41 = num40;
          double num42 = 0.0;
          for (; index5 <= endIdx; ++index5)
          {
            double num14 = 0.075 * num33 + 0.54;
            double num15 = (double) inReal[index5];
            num10 = num10 + num15 - num12;
            double num16 = num11 + num15 * 4.0;
            num12 = (double) inReal[index1];
            ++index1;
            double num43 = num16 * 0.1;
            num11 = num16 - num10;
            double num44;
            double num45;
            if (index5 % 2 == 0)
            {
              double num46 = 0.0962 * num43;
              double num47 = -numArray2[index6];
              numArray2[index6] = num46;
              double num48 = num47 + num46 - num18;
              num18 = 0.5769 * num20;
              double num49 = num48 + num18;
              num20 = num43;
              double num50 = num49 * num14;
              double num51 = 0.0962 * num50;
              double num52 = -numArray4[index6];
              numArray4[index6] = num51;
              double num53 = num52 + num51 - num22;
              num22 = 0.5769 * num24;
              double num54 = num53 + num22;
              num24 = num50;
              double num55 = num54 * num14;
              double num56 = 0.0962 * num38;
              double num57 = -numArray6[index6];
              numArray6[index6] = num56;
              double num58 = num57 + num56 - num26;
              num26 = 0.5769 * num28;
              double num59 = num58 + num26;
              num28 = num38;
              double num60 = num59 * num14;
              double num61 = 0.0962 * num55;
              double num62 = -numArray8[index6];
              numArray8[index6] = num61;
              double num63 = num62 + num61 - num30;
              num30 = 0.5769 * num32;
              double num64 = num63 + num30;
              num32 = num55;
              double num65 = num64 * num14;
              ++index6;
              if (index6 == 3)
                index6 = 0;
              num44 = 0.2 * (num55 + num60) + 0.8 * num34;
              num45 = 0.2 * (num38 - num65) + 0.8 * num35;
              num39 = num41;
              num41 = num50;
            }
            else
            {
              double num46 = 0.0962 * num43;
              double num47 = -numArray1[index6];
              numArray1[index6] = num46;
              double num48 = num47 + num46 - num17;
              num17 = 0.5769 * num19;
              double num49 = num48 + num17;
              num19 = num43;
              double num50 = num49 * num14;
              double num51 = 0.0962 * num50;
              double num52 = -numArray3[index6];
              numArray3[index6] = num51;
              double num53 = num52 + num51 - num21;
              num21 = 0.5769 * num23;
              double num54 = num53 + num21;
              num23 = num50;
              double num55 = num54 * num14;
              double num56 = 0.0962 * num39;
              double num57 = -numArray5[index6];
              numArray5[index6] = num56;
              double num58 = num57 + num56 - num25;
              num25 = 0.5769 * num27;
              double num59 = num58 + num25;
              num27 = num39;
              double num60 = num59 * num14;
              double num61 = 0.0962 * num55;
              double num62 = -numArray7[index6];
              numArray7[index6] = num61;
              double num63 = num62 + num61 - num29;
              num29 = 0.5769 * num31;
              double num64 = num63 + num29;
              num31 = num55;
              double num65 = num64 * num14;
              num44 = 0.2 * (num55 + num60) + 0.8 * num34;
              num45 = 0.2 * (num39 - num65) + 0.8 * num35;
              num38 = num40;
              num40 = num50;
            }
            num37 = 0.2 * (num45 * num35 + num44 * num34) + 0.8 * num37;
            num36 = 0.2 * (num45 * num34 - num44 * num35) + 0.8 * num36;
            num34 = num44;
            num35 = num45;
            double num66 = num33;
            if (num36 != 0.0 && num37 != 0.0)
              num33 = 360.0 / (Math.Atan(num36 / num37) * num1);
            double num67 = 1.5 * num66;
            if (num33 > num67)
              num33 = num67;
            double num68 = 0.67 * num66;
            if (num33 < num68)
              num33 = num68;
            if (num33 < 6.0)
              num33 = 6.0;
            else if (num33 > 50.0)
              num33 = 50.0;
            num33 = 0.2 * num33 + 0.8 * num66;
            num42 = 0.33 * num33 + 0.67 * num42;
            if (index5 >= startIdx)
            {
              outReal[index7] = num42;
              ++index7;
            }
          }
          outNBElement = index7;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode HtDcPeriod(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double num1 = 180.0 / (4.0 * Math.Atan(1.0));
        int num2 = (int) Core.Globals.unstablePeriod[6] + 32;
        if (startIdx < num2)
          startIdx = num2;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          outBegIdx = startIdx;
          int index1 = startIdx - num2;
          int index2 = index1;
          double num3 = inReal[index2];
          int index3 = index2 + 1;
          double num4 = num3;
          double num5 = num3;
          double num6 = inReal[index3];
          int index4 = index3 + 1;
          double num7 = num4 + num6;
          double num8 = num5 + num6 * 2.0;
          double num9 = inReal[index4];
          int index5 = index4 + 1;
          double num10 = num7 + num9;
          double num11 = num8 + num9 * 3.0;
          double num12 = 0.0;
          int num13 = 9;
          do
          {
            double num14 = inReal[index5];
            ++index5;
            num10 = num10 + num14 - num12;
            double num15 = num11 + num14 * 4.0;
            num12 = inReal[index1];
            ++index1;
            double num16 = num15 * 0.1;
            num11 = num15 - num10;
            --num13;
          }
          while (num13 != 0);
          int index6 = 0;
          numArray1[0] = 0.0;
          numArray1[1] = 0.0;
          numArray1[2] = 0.0;
          numArray2[0] = 0.0;
          numArray2[1] = 0.0;
          numArray2[2] = 0.0;
          double num17 = 0.0;
          double num18 = 0.0;
          double num19 = 0.0;
          double num20 = 0.0;
          numArray3[0] = 0.0;
          numArray3[1] = 0.0;
          numArray3[2] = 0.0;
          numArray4[0] = 0.0;
          numArray4[1] = 0.0;
          numArray4[2] = 0.0;
          double num21 = 0.0;
          double num22 = 0.0;
          double num23 = 0.0;
          double num24 = 0.0;
          numArray5[0] = 0.0;
          numArray5[1] = 0.0;
          numArray5[2] = 0.0;
          numArray6[0] = 0.0;
          numArray6[1] = 0.0;
          numArray6[2] = 0.0;
          double num25 = 0.0;
          double num26 = 0.0;
          double num27 = 0.0;
          double num28 = 0.0;
          numArray7[0] = 0.0;
          numArray7[1] = 0.0;
          numArray7[2] = 0.0;
          numArray8[0] = 0.0;
          numArray8[1] = 0.0;
          numArray8[2] = 0.0;
          double num29 = 0.0;
          double num30 = 0.0;
          double num31 = 0.0;
          double num32 = 0.0;
          double num33 = 0.0;
          int index7 = 0;
          double num34 = 0.0;
          double num35 = num34;
          double num36 = 0.0;
          double num37 = num36;
          double num38 = 0.0;
          double num39 = num38;
          double num40 = 0.0;
          double num41 = num40;
          double num42 = 0.0;
          for (; index5 <= endIdx; ++index5)
          {
            double num14 = 0.075 * num33 + 0.54;
            double num15 = inReal[index5];
            num10 = num10 + num15 - num12;
            double num16 = num11 + num15 * 4.0;
            num12 = inReal[index1];
            ++index1;
            double num43 = num16 * 0.1;
            num11 = num16 - num10;
            double num44;
            double num45;
            if (index5 % 2 == 0)
            {
              double num46 = 0.0962 * num43;
              double num47 = -numArray2[index6];
              numArray2[index6] = num46;
              double num48 = num47 + num46 - num18;
              num18 = 0.5769 * num20;
              double num49 = num48 + num18;
              num20 = num43;
              double num50 = num49 * num14;
              double num51 = 0.0962 * num50;
              double num52 = -numArray4[index6];
              numArray4[index6] = num51;
              double num53 = num52 + num51 - num22;
              num22 = 0.5769 * num24;
              double num54 = num53 + num22;
              num24 = num50;
              double num55 = num54 * num14;
              double num56 = 0.0962 * num38;
              double num57 = -numArray6[index6];
              numArray6[index6] = num56;
              double num58 = num57 + num56 - num26;
              num26 = 0.5769 * num28;
              double num59 = num58 + num26;
              num28 = num38;
              double num60 = num59 * num14;
              double num61 = 0.0962 * num55;
              double num62 = -numArray8[index6];
              numArray8[index6] = num61;
              double num63 = num62 + num61 - num30;
              num30 = 0.5769 * num32;
              double num64 = num63 + num30;
              num32 = num55;
              double num65 = num64 * num14;
              ++index6;
              if (index6 == 3)
                index6 = 0;
              num44 = 0.2 * (num55 + num60) + 0.8 * num34;
              num45 = 0.2 * (num38 - num65) + 0.8 * num35;
              num39 = num41;
              num41 = num50;
            }
            else
            {
              double num46 = 0.0962 * num43;
              double num47 = -numArray1[index6];
              numArray1[index6] = num46;
              double num48 = num47 + num46 - num17;
              num17 = 0.5769 * num19;
              double num49 = num48 + num17;
              num19 = num43;
              double num50 = num49 * num14;
              double num51 = 0.0962 * num50;
              double num52 = -numArray3[index6];
              numArray3[index6] = num51;
              double num53 = num52 + num51 - num21;
              num21 = 0.5769 * num23;
              double num54 = num53 + num21;
              num23 = num50;
              double num55 = num54 * num14;
              double num56 = 0.0962 * num39;
              double num57 = -numArray5[index6];
              numArray5[index6] = num56;
              double num58 = num57 + num56 - num25;
              num25 = 0.5769 * num27;
              double num59 = num58 + num25;
              num27 = num39;
              double num60 = num59 * num14;
              double num61 = 0.0962 * num55;
              double num62 = -numArray7[index6];
              numArray7[index6] = num61;
              double num63 = num62 + num61 - num29;
              num29 = 0.5769 * num31;
              double num64 = num63 + num29;
              num31 = num55;
              double num65 = num64 * num14;
              num44 = 0.2 * (num55 + num60) + 0.8 * num34;
              num45 = 0.2 * (num39 - num65) + 0.8 * num35;
              num38 = num40;
              num40 = num50;
            }
            num37 = 0.2 * (num45 * num35 + num44 * num34) + 0.8 * num37;
            num36 = 0.2 * (num45 * num34 - num44 * num35) + 0.8 * num36;
            num34 = num44;
            num35 = num45;
            double num66 = num33;
            if (num36 != 0.0 && num37 != 0.0)
              num33 = 360.0 / (Math.Atan(num36 / num37) * num1);
            double num67 = 1.5 * num66;
            if (num33 > num67)
              num33 = num67;
            double num68 = 0.67 * num66;
            if (num33 < num68)
              num33 = num68;
            if (num33 < 6.0)
              num33 = 6.0;
            else if (num33 > 50.0)
              num33 = 50.0;
            num33 = 0.2 * num33 + 0.8 * num66;
            num42 = 0.33 * num33 + 0.67 * num42;
            if (index5 >= startIdx)
            {
              outReal[index7] = num42;
              ++index7;
            }
          }
          outNBElement = index7;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int HtDcPhaseLookback()
    {
      return (int) Core.Globals.unstablePeriod[7] + 63;
    }

    public static Core.RetCode HtDcPhase(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = Math.Atan(1.0);
          double num3 = 45.0 / num2;
          double num4 = num2 * 8.0;
          int num5 = (int) Core.Globals.unstablePeriod[7] + 63;
          if (startIdx < num5)
            startIdx = num5;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num5;
            int index3 = index2;
            double num6 = (double) inReal[index3];
            int index4 = index3 + 1;
            double num7 = num6;
            double num8 = num6;
            double num9 = (double) inReal[index4];
            int index5 = index4 + 1;
            double num10 = num7 + num9;
            double num11 = num8 + num9 * 2.0;
            double num12 = (double) inReal[index5];
            int index6 = index5 + 1;
            double num13 = num10 + num12;
            double num14 = num11 + num12 * 3.0;
            double num15 = 0.0;
            int num16 = 34;
            do
            {
              double num17 = (double) inReal[index6];
              ++index6;
              num13 = num13 + num17 - num15;
              double num18 = num14 + num17 * 4.0;
              num15 = (double) inReal[index2];
              ++index2;
              double num19 = num18 * 0.1;
              num14 = num18 - num13;
              --num16;
            }
            while (num16 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num20 = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num24 = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num28 = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num32 = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            int index8 = 0;
            double num37 = 0.0;
            double num38 = num37;
            double num39 = 0.0;
            double num40 = num39;
            double num41 = 0.0;
            double num42 = num41;
            double num43 = 0.0;
            double num44 = num43;
            double num45 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            double num46 = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num17 = 0.075 * num36 + 0.54;
              double num18 = (double) inReal[index6];
              num13 = num13 + num18 - num15;
              double num19 = num14 + num18 * 4.0;
              num15 = (double) inReal[index2];
              ++index2;
              double num47 = num19 * 0.1;
              num14 = num19 - num13;
              numArray9[index1] = num47;
              double num48;
              double num49;
              if (index6 % 2 == 0)
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray2[index7];
                numArray2[index7] = num50;
                double num52 = num51 + num50 - num21;
                num21 = 0.5769 * num23;
                double num53 = num52 + num21;
                num23 = num47;
                double num54 = num53 * num17;
                double num55 = 0.0962 * num54;
                double num56 = -numArray4[index7];
                numArray4[index7] = num55;
                double num57 = num56 + num55 - num25;
                num25 = 0.5769 * num27;
                double num58 = num57 + num25;
                num27 = num54;
                double num59 = num58 * num17;
                double num60 = 0.0962 * num41;
                double num61 = -numArray6[index7];
                numArray6[index7] = num60;
                double num62 = num61 + num60 - num29;
                num29 = 0.5769 * num31;
                double num63 = num62 + num29;
                num31 = num41;
                double num64 = num63 * num17;
                double num65 = 0.0962 * num59;
                double num66 = -numArray8[index7];
                numArray8[index7] = num65;
                double num67 = num66 + num65 - num33;
                num33 = 0.5769 * num35;
                double num68 = num67 + num33;
                num35 = num59;
                double num69 = num68 * num17;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num48 = 0.2 * (num59 + num64) + 0.8 * num37;
                num49 = 0.2 * (num41 - num69) + 0.8 * num38;
                num42 = num44;
                num44 = num54;
              }
              else
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray1[index7];
                numArray1[index7] = num50;
                double num52 = num51 + num50 - num20;
                num20 = 0.5769 * num22;
                double num53 = num52 + num20;
                num22 = num47;
                double num54 = num53 * num17;
                double num55 = 0.0962 * num54;
                double num56 = -numArray3[index7];
                numArray3[index7] = num55;
                double num57 = num56 + num55 - num24;
                num24 = 0.5769 * num26;
                double num58 = num57 + num24;
                num26 = num54;
                double num59 = num58 * num17;
                double num60 = 0.0962 * num42;
                double num61 = -numArray5[index7];
                numArray5[index7] = num60;
                double num62 = num61 + num60 - num28;
                num28 = 0.5769 * num30;
                double num63 = num62 + num28;
                num30 = num42;
                double num64 = num63 * num17;
                double num65 = 0.0962 * num59;
                double num66 = -numArray7[index7];
                numArray7[index7] = num65;
                double num67 = num66 + num65 - num32;
                num32 = 0.5769 * num34;
                double num68 = num67 + num32;
                num34 = num59;
                double num69 = num68 * num17;
                num48 = 0.2 * (num59 + num64) + 0.8 * num37;
                num49 = 0.2 * (num42 - num69) + 0.8 * num38;
                num41 = num43;
                num43 = num54;
              }
              num40 = 0.2 * (num49 * num38 + num48 * num37) + 0.8 * num40;
              num39 = 0.2 * (num49 * num37 - num48 * num38) + 0.8 * num39;
              num37 = num48;
              num38 = num49;
              double num70 = num36;
              if (num39 != 0.0 && num40 != 0.0)
                num36 = 360.0 / (Math.Atan(num39 / num40) * num3);
              double num71 = 1.5 * num70;
              if (num36 > num71)
                num36 = num71;
              double num72 = 0.67 * num70;
              if (num36 < num72)
                num36 = num72;
              if (num36 < 6.0)
                num36 = 6.0;
              else if (num36 > 50.0)
                num36 = 50.0;
              num36 = 0.2 * num36 + 0.8 * num70;
              num45 = 0.33 * num36 + 0.67 * num45;
              int num73 = (int) (num45 + 0.5);
              double num74 = 0.0;
              double num75 = 0.0;
              int index9 = index1;
              for (int index10 = 0; index10 < num73; ++index10)
              {
                double num50 = (double) index10 * num4 / (double) num73;
                double num51 = numArray9[index9];
                num74 += Math.Sin(num50) * num51;
                num75 += Math.Cos(num50) * num51;
                if (index9 != 0)
                  goto label_41;
                index9 = 49;
                continue;
label_41:
                --index9;
              }
              double num76 = Math.Abs(num75);
              if (num76 > 0.0)
                num46 = Math.Atan(num74 / num75) * num3;
              else if (num76 <= 0.01)
              {
                if (num74 < 0.0)
                  num46 -= 90.0;
                else if (num74 > 0.0)
                  num46 += 90.0;
              }
              num46 = num46 + 90.0 + 360.0 / num45;
              if (num75 < 0.0)
                num46 += 180.0;
              if (num46 > 315.0)
                num46 -= 360.0;
              if (index6 >= startIdx)
              {
                outReal[index8] = num46;
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static Core.RetCode HtDcPhase(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = Math.Atan(1.0);
          double num3 = 45.0 / num2;
          double num4 = num2 * 8.0;
          int num5 = (int) Core.Globals.unstablePeriod[7] + 63;
          if (startIdx < num5)
            startIdx = num5;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num5;
            int index3 = index2;
            double num6 = inReal[index3];
            int index4 = index3 + 1;
            double num7 = num6;
            double num8 = num6;
            double num9 = inReal[index4];
            int index5 = index4 + 1;
            double num10 = num7 + num9;
            double num11 = num8 + num9 * 2.0;
            double num12 = inReal[index5];
            int index6 = index5 + 1;
            double num13 = num10 + num12;
            double num14 = num11 + num12 * 3.0;
            double num15 = 0.0;
            int num16 = 34;
            do
            {
              double num17 = inReal[index6];
              ++index6;
              num13 = num13 + num17 - num15;
              double num18 = num14 + num17 * 4.0;
              num15 = inReal[index2];
              ++index2;
              double num19 = num18 * 0.1;
              num14 = num18 - num13;
              --num16;
            }
            while (num16 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num20 = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num24 = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num28 = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num32 = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            int index8 = 0;
            double num37 = 0.0;
            double num38 = num37;
            double num39 = 0.0;
            double num40 = num39;
            double num41 = 0.0;
            double num42 = num41;
            double num43 = 0.0;
            double num44 = num43;
            double num45 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            double num46 = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num17 = 0.075 * num36 + 0.54;
              double num18 = inReal[index6];
              num13 = num13 + num18 - num15;
              double num19 = num14 + num18 * 4.0;
              num15 = inReal[index2];
              ++index2;
              double num47 = num19 * 0.1;
              num14 = num19 - num13;
              numArray9[index1] = num47;
              double num48;
              double num49;
              if (index6 % 2 == 0)
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray2[index7];
                numArray2[index7] = num50;
                double num52 = num51 + num50 - num21;
                num21 = 0.5769 * num23;
                double num53 = num52 + num21;
                num23 = num47;
                double num54 = num53 * num17;
                double num55 = 0.0962 * num54;
                double num56 = -numArray4[index7];
                numArray4[index7] = num55;
                double num57 = num56 + num55 - num25;
                num25 = 0.5769 * num27;
                double num58 = num57 + num25;
                num27 = num54;
                double num59 = num58 * num17;
                double num60 = 0.0962 * num41;
                double num61 = -numArray6[index7];
                numArray6[index7] = num60;
                double num62 = num61 + num60 - num29;
                num29 = 0.5769 * num31;
                double num63 = num62 + num29;
                num31 = num41;
                double num64 = num63 * num17;
                double num65 = 0.0962 * num59;
                double num66 = -numArray8[index7];
                numArray8[index7] = num65;
                double num67 = num66 + num65 - num33;
                num33 = 0.5769 * num35;
                double num68 = num67 + num33;
                num35 = num59;
                double num69 = num68 * num17;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num48 = 0.2 * (num59 + num64) + 0.8 * num37;
                num49 = 0.2 * (num41 - num69) + 0.8 * num38;
                num42 = num44;
                num44 = num54;
              }
              else
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray1[index7];
                numArray1[index7] = num50;
                double num52 = num51 + num50 - num20;
                num20 = 0.5769 * num22;
                double num53 = num52 + num20;
                num22 = num47;
                double num54 = num53 * num17;
                double num55 = 0.0962 * num54;
                double num56 = -numArray3[index7];
                numArray3[index7] = num55;
                double num57 = num56 + num55 - num24;
                num24 = 0.5769 * num26;
                double num58 = num57 + num24;
                num26 = num54;
                double num59 = num58 * num17;
                double num60 = 0.0962 * num42;
                double num61 = -numArray5[index7];
                numArray5[index7] = num60;
                double num62 = num61 + num60 - num28;
                num28 = 0.5769 * num30;
                double num63 = num62 + num28;
                num30 = num42;
                double num64 = num63 * num17;
                double num65 = 0.0962 * num59;
                double num66 = -numArray7[index7];
                numArray7[index7] = num65;
                double num67 = num66 + num65 - num32;
                num32 = 0.5769 * num34;
                double num68 = num67 + num32;
                num34 = num59;
                double num69 = num68 * num17;
                num48 = 0.2 * (num59 + num64) + 0.8 * num37;
                num49 = 0.2 * (num42 - num69) + 0.8 * num38;
                num41 = num43;
                num43 = num54;
              }
              num40 = 0.2 * (num49 * num38 + num48 * num37) + 0.8 * num40;
              num39 = 0.2 * (num49 * num37 - num48 * num38) + 0.8 * num39;
              num37 = num48;
              num38 = num49;
              double num70 = num36;
              if (num39 != 0.0 && num40 != 0.0)
                num36 = 360.0 / (Math.Atan(num39 / num40) * num3);
              double num71 = 1.5 * num70;
              if (num36 > num71)
                num36 = num71;
              double num72 = 0.67 * num70;
              if (num36 < num72)
                num36 = num72;
              if (num36 < 6.0)
                num36 = 6.0;
              else if (num36 > 50.0)
                num36 = 50.0;
              num36 = 0.2 * num36 + 0.8 * num70;
              num45 = 0.33 * num36 + 0.67 * num45;
              int num73 = (int) (num45 + 0.5);
              double num74 = 0.0;
              double num75 = 0.0;
              int index9 = index1;
              for (int index10 = 0; index10 < num73; ++index10)
              {
                double num50 = (double) index10 * num4 / (double) num73;
                double num51 = numArray9[index9];
                num74 += Math.Sin(num50) * num51;
                num75 += Math.Cos(num50) * num51;
                if (index9 != 0)
                  goto label_41;
                index9 = 49;
                continue;
label_41:
                --index9;
              }
              double num76 = Math.Abs(num75);
              if (num76 > 0.0)
                num46 = Math.Atan(num74 / num75) * num3;
              else if (num76 <= 0.01)
              {
                if (num74 < 0.0)
                  num46 -= 90.0;
                else if (num74 > 0.0)
                  num46 += 90.0;
              }
              num46 = num46 + 90.0 + 360.0 / num45;
              if (num75 < 0.0)
                num46 += 180.0;
              if (num46 > 315.0)
                num46 -= 360.0;
              if (index6 >= startIdx)
              {
                outReal[index8] = num46;
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static int HtPhasorLookback()
    {
      return (int) Core.Globals.unstablePeriod[8] + 32;
    }

    public static Core.RetCode HtPhasor(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outInPhase,
      double[] outQuadrature)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outInPhase == null)
        retCode = Core.RetCode.BadParam;
      else if (outQuadrature == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double num1 = 180.0 / (4.0 * Math.Atan(1.0));
        int num2 = (int) Core.Globals.unstablePeriod[8] + 32;
        if (startIdx < num2)
          startIdx = num2;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          outBegIdx = startIdx;
          int index1 = startIdx - num2;
          int index2 = index1;
          double num3 = (double) inReal[index2];
          int index3 = index2 + 1;
          double num4 = num3;
          double num5 = num3;
          double num6 = (double) inReal[index3];
          int index4 = index3 + 1;
          double num7 = num4 + num6;
          double num8 = num5 + num6 * 2.0;
          double num9 = (double) inReal[index4];
          int index5 = index4 + 1;
          double num10 = num7 + num9;
          double num11 = num8 + num9 * 3.0;
          double num12 = 0.0;
          int num13 = 9;
          do
          {
            double num14 = (double) inReal[index5];
            ++index5;
            num10 = num10 + num14 - num12;
            double num15 = num11 + num14 * 4.0;
            num12 = (double) inReal[index1];
            ++index1;
            double num16 = num15 * 0.1;
            num11 = num15 - num10;
            --num13;
          }
          while (num13 != 0);
          int index6 = 0;
          numArray1[0] = 0.0;
          numArray1[1] = 0.0;
          numArray1[2] = 0.0;
          numArray2[0] = 0.0;
          numArray2[1] = 0.0;
          numArray2[2] = 0.0;
          double num17 = 0.0;
          double num18 = 0.0;
          double num19 = 0.0;
          double num20 = 0.0;
          numArray3[0] = 0.0;
          numArray3[1] = 0.0;
          numArray3[2] = 0.0;
          numArray4[0] = 0.0;
          numArray4[1] = 0.0;
          numArray4[2] = 0.0;
          double num21 = 0.0;
          double num22 = 0.0;
          double num23 = 0.0;
          double num24 = 0.0;
          numArray5[0] = 0.0;
          numArray5[1] = 0.0;
          numArray5[2] = 0.0;
          numArray6[0] = 0.0;
          numArray6[1] = 0.0;
          numArray6[2] = 0.0;
          double num25 = 0.0;
          double num26 = 0.0;
          double num27 = 0.0;
          double num28 = 0.0;
          numArray7[0] = 0.0;
          numArray7[1] = 0.0;
          numArray7[2] = 0.0;
          numArray8[0] = 0.0;
          numArray8[1] = 0.0;
          numArray8[2] = 0.0;
          double num29 = 0.0;
          double num30 = 0.0;
          double num31 = 0.0;
          double num32 = 0.0;
          double num33 = 0.0;
          int index7 = 0;
          double num34 = 0.0;
          double num35 = num34;
          double num36 = 0.0;
          double num37 = num36;
          double num38 = 0.0;
          double num39 = num38;
          double num40 = 0.0;
          double num41 = num40;
          for (; index5 <= endIdx; ++index5)
          {
            double num14 = 0.075 * num33 + 0.54;
            double num15 = (double) inReal[index5];
            num10 = num10 + num15 - num12;
            double num16 = num11 + num15 * 4.0;
            num12 = (double) inReal[index1];
            ++index1;
            double num42 = num16 * 0.1;
            num11 = num16 - num10;
            double num43;
            double num44;
            if (index5 % 2 == 0)
            {
              double num45 = 0.0962 * num42;
              double num46 = -numArray2[index6];
              numArray2[index6] = num45;
              double num47 = num46 + num45 - num18;
              num18 = 0.5769 * num20;
              double num48 = num47 + num18;
              num20 = num42;
              double num49 = num48 * num14;
              double num50 = 0.0962 * num49;
              double num51 = -numArray4[index6];
              numArray4[index6] = num50;
              double num52 = num51 + num50 - num22;
              num22 = 0.5769 * num24;
              double num53 = num52 + num22;
              num24 = num49;
              double num54 = num53 * num14;
              if (index5 >= startIdx)
              {
                outQuadrature[index7] = num54;
                outInPhase[index7] = num38;
                ++index7;
              }
              double num55 = 0.0962 * num38;
              double num56 = -numArray6[index6];
              numArray6[index6] = num55;
              double num57 = num56 + num55 - num26;
              num26 = 0.5769 * num28;
              double num58 = num57 + num26;
              num28 = num38;
              double num59 = num58 * num14;
              double num60 = 0.0962 * num54;
              double num61 = -numArray8[index6];
              numArray8[index6] = num60;
              double num62 = num61 + num60 - num30;
              num30 = 0.5769 * num32;
              double num63 = num62 + num30;
              num32 = num54;
              double num64 = num63 * num14;
              ++index6;
              if (index6 == 3)
                index6 = 0;
              num43 = 0.2 * (num54 + num59) + 0.8 * num34;
              num44 = 0.2 * (num38 - num64) + 0.8 * num35;
              num39 = num41;
              num41 = num49;
            }
            else
            {
              double num45 = 0.0962 * num42;
              double num46 = -numArray1[index6];
              numArray1[index6] = num45;
              double num47 = num46 + num45 - num17;
              num17 = 0.5769 * num19;
              double num48 = num47 + num17;
              num19 = num42;
              double num49 = num48 * num14;
              double num50 = 0.0962 * num49;
              double num51 = -numArray3[index6];
              numArray3[index6] = num50;
              double num52 = num51 + num50 - num21;
              num21 = 0.5769 * num23;
              double num53 = num52 + num21;
              num23 = num49;
              double num54 = num53 * num14;
              if (index5 >= startIdx)
              {
                outQuadrature[index7] = num54;
                outInPhase[index7] = num39;
                ++index7;
              }
              double num55 = 0.0962 * num39;
              double num56 = -numArray5[index6];
              numArray5[index6] = num55;
              double num57 = num56 + num55 - num25;
              num25 = 0.5769 * num27;
              double num58 = num57 + num25;
              num27 = num39;
              double num59 = num58 * num14;
              double num60 = 0.0962 * num54;
              double num61 = -numArray7[index6];
              numArray7[index6] = num60;
              double num62 = num61 + num60 - num29;
              num29 = 0.5769 * num31;
              double num63 = num62 + num29;
              num31 = num54;
              double num64 = num63 * num14;
              num43 = 0.2 * (num54 + num59) + 0.8 * num34;
              num44 = 0.2 * (num39 - num64) + 0.8 * num35;
              num38 = num40;
              num40 = num49;
            }
            num37 = 0.2 * (num44 * num35 + num43 * num34) + 0.8 * num37;
            num36 = 0.2 * (num44 * num34 - num43 * num35) + 0.8 * num36;
            num34 = num43;
            num35 = num44;
            double num65 = num33;
            if (num36 != 0.0 && num37 != 0.0)
              num33 = 360.0 / (Math.Atan(num36 / num37) * num1);
            double num66 = 1.5 * num65;
            if (num33 > num66)
              num33 = num66;
            double num67 = 0.67 * num65;
            if (num33 < num67)
              num33 = num67;
            if (num33 < 6.0)
              num33 = 6.0;
            else if (num33 > 50.0)
              num33 = 50.0;
            num33 = 0.2 * num33 + 0.8 * num65;
          }
          outNBElement = index7;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode HtPhasor(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outInPhase,
      double[] outQuadrature)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outInPhase == null)
        retCode = Core.RetCode.BadParam;
      else if (outQuadrature == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double num1 = 180.0 / (4.0 * Math.Atan(1.0));
        int num2 = (int) Core.Globals.unstablePeriod[8] + 32;
        if (startIdx < num2)
          startIdx = num2;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          outBegIdx = startIdx;
          int index1 = startIdx - num2;
          int index2 = index1;
          double num3 = inReal[index2];
          int index3 = index2 + 1;
          double num4 = num3;
          double num5 = num3;
          double num6 = inReal[index3];
          int index4 = index3 + 1;
          double num7 = num4 + num6;
          double num8 = num5 + num6 * 2.0;
          double num9 = inReal[index4];
          int index5 = index4 + 1;
          double num10 = num7 + num9;
          double num11 = num8 + num9 * 3.0;
          double num12 = 0.0;
          int num13 = 9;
          do
          {
            double num14 = inReal[index5];
            ++index5;
            num10 = num10 + num14 - num12;
            double num15 = num11 + num14 * 4.0;
            num12 = inReal[index1];
            ++index1;
            double num16 = num15 * 0.1;
            num11 = num15 - num10;
            --num13;
          }
          while (num13 != 0);
          int index6 = 0;
          numArray1[0] = 0.0;
          numArray1[1] = 0.0;
          numArray1[2] = 0.0;
          numArray2[0] = 0.0;
          numArray2[1] = 0.0;
          numArray2[2] = 0.0;
          double num17 = 0.0;
          double num18 = 0.0;
          double num19 = 0.0;
          double num20 = 0.0;
          numArray3[0] = 0.0;
          numArray3[1] = 0.0;
          numArray3[2] = 0.0;
          numArray4[0] = 0.0;
          numArray4[1] = 0.0;
          numArray4[2] = 0.0;
          double num21 = 0.0;
          double num22 = 0.0;
          double num23 = 0.0;
          double num24 = 0.0;
          numArray5[0] = 0.0;
          numArray5[1] = 0.0;
          numArray5[2] = 0.0;
          numArray6[0] = 0.0;
          numArray6[1] = 0.0;
          numArray6[2] = 0.0;
          double num25 = 0.0;
          double num26 = 0.0;
          double num27 = 0.0;
          double num28 = 0.0;
          numArray7[0] = 0.0;
          numArray7[1] = 0.0;
          numArray7[2] = 0.0;
          numArray8[0] = 0.0;
          numArray8[1] = 0.0;
          numArray8[2] = 0.0;
          double num29 = 0.0;
          double num30 = 0.0;
          double num31 = 0.0;
          double num32 = 0.0;
          double num33 = 0.0;
          int index7 = 0;
          double num34 = 0.0;
          double num35 = num34;
          double num36 = 0.0;
          double num37 = num36;
          double num38 = 0.0;
          double num39 = num38;
          double num40 = 0.0;
          double num41 = num40;
          for (; index5 <= endIdx; ++index5)
          {
            double num14 = 0.075 * num33 + 0.54;
            double num15 = inReal[index5];
            num10 = num10 + num15 - num12;
            double num16 = num11 + num15 * 4.0;
            num12 = inReal[index1];
            ++index1;
            double num42 = num16 * 0.1;
            num11 = num16 - num10;
            double num43;
            double num44;
            if (index5 % 2 == 0)
            {
              double num45 = 0.0962 * num42;
              double num46 = -numArray2[index6];
              numArray2[index6] = num45;
              double num47 = num46 + num45 - num18;
              num18 = 0.5769 * num20;
              double num48 = num47 + num18;
              num20 = num42;
              double num49 = num48 * num14;
              double num50 = 0.0962 * num49;
              double num51 = -numArray4[index6];
              numArray4[index6] = num50;
              double num52 = num51 + num50 - num22;
              num22 = 0.5769 * num24;
              double num53 = num52 + num22;
              num24 = num49;
              double num54 = num53 * num14;
              if (index5 >= startIdx)
              {
                outQuadrature[index7] = num54;
                outInPhase[index7] = num38;
                ++index7;
              }
              double num55 = 0.0962 * num38;
              double num56 = -numArray6[index6];
              numArray6[index6] = num55;
              double num57 = num56 + num55 - num26;
              num26 = 0.5769 * num28;
              double num58 = num57 + num26;
              num28 = num38;
              double num59 = num58 * num14;
              double num60 = 0.0962 * num54;
              double num61 = -numArray8[index6];
              numArray8[index6] = num60;
              double num62 = num61 + num60 - num30;
              num30 = 0.5769 * num32;
              double num63 = num62 + num30;
              num32 = num54;
              double num64 = num63 * num14;
              ++index6;
              if (index6 == 3)
                index6 = 0;
              num43 = 0.2 * (num54 + num59) + 0.8 * num34;
              num44 = 0.2 * (num38 - num64) + 0.8 * num35;
              num39 = num41;
              num41 = num49;
            }
            else
            {
              double num45 = 0.0962 * num42;
              double num46 = -numArray1[index6];
              numArray1[index6] = num45;
              double num47 = num46 + num45 - num17;
              num17 = 0.5769 * num19;
              double num48 = num47 + num17;
              num19 = num42;
              double num49 = num48 * num14;
              double num50 = 0.0962 * num49;
              double num51 = -numArray3[index6];
              numArray3[index6] = num50;
              double num52 = num51 + num50 - num21;
              num21 = 0.5769 * num23;
              double num53 = num52 + num21;
              num23 = num49;
              double num54 = num53 * num14;
              if (index5 >= startIdx)
              {
                outQuadrature[index7] = num54;
                outInPhase[index7] = num39;
                ++index7;
              }
              double num55 = 0.0962 * num39;
              double num56 = -numArray5[index6];
              numArray5[index6] = num55;
              double num57 = num56 + num55 - num25;
              num25 = 0.5769 * num27;
              double num58 = num57 + num25;
              num27 = num39;
              double num59 = num58 * num14;
              double num60 = 0.0962 * num54;
              double num61 = -numArray7[index6];
              numArray7[index6] = num60;
              double num62 = num61 + num60 - num29;
              num29 = 0.5769 * num31;
              double num63 = num62 + num29;
              num31 = num54;
              double num64 = num63 * num14;
              num43 = 0.2 * (num54 + num59) + 0.8 * num34;
              num44 = 0.2 * (num39 - num64) + 0.8 * num35;
              num38 = num40;
              num40 = num49;
            }
            num37 = 0.2 * (num44 * num35 + num43 * num34) + 0.8 * num37;
            num36 = 0.2 * (num44 * num34 - num43 * num35) + 0.8 * num36;
            num34 = num43;
            num35 = num44;
            double num65 = num33;
            if (num36 != 0.0 && num37 != 0.0)
              num33 = 360.0 / (Math.Atan(num36 / num37) * num1);
            double num66 = 1.5 * num65;
            if (num33 > num66)
              num33 = num66;
            double num67 = 0.67 * num65;
            if (num33 < num67)
              num33 = num67;
            if (num33 < 6.0)
              num33 = 6.0;
            else if (num33 > 50.0)
              num33 = 50.0;
            num33 = 0.2 * num33 + 0.8 * num65;
          }
          outNBElement = index7;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int HtSineLookback()
    {
      return (int) Core.Globals.unstablePeriod[9] + 63;
    }

    public static Core.RetCode HtSine(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outSine,
      double[] outLeadSine)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outSine == null)
        retCode = Core.RetCode.BadParam;
      else if (outLeadSine == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = Math.Atan(1.0);
          double num3 = 45.0 / num2;
          double num4 = 1.0 / num3;
          double num5 = num2 * 8.0;
          int num6 = (int) Core.Globals.unstablePeriod[9] + 63;
          if (startIdx < num6)
            startIdx = num6;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num6;
            int index3 = index2;
            double num7 = (double) inReal[index3];
            int index4 = index3 + 1;
            double num8 = num7;
            double num9 = num7;
            double num10 = (double) inReal[index4];
            int index5 = index4 + 1;
            double num11 = num8 + num10;
            double num12 = num9 + num10 * 2.0;
            double num13 = (double) inReal[index5];
            int index6 = index5 + 1;
            double num14 = num11 + num13;
            double num15 = num12 + num13 * 3.0;
            double num16 = 0.0;
            int num17 = 34;
            do
            {
              double num18 = (double) inReal[index6];
              ++index6;
              num14 = num14 + num18 - num16;
              double num19 = num15 + num18 * 4.0;
              num16 = (double) inReal[index2];
              ++index2;
              double num20 = num19 * 0.1;
              num15 = num19 - num14;
              --num17;
            }
            while (num17 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            double num24 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            double num37 = 0.0;
            int index8 = 0;
            double num38 = 0.0;
            double num39 = num38;
            double num40 = 0.0;
            double num41 = num40;
            double num42 = 0.0;
            double num43 = num42;
            double num44 = 0.0;
            double num45 = num44;
            double num46 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            double num47 = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num18 = 0.075 * num37 + 0.54;
              double num19 = (double) inReal[index6];
              num14 = num14 + num19 - num16;
              double num20 = num15 + num19 * 4.0;
              num16 = (double) inReal[index2];
              ++index2;
              double num48 = num20 * 0.1;
              num15 = num20 - num14;
              numArray9[index1] = num48;
              double num49;
              double num50;
              if (index6 % 2 == 0)
              {
                double num51 = 0.0962 * num48;
                double num52 = -numArray2[index7];
                numArray2[index7] = num51;
                double num53 = num52 + num51 - num22;
                num22 = 0.5769 * num24;
                double num54 = num53 + num22;
                num24 = num48;
                double num55 = num54 * num18;
                double num56 = 0.0962 * num55;
                double num57 = -numArray4[index7];
                numArray4[index7] = num56;
                double num58 = num57 + num56 - num26;
                num26 = 0.5769 * num28;
                double num59 = num58 + num26;
                num28 = num55;
                double num60 = num59 * num18;
                double num61 = 0.0962 * num42;
                double num62 = -numArray6[index7];
                numArray6[index7] = num61;
                double num63 = num62 + num61 - num30;
                num30 = 0.5769 * num32;
                double num64 = num63 + num30;
                num32 = num42;
                double num65 = num64 * num18;
                double num66 = 0.0962 * num60;
                double num67 = -numArray8[index7];
                numArray8[index7] = num66;
                double num68 = num67 + num66 - num34;
                num34 = 0.5769 * num36;
                double num69 = num68 + num34;
                num36 = num60;
                double num70 = num69 * num18;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num49 = 0.2 * (num60 + num65) + 0.8 * num38;
                num50 = 0.2 * (num42 - num70) + 0.8 * num39;
                num43 = num45;
                num45 = num55;
              }
              else
              {
                double num51 = 0.0962 * num48;
                double num52 = -numArray1[index7];
                numArray1[index7] = num51;
                double num53 = num52 + num51 - num21;
                num21 = 0.5769 * num23;
                double num54 = num53 + num21;
                num23 = num48;
                double num55 = num54 * num18;
                double num56 = 0.0962 * num55;
                double num57 = -numArray3[index7];
                numArray3[index7] = num56;
                double num58 = num57 + num56 - num25;
                num25 = 0.5769 * num27;
                double num59 = num58 + num25;
                num27 = num55;
                double num60 = num59 * num18;
                double num61 = 0.0962 * num43;
                double num62 = -numArray5[index7];
                numArray5[index7] = num61;
                double num63 = num62 + num61 - num29;
                num29 = 0.5769 * num31;
                double num64 = num63 + num29;
                num31 = num43;
                double num65 = num64 * num18;
                double num66 = 0.0962 * num60;
                double num67 = -numArray7[index7];
                numArray7[index7] = num66;
                double num68 = num67 + num66 - num33;
                num33 = 0.5769 * num35;
                double num69 = num68 + num33;
                num35 = num60;
                double num70 = num69 * num18;
                num49 = 0.2 * (num60 + num65) + 0.8 * num38;
                num50 = 0.2 * (num43 - num70) + 0.8 * num39;
                num42 = num44;
                num44 = num55;
              }
              num41 = 0.2 * (num50 * num39 + num49 * num38) + 0.8 * num41;
              num40 = 0.2 * (num50 * num38 - num49 * num39) + 0.8 * num40;
              num38 = num49;
              num39 = num50;
              double num71 = num37;
              if (num40 != 0.0 && num41 != 0.0)
                num37 = 360.0 / (Math.Atan(num40 / num41) * num3);
              double num72 = 1.5 * num71;
              if (num37 > num72)
                num37 = num72;
              double num73 = 0.67 * num71;
              if (num37 < num73)
                num37 = num73;
              if (num37 < 6.0)
                num37 = 6.0;
              else if (num37 > 50.0)
                num37 = 50.0;
              num37 = 0.2 * num37 + 0.8 * num71;
              num46 = 0.33 * num37 + 0.67 * num46;
              int num74 = (int) (num46 + 0.5);
              double num75 = 0.0;
              double num76 = 0.0;
              int index9 = index1;
              for (int index10 = 0; index10 < num74; ++index10)
              {
                double num51 = (double) index10 * num5 / (double) num74;
                double num52 = numArray9[index9];
                num75 += Math.Sin(num51) * num52;
                num76 += Math.Cos(num51) * num52;
                if (index9 != 0)
                  goto label_43;
                index9 = 49;
                continue;
label_43:
                --index9;
              }
              double num77 = Math.Abs(num76);
              if (num77 > 0.0)
                num47 = Math.Atan(num75 / num76) * num3;
              else if (num77 <= 0.01)
              {
                if (num75 < 0.0)
                  num47 -= 90.0;
                else if (num75 > 0.0)
                  num47 += 90.0;
              }
              num47 = num47 + 90.0 + 360.0 / num46;
              if (num76 < 0.0)
                num47 += 180.0;
              if (num47 > 315.0)
                num47 -= 360.0;
              if (index6 >= startIdx)
              {
                outSine[index8] = Math.Sin(num47 * num4);
                outLeadSine[index8] = Math.Sin((num47 + 45.0) * num4);
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static Core.RetCode HtSine(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outSine,
      double[] outLeadSine)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outSine == null)
        retCode = Core.RetCode.BadParam;
      else if (outLeadSine == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = Math.Atan(1.0);
          double num3 = 45.0 / num2;
          double num4 = 1.0 / num3;
          double num5 = num2 * 8.0;
          int num6 = (int) Core.Globals.unstablePeriod[9] + 63;
          if (startIdx < num6)
            startIdx = num6;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num6;
            int index3 = index2;
            double num7 = inReal[index3];
            int index4 = index3 + 1;
            double num8 = num7;
            double num9 = num7;
            double num10 = inReal[index4];
            int index5 = index4 + 1;
            double num11 = num8 + num10;
            double num12 = num9 + num10 * 2.0;
            double num13 = inReal[index5];
            int index6 = index5 + 1;
            double num14 = num11 + num13;
            double num15 = num12 + num13 * 3.0;
            double num16 = 0.0;
            int num17 = 34;
            do
            {
              double num18 = inReal[index6];
              ++index6;
              num14 = num14 + num18 - num16;
              double num19 = num15 + num18 * 4.0;
              num16 = inReal[index2];
              ++index2;
              double num20 = num19 * 0.1;
              num15 = num19 - num14;
              --num17;
            }
            while (num17 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            double num24 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            double num37 = 0.0;
            int index8 = 0;
            double num38 = 0.0;
            double num39 = num38;
            double num40 = 0.0;
            double num41 = num40;
            double num42 = 0.0;
            double num43 = num42;
            double num44 = 0.0;
            double num45 = num44;
            double num46 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            double num47 = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num18 = 0.075 * num37 + 0.54;
              double num19 = inReal[index6];
              num14 = num14 + num19 - num16;
              double num20 = num15 + num19 * 4.0;
              num16 = inReal[index2];
              ++index2;
              double num48 = num20 * 0.1;
              num15 = num20 - num14;
              numArray9[index1] = num48;
              double num49;
              double num50;
              if (index6 % 2 == 0)
              {
                double num51 = 0.0962 * num48;
                double num52 = -numArray2[index7];
                numArray2[index7] = num51;
                double num53 = num52 + num51 - num22;
                num22 = 0.5769 * num24;
                double num54 = num53 + num22;
                num24 = num48;
                double num55 = num54 * num18;
                double num56 = 0.0962 * num55;
                double num57 = -numArray4[index7];
                numArray4[index7] = num56;
                double num58 = num57 + num56 - num26;
                num26 = 0.5769 * num28;
                double num59 = num58 + num26;
                num28 = num55;
                double num60 = num59 * num18;
                double num61 = 0.0962 * num42;
                double num62 = -numArray6[index7];
                numArray6[index7] = num61;
                double num63 = num62 + num61 - num30;
                num30 = 0.5769 * num32;
                double num64 = num63 + num30;
                num32 = num42;
                double num65 = num64 * num18;
                double num66 = 0.0962 * num60;
                double num67 = -numArray8[index7];
                numArray8[index7] = num66;
                double num68 = num67 + num66 - num34;
                num34 = 0.5769 * num36;
                double num69 = num68 + num34;
                num36 = num60;
                double num70 = num69 * num18;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num49 = 0.2 * (num60 + num65) + 0.8 * num38;
                num50 = 0.2 * (num42 - num70) + 0.8 * num39;
                num43 = num45;
                num45 = num55;
              }
              else
              {
                double num51 = 0.0962 * num48;
                double num52 = -numArray1[index7];
                numArray1[index7] = num51;
                double num53 = num52 + num51 - num21;
                num21 = 0.5769 * num23;
                double num54 = num53 + num21;
                num23 = num48;
                double num55 = num54 * num18;
                double num56 = 0.0962 * num55;
                double num57 = -numArray3[index7];
                numArray3[index7] = num56;
                double num58 = num57 + num56 - num25;
                num25 = 0.5769 * num27;
                double num59 = num58 + num25;
                num27 = num55;
                double num60 = num59 * num18;
                double num61 = 0.0962 * num43;
                double num62 = -numArray5[index7];
                numArray5[index7] = num61;
                double num63 = num62 + num61 - num29;
                num29 = 0.5769 * num31;
                double num64 = num63 + num29;
                num31 = num43;
                double num65 = num64 * num18;
                double num66 = 0.0962 * num60;
                double num67 = -numArray7[index7];
                numArray7[index7] = num66;
                double num68 = num67 + num66 - num33;
                num33 = 0.5769 * num35;
                double num69 = num68 + num33;
                num35 = num60;
                double num70 = num69 * num18;
                num49 = 0.2 * (num60 + num65) + 0.8 * num38;
                num50 = 0.2 * (num43 - num70) + 0.8 * num39;
                num42 = num44;
                num44 = num55;
              }
              num41 = 0.2 * (num50 * num39 + num49 * num38) + 0.8 * num41;
              num40 = 0.2 * (num50 * num38 - num49 * num39) + 0.8 * num40;
              num38 = num49;
              num39 = num50;
              double num71 = num37;
              if (num40 != 0.0 && num41 != 0.0)
                num37 = 360.0 / (Math.Atan(num40 / num41) * num3);
              double num72 = 1.5 * num71;
              if (num37 > num72)
                num37 = num72;
              double num73 = 0.67 * num71;
              if (num37 < num73)
                num37 = num73;
              if (num37 < 6.0)
                num37 = 6.0;
              else if (num37 > 50.0)
                num37 = 50.0;
              num37 = 0.2 * num37 + 0.8 * num71;
              num46 = 0.33 * num37 + 0.67 * num46;
              int num74 = (int) (num46 + 0.5);
              double num75 = 0.0;
              double num76 = 0.0;
              int index9 = index1;
              for (int index10 = 0; index10 < num74; ++index10)
              {
                double num51 = (double) index10 * num5 / (double) num74;
                double num52 = numArray9[index9];
                num75 += Math.Sin(num51) * num52;
                num76 += Math.Cos(num51) * num52;
                if (index9 != 0)
                  goto label_43;
                index9 = 49;
                continue;
label_43:
                --index9;
              }
              double num77 = Math.Abs(num76);
              if (num77 > 0.0)
                num47 = Math.Atan(num75 / num76) * num3;
              else if (num77 <= 0.01)
              {
                if (num75 < 0.0)
                  num47 -= 90.0;
                else if (num75 > 0.0)
                  num47 += 90.0;
              }
              num47 = num47 + 90.0 + 360.0 / num46;
              if (num76 < 0.0)
                num47 += 180.0;
              if (num47 > 315.0)
                num47 -= 360.0;
              if (index6 >= startIdx)
              {
                outSine[index8] = Math.Sin(num47 * num4);
                outLeadSine[index8] = Math.Sin((num47 + 45.0) * num4);
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static int HtTrendlineLookback()
    {
      return (int) Core.Globals.unstablePeriod[10] + 63;
    }

    public static Core.RetCode HtTrendline(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = 0.0;
          double num3 = num2;
          double num4 = num3;
          double num5 = 45.0 / Math.Atan(1.0);
          int num6 = (int) Core.Globals.unstablePeriod[10] + 63;
          if (startIdx < num6)
            startIdx = num6;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num6;
            int index3 = index2;
            double num7 = (double) inReal[index3];
            int index4 = index3 + 1;
            double num8 = num7;
            double num9 = num7;
            double num10 = (double) inReal[index4];
            int index5 = index4 + 1;
            double num11 = num8 + num10;
            double num12 = num9 + num10 * 2.0;
            double num13 = (double) inReal[index5];
            int index6 = index5 + 1;
            double num14 = num11 + num13;
            double num15 = num12 + num13 * 3.0;
            double num16 = 0.0;
            int num17 = 34;
            do
            {
              double num18 = (double) inReal[index6];
              ++index6;
              num14 = num14 + num18 - num16;
              double num19 = num15 + num18 * 4.0;
              num16 = (double) inReal[index2];
              ++index2;
              double num20 = num19 * 0.1;
              num15 = num19 - num14;
              --num17;
            }
            while (num17 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            double num24 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            double num37 = 0.0;
            int index8 = 0;
            double num38 = 0.0;
            double num39 = num38;
            double num40 = 0.0;
            double num41 = num40;
            double num42 = 0.0;
            double num43 = num42;
            double num44 = 0.0;
            double num45 = num44;
            double num46 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num18 = 0.075 * num37 + 0.54;
              double num19 = (double) inReal[index6];
              num14 = num14 + num19 - num16;
              double num20 = num15 + num19 * 4.0;
              num16 = (double) inReal[index2];
              ++index2;
              double num47 = num20 * 0.1;
              num15 = num20 - num14;
              numArray9[index1] = num47;
              double num48;
              double num49;
              if (index6 % 2 == 0)
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray2[index7];
                numArray2[index7] = num50;
                double num52 = num51 + num50 - num22;
                num22 = 0.5769 * num24;
                double num53 = num52 + num22;
                num24 = num47;
                double num54 = num53 * num18;
                double num55 = 0.0962 * num54;
                double num56 = -numArray4[index7];
                numArray4[index7] = num55;
                double num57 = num56 + num55 - num26;
                num26 = 0.5769 * num28;
                double num58 = num57 + num26;
                num28 = num54;
                double num59 = num58 * num18;
                double num60 = 0.0962 * num42;
                double num61 = -numArray6[index7];
                numArray6[index7] = num60;
                double num62 = num61 + num60 - num30;
                num30 = 0.5769 * num32;
                double num63 = num62 + num30;
                num32 = num42;
                double num64 = num63 * num18;
                double num65 = 0.0962 * num59;
                double num66 = -numArray8[index7];
                numArray8[index7] = num65;
                double num67 = num66 + num65 - num34;
                num34 = 0.5769 * num36;
                double num68 = num67 + num34;
                num36 = num59;
                double num69 = num68 * num18;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num48 = 0.2 * (num59 + num64) + 0.8 * num38;
                num49 = 0.2 * (num42 - num69) + 0.8 * num39;
                num43 = num45;
                num45 = num54;
              }
              else
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray1[index7];
                numArray1[index7] = num50;
                double num52 = num51 + num50 - num21;
                num21 = 0.5769 * num23;
                double num53 = num52 + num21;
                num23 = num47;
                double num54 = num53 * num18;
                double num55 = 0.0962 * num54;
                double num56 = -numArray3[index7];
                numArray3[index7] = num55;
                double num57 = num56 + num55 - num25;
                num25 = 0.5769 * num27;
                double num58 = num57 + num25;
                num27 = num54;
                double num59 = num58 * num18;
                double num60 = 0.0962 * num43;
                double num61 = -numArray5[index7];
                numArray5[index7] = num60;
                double num62 = num61 + num60 - num29;
                num29 = 0.5769 * num31;
                double num63 = num62 + num29;
                num31 = num43;
                double num64 = num63 * num18;
                double num65 = 0.0962 * num59;
                double num66 = -numArray7[index7];
                numArray7[index7] = num65;
                double num67 = num66 + num65 - num33;
                num33 = 0.5769 * num35;
                double num68 = num67 + num33;
                num35 = num59;
                double num69 = num68 * num18;
                num48 = 0.2 * (num59 + num64) + 0.8 * num38;
                num49 = 0.2 * (num43 - num69) + 0.8 * num39;
                num42 = num44;
                num44 = num54;
              }
              num41 = 0.2 * (num49 * num39 + num48 * num38) + 0.8 * num41;
              num40 = 0.2 * (num49 * num38 - num48 * num39) + 0.8 * num40;
              num38 = num48;
              num39 = num49;
              double num70 = num37;
              if (num40 != 0.0 && num41 != 0.0)
                num37 = 360.0 / (Math.Atan(num40 / num41) * num5);
              double num71 = 1.5 * num70;
              if (num37 > num71)
                num37 = num71;
              double num72 = 0.67 * num70;
              if (num37 < num72)
                num37 = num72;
              if (num37 < 6.0)
                num37 = 6.0;
              else if (num37 > 50.0)
                num37 = 50.0;
              num37 = 0.2 * num37 + 0.8 * num70;
              num46 = 0.33 * num37 + 0.67 * num46;
              int num73 = (int) (num46 + 0.5);
              int index9 = index6;
              double num74 = 0.0;
              for (int index10 = 0; index10 < num73; ++index10)
              {
                num74 += (double) inReal[index9];
                --index9;
              }
              if (num73 > 0)
                num74 /= (double) num73;
              double num75 = (4.0 * num74 + 3.0 * num4 + 2.0 * num3 + num2) / 10.0;
              num2 = num3;
              num3 = num4;
              num4 = num74;
              if (index6 >= startIdx)
              {
                outReal[index8] = num75;
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static Core.RetCode HtTrendline(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = 0.0;
          double num3 = num2;
          double num4 = num3;
          double num5 = 45.0 / Math.Atan(1.0);
          int num6 = (int) Core.Globals.unstablePeriod[10] + 63;
          if (startIdx < num6)
            startIdx = num6;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num6;
            int index3 = index2;
            double num7 = inReal[index3];
            int index4 = index3 + 1;
            double num8 = num7;
            double num9 = num7;
            double num10 = inReal[index4];
            int index5 = index4 + 1;
            double num11 = num8 + num10;
            double num12 = num9 + num10 * 2.0;
            double num13 = inReal[index5];
            int index6 = index5 + 1;
            double num14 = num11 + num13;
            double num15 = num12 + num13 * 3.0;
            double num16 = 0.0;
            int num17 = 34;
            do
            {
              double num18 = inReal[index6];
              ++index6;
              num14 = num14 + num18 - num16;
              double num19 = num15 + num18 * 4.0;
              num16 = inReal[index2];
              ++index2;
              double num20 = num19 * 0.1;
              num15 = num19 - num14;
              --num17;
            }
            while (num17 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            double num24 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            double num37 = 0.0;
            int index8 = 0;
            double num38 = 0.0;
            double num39 = num38;
            double num40 = 0.0;
            double num41 = num40;
            double num42 = 0.0;
            double num43 = num42;
            double num44 = 0.0;
            double num45 = num44;
            double num46 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num18 = 0.075 * num37 + 0.54;
              double num19 = inReal[index6];
              num14 = num14 + num19 - num16;
              double num20 = num15 + num19 * 4.0;
              num16 = inReal[index2];
              ++index2;
              double num47 = num20 * 0.1;
              num15 = num20 - num14;
              numArray9[index1] = num47;
              double num48;
              double num49;
              if (index6 % 2 == 0)
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray2[index7];
                numArray2[index7] = num50;
                double num52 = num51 + num50 - num22;
                num22 = 0.5769 * num24;
                double num53 = num52 + num22;
                num24 = num47;
                double num54 = num53 * num18;
                double num55 = 0.0962 * num54;
                double num56 = -numArray4[index7];
                numArray4[index7] = num55;
                double num57 = num56 + num55 - num26;
                num26 = 0.5769 * num28;
                double num58 = num57 + num26;
                num28 = num54;
                double num59 = num58 * num18;
                double num60 = 0.0962 * num42;
                double num61 = -numArray6[index7];
                numArray6[index7] = num60;
                double num62 = num61 + num60 - num30;
                num30 = 0.5769 * num32;
                double num63 = num62 + num30;
                num32 = num42;
                double num64 = num63 * num18;
                double num65 = 0.0962 * num59;
                double num66 = -numArray8[index7];
                numArray8[index7] = num65;
                double num67 = num66 + num65 - num34;
                num34 = 0.5769 * num36;
                double num68 = num67 + num34;
                num36 = num59;
                double num69 = num68 * num18;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num48 = 0.2 * (num59 + num64) + 0.8 * num38;
                num49 = 0.2 * (num42 - num69) + 0.8 * num39;
                num43 = num45;
                num45 = num54;
              }
              else
              {
                double num50 = 0.0962 * num47;
                double num51 = -numArray1[index7];
                numArray1[index7] = num50;
                double num52 = num51 + num50 - num21;
                num21 = 0.5769 * num23;
                double num53 = num52 + num21;
                num23 = num47;
                double num54 = num53 * num18;
                double num55 = 0.0962 * num54;
                double num56 = -numArray3[index7];
                numArray3[index7] = num55;
                double num57 = num56 + num55 - num25;
                num25 = 0.5769 * num27;
                double num58 = num57 + num25;
                num27 = num54;
                double num59 = num58 * num18;
                double num60 = 0.0962 * num43;
                double num61 = -numArray5[index7];
                numArray5[index7] = num60;
                double num62 = num61 + num60 - num29;
                num29 = 0.5769 * num31;
                double num63 = num62 + num29;
                num31 = num43;
                double num64 = num63 * num18;
                double num65 = 0.0962 * num59;
                double num66 = -numArray7[index7];
                numArray7[index7] = num65;
                double num67 = num66 + num65 - num33;
                num33 = 0.5769 * num35;
                double num68 = num67 + num33;
                num35 = num59;
                double num69 = num68 * num18;
                num48 = 0.2 * (num59 + num64) + 0.8 * num38;
                num49 = 0.2 * (num43 - num69) + 0.8 * num39;
                num42 = num44;
                num44 = num54;
              }
              num41 = 0.2 * (num49 * num39 + num48 * num38) + 0.8 * num41;
              num40 = 0.2 * (num49 * num38 - num48 * num39) + 0.8 * num40;
              num38 = num48;
              num39 = num49;
              double num70 = num37;
              if (num40 != 0.0 && num41 != 0.0)
                num37 = 360.0 / (Math.Atan(num40 / num41) * num5);
              double num71 = 1.5 * num70;
              if (num37 > num71)
                num37 = num71;
              double num72 = 0.67 * num70;
              if (num37 < num72)
                num37 = num72;
              if (num37 < 6.0)
                num37 = 6.0;
              else if (num37 > 50.0)
                num37 = 50.0;
              num37 = 0.2 * num37 + 0.8 * num70;
              num46 = 0.33 * num37 + 0.67 * num46;
              int num73 = (int) (num46 + 0.5);
              int index9 = index6;
              double num74 = 0.0;
              for (int index10 = 0; index10 < num73; ++index10)
              {
                num74 += inReal[index9];
                --index9;
              }
              if (num73 > 0)
                num74 /= (double) num73;
              double num75 = (4.0 * num74 + 3.0 * num4 + 2.0 * num3 + num2) / 10.0;
              num2 = num3;
              num3 = num4;
              num4 = num74;
              if (index6 >= startIdx)
              {
                outReal[index8] = num75;
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static int HtTrendModeLookback()
    {
      return (int) Core.Globals.unstablePeriod[11] + 63;
    }

    public static Core.RetCode HtTrendMode(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = 0.0;
          double num3 = num2;
          double num4 = num3;
          int num5 = 0;
          double num6 = 0.0;
          double num7 = 0.0;
          double num8 = Math.Atan(1.0);
          double num9 = 45.0 / num8;
          double num10 = 1.0 / num9;
          double num11 = num8 * 8.0;
          int num12 = (int) Core.Globals.unstablePeriod[11] + 63;
          if (startIdx < num12)
            startIdx = num12;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num12;
            int index3 = index2;
            double num13 = (double) inReal[index3];
            int index4 = index3 + 1;
            double num14 = num13;
            double num15 = num13;
            double num16 = (double) inReal[index4];
            int index5 = index4 + 1;
            double num17 = num14 + num16;
            double num18 = num15 + num16 * 2.0;
            double num19 = (double) inReal[index5];
            int index6 = index5 + 1;
            double num20 = num17 + num19;
            double num21 = num18 + num19 * 3.0;
            double num22 = 0.0;
            int num23 = 34;
            do
            {
              double num24 = (double) inReal[index6];
              ++index6;
              num20 = num20 + num24 - num22;
              double num25 = num21 + num24 * 4.0;
              num22 = (double) inReal[index2];
              ++index2;
              double num26 = num25 * 0.1;
              num21 = num25 - num20;
              --num23;
            }
            while (num23 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            double num37 = 0.0;
            double num38 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num39 = 0.0;
            double num40 = 0.0;
            double num41 = 0.0;
            double num42 = 0.0;
            double num43 = 0.0;
            int index8 = 0;
            double num44 = 0.0;
            double num45 = num44;
            double num46 = 0.0;
            double num47 = num46;
            double num48 = 0.0;
            double num49 = num48;
            double num50 = 0.0;
            double num51 = num50;
            double num52 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            double num53 = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num24 = 0.075 * num43 + 0.54;
              double num25 = (double) inReal[index6];
              num20 = num20 + num25 - num22;
              double num26 = num21 + num25 * 4.0;
              num22 = (double) inReal[index2];
              ++index2;
              double num54 = num26 * 0.1;
              num21 = num26 - num20;
              numArray9[index1] = num54;
              double num55;
              double num56;
              if (index6 % 2 == 0)
              {
                double num57 = 0.0962 * num54;
                double num58 = -numArray2[index7];
                numArray2[index7] = num57;
                double num59 = num58 + num57 - num28;
                num28 = 0.5769 * num30;
                double num60 = num59 + num28;
                num30 = num54;
                double num61 = num60 * num24;
                double num62 = 0.0962 * num61;
                double num63 = -numArray4[index7];
                numArray4[index7] = num62;
                double num64 = num63 + num62 - num32;
                num32 = 0.5769 * num34;
                double num65 = num64 + num32;
                num34 = num61;
                double num66 = num65 * num24;
                double num67 = 0.0962 * num48;
                double num68 = -numArray6[index7];
                numArray6[index7] = num67;
                double num69 = num68 + num67 - num36;
                num36 = 0.5769 * num38;
                double num70 = num69 + num36;
                num38 = num48;
                double num71 = num70 * num24;
                double num72 = 0.0962 * num66;
                double num73 = -numArray8[index7];
                numArray8[index7] = num72;
                double num74 = num73 + num72 - num40;
                num40 = 0.5769 * num42;
                double num75 = num74 + num40;
                num42 = num66;
                double num76 = num75 * num24;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num55 = 0.2 * (num66 + num71) + 0.8 * num44;
                num56 = 0.2 * (num48 - num76) + 0.8 * num45;
                num49 = num51;
                num51 = num61;
              }
              else
              {
                double num57 = 0.0962 * num54;
                double num58 = -numArray1[index7];
                numArray1[index7] = num57;
                double num59 = num58 + num57 - num27;
                num27 = 0.5769 * num29;
                double num60 = num59 + num27;
                num29 = num54;
                double num61 = num60 * num24;
                double num62 = 0.0962 * num61;
                double num63 = -numArray3[index7];
                numArray3[index7] = num62;
                double num64 = num63 + num62 - num31;
                num31 = 0.5769 * num33;
                double num65 = num64 + num31;
                num33 = num61;
                double num66 = num65 * num24;
                double num67 = 0.0962 * num49;
                double num68 = -numArray5[index7];
                numArray5[index7] = num67;
                double num69 = num68 + num67 - num35;
                num35 = 0.5769 * num37;
                double num70 = num69 + num35;
                num37 = num49;
                double num71 = num70 * num24;
                double num72 = 0.0962 * num66;
                double num73 = -numArray7[index7];
                numArray7[index7] = num72;
                double num74 = num73 + num72 - num39;
                num39 = 0.5769 * num41;
                double num75 = num74 + num39;
                num41 = num66;
                double num76 = num75 * num24;
                num55 = 0.2 * (num66 + num71) + 0.8 * num44;
                num56 = 0.2 * (num49 - num76) + 0.8 * num45;
                num48 = num50;
                num50 = num61;
              }
              num47 = 0.2 * (num56 * num45 + num55 * num44) + 0.8 * num47;
              num46 = 0.2 * (num56 * num44 - num55 * num45) + 0.8 * num46;
              num44 = num55;
              num45 = num56;
              double num77 = num43;
              if (num46 != 0.0 && num47 != 0.0)
                num43 = 360.0 / (Math.Atan(num46 / num47) * num9);
              double num78 = 1.5 * num77;
              if (num43 > num78)
                num43 = num78;
              double num79 = 0.67 * num77;
              if (num43 < num79)
                num43 = num79;
              if (num43 < 6.0)
                num43 = 6.0;
              else if (num43 > 50.0)
                num43 = 50.0;
              num43 = 0.2 * num43 + 0.8 * num77;
              num52 = 0.33 * num43 + 0.67 * num52;
              double num80 = num53;
              int num81 = (int) (num52 + 0.5);
              double num82 = 0.0;
              double num83 = 0.0;
              int index9 = index1;
              for (int index10 = 0; index10 < num81; ++index10)
              {
                double num57 = (double) index10 * num11 / (double) num81;
                double num58 = numArray9[index9];
                num82 += Math.Sin(num57) * num58;
                num83 += Math.Cos(num57) * num58;
                if (index9 != 0)
                  goto label_41;
                index9 = 49;
                continue;
label_41:
                --index9;
              }
              double num84 = Math.Abs(num83);
              if (num84 > 0.0)
                num53 = Math.Atan(num82 / num83) * num9;
              else if (num84 <= 0.01)
              {
                if (num82 < 0.0)
                  num53 -= 90.0;
                else if (num82 > 0.0)
                  num53 += 90.0;
              }
              num53 = num53 + 90.0 + 360.0 / num52;
              if (num83 < 0.0)
                num53 += 180.0;
              if (num53 > 315.0)
                num53 -= 360.0;
              double num85 = num6;
              double num86 = num7;
              num6 = Math.Sin(num53 * num10);
              num7 = Math.Sin((num53 + 45.0) * num10);
              int num87 = (int) (num52 + 0.5);
              int index11 = index6;
              double num88 = 0.0;
              for (int index10 = 0; index10 < num87; ++index10)
              {
                num88 += (double) inReal[index11];
                --index11;
              }
              if (num87 > 0)
                num88 /= (double) num87;
              double num89 = (4.0 * num88 + 3.0 * num4 + 2.0 * num3 + num2) / 10.0;
              num2 = num3;
              num3 = num4;
              num4 = num88;
              int num90 = 1;
              if (num6 > num7 && num85 <= num86 || num6 < num7 && num85 >= num86)
              {
                num5 = 0;
                num90 = 0;
              }
              ++num5;
              if ((double) num5 < 0.5 * num52)
                num90 = 0;
              double num91 = num53 - num80;
              if (num52 != 0.0 && num91 > 241.2 / num52 && num91 < 540.0 / num52)
                num90 = 0;
              double num92 = numArray9[index1];
              if (num89 != 0.0 && Math.Abs((num92 - num89) / num89) >= 0.015)
                num90 = 1;
              if (index6 >= startIdx)
              {
                outInteger[index8] = num90;
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static Core.RetCode HtTrendMode(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      int index1 = 0;
      int num1 = 49;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outInteger == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double[] numArray9 = new double[num1 + 1];
        if (numArray9 == null)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          double num2 = 0.0;
          double num3 = num2;
          double num4 = num3;
          int num5 = 0;
          double num6 = 0.0;
          double num7 = 0.0;
          double num8 = Math.Atan(1.0);
          double num9 = 45.0 / num8;
          double num10 = 1.0 / num9;
          double num11 = num8 * 8.0;
          int num12 = (int) Core.Globals.unstablePeriod[11] + 63;
          if (startIdx < num12)
            startIdx = num12;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index2 = startIdx - num12;
            int index3 = index2;
            double num13 = inReal[index3];
            int index4 = index3 + 1;
            double num14 = num13;
            double num15 = num13;
            double num16 = inReal[index4];
            int index5 = index4 + 1;
            double num17 = num14 + num16;
            double num18 = num15 + num16 * 2.0;
            double num19 = inReal[index5];
            int index6 = index5 + 1;
            double num20 = num17 + num19;
            double num21 = num18 + num19 * 3.0;
            double num22 = 0.0;
            int num23 = 34;
            do
            {
              double num24 = inReal[index6];
              ++index6;
              num20 = num20 + num24 - num22;
              double num25 = num21 + num24 * 4.0;
              num22 = inReal[index2];
              ++index2;
              double num26 = num25 * 0.1;
              num21 = num25 - num20;
              --num23;
            }
            while (num23 != 0);
            int index7 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            double num33 = 0.0;
            double num34 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num35 = 0.0;
            double num36 = 0.0;
            double num37 = 0.0;
            double num38 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num39 = 0.0;
            double num40 = 0.0;
            double num41 = 0.0;
            double num42 = 0.0;
            double num43 = 0.0;
            int index8 = 0;
            double num44 = 0.0;
            double num45 = num44;
            double num46 = 0.0;
            double num47 = num46;
            double num48 = 0.0;
            double num49 = num48;
            double num50 = 0.0;
            double num51 = num50;
            double num52 = 0.0;
            for (int index9 = 0; index9 < 50; ++index9)
              numArray9[index9] = 0.0;
            double num53 = 0.0;
            for (; index6 <= endIdx; ++index6)
            {
              double num24 = 0.075 * num43 + 0.54;
              double num25 = inReal[index6];
              num20 = num20 + num25 - num22;
              double num26 = num21 + num25 * 4.0;
              num22 = inReal[index2];
              ++index2;
              double num54 = num26 * 0.1;
              num21 = num26 - num20;
              numArray9[index1] = num54;
              double num55;
              double num56;
              if (index6 % 2 == 0)
              {
                double num57 = 0.0962 * num54;
                double num58 = -numArray2[index7];
                numArray2[index7] = num57;
                double num59 = num58 + num57 - num28;
                num28 = 0.5769 * num30;
                double num60 = num59 + num28;
                num30 = num54;
                double num61 = num60 * num24;
                double num62 = 0.0962 * num61;
                double num63 = -numArray4[index7];
                numArray4[index7] = num62;
                double num64 = num63 + num62 - num32;
                num32 = 0.5769 * num34;
                double num65 = num64 + num32;
                num34 = num61;
                double num66 = num65 * num24;
                double num67 = 0.0962 * num48;
                double num68 = -numArray6[index7];
                numArray6[index7] = num67;
                double num69 = num68 + num67 - num36;
                num36 = 0.5769 * num38;
                double num70 = num69 + num36;
                num38 = num48;
                double num71 = num70 * num24;
                double num72 = 0.0962 * num66;
                double num73 = -numArray8[index7];
                numArray8[index7] = num72;
                double num74 = num73 + num72 - num40;
                num40 = 0.5769 * num42;
                double num75 = num74 + num40;
                num42 = num66;
                double num76 = num75 * num24;
                ++index7;
                if (index7 == 3)
                  index7 = 0;
                num55 = 0.2 * (num66 + num71) + 0.8 * num44;
                num56 = 0.2 * (num48 - num76) + 0.8 * num45;
                num49 = num51;
                num51 = num61;
              }
              else
              {
                double num57 = 0.0962 * num54;
                double num58 = -numArray1[index7];
                numArray1[index7] = num57;
                double num59 = num58 + num57 - num27;
                num27 = 0.5769 * num29;
                double num60 = num59 + num27;
                num29 = num54;
                double num61 = num60 * num24;
                double num62 = 0.0962 * num61;
                double num63 = -numArray3[index7];
                numArray3[index7] = num62;
                double num64 = num63 + num62 - num31;
                num31 = 0.5769 * num33;
                double num65 = num64 + num31;
                num33 = num61;
                double num66 = num65 * num24;
                double num67 = 0.0962 * num49;
                double num68 = -numArray5[index7];
                numArray5[index7] = num67;
                double num69 = num68 + num67 - num35;
                num35 = 0.5769 * num37;
                double num70 = num69 + num35;
                num37 = num49;
                double num71 = num70 * num24;
                double num72 = 0.0962 * num66;
                double num73 = -numArray7[index7];
                numArray7[index7] = num72;
                double num74 = num73 + num72 - num39;
                num39 = 0.5769 * num41;
                double num75 = num74 + num39;
                num41 = num66;
                double num76 = num75 * num24;
                num55 = 0.2 * (num66 + num71) + 0.8 * num44;
                num56 = 0.2 * (num49 - num76) + 0.8 * num45;
                num48 = num50;
                num50 = num61;
              }
              num47 = 0.2 * (num56 * num45 + num55 * num44) + 0.8 * num47;
              num46 = 0.2 * (num56 * num44 - num55 * num45) + 0.8 * num46;
              num44 = num55;
              num45 = num56;
              double num77 = num43;
              if (num46 != 0.0 && num47 != 0.0)
                num43 = 360.0 / (Math.Atan(num46 / num47) * num9);
              double num78 = 1.5 * num77;
              if (num43 > num78)
                num43 = num78;
              double num79 = 0.67 * num77;
              if (num43 < num79)
                num43 = num79;
              if (num43 < 6.0)
                num43 = 6.0;
              else if (num43 > 50.0)
                num43 = 50.0;
              num43 = 0.2 * num43 + 0.8 * num77;
              num52 = 0.33 * num43 + 0.67 * num52;
              double num80 = num53;
              int num81 = (int) (num52 + 0.5);
              double num82 = 0.0;
              double num83 = 0.0;
              int index9 = index1;
              for (int index10 = 0; index10 < num81; ++index10)
              {
                double num57 = (double) index10 * num11 / (double) num81;
                double num58 = numArray9[index9];
                num82 += Math.Sin(num57) * num58;
                num83 += Math.Cos(num57) * num58;
                if (index9 != 0)
                  goto label_41;
                index9 = 49;
                continue;
label_41:
                --index9;
              }
              double num84 = Math.Abs(num83);
              if (num84 > 0.0)
                num53 = Math.Atan(num82 / num83) * num9;
              else if (num84 <= 0.01)
              {
                if (num82 < 0.0)
                  num53 -= 90.0;
                else if (num82 > 0.0)
                  num53 += 90.0;
              }
              num53 = num53 + 90.0 + 360.0 / num52;
              if (num83 < 0.0)
                num53 += 180.0;
              if (num53 > 315.0)
                num53 -= 360.0;
              double num85 = num6;
              double num86 = num7;
              num6 = Math.Sin(num53 * num10);
              num7 = Math.Sin((num53 + 45.0) * num10);
              int num87 = (int) (num52 + 0.5);
              int index11 = index6;
              double num88 = 0.0;
              for (int index10 = 0; index10 < num87; ++index10)
              {
                num88 += inReal[index11];
                --index11;
              }
              if (num87 > 0)
                num88 /= (double) num87;
              double num89 = (4.0 * num88 + 3.0 * num4 + 2.0 * num3 + num2) / 10.0;
              num2 = num3;
              num3 = num4;
              num4 = num88;
              int num90 = 1;
              if (num6 > num7 && num85 <= num86 || num6 < num7 && num85 >= num86)
              {
                num5 = 0;
                num90 = 0;
              }
              ++num5;
              if ((double) num5 < 0.5 * num52)
                num90 = 0;
              double num91 = num53 - num80;
              if (num52 != 0.0 && num91 > 241.2 / num52 && num91 < 540.0 / num52)
                num90 = 0;
              double num92 = numArray9[index1];
              if (num89 != 0.0 && Math.Abs((num92 - num89) / num89) >= 0.015)
                num90 = 1;
              if (index6 >= startIdx)
              {
                outInteger[index8] = num90;
                ++index8;
              }
              ++index1;
              if (index1 > num1)
                index1 = 0;
            }
            outNBElement = index8;
            retCode = Core.RetCode.Success;
          }
        }
      }
      return retCode;
    }

    public static int KamaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod + (int) Core.Globals.unstablePeriod[12];
label_5:
      return num;
    }

    public static Core.RetCode Kama(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_26;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = optInTimePeriod + (int) Core.Globals.unstablePeriod[12];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            int index1 = startIdx - num1;
            int index2 = index1;
            int num3 = optInTimePeriod;
            while (true)
            {
              int num4 = num3;
              --num3;
              if (num4 > 0)
              {
                double num5 = (double) inReal[index1];
                ++index1;
                double num6 = num5 - (double) inReal[index1];
                num2 += Math.Abs(num6);
              }
              else
                break;
            }
            double num7 = (double) inReal[index1 - 1];
            double num8 = (double) inReal[index1];
            double num9 = (double) inReal[index2];
            int index3 = index2 + 1;
            double num10 = num8 - num9;
            double num11 = num9;
            double num12 = (num2 <= num10 || -1E-08 < num2 && num2 < 1E-08 ? 1.0 : Math.Abs(num10 / num2)) * (56.0 / 93.0) + 2.0 / 31.0;
            double num13 = num12 * num12;
            double num14 = ((double) inReal[index1] - num7) * num13 + num7;
            int index4;
            for (index4 = index1 + 1; index4 <= startIdx; ++index4)
            {
              double num4 = (double) inReal[index4];
              double num5 = (double) inReal[index3];
              ++index3;
              double num6 = num4 - num5;
              num2 = num2 - Math.Abs(num11 - num5) + Math.Abs(num4 - (double) inReal[index4 - 1]);
              num11 = num5;
              double num15 = (num2 <= num6 || -1E-08 < num2 && num2 < 1E-08 ? 1.0 : Math.Abs(num6 / num2)) * (56.0 / 93.0) + 2.0 / 31.0;
              double num16 = num15 * num15;
              num14 = ((double) inReal[index4] - num14) * num16 + num14;
            }
            outReal[0] = num14;
            int index5 = 1;
            outBegIdx = index4 - 1;
            while (index4 <= endIdx)
            {
              double num4 = (double) inReal[index4];
              double num5 = (double) inReal[index3];
              ++index3;
              double num6 = num4 - num5;
              num2 = num2 - Math.Abs(num11 - num5) + Math.Abs(num4 - (double) inReal[index4 - 1]);
              num11 = num5;
              double num15 = (num2 <= num6 || -1E-08 < num2 && num2 < 1E-08 ? 1.0 : Math.Abs(num6 / num2)) * (56.0 / 93.0) + 2.0 / 31.0;
              double num16 = num15 * num15;
              num14 = ((double) inReal[index4] - num14) * num16 + num14;
              ++index4;
              outReal[index5] = num14;
              ++index5;
            }
            outNBElement = index5;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_26:
      return retCode;
    }

    public static Core.RetCode Kama(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_26;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = optInTimePeriod + (int) Core.Globals.unstablePeriod[12];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            int index1 = startIdx - num1;
            int index2 = index1;
            int num3 = optInTimePeriod;
            while (true)
            {
              int num4 = num3;
              --num3;
              if (num4 > 0)
              {
                double num5 = inReal[index1];
                ++index1;
                double num6 = num5 - inReal[index1];
                num2 += Math.Abs(num6);
              }
              else
                break;
            }
            double num7 = inReal[index1 - 1];
            double num8 = inReal[index1];
            double num9 = inReal[index2];
            int index3 = index2 + 1;
            double num10 = num8 - num9;
            double num11 = num9;
            double num12 = (num2 <= num10 || -1E-08 < num2 && num2 < 1E-08 ? 1.0 : Math.Abs(num10 / num2)) * (56.0 / 93.0) + 2.0 / 31.0;
            double num13 = num12 * num12;
            double num14 = (inReal[index1] - num7) * num13 + num7;
            int index4;
            for (index4 = index1 + 1; index4 <= startIdx; ++index4)
            {
              double num4 = inReal[index4];
              double num5 = inReal[index3];
              ++index3;
              double num6 = num4 - num5;
              num2 = num2 - Math.Abs(num11 - num5) + Math.Abs(num4 - inReal[index4 - 1]);
              num11 = num5;
              double num15 = (num2 <= num6 || -1E-08 < num2 && num2 < 1E-08 ? 1.0 : Math.Abs(num6 / num2)) * (56.0 / 93.0) + 2.0 / 31.0;
              double num16 = num15 * num15;
              num14 = (inReal[index4] - num14) * num16 + num14;
            }
            outReal[0] = num14;
            int index5 = 1;
            outBegIdx = index4 - 1;
            while (index4 <= endIdx)
            {
              double num4 = inReal[index4];
              double num5 = inReal[index3];
              ++index3;
              double num6 = num4 - num5;
              num2 = num2 - Math.Abs(num11 - num5) + Math.Abs(num4 - inReal[index4 - 1]);
              num11 = num5;
              double num15 = (num2 <= num6 || -1E-08 < num2 && num2 < 1E-08 ? 1.0 : Math.Abs(num6 / num2)) * (56.0 / 93.0) + 2.0 / 31.0;
              double num16 = num15 * num15;
              num14 = (inReal[index4] - num14) * num16 + num14;
              ++index4;
              outReal[index5] = num14;
              ++index5;
            }
            outNBElement = index5;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_26:
      return retCode;
    }

    public static int LinearRegLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode LinearReg(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = (double) inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double num14 = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              double num15 = (num10 - num14 * num4) / (double) optInTimePeriod;
              outReal[index] = num15 + num14 * (double) (optInTimePeriod - 1);
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode LinearReg(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double num14 = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              double num15 = (num10 - num14 * num4) / (double) optInTimePeriod;
              outReal[index] = num15 + num14 * (double) (optInTimePeriod - 1);
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int LinearRegAngleLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode LinearRegAngle(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegAngleLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = (double) inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double d = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              outReal[index] = Math.Atan(d) * (180.0 / Math.PI);
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode LinearRegAngle(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegAngleLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double d = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              outReal[index] = Math.Atan(d) * (180.0 / Math.PI);
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int LinearRegInterceptLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode LinearRegIntercept(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegInterceptLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = (double) inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double num14 = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              outReal[index] = (num10 - num14 * num4) / (double) optInTimePeriod;
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode LinearRegIntercept(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegInterceptLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double num14 = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              outReal[index] = (num10 - num14 * num4) / (double) optInTimePeriod;
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int LinearRegSlopeLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode LinearRegSlope(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegSlopeLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = (double) inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              outReal[index] = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode LinearRegSlope(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.LinearRegSlopeLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              outReal[index] = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int LnLookback()
    {
      return 0;
    }

    public static Core.RetCode Ln(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Log((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Ln(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Log(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int Log10Lookback()
    {
      return 0;
    }

    public static Core.RetCode Log10(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Log10((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Log10(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Log10(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int MovingAverageLookback(int optInTimePeriod, Core.MAType optInMAType)
    {
      int num1;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num1 = -1;
        goto label_18;
      }
      if (optInTimePeriod <= 1)
      {
        num1 = 0;
      }
      else
      {
        int num2;
        switch (optInMAType)
        {
          case Core.MAType.Sma:
            num2 = Core.SmaLookback(optInTimePeriod);
            break;
          case Core.MAType.Ema:
            num2 = Core.EmaLookback(optInTimePeriod);
            break;
          case Core.MAType.Wma:
            num2 = Core.WmaLookback(optInTimePeriod);
            break;
          case Core.MAType.Dema:
            num2 = Core.DemaLookback(optInTimePeriod);
            break;
          case Core.MAType.Tema:
            num2 = Core.TemaLookback(optInTimePeriod);
            break;
          case Core.MAType.Trima:
            num2 = Core.TrimaLookback(optInTimePeriod);
            break;
          case Core.MAType.Kama:
            num2 = Core.KamaLookback(optInTimePeriod);
            break;
          case Core.MAType.Mama:
            num2 = Core.MamaLookback(0.5, 0.05);
            break;
          case Core.MAType.T3:
            num2 = Core.T3Lookback(optInTimePeriod, 0.7);
            break;
          default:
            num2 = 0;
            break;
        }
        num1 = num2;
      }
label_18:
      return num1;
    }

    public static Core.RetCode MovingAverage(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (outReal == null)
          retCode1 = Core.RetCode.BadParam;
        else if (optInTimePeriod == 1)
        {
          int num = endIdx - startIdx + 1;
          outNBElement = num;
          int index1 = startIdx;
          int index2 = 0;
          while (index2 < num)
          {
            outReal[index2] = (double) inReal[index1];
            ++index2;
            ++index1;
          }
          outBegIdx = startIdx;
          retCode1 = Core.RetCode.Success;
        }
        else
        {
          Core.RetCode retCode2;
          switch (optInMAType)
          {
            case Core.MAType.Sma:
              retCode2 = Core.Sma(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Ema:
              retCode2 = Core.Ema(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Wma:
              retCode2 = Core.Wma(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Dema:
              retCode2 = Core.Dema(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Tema:
              retCode2 = Core.Tema(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Trima:
              retCode2 = Core.Trima(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Kama:
              retCode2 = Core.Kama(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Mama:
              double[] outFAMA = new double[endIdx - startIdx + 1];
              if (outFAMA == null)
              {
                retCode1 = Core.RetCode.AllocErr;
                goto label_31;
              }
              else
              {
                retCode2 = Core.Mama(startIdx, endIdx, inReal, 0.5, 0.05, out outBegIdx, out outNBElement, outReal, outFAMA);
                break;
              }
            case Core.MAType.T3:
              retCode2 = Core.T3(startIdx, endIdx, inReal, optInTimePeriod, 0.7, out outBegIdx, out outNBElement, outReal);
              break;
            default:
              retCode2 = Core.RetCode.BadParam;
              break;
          }
          retCode1 = retCode2;
        }
      }
label_31:
      return retCode1;
    }

    public static Core.RetCode MovingAverage(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (outReal == null)
          retCode1 = Core.RetCode.BadParam;
        else if (optInTimePeriod == 1)
        {
          int num = endIdx - startIdx + 1;
          outNBElement = num;
          int index1 = startIdx;
          int index2 = 0;
          while (index2 < num)
          {
            outReal[index2] = inReal[index1];
            ++index2;
            ++index1;
          }
          outBegIdx = startIdx;
          retCode1 = Core.RetCode.Success;
        }
        else
        {
          Core.RetCode retCode2;
          switch (optInMAType)
          {
            case Core.MAType.Sma:
              retCode2 = Core.Sma(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Ema:
              retCode2 = Core.Ema(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Wma:
              retCode2 = Core.Wma(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Dema:
              retCode2 = Core.Dema(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Tema:
              retCode2 = Core.Tema(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Trima:
              retCode2 = Core.Trima(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Kama:
              retCode2 = Core.Kama(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
              break;
            case Core.MAType.Mama:
              double[] outFAMA = new double[endIdx - startIdx + 1];
              if (outFAMA == null)
              {
                retCode1 = Core.RetCode.AllocErr;
                goto label_31;
              }
              else
              {
                retCode2 = Core.Mama(startIdx, endIdx, inReal, 0.5, 0.05, out outBegIdx, out outNBElement, outReal, outFAMA);
                break;
              }
            case Core.MAType.T3:
              retCode2 = Core.T3(startIdx, endIdx, inReal, optInTimePeriod, 0.7, out outBegIdx, out outNBElement, outReal);
              break;
            default:
              retCode2 = Core.RetCode.BadParam;
              break;
          }
          retCode1 = retCode2;
        }
      }
label_31:
      return retCode1;
    }

    public static int MacdLookback(int optInFastPeriod, int optInSlowPeriod, int optInSignalPeriod)
    {
      int num1;
      if (optInFastPeriod == int.MinValue)
        optInFastPeriod = 12;
      else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
      {
        num1 = -1;
        goto label_15;
      }
      if (optInSlowPeriod == int.MinValue)
        optInSlowPeriod = 26;
      else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
      {
        num1 = -1;
        goto label_15;
      }
      if (optInSignalPeriod == int.MinValue)
        optInSignalPeriod = 9;
      else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
      {
        num1 = -1;
        goto label_15;
      }
      if (optInSlowPeriod < optInFastPeriod)
      {
        int num2 = optInSlowPeriod;
        optInSlowPeriod = optInFastPeriod;
        optInFastPeriod = num2;
      }
      num1 = Core.EmaLookback(optInSlowPeriod) + Core.EmaLookback(optInSignalPeriod);
label_15:
      return num1;
    }

    public static Core.RetCode Macd(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInFastPeriod,
      int optInSlowPeriod,
      int optInSignalPeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outMACD,
      double[] outMACDSignal,
      double[] outMACDHist)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_19;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_19;
        }
        if (optInSignalPeriod == int.MinValue)
          optInSignalPeriod = 9;
        else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_19;
        }
        retCode = outMACD != null ? (outMACDSignal != null ? (outMACDHist != null ? Core.TA_INT_MACD(startIdx, endIdx, inReal, optInFastPeriod, optInSlowPeriod, optInSignalPeriod, out outBegIdx, out outNBElement, outMACD, outMACDSignal, outMACDHist) : Core.RetCode.BadParam) : Core.RetCode.BadParam) : Core.RetCode.BadParam;
      }
label_19:
      return retCode;
    }

    public static Core.RetCode Macd(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInFastPeriod,
      int optInSlowPeriod,
      int optInSignalPeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outMACD,
      double[] outMACDSignal,
      double[] outMACDHist)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_19;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_19;
        }
        if (optInSignalPeriod == int.MinValue)
          optInSignalPeriod = 9;
        else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_19;
        }
        retCode = outMACD != null ? (outMACDSignal != null ? (outMACDHist != null ? Core.TA_INT_MACD(startIdx, endIdx, inReal, optInFastPeriod, optInSlowPeriod, optInSignalPeriod, out outBegIdx, out outNBElement, outMACD, outMACDSignal, outMACDHist) : Core.RetCode.BadParam) : Core.RetCode.BadParam) : Core.RetCode.BadParam;
      }
label_19:
      return retCode;
    }

    public static int MacdExtLookback(
      int optInFastPeriod,
      Core.MAType optInFastMAType,
      int optInSlowPeriod,
      Core.MAType optInSlowMAType,
      int optInSignalPeriod,
      Core.MAType optInSignalMAType)
    {
      int num1;
      if (optInFastPeriod == int.MinValue)
        optInFastPeriod = 12;
      else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
      {
        num1 = -1;
        goto label_15;
      }
      if (optInSlowPeriod == int.MinValue)
        optInSlowPeriod = 26;
      else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
      {
        num1 = -1;
        goto label_15;
      }
      if (optInSignalPeriod == int.MinValue)
        optInSignalPeriod = 9;
      else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
      {
        num1 = -1;
        goto label_15;
      }
      int num2 = Core.MovingAverageLookback(optInFastPeriod, optInFastMAType);
      int num3 = Core.MovingAverageLookback(optInSlowPeriod, optInSlowMAType);
      if (num3 > num2)
        num2 = num3;
      num1 = num2 + Core.MovingAverageLookback(optInSignalPeriod, optInSignalMAType);
label_15:
      return num1;
    }

    public static Core.RetCode MacdExt(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInFastPeriod,
      Core.MAType optInFastMAType,
      int optInSlowPeriod,
      Core.MAType optInSlowMAType,
      int optInSignalPeriod,
      Core.MAType optInSignalMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outMACD,
      double[] outMACDSignal,
      double[] outMACDHist)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_51;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_51;
        }
        if (optInSignalPeriod == int.MinValue)
          optInSignalPeriod = 9;
        else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_51;
        }
        if (outMACD == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outMACDSignal == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outMACDHist == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          if (optInSlowPeriod < optInFastPeriod)
          {
            int num = optInSlowPeriod;
            optInSlowPeriod = optInFastPeriod;
            optInFastPeriod = num;
            Core.MAType maType = optInSlowMAType;
            optInSlowMAType = optInFastMAType;
            optInFastMAType = maType;
          }
          int num1 = Core.MovingAverageLookback(optInFastPeriod, optInFastMAType);
          int num2 = Core.MovingAverageLookback(optInSlowPeriod, optInSlowMAType);
          if (num2 > num1)
            num1 = num2;
          int sourceIndex = Core.MovingAverageLookback(optInSignalPeriod, optInSignalMAType);
          int num3 = sourceIndex + num1;
          if (startIdx < num3)
            startIdx = num3;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int length = endIdx - startIdx + 1 + sourceIndex;
            double[] numArray = new double[length];
            if (numArray == null)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double[] outReal = new double[length];
              if (outReal == null)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = Core.RetCode.AllocErr;
              }
              else
              {
                int startIdx1 = startIdx - sourceIndex;
                int outBegIdx1;
                int outNBElement1;
                Core.RetCode retCode2 = Core.MovingAverage(startIdx1, endIdx, inReal, optInSlowPeriod, optInSlowMAType, out outBegIdx1, out outNBElement1, outReal);
                if (retCode2 != Core.RetCode.Success)
                {
                  outBegIdx = 0;
                  outNBElement = 0;
                  retCode1 = retCode2;
                }
                else
                {
                  int outBegIdx2;
                  int outNBElement2;
                  Core.RetCode retCode3 = Core.MovingAverage(startIdx1, endIdx, inReal, optInFastPeriod, optInFastMAType, out outBegIdx2, out outNBElement2, numArray);
                  if (retCode3 != Core.RetCode.Success)
                  {
                    outBegIdx = 0;
                    outNBElement = 0;
                    retCode1 = retCode3;
                  }
                  else if (outBegIdx1 != startIdx1 || outBegIdx2 != startIdx1 || (outNBElement1 != outNBElement2 || outNBElement1 != endIdx - startIdx + 1 + sourceIndex))
                  {
                    outBegIdx = 0;
                    outNBElement = 0;
                    retCode1 = Core.RetCode.InternalError;
                  }
                  else
                  {
                    for (int index = 0; index < outNBElement1; ++index)
                      numArray[index] = numArray[index] - outReal[index];
                    Array.Copy((Array) numArray, sourceIndex, (Array) outMACD, 0, endIdx - startIdx + 1);
                    Core.RetCode retCode4 = Core.MovingAverage(0, outNBElement1 - 1, numArray, optInSignalPeriod, optInSignalMAType, out outBegIdx2, out outNBElement2, outMACDSignal);
                    if (retCode4 != Core.RetCode.Success)
                    {
                      outBegIdx = 0;
                      outNBElement = 0;
                      retCode1 = retCode4;
                    }
                    else
                    {
                      for (int index = 0; index < outNBElement2; ++index)
                        outMACDHist[index] = outMACD[index] - outMACDSignal[index];
                      outBegIdx = startIdx;
                      outNBElement = outNBElement2;
                      retCode1 = Core.RetCode.Success;
                    }
                  }
                }
              }
            }
          }
        }
      }
label_51:
      return retCode1;
    }

    public static Core.RetCode MacdExt(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInFastPeriod,
      Core.MAType optInFastMAType,
      int optInSlowPeriod,
      Core.MAType optInSlowMAType,
      int optInSignalPeriod,
      Core.MAType optInSignalMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outMACD,
      double[] outMACDSignal,
      double[] outMACDHist)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_51;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_51;
        }
        if (optInSignalPeriod == int.MinValue)
          optInSignalPeriod = 9;
        else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_51;
        }
        if (outMACD == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outMACDSignal == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outMACDHist == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          if (optInSlowPeriod < optInFastPeriod)
          {
            int num = optInSlowPeriod;
            optInSlowPeriod = optInFastPeriod;
            optInFastPeriod = num;
            Core.MAType maType = optInSlowMAType;
            optInSlowMAType = optInFastMAType;
            optInFastMAType = maType;
          }
          int num1 = Core.MovingAverageLookback(optInFastPeriod, optInFastMAType);
          int num2 = Core.MovingAverageLookback(optInSlowPeriod, optInSlowMAType);
          if (num2 > num1)
            num1 = num2;
          int sourceIndex = Core.MovingAverageLookback(optInSignalPeriod, optInSignalMAType);
          int num3 = sourceIndex + num1;
          if (startIdx < num3)
            startIdx = num3;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int length = endIdx - startIdx + 1 + sourceIndex;
            double[] numArray = new double[length];
            if (numArray == null)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double[] outReal = new double[length];
              if (outReal == null)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = Core.RetCode.AllocErr;
              }
              else
              {
                int startIdx1 = startIdx - sourceIndex;
                int outBegIdx1;
                int outNBElement1;
                Core.RetCode retCode2 = Core.MovingAverage(startIdx1, endIdx, inReal, optInSlowPeriod, optInSlowMAType, out outBegIdx1, out outNBElement1, outReal);
                if (retCode2 != Core.RetCode.Success)
                {
                  outBegIdx = 0;
                  outNBElement = 0;
                  retCode1 = retCode2;
                }
                else
                {
                  int outBegIdx2;
                  int outNBElement2;
                  Core.RetCode retCode3 = Core.MovingAverage(startIdx1, endIdx, inReal, optInFastPeriod, optInFastMAType, out outBegIdx2, out outNBElement2, numArray);
                  if (retCode3 != Core.RetCode.Success)
                  {
                    outBegIdx = 0;
                    outNBElement = 0;
                    retCode1 = retCode3;
                  }
                  else if (outBegIdx1 != startIdx1 || outBegIdx2 != startIdx1 || (outNBElement1 != outNBElement2 || outNBElement1 != endIdx - startIdx + 1 + sourceIndex))
                  {
                    outBegIdx = 0;
                    outNBElement = 0;
                    retCode1 = Core.RetCode.InternalError;
                  }
                  else
                  {
                    for (int index = 0; index < outNBElement1; ++index)
                      numArray[index] = numArray[index] - outReal[index];
                    Array.Copy((Array) numArray, sourceIndex, (Array) outMACD, 0, endIdx - startIdx + 1);
                    Core.RetCode retCode4 = Core.MovingAverage(0, outNBElement1 - 1, numArray, optInSignalPeriod, optInSignalMAType, out outBegIdx2, out outNBElement2, outMACDSignal);
                    if (retCode4 != Core.RetCode.Success)
                    {
                      outBegIdx = 0;
                      outNBElement = 0;
                      retCode1 = retCode4;
                    }
                    else
                    {
                      for (int index = 0; index < outNBElement2; ++index)
                        outMACDHist[index] = outMACD[index] - outMACDSignal[index];
                      outBegIdx = startIdx;
                      outNBElement = outNBElement2;
                      retCode1 = Core.RetCode.Success;
                    }
                  }
                }
              }
            }
          }
        }
      }
label_51:
      return retCode1;
    }

    public static int MacdFixLookback(int optInSignalPeriod)
    {
      int num;
      if (optInSignalPeriod == int.MinValue)
        optInSignalPeriod = 9;
      else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = Core.EmaLookback(26) + Core.EmaLookback(optInSignalPeriod);
label_5:
      return num;
    }

    public static Core.RetCode MacdFix(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInSignalPeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outMACD,
      double[] outMACDSignal,
      double[] outMACDHist)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInSignalPeriod == int.MinValue)
          optInSignalPeriod = 9;
        else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_11;
        }
        retCode = outMACD != null ? (outMACDSignal != null ? (outMACDHist != null ? Core.TA_INT_MACD(startIdx, endIdx, inReal, 0, 0, optInSignalPeriod, out outBegIdx, out outNBElement, outMACD, outMACDSignal, outMACDHist) : Core.RetCode.BadParam) : Core.RetCode.BadParam) : Core.RetCode.BadParam;
      }
label_11:
      return retCode;
    }

    public static Core.RetCode MacdFix(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInSignalPeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outMACD,
      double[] outMACDSignal,
      double[] outMACDHist)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInSignalPeriod == int.MinValue)
          optInSignalPeriod = 9;
        else if (optInSignalPeriod < 1 || optInSignalPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_11;
        }
        retCode = outMACD != null ? (outMACDSignal != null ? (outMACDHist != null ? Core.TA_INT_MACD(startIdx, endIdx, inReal, 0, 0, optInSignalPeriod, out outBegIdx, out outNBElement, outMACD, outMACDSignal, outMACDHist) : Core.RetCode.BadParam) : Core.RetCode.BadParam) : Core.RetCode.BadParam;
      }
label_11:
      return retCode;
    }

    public static int MamaLookback(double optInFastLimit, double optInSlowLimit)
    {
      int num;
      if (optInFastLimit == -4E+37)
        optInFastLimit = 0.5;
      else if (optInFastLimit < 0.01 || optInFastLimit > 0.99)
      {
        num = -1;
        goto label_9;
      }
      if (optInSlowLimit == -4E+37)
        optInSlowLimit = 0.05;
      else if (optInSlowLimit < 0.01 || optInSlowLimit > 0.99)
      {
        num = -1;
        goto label_9;
      }
      num = (int) Core.Globals.unstablePeriod[13] + 32;
label_9:
      return num;
    }

    public static Core.RetCode Mama(
      int startIdx,
      int endIdx,
      float[] inReal,
      double optInFastLimit,
      double optInSlowLimit,
      out int outBegIdx,
      out int outNBElement,
      double[] outMAMA,
      double[] outFAMA)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastLimit == -4E+37)
          optInFastLimit = 0.5;
        else if (optInFastLimit < 0.01 || optInFastLimit > 0.99)
        {
          retCode = Core.RetCode.BadParam;
          goto label_51;
        }
        if (optInSlowLimit == -4E+37)
          optInSlowLimit = 0.05;
        else if (optInSlowLimit < 0.01 || optInSlowLimit > 0.99)
        {
          retCode = Core.RetCode.BadParam;
          goto label_51;
        }
        if (outMAMA == null)
          retCode = Core.RetCode.BadParam;
        else if (outFAMA == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          double num1 = 180.0 / (4.0 * Math.Atan(1.0));
          int num2 = (int) Core.Globals.unstablePeriod[13] + 32;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num2;
            int index2 = index1;
            double num3 = (double) inReal[index2];
            int index3 = index2 + 1;
            double num4 = num3;
            double num5 = num3;
            double num6 = (double) inReal[index3];
            int index4 = index3 + 1;
            double num7 = num4 + num6;
            double num8 = num5 + num6 * 2.0;
            double num9 = (double) inReal[index4];
            int index5 = index4 + 1;
            double num10 = num7 + num9;
            double num11 = num8 + num9 * 3.0;
            double num12 = 0.0;
            int num13 = 9;
            do
            {
              double num14 = (double) inReal[index5];
              ++index5;
              num10 = num10 + num14 - num12;
              double num15 = num11 + num14 * 4.0;
              num12 = (double) inReal[index1];
              ++index1;
              double num16 = num15 * 0.1;
              num11 = num15 - num10;
              --num13;
            }
            while (num13 != 0);
            int index6 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num17 = 0.0;
            double num18 = 0.0;
            double num19 = 0.0;
            double num20 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            double num24 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            double num33 = 0.0;
            int index7 = 0;
            double num34 = 0.0;
            double num35 = num34;
            double num36 = 0.0;
            double num37 = num36;
            double num38 = 0.0;
            double num39 = num38;
            double num40 = 0.0;
            double num41 = num40;
            double num42 = 0.0;
            double num43 = num42;
            double num44 = 0.0;
            for (; index5 <= endIdx; ++index5)
            {
              double num14 = 0.075 * num33 + 0.54;
              double num15 = (double) inReal[index5];
              num10 = num10 + num15 - num12;
              double num16 = num11 + num15 * 4.0;
              num12 = (double) inReal[index1];
              ++index1;
              double num45 = num16 * 0.1;
              num11 = num16 - num10;
              double num46;
              double num47;
              double num48;
              if (index5 % 2 == 0)
              {
                double num49 = 0.0962 * num45;
                double num50 = -numArray2[index6];
                numArray2[index6] = num49;
                double num51 = num50 + num49 - num18;
                num18 = 0.5769 * num20;
                double num52 = num51 + num18;
                num20 = num45;
                double num53 = num52 * num14;
                double num54 = 0.0962 * num53;
                double num55 = -numArray4[index6];
                numArray4[index6] = num54;
                double num56 = num55 + num54 - num22;
                num22 = 0.5769 * num24;
                double num57 = num56 + num22;
                num24 = num53;
                double num58 = num57 * num14;
                double num59 = 0.0962 * num40;
                double num60 = -numArray6[index6];
                numArray6[index6] = num59;
                double num61 = num60 + num59 - num26;
                num26 = 0.5769 * num28;
                double num62 = num61 + num26;
                num28 = num40;
                double num63 = num62 * num14;
                double num64 = 0.0962 * num58;
                double num65 = -numArray8[index6];
                numArray8[index6] = num64;
                double num66 = num65 + num64 - num30;
                num30 = 0.5769 * num32;
                double num67 = num66 + num30;
                num32 = num58;
                double num68 = num67 * num14;
                ++index6;
                if (index6 == 3)
                  index6 = 0;
                num46 = 0.2 * (num58 + num63) + 0.8 * num34;
                num47 = 0.2 * (num40 - num68) + 0.8 * num35;
                num41 = num43;
                num43 = num53;
                num48 = num40 == 0.0 ? 0.0 : Math.Atan(num58 / num40) * num1;
              }
              else
              {
                double num49 = 0.0962 * num45;
                double num50 = -numArray1[index6];
                numArray1[index6] = num49;
                double num51 = num50 + num49 - num17;
                num17 = 0.5769 * num19;
                double num52 = num51 + num17;
                num19 = num45;
                double num53 = num52 * num14;
                double num54 = 0.0962 * num53;
                double num55 = -numArray3[index6];
                numArray3[index6] = num54;
                double num56 = num55 + num54 - num21;
                num21 = 0.5769 * num23;
                double num57 = num56 + num21;
                num23 = num53;
                double num58 = num57 * num14;
                double num59 = 0.0962 * num41;
                double num60 = -numArray5[index6];
                numArray5[index6] = num59;
                double num61 = num60 + num59 - num25;
                num25 = 0.5769 * num27;
                double num62 = num61 + num25;
                num27 = num41;
                double num63 = num62 * num14;
                double num64 = 0.0962 * num58;
                double num65 = -numArray7[index6];
                numArray7[index6] = num64;
                double num66 = num65 + num64 - num29;
                num29 = 0.5769 * num31;
                double num67 = num66 + num29;
                num31 = num58;
                double num68 = num67 * num14;
                num46 = 0.2 * (num58 + num63) + 0.8 * num34;
                num47 = 0.2 * (num41 - num68) + 0.8 * num35;
                num40 = num42;
                num42 = num53;
                num48 = num41 == 0.0 ? 0.0 : Math.Atan(num58 / num41) * num1;
              }
              double num69 = num44 - num48;
              num44 = num48;
              if (num69 < 1.0)
                num69 = 1.0;
              double num70;
              if (num69 > 1.0)
              {
                num70 = optInFastLimit / num69;
                if (num70 < optInSlowLimit)
                  num70 = optInSlowLimit;
              }
              else
                num70 = optInFastLimit;
              num39 = num70 * num15 + (1.0 - num70) * num39;
              double num71 = num70 * 0.5;
              num38 = num71 * num39 + (1.0 - num71) * num38;
              if (index5 >= startIdx)
              {
                outMAMA[index7] = num39;
                outFAMA[index7] = num38;
                ++index7;
              }
              num37 = 0.2 * (num47 * num35 + num46 * num34) + 0.8 * num37;
              num36 = 0.2 * (num47 * num34 - num46 * num35) + 0.8 * num36;
              num34 = num46;
              num35 = num47;
              double num72 = num33;
              if (num36 != 0.0 && num37 != 0.0)
                num33 = 360.0 / (Math.Atan(num36 / num37) * num1);
              double num73 = 1.5 * num72;
              if (num33 > num73)
                num33 = num73;
              double num74 = 0.67 * num72;
              if (num33 < num74)
                num33 = num74;
              if (num33 < 6.0)
                num33 = 6.0;
              else if (num33 > 50.0)
                num33 = 50.0;
              num33 = 0.2 * num33 + 0.8 * num72;
            }
            outNBElement = index7;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_51:
      return retCode;
    }

    public static Core.RetCode Mama(
      int startIdx,
      int endIdx,
      double[] inReal,
      double optInFastLimit,
      double optInSlowLimit,
      out int outBegIdx,
      out int outNBElement,
      double[] outMAMA,
      double[] outFAMA)
    {
      double[] numArray1 = new double[3];
      double[] numArray2 = new double[3];
      double[] numArray3 = new double[3];
      double[] numArray4 = new double[3];
      double[] numArray5 = new double[3];
      double[] numArray6 = new double[3];
      double[] numArray7 = new double[3];
      double[] numArray8 = new double[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastLimit == -4E+37)
          optInFastLimit = 0.5;
        else if (optInFastLimit < 0.01 || optInFastLimit > 0.99)
        {
          retCode = Core.RetCode.BadParam;
          goto label_51;
        }
        if (optInSlowLimit == -4E+37)
          optInSlowLimit = 0.05;
        else if (optInSlowLimit < 0.01 || optInSlowLimit > 0.99)
        {
          retCode = Core.RetCode.BadParam;
          goto label_51;
        }
        if (outMAMA == null)
          retCode = Core.RetCode.BadParam;
        else if (outFAMA == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          double num1 = 180.0 / (4.0 * Math.Atan(1.0));
          int num2 = (int) Core.Globals.unstablePeriod[13] + 32;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num2;
            int index2 = index1;
            double num3 = inReal[index2];
            int index3 = index2 + 1;
            double num4 = num3;
            double num5 = num3;
            double num6 = inReal[index3];
            int index4 = index3 + 1;
            double num7 = num4 + num6;
            double num8 = num5 + num6 * 2.0;
            double num9 = inReal[index4];
            int index5 = index4 + 1;
            double num10 = num7 + num9;
            double num11 = num8 + num9 * 3.0;
            double num12 = 0.0;
            int num13 = 9;
            do
            {
              double num14 = inReal[index5];
              ++index5;
              num10 = num10 + num14 - num12;
              double num15 = num11 + num14 * 4.0;
              num12 = inReal[index1];
              ++index1;
              double num16 = num15 * 0.1;
              num11 = num15 - num10;
              --num13;
            }
            while (num13 != 0);
            int index6 = 0;
            numArray1[0] = 0.0;
            numArray1[1] = 0.0;
            numArray1[2] = 0.0;
            numArray2[0] = 0.0;
            numArray2[1] = 0.0;
            numArray2[2] = 0.0;
            double num17 = 0.0;
            double num18 = 0.0;
            double num19 = 0.0;
            double num20 = 0.0;
            numArray3[0] = 0.0;
            numArray3[1] = 0.0;
            numArray3[2] = 0.0;
            numArray4[0] = 0.0;
            numArray4[1] = 0.0;
            numArray4[2] = 0.0;
            double num21 = 0.0;
            double num22 = 0.0;
            double num23 = 0.0;
            double num24 = 0.0;
            numArray5[0] = 0.0;
            numArray5[1] = 0.0;
            numArray5[2] = 0.0;
            numArray6[0] = 0.0;
            numArray6[1] = 0.0;
            numArray6[2] = 0.0;
            double num25 = 0.0;
            double num26 = 0.0;
            double num27 = 0.0;
            double num28 = 0.0;
            numArray7[0] = 0.0;
            numArray7[1] = 0.0;
            numArray7[2] = 0.0;
            numArray8[0] = 0.0;
            numArray8[1] = 0.0;
            numArray8[2] = 0.0;
            double num29 = 0.0;
            double num30 = 0.0;
            double num31 = 0.0;
            double num32 = 0.0;
            double num33 = 0.0;
            int index7 = 0;
            double num34 = 0.0;
            double num35 = num34;
            double num36 = 0.0;
            double num37 = num36;
            double num38 = 0.0;
            double num39 = num38;
            double num40 = 0.0;
            double num41 = num40;
            double num42 = 0.0;
            double num43 = num42;
            double num44 = 0.0;
            for (; index5 <= endIdx; ++index5)
            {
              double num14 = 0.075 * num33 + 0.54;
              double num15 = inReal[index5];
              num10 = num10 + num15 - num12;
              double num16 = num11 + num15 * 4.0;
              num12 = inReal[index1];
              ++index1;
              double num45 = num16 * 0.1;
              num11 = num16 - num10;
              double num46;
              double num47;
              double num48;
              if (index5 % 2 == 0)
              {
                double num49 = 0.0962 * num45;
                double num50 = -numArray2[index6];
                numArray2[index6] = num49;
                double num51 = num50 + num49 - num18;
                num18 = 0.5769 * num20;
                double num52 = num51 + num18;
                num20 = num45;
                double num53 = num52 * num14;
                double num54 = 0.0962 * num53;
                double num55 = -numArray4[index6];
                numArray4[index6] = num54;
                double num56 = num55 + num54 - num22;
                num22 = 0.5769 * num24;
                double num57 = num56 + num22;
                num24 = num53;
                double num58 = num57 * num14;
                double num59 = 0.0962 * num40;
                double num60 = -numArray6[index6];
                numArray6[index6] = num59;
                double num61 = num60 + num59 - num26;
                num26 = 0.5769 * num28;
                double num62 = num61 + num26;
                num28 = num40;
                double num63 = num62 * num14;
                double num64 = 0.0962 * num58;
                double num65 = -numArray8[index6];
                numArray8[index6] = num64;
                double num66 = num65 + num64 - num30;
                num30 = 0.5769 * num32;
                double num67 = num66 + num30;
                num32 = num58;
                double num68 = num67 * num14;
                ++index6;
                if (index6 == 3)
                  index6 = 0;
                num46 = 0.2 * (num58 + num63) + 0.8 * num34;
                num47 = 0.2 * (num40 - num68) + 0.8 * num35;
                num41 = num43;
                num43 = num53;
                num48 = num40 == 0.0 ? 0.0 : Math.Atan(num58 / num40) * num1;
              }
              else
              {
                double num49 = 0.0962 * num45;
                double num50 = -numArray1[index6];
                numArray1[index6] = num49;
                double num51 = num50 + num49 - num17;
                num17 = 0.5769 * num19;
                double num52 = num51 + num17;
                num19 = num45;
                double num53 = num52 * num14;
                double num54 = 0.0962 * num53;
                double num55 = -numArray3[index6];
                numArray3[index6] = num54;
                double num56 = num55 + num54 - num21;
                num21 = 0.5769 * num23;
                double num57 = num56 + num21;
                num23 = num53;
                double num58 = num57 * num14;
                double num59 = 0.0962 * num41;
                double num60 = -numArray5[index6];
                numArray5[index6] = num59;
                double num61 = num60 + num59 - num25;
                num25 = 0.5769 * num27;
                double num62 = num61 + num25;
                num27 = num41;
                double num63 = num62 * num14;
                double num64 = 0.0962 * num58;
                double num65 = -numArray7[index6];
                numArray7[index6] = num64;
                double num66 = num65 + num64 - num29;
                num29 = 0.5769 * num31;
                double num67 = num66 + num29;
                num31 = num58;
                double num68 = num67 * num14;
                num46 = 0.2 * (num58 + num63) + 0.8 * num34;
                num47 = 0.2 * (num41 - num68) + 0.8 * num35;
                num40 = num42;
                num42 = num53;
                num48 = num41 == 0.0 ? 0.0 : Math.Atan(num58 / num41) * num1;
              }
              double num69 = num44 - num48;
              num44 = num48;
              if (num69 < 1.0)
                num69 = 1.0;
              double num70;
              if (num69 > 1.0)
              {
                num70 = optInFastLimit / num69;
                if (num70 < optInSlowLimit)
                  num70 = optInSlowLimit;
              }
              else
                num70 = optInFastLimit;
              num39 = num70 * num15 + (1.0 - num70) * num39;
              double num71 = num70 * 0.5;
              num38 = num71 * num39 + (1.0 - num71) * num38;
              if (index5 >= startIdx)
              {
                outMAMA[index7] = num39;
                outFAMA[index7] = num38;
                ++index7;
              }
              num37 = 0.2 * (num47 * num35 + num46 * num34) + 0.8 * num37;
              num36 = 0.2 * (num47 * num34 - num46 * num35) + 0.8 * num36;
              num34 = num46;
              num35 = num47;
              double num72 = num33;
              if (num36 != 0.0 && num37 != 0.0)
                num33 = 360.0 / (Math.Atan(num36 / num37) * num1);
              double num73 = 1.5 * num72;
              if (num33 > num73)
                num33 = num73;
              double num74 = 0.67 * num72;
              if (num33 < num74)
                num33 = num74;
              if (num33 < 6.0)
                num33 = 6.0;
              else if (num33 > 50.0)
                num33 = 50.0;
              num33 = 0.2 * num33 + 0.8 * num72;
            }
            outNBElement = index7;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_51:
      return retCode;
    }

    public static int MovingAverageVariablePeriodLookback(
      int optInMinPeriod,
      int optInMaxPeriod,
      Core.MAType optInMAType)
    {
      int num;
      if (optInMinPeriod == int.MinValue)
        optInMinPeriod = 2;
      else if (optInMinPeriod < 2 || optInMinPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInMaxPeriod == int.MinValue)
        optInMaxPeriod = 30;
      else if (optInMaxPeriod < 2 || optInMaxPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      num = Core.MovingAverageLookback(optInMaxPeriod, optInMAType);
label_9:
      return num;
    }

    public static Core.RetCode MovingAverageVariablePeriod(
      int startIdx,
      int endIdx,
      float[] inReal,
      float[] inPeriods,
      int optInMinPeriod,
      int optInMaxPeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode1 = Core.RetCode.BadParam;
      else if (inPeriods == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInMinPeriod == int.MinValue)
          optInMinPeriod = 2;
        else if (optInMinPeriod < 2 || optInMinPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_43;
        }
        if (optInMaxPeriod == int.MinValue)
          optInMaxPeriod = 30;
        else if (optInMaxPeriod < 2 || optInMaxPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_43;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.MovingAverageLookback(optInMaxPeriod, optInMAType);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int num2 = num1 <= startIdx ? startIdx : num1;
            if (num2 > endIdx)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = Core.RetCode.Success;
            }
            else
            {
              int length = endIdx - num2 + 1;
              double[] outReal1 = new double[length];
              int[] numArray = new int[length];
              for (int index = 0; index < length; ++index)
              {
                int num3 = (int) inPeriods[startIdx + index];
                if (num3 < optInMinPeriod)
                  num3 = optInMinPeriod;
                else if (num3 > optInMaxPeriod)
                  num3 = optInMaxPeriod;
                numArray[index] = num3;
              }
              for (int index1 = 0; index1 < length; ++index1)
              {
                int optInTimePeriod = numArray[index1];
                if (optInTimePeriod == 0)
                  continue;
                Core.RetCode retCode2 = Core.MovingAverage(startIdx, endIdx, inReal, optInTimePeriod, optInMAType, out int _, out int _, outReal1);
                if (retCode2 != Core.RetCode.Success)
                {
                  outBegIdx = 0;
                  outNBElement = 0;
                  retCode1 = retCode2;
                  goto label_43;
                }
                else
                {
                  outReal[index1] = outReal1[index1];
                  for (int index2 = index1 + 1; index2 < length; ++index2)
                  {
                    if (numArray[index2] != optInTimePeriod)
                      continue;
                    numArray[index2] = 0;
                    outReal[index2] = outReal1[index2];
                  }
                }
              }
              outBegIdx = startIdx;
              outNBElement = length;
              retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_43:
      return retCode1;
    }

    public static Core.RetCode MovingAverageVariablePeriod(
      int startIdx,
      int endIdx,
      double[] inReal,
      double[] inPeriods,
      int optInMinPeriod,
      int optInMaxPeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode1 = Core.RetCode.BadParam;
      else if (inPeriods == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInMinPeriod == int.MinValue)
          optInMinPeriod = 2;
        else if (optInMinPeriod < 2 || optInMinPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_43;
        }
        if (optInMaxPeriod == int.MinValue)
          optInMaxPeriod = 30;
        else if (optInMaxPeriod < 2 || optInMaxPeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_43;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.MovingAverageLookback(optInMaxPeriod, optInMAType);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int num2 = num1 <= startIdx ? startIdx : num1;
            if (num2 > endIdx)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = Core.RetCode.Success;
            }
            else
            {
              int length = endIdx - num2 + 1;
              double[] outReal1 = new double[length];
              int[] numArray = new int[length];
              for (int index = 0; index < length; ++index)
              {
                int num3 = (int) inPeriods[startIdx + index];
                if (num3 < optInMinPeriod)
                  num3 = optInMinPeriod;
                else if (num3 > optInMaxPeriod)
                  num3 = optInMaxPeriod;
                numArray[index] = num3;
              }
              for (int index1 = 0; index1 < length; ++index1)
              {
                int optInTimePeriod = numArray[index1];
                if (optInTimePeriod == 0)
                  continue;
                Core.RetCode retCode2 = Core.MovingAverage(startIdx, endIdx, inReal, optInTimePeriod, optInMAType, out int _, out int _, outReal1);
                if (retCode2 != Core.RetCode.Success)
                {
                  outBegIdx = 0;
                  outNBElement = 0;
                  retCode1 = retCode2;
                  goto label_43;
                }
                else
                {
                  outReal[index1] = outReal1[index1];
                  for (int index2 = index1 + 1; index2 < length; ++index2)
                  {
                    if (numArray[index2] != optInTimePeriod)
                      continue;
                    numArray[index2] = 0;
                    outReal[index2] = outReal1[index2];
                  }
                }
              }
              outBegIdx = startIdx;
              outNBElement = length;
              retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_43:
      return retCode1;
    }

    public static int MaxLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Max(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = (double) inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = (double) inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = (double) inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 <= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 >= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outReal[index1] = num3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode Max(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 <= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 >= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outReal[index1] = num3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int MaxIndexLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode MaxIndex(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = (double) inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = (double) inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = (double) inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 <= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 >= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outInteger[index1] = index3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode MaxIndex(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 <= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 >= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outInteger[index1] = index3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int MedPriceLookback()
    {
      return 0;
    }

    public static Core.RetCode MedPrice(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = ((double) inHigh[index2] + (double) inLow[index2]) / 2.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode MedPrice(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = (inHigh[index2] + inLow[index2]) / 2.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int MfiLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod + (int) Core.Globals.unstablePeriod[14];
label_5:
      return num;
    }

    public static Core.RetCode Mfi(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      float[] inVolume,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      int index1 = 0;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || (inClose == null || inVolume == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_57;
        }
        if (outReal == null)
          retCode = Core.RetCode.BadParam;
        else if (optInTimePeriod <= 0)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          MoneyFlow[] moneyFlowArray = new MoneyFlow[optInTimePeriod];
          for (int index2 = 0; index2 < moneyFlowArray.Length; ++index2)
            moneyFlowArray[index2] = new MoneyFlow();
          if (moneyFlowArray == null)
          {
            retCode = Core.RetCode.AllocErr;
          }
          else
          {
            int num1 = optInTimePeriod - 1;
            outBegIdx = 0;
            outNBElement = 0;
            int num2 = optInTimePeriod + (int) Core.Globals.unstablePeriod[14];
            if (startIdx < num2)
              startIdx = num2;
            if (startIdx > endIdx)
            {
              retCode = Core.RetCode.Success;
            }
            else
            {
              int index2 = 0;
              int index3 = startIdx - num2;
              double num3 = ((double) inHigh[index3] + (double) inLow[index3] + (double) inClose[index3]) / 3.0;
              double num4 = 0.0;
              double num5 = 0.0;
              int index4 = index3 + 1;
              for (int index5 = optInTimePeriod; index5 > 0; --index5)
              {
                double num6 = ((double) inHigh[index4] + (double) inLow[index4] + (double) inClose[index4]) / 3.0;
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = num6 * (double) inVolume[index4];
                ++index4;
                if (num7 < 0.0)
                {
                  moneyFlowArray[index1].negative = num8;
                  num5 += num8;
                  moneyFlowArray[index1].positive = 0.0;
                }
                else if (num7 > 0.0)
                {
                  moneyFlowArray[index1].positive = num8;
                  num4 += num8;
                  moneyFlowArray[index1].negative = 0.0;
                }
                else
                {
                  moneyFlowArray[index1].positive = 0.0;
                  moneyFlowArray[index1].negative = 0.0;
                }
                ++index1;
                if (index1 <= num1)
                  continue;
                index1 = 0;
              }
              if (index4 > startIdx)
              {
                double num6 = num4 + num5;
                if (num6 < 1.0)
                {
                  outReal[index2] = 0.0;
                  ++index2;
                }
                else
                {
                  outReal[index2] = 100.0 * (num4 / num6);
                  ++index2;
                }
              }
              else
              {
                while (index4 < startIdx)
                {
                  num4 -= moneyFlowArray[index1].positive;
                  num5 -= moneyFlowArray[index1].negative;
                  double num6 = ((double) inHigh[index4] + (double) inLow[index4] + (double) inClose[index4]) / 3.0;
                  double num7 = num6 - num3;
                  num3 = num6;
                  double num8 = num6 * (double) inVolume[index4];
                  ++index4;
                  if (num7 < 0.0)
                  {
                    moneyFlowArray[index1].negative = num8;
                    num5 += num8;
                    moneyFlowArray[index1].positive = 0.0;
                  }
                  else if (num7 > 0.0)
                  {
                    moneyFlowArray[index1].positive = num8;
                    num4 += num8;
                    moneyFlowArray[index1].negative = 0.0;
                  }
                  else
                  {
                    moneyFlowArray[index1].positive = 0.0;
                    moneyFlowArray[index1].negative = 0.0;
                  }
                  ++index1;
                  if (index1 > num1)
                    index1 = 0;
                }
              }
              while (index4 <= endIdx)
              {
                num4 -= moneyFlowArray[index1].positive;
                num5 -= moneyFlowArray[index1].negative;
                double num6 = ((double) inHigh[index4] + (double) inLow[index4] + (double) inClose[index4]) / 3.0;
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = num6 * (double) inVolume[index4];
                ++index4;
                if (num7 < 0.0)
                {
                  moneyFlowArray[index1].negative = num8;
                  num5 += num8;
                  moneyFlowArray[index1].positive = 0.0;
                }
                else if (num7 > 0.0)
                {
                  moneyFlowArray[index1].positive = num8;
                  num4 += num8;
                  moneyFlowArray[index1].negative = 0.0;
                }
                else
                {
                  moneyFlowArray[index1].positive = 0.0;
                  moneyFlowArray[index1].negative = 0.0;
                }
                double num9 = num4 + num5;
                if (num9 < 1.0)
                {
                  outReal[index2] = 0.0;
                  ++index2;
                }
                else
                {
                  outReal[index2] = 100.0 * (num4 / num9);
                  ++index2;
                }
                ++index1;
                if (index1 > num1)
                  index1 = 0;
              }
              outBegIdx = startIdx;
              outNBElement = index2;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_57:
      return retCode;
    }

    public static Core.RetCode Mfi(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      double[] inVolume,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      int index1 = 0;
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || (inClose == null || inVolume == null))
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_57;
        }
        if (outReal == null)
          retCode = Core.RetCode.BadParam;
        else if (optInTimePeriod <= 0)
        {
          retCode = Core.RetCode.AllocErr;
        }
        else
        {
          MoneyFlow[] moneyFlowArray = new MoneyFlow[optInTimePeriod];
          for (int index2 = 0; index2 < moneyFlowArray.Length; ++index2)
            moneyFlowArray[index2] = new MoneyFlow();
          if (moneyFlowArray == null)
          {
            retCode = Core.RetCode.AllocErr;
          }
          else
          {
            int num1 = optInTimePeriod - 1;
            outBegIdx = 0;
            outNBElement = 0;
            int num2 = optInTimePeriod + (int) Core.Globals.unstablePeriod[14];
            if (startIdx < num2)
              startIdx = num2;
            if (startIdx > endIdx)
            {
              retCode = Core.RetCode.Success;
            }
            else
            {
              int index2 = 0;
              int index3 = startIdx - num2;
              double num3 = (inHigh[index3] + inLow[index3] + inClose[index3]) / 3.0;
              double num4 = 0.0;
              double num5 = 0.0;
              int index4 = index3 + 1;
              for (int index5 = optInTimePeriod; index5 > 0; --index5)
              {
                double num6 = (inHigh[index4] + inLow[index4] + inClose[index4]) / 3.0;
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = num6 * inVolume[index4];
                ++index4;
                if (num7 < 0.0)
                {
                  moneyFlowArray[index1].negative = num8;
                  num5 += num8;
                  moneyFlowArray[index1].positive = 0.0;
                }
                else if (num7 > 0.0)
                {
                  moneyFlowArray[index1].positive = num8;
                  num4 += num8;
                  moneyFlowArray[index1].negative = 0.0;
                }
                else
                {
                  moneyFlowArray[index1].positive = 0.0;
                  moneyFlowArray[index1].negative = 0.0;
                }
                ++index1;
                if (index1 <= num1)
                  continue;
                index1 = 0;
              }
              if (index4 > startIdx)
              {
                double num6 = num4 + num5;
                if (num6 < 1.0)
                {
                  outReal[index2] = 0.0;
                  ++index2;
                }
                else
                {
                  outReal[index2] = 100.0 * (num4 / num6);
                  ++index2;
                }
              }
              else
              {
                while (index4 < startIdx)
                {
                  num4 -= moneyFlowArray[index1].positive;
                  num5 -= moneyFlowArray[index1].negative;
                  double num6 = (inHigh[index4] + inLow[index4] + inClose[index4]) / 3.0;
                  double num7 = num6 - num3;
                  num3 = num6;
                  double num8 = num6 * inVolume[index4];
                  ++index4;
                  if (num7 < 0.0)
                  {
                    moneyFlowArray[index1].negative = num8;
                    num5 += num8;
                    moneyFlowArray[index1].positive = 0.0;
                  }
                  else if (num7 > 0.0)
                  {
                    moneyFlowArray[index1].positive = num8;
                    num4 += num8;
                    moneyFlowArray[index1].negative = 0.0;
                  }
                  else
                  {
                    moneyFlowArray[index1].positive = 0.0;
                    moneyFlowArray[index1].negative = 0.0;
                  }
                  ++index1;
                  if (index1 > num1)
                    index1 = 0;
                }
              }
              while (index4 <= endIdx)
              {
                num4 -= moneyFlowArray[index1].positive;
                num5 -= moneyFlowArray[index1].negative;
                double num6 = (inHigh[index4] + inLow[index4] + inClose[index4]) / 3.0;
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = num6 * inVolume[index4];
                ++index4;
                if (num7 < 0.0)
                {
                  moneyFlowArray[index1].negative = num8;
                  num5 += num8;
                  moneyFlowArray[index1].positive = 0.0;
                }
                else if (num7 > 0.0)
                {
                  moneyFlowArray[index1].positive = num8;
                  num4 += num8;
                  moneyFlowArray[index1].negative = 0.0;
                }
                else
                {
                  moneyFlowArray[index1].positive = 0.0;
                  moneyFlowArray[index1].negative = 0.0;
                }
                double num9 = num4 + num5;
                if (num9 < 1.0)
                {
                  outReal[index2] = 0.0;
                  ++index2;
                }
                else
                {
                  outReal[index2] = 100.0 * (num4 / num9);
                  ++index2;
                }
                ++index1;
                if (index1 > num1)
                  index1 = 0;
              }
              outBegIdx = startIdx;
              outNBElement = index2;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_57:
      return retCode;
    }

    public static int MidPointLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode MidPoint(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num2 = startIdx;
            int index2 = startIdx - num1;
            for (; num2 <= endIdx; ++num2)
            {
              double num3 = (double) inReal[index2];
              ++index2;
              double num4 = num3;
              for (int index3 = index2; index3 <= num2; ++index3)
              {
                double num5 = (double) inReal[index3];
                if (num5 >= num3)
                  goto label_23;
                num3 = num5;
                continue;
label_23:
                if (num5 > num4)
                  num4 = num5;
              }
              outReal[index1] = (num4 + num3) / 2.0;
              ++index1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode MidPoint(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num2 = startIdx;
            int index2 = startIdx - num1;
            for (; num2 <= endIdx; ++num2)
            {
              double num3 = inReal[index2];
              ++index2;
              double num4 = num3;
              for (int index3 = index2; index3 <= num2; ++index3)
              {
                double num5 = inReal[index3];
                if (num5 >= num3)
                  goto label_23;
                num3 = num5;
                continue;
label_23:
                if (num5 > num4)
                  num4 = num5;
              }
              outReal[index1] = (num4 + num3) / 2.0;
              ++index1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int MidPriceLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode MidPrice(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num2 = startIdx;
            int index2 = startIdx - num1;
            for (; num2 <= endIdx; ++num2)
            {
              double num3 = (double) inLow[index2];
              double num4 = (double) inHigh[index2];
              ++index2;
              for (int index3 = index2; index3 <= num2; ++index3)
              {
                double num5 = (double) inLow[index3];
                if (num5 < num3)
                  num3 = num5;
                double num6 = (double) inHigh[index3];
                if (num6 <= num4)
                  continue;
                num4 = num6;
              }
              outReal[index1] = (num4 + num3) / 2.0;
              ++index1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode MidPrice(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num2 = startIdx;
            int index2 = startIdx - num1;
            for (; num2 <= endIdx; ++num2)
            {
              double num3 = inLow[index2];
              double num4 = inHigh[index2];
              ++index2;
              for (int index3 = index2; index3 <= num2; ++index3)
              {
                double num5 = inLow[index3];
                if (num5 < num3)
                  num3 = num5;
                double num6 = inHigh[index3];
                if (num6 <= num4)
                  continue;
                num4 = num6;
              }
              outReal[index1] = (num4 + num3) / 2.0;
              ++index1;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int MinLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Min(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = (double) inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = (double) inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = (double) inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 >= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 <= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outReal[index1] = num3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode Min(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 >= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 <= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outReal[index1] = num3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int MinIndexLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode MinIndex(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = (double) inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = (double) inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = (double) inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 >= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 <= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outInteger[index1] = index3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static Core.RetCode MinIndex(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      int[] outInteger)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outInteger == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num4 = inReal[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num3 = inReal[index3];
                int index4 = index3;
                while (true)
                {
                  double num5;
                  do
                  {
                    ++index4;
                    if (index4 <= index2)
                      num5 = inReal[index4];
                    else
                      goto label_25;
                  }
                  while (num5 >= num3);
                  index3 = index4;
                  num3 = num5;
                }
              }
              else if (num4 <= num3)
              {
                index3 = index2;
                num3 = num4;
              }
label_25:
              outInteger[index1] = index3;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_27:
      return retCode;
    }

    public static int MinMaxLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode MinMax(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outMin,
      double[] outMax)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outMin == null)
          retCode = Core.RetCode.BadParam;
        else if (outMax == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            int index4 = -1;
            double num4 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = (double) inReal[index2];
              double num6 = num5;
              if (index3 < num2)
              {
                index3 = num2;
                num3 = (double) inReal[index3];
                int index5 = index3;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = (double) inReal[index5];
                    else
                      goto label_27;
                  }
                  while (num7 <= num3);
                  index3 = index5;
                  num3 = num7;
                }
              }
              else if (num5 >= num3)
              {
                index3 = index2;
                num3 = num5;
              }
label_27:
              if (index4 < num2)
              {
                index4 = num2;
                num4 = (double) inReal[index4];
                int index5 = index4;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = (double) inReal[index5];
                    else
                      goto label_34;
                  }
                  while (num7 >= num4);
                  index4 = index5;
                  num4 = num7;
                }
              }
              else if (num6 <= num4)
              {
                index4 = index2;
                num4 = num6;
              }
label_34:
              outMax[index1] = num3;
              outMin[index1] = num4;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static Core.RetCode MinMax(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outMin,
      double[] outMax)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outMin == null)
          retCode = Core.RetCode.BadParam;
        else if (outMax == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            int index4 = -1;
            double num4 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = inReal[index2];
              double num6 = num5;
              if (index3 < num2)
              {
                index3 = num2;
                num3 = inReal[index3];
                int index5 = index3;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = inReal[index5];
                    else
                      goto label_27;
                  }
                  while (num7 <= num3);
                  index3 = index5;
                  num3 = num7;
                }
              }
              else if (num5 >= num3)
              {
                index3 = index2;
                num3 = num5;
              }
label_27:
              if (index4 < num2)
              {
                index4 = num2;
                num4 = inReal[index4];
                int index5 = index4;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = inReal[index5];
                    else
                      goto label_34;
                  }
                  while (num7 >= num4);
                  index4 = index5;
                  num4 = num7;
                }
              }
              else if (num6 <= num4)
              {
                index4 = index2;
                num4 = num6;
              }
label_34:
              outMax[index1] = num3;
              outMin[index1] = num4;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static int MinMaxIndexLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode MinMaxIndex(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      int[] outMinIdx,
      int[] outMaxIdx)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outMinIdx == null)
          retCode = Core.RetCode.BadParam;
        else if (outMaxIdx == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            int index4 = -1;
            double num4 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = (double) inReal[index2];
              double num6 = num5;
              if (index3 < num2)
              {
                index3 = num2;
                num3 = (double) inReal[index3];
                int index5 = index3;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = (double) inReal[index5];
                    else
                      goto label_27;
                  }
                  while (num7 <= num3);
                  index3 = index5;
                  num3 = num7;
                }
              }
              else if (num5 >= num3)
              {
                index3 = index2;
                num3 = num5;
              }
label_27:
              if (index4 < num2)
              {
                index4 = num2;
                num4 = (double) inReal[index4];
                int index5 = index4;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = (double) inReal[index5];
                    else
                      goto label_34;
                  }
                  while (num7 >= num4);
                  index4 = index5;
                  num4 = num7;
                }
              }
              else if (num6 <= num4)
              {
                index4 = index2;
                num4 = num6;
              }
label_34:
              outMaxIdx[index1] = index3;
              outMinIdx[index1] = index4;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static Core.RetCode MinMaxIndex(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      int[] outMinIdx,
      int[] outMaxIdx)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outMinIdx == null)
          retCode = Core.RetCode.BadParam;
        else if (outMaxIdx == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            double num3 = 0.0;
            int index4 = -1;
            double num4 = 0.0;
            for (; index2 <= endIdx; ++index2)
            {
              double num5 = inReal[index2];
              double num6 = num5;
              if (index3 < num2)
              {
                index3 = num2;
                num3 = inReal[index3];
                int index5 = index3;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = inReal[index5];
                    else
                      goto label_27;
                  }
                  while (num7 <= num3);
                  index3 = index5;
                  num3 = num7;
                }
              }
              else if (num5 >= num3)
              {
                index3 = index2;
                num3 = num5;
              }
label_27:
              if (index4 < num2)
              {
                index4 = num2;
                num4 = inReal[index4];
                int index5 = index4;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = inReal[index5];
                    else
                      goto label_34;
                  }
                  while (num7 >= num4);
                  index4 = index5;
                  num4 = num7;
                }
              }
              else if (num6 <= num4)
              {
                index4 = index2;
                num4 = num6;
              }
label_34:
              outMaxIdx[index1] = index3;
              outMinIdx[index1] = index4;
              ++index1;
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static int MinusDILookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[15];
label_5:
      return num;
    }

    public static Core.RetCode MinusDI(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_62;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[15];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = (double) inHigh[index2];
              double num3 = (double) inLow[index2];
              double num4 = (double) inClose[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num5 = (double) inHigh[index2];
                double num6 = num5 - num2;
                num2 = num5;
                double num7 = (double) inLow[index2];
                double num8 = num3 - num7;
                num3 = num7;
                if (num8 > 0.0 && num6 < num8)
                {
                  double num9 = num2 - num3;
                  double num10 = Math.Abs(num2 - num4);
                  if (num10 > num9)
                    num9 = num10;
                  double num11 = Math.Abs(num3 - num4);
                  if (num11 > num9)
                    num9 = num11;
                  if (-1E-08 < num9 && num9 < 1E-08)
                  {
                    outReal[index1] = 0.0;
                    ++index1;
                  }
                  else
                  {
                    outReal[index1] = num8 / num9;
                    ++index1;
                  }
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                num4 = (double) inClose[index2];
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              int num2 = startIdx;
              outBegIdx = num2;
              double num3 = 0.0;
              double num4 = 0.0;
              int index2 = startIdx - num1;
              double num5 = (double) inHigh[index2];
              double num6 = (double) inLow[index2];
              double num7 = (double) inClose[index2];
              int num8 = optInTimePeriod - 1;
              while (true)
              {
                int num9 = num8;
                --num8;
                if (num9 > 0)
                {
                  ++index2;
                  double num10 = (double) inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = (double) inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num13 > 0.0 && num11 < num13)
                    num3 += num13;
                  double num14 = num5 - num6;
                  double num15 = Math.Abs(num5 - num7);
                  if (num15 > num14)
                    num14 = num15;
                  double num16 = Math.Abs(num6 - num7);
                  if (num16 > num14)
                    num14 = num16;
                  num4 += num14;
                  num7 = (double) inClose[index2];
                }
                else
                  break;
              }
              int num17 = (int) Core.Globals.unstablePeriod[15] + 1;
              while (true)
              {
                int num9 = num17;
                --num17;
                if (num9 != 0)
                {
                  ++index2;
                  double num10 = (double) inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = (double) inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num13 > 0.0 && num11 < num13)
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod + num13;
                  }
                  else
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod;
                  }
                  double num15 = num5 - num6;
                  double num16 = Math.Abs(num5 - num7);
                  if (num16 > num15)
                    num15 = num16;
                  double num18 = Math.Abs(num6 - num7);
                  if (num18 > num15)
                    num15 = num18;
                  double num19 = num4;
                  num4 = num19 - num19 / (double) optInTimePeriod + num15;
                  num7 = (double) inClose[index2];
                }
                else
                  break;
              }
              outReal[0] = -1E-08 >= num4 || num4 >= 1E-08 ? 100.0 * (num3 / num4) : 0.0;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num9 = (double) inHigh[index2];
                double num10 = num9 - num5;
                num5 = num9;
                double num11 = (double) inLow[index2];
                double num12 = num6 - num11;
                num6 = num11;
                if (num12 > 0.0 && num10 < num12)
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod + num12;
                }
                else
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod;
                }
                double num14 = num5 - num6;
                double num15 = Math.Abs(num5 - num7);
                if (num15 > num14)
                  num14 = num15;
                double num16 = Math.Abs(num6 - num7);
                if (num16 > num14)
                  num14 = num16;
                double num18 = num4;
                num4 = num18 - num18 / (double) optInTimePeriod + num14;
                num7 = (double) inClose[index2];
                if (-1E-08 >= num4 || num4 >= 1E-08)
                {
                  outReal[index3] = 100.0 * (num3 / num4);
                  ++index3;
                }
                else
                {
                  outReal[index3] = 0.0;
                  ++index3;
                }
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_62:
      return retCode;
    }

    public static Core.RetCode MinusDI(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_62;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[15];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = inHigh[index2];
              double num3 = inLow[index2];
              double num4 = inClose[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num5 = inHigh[index2];
                double num6 = num5 - num2;
                num2 = num5;
                double num7 = inLow[index2];
                double num8 = num3 - num7;
                num3 = num7;
                if (num8 > 0.0 && num6 < num8)
                {
                  double num9 = num2 - num3;
                  double num10 = Math.Abs(num2 - num4);
                  if (num10 > num9)
                    num9 = num10;
                  double num11 = Math.Abs(num3 - num4);
                  if (num11 > num9)
                    num9 = num11;
                  if (-1E-08 < num9 && num9 < 1E-08)
                  {
                    outReal[index1] = 0.0;
                    ++index1;
                  }
                  else
                  {
                    outReal[index1] = num8 / num9;
                    ++index1;
                  }
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                num4 = inClose[index2];
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              int num2 = startIdx;
              outBegIdx = num2;
              double num3 = 0.0;
              double num4 = 0.0;
              int index2 = startIdx - num1;
              double num5 = inHigh[index2];
              double num6 = inLow[index2];
              double num7 = inClose[index2];
              int num8 = optInTimePeriod - 1;
              while (true)
              {
                int num9 = num8;
                --num8;
                if (num9 > 0)
                {
                  ++index2;
                  double num10 = inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num13 > 0.0 && num11 < num13)
                    num3 += num13;
                  double num14 = num5 - num6;
                  double num15 = Math.Abs(num5 - num7);
                  if (num15 > num14)
                    num14 = num15;
                  double num16 = Math.Abs(num6 - num7);
                  if (num16 > num14)
                    num14 = num16;
                  num4 += num14;
                  num7 = inClose[index2];
                }
                else
                  break;
              }
              int num17 = (int) Core.Globals.unstablePeriod[15] + 1;
              while (true)
              {
                int num9 = num17;
                --num17;
                if (num9 != 0)
                {
                  ++index2;
                  double num10 = inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num13 > 0.0 && num11 < num13)
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod + num13;
                  }
                  else
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod;
                  }
                  double num15 = num5 - num6;
                  double num16 = Math.Abs(num5 - num7);
                  if (num16 > num15)
                    num15 = num16;
                  double num18 = Math.Abs(num6 - num7);
                  if (num18 > num15)
                    num15 = num18;
                  double num19 = num4;
                  num4 = num19 - num19 / (double) optInTimePeriod + num15;
                  num7 = inClose[index2];
                }
                else
                  break;
              }
              outReal[0] = -1E-08 >= num4 || num4 >= 1E-08 ? 100.0 * (num3 / num4) : 0.0;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num9 = inHigh[index2];
                double num10 = num9 - num5;
                num5 = num9;
                double num11 = inLow[index2];
                double num12 = num6 - num11;
                num6 = num11;
                if (num12 > 0.0 && num10 < num12)
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod + num12;
                }
                else
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod;
                }
                double num14 = num5 - num6;
                double num15 = Math.Abs(num5 - num7);
                if (num15 > num14)
                  num14 = num15;
                double num16 = Math.Abs(num6 - num7);
                if (num16 > num14)
                  num14 = num16;
                double num18 = num4;
                num4 = num18 - num18 / (double) optInTimePeriod + num14;
                num7 = inClose[index2];
                if (-1E-08 >= num4 || num4 >= 1E-08)
                {
                  outReal[index3] = 100.0 * (num3 / num4);
                  ++index3;
                }
                else
                {
                  outReal[index3] = 0.0;
                  ++index3;
                }
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_62:
      return retCode;
    }

    public static int MinusDMLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[16] - 1;
label_5:
      return num;
    }

    public static Core.RetCode MinusDM(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_39;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[16] - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = (double) inHigh[index2];
              double num3 = (double) inLow[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num4 = (double) inHigh[index2];
                double num5 = num4 - num2;
                num2 = num4;
                double num6 = (double) inLow[index2];
                double num7 = num3 - num6;
                num3 = num6;
                if (num7 > 0.0 && num5 < num7)
                {
                  outReal[index1] = num7;
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              outBegIdx = startIdx;
              double num2 = 0.0;
              int index2 = startIdx - num1;
              double num3 = (double) inHigh[index2];
              double num4 = (double) inLow[index2];
              int num5 = optInTimePeriod - 1;
              while (true)
              {
                double num6;
                double num7;
                do
                {
                  int num8 = num5;
                  --num5;
                  if (num8 > 0)
                  {
                    ++index2;
                    double num9 = (double) inHigh[index2];
                    num6 = num9 - num3;
                    num3 = num9;
                    double num10 = (double) inLow[index2];
                    num7 = num4 - num10;
                    num4 = num10;
                  }
                  else
                    goto label_27;
                }
                while (num7 <= 0.0 || num6 >= num7);
                num2 += num7;
              }
label_27:
              int num11 = (int) Core.Globals.unstablePeriod[16];
              while (true)
              {
                int num6 = num11;
                --num11;
                if (num6 != 0)
                {
                  ++index2;
                  double num7 = (double) inHigh[index2];
                  double num8 = num7 - num3;
                  num3 = num7;
                  double num9 = (double) inLow[index2];
                  double num10 = num4 - num9;
                  num4 = num9;
                  if (num10 > 0.0 && num8 < num10)
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod + num10;
                  }
                  else
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod;
                  }
                }
                else
                  break;
              }
              outReal[0] = num2;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num6 = (double) inHigh[index2];
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = (double) inLow[index2];
                double num9 = num4 - num8;
                num4 = num8;
                if (num9 > 0.0 && num7 < num9)
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod + num9;
                }
                else
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod;
                }
                outReal[index3] = num2;
                ++index3;
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_39:
      return retCode;
    }

    public static Core.RetCode MinusDM(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_39;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[16] - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = inHigh[index2];
              double num3 = inLow[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num4 = inHigh[index2];
                double num5 = num4 - num2;
                num2 = num4;
                double num6 = inLow[index2];
                double num7 = num3 - num6;
                num3 = num6;
                if (num7 > 0.0 && num5 < num7)
                {
                  outReal[index1] = num7;
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              outBegIdx = startIdx;
              double num2 = 0.0;
              int index2 = startIdx - num1;
              double num3 = inHigh[index2];
              double num4 = inLow[index2];
              int num5 = optInTimePeriod - 1;
              while (true)
              {
                double num6;
                double num7;
                do
                {
                  int num8 = num5;
                  --num5;
                  if (num8 > 0)
                  {
                    ++index2;
                    double num9 = inHigh[index2];
                    num6 = num9 - num3;
                    num3 = num9;
                    double num10 = inLow[index2];
                    num7 = num4 - num10;
                    num4 = num10;
                  }
                  else
                    goto label_27;
                }
                while (num7 <= 0.0 || num6 >= num7);
                num2 += num7;
              }
label_27:
              int num11 = (int) Core.Globals.unstablePeriod[16];
              while (true)
              {
                int num6 = num11;
                --num11;
                if (num6 != 0)
                {
                  ++index2;
                  double num7 = inHigh[index2];
                  double num8 = num7 - num3;
                  num3 = num7;
                  double num9 = inLow[index2];
                  double num10 = num4 - num9;
                  num4 = num9;
                  if (num10 > 0.0 && num8 < num10)
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod + num10;
                  }
                  else
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod;
                  }
                }
                else
                  break;
              }
              outReal[0] = num2;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num6 = inHigh[index2];
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = inLow[index2];
                double num9 = num4 - num8;
                num4 = num8;
                if (num9 > 0.0 && num7 < num9)
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod + num9;
                }
                else
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod;
                }
                outReal[index3] = num2;
                ++index3;
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_39:
      return retCode;
    }

    public static int MomLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 10;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode Mom(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_20;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              outReal[index1] = (double) inReal[index2] - (double) inReal[index3];
              ++index1;
              ++index3;
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_20:
      return retCode;
    }

    public static Core.RetCode Mom(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_20;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              outReal[index1] = inReal[index2] - inReal[index3];
              ++index1;
              ++index3;
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_20:
      return retCode;
    }

    public static int MultLookback()
    {
      return 0;
    }

    public static Core.RetCode Mult(
      int startIdx,
      int endIdx,
      float[] inReal0,
      float[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = (double) inReal0[index1] * (double) inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Mult(
      int startIdx,
      int endIdx,
      double[] inReal0,
      double[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = inReal0[index1] * inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int NatrLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod + (int) Core.Globals.unstablePeriod[17];
label_5:
      return num;
    }

    public static Core.RetCode Natr(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal_0 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_32;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.NatrLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
            retCode1 = Core.RetCode.Success;
          else if (optInTimePeriod <= 1)
          {
            retCode1 = Core.TrueRange(startIdx, endIdx, inHigh, inLow, inClose, out outBegIdx, out outNBElement, outReal);
          }
          else
          {
            double[] numArray = new double[num1 + (endIdx - startIdx) + 1];
            int outBegIdx1;
            int num2;
            Core.RetCode retCode2 = Core.TrueRange(startIdx - num1 + 1, endIdx, inHigh, inLow, inClose, out outBegIdx1, out num2, numArray);
            if (retCode2 != Core.RetCode.Success)
            {
              retCode1 = retCode2;
            }
            else
            {
              Core.RetCode retCode3 = Core.TA_INT_SMA(optInTimePeriod - 1, optInTimePeriod - 1, numArray, optInTimePeriod, out outBegIdx1, out num2, outReal_0);
              if (retCode3 != Core.RetCode.Success)
              {
                retCode1 = retCode3;
              }
              else
              {
                double num3 = outReal_0[0];
                int index1 = optInTimePeriod;
                for (int index2 = (int) Core.Globals.unstablePeriod[17]; index2 != 0; --index2)
                {
                  double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                  ++index1;
                  num3 = num4 / (double) optInTimePeriod;
                }
                int index3 = 1;
                double num5 = (double) inClose[index1];
                outReal[0] = -1E-08 >= num5 || num5 >= 1E-08 ? num3 / num5 * 100.0 : 0.0;
                int num6 = endIdx - startIdx + 1;
                while (true)
                {
                  --num6;
                  if (num6 != 0)
                  {
                    double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                    ++index1;
                    num3 = num4 / (double) optInTimePeriod;
                    double num7 = (double) inClose[index1];
                    if (-1E-08 >= num7 || num7 >= 1E-08)
                      outReal[index3] = num3 / num7 * 100.0;
                    else
                      outReal[0] = 0.0;
                    ++index3;
                  }
                  else
                    break;
                }
                outBegIdx = startIdx;
                outNBElement = index3;
                retCode1 = retCode3;
              }
            }
          }
        }
      }
label_32:
      return retCode1;
    }

    public static Core.RetCode Natr(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal_0 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_32;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.NatrLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
            retCode1 = Core.RetCode.Success;
          else if (optInTimePeriod <= 1)
          {
            retCode1 = Core.TrueRange(startIdx, endIdx, inHigh, inLow, inClose, out outBegIdx, out outNBElement, outReal);
          }
          else
          {
            double[] numArray = new double[num1 + (endIdx - startIdx) + 1];
            int outBegIdx1;
            int num2;
            Core.RetCode retCode2 = Core.TrueRange(startIdx - num1 + 1, endIdx, inHigh, inLow, inClose, out outBegIdx1, out num2, numArray);
            if (retCode2 != Core.RetCode.Success)
            {
              retCode1 = retCode2;
            }
            else
            {
              Core.RetCode retCode3 = Core.TA_INT_SMA(optInTimePeriod - 1, optInTimePeriod - 1, numArray, optInTimePeriod, out outBegIdx1, out num2, outReal_0);
              if (retCode3 != Core.RetCode.Success)
              {
                retCode1 = retCode3;
              }
              else
              {
                double num3 = outReal_0[0];
                int index1 = optInTimePeriod;
                for (int index2 = (int) Core.Globals.unstablePeriod[17]; index2 != 0; --index2)
                {
                  double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                  ++index1;
                  num3 = num4 / (double) optInTimePeriod;
                }
                int index3 = 1;
                double num5 = inClose[index1];
                outReal[0] = -1E-08 >= num5 || num5 >= 1E-08 ? num3 / num5 * 100.0 : 0.0;
                int num6 = endIdx - startIdx + 1;
                while (true)
                {
                  --num6;
                  if (num6 != 0)
                  {
                    double num4 = num3 * (double) (optInTimePeriod - 1) + numArray[index1];
                    ++index1;
                    num3 = num4 / (double) optInTimePeriod;
                    double num7 = inClose[index1];
                    if (-1E-08 >= num7 || num7 >= 1E-08)
                      outReal[index3] = num3 / num7 * 100.0;
                    else
                      outReal[0] = 0.0;
                    ++index3;
                  }
                  else
                    break;
                }
                outBegIdx = startIdx;
                outNBElement = index3;
                retCode1 = retCode3;
              }
            }
          }
        }
      }
label_32:
      return retCode1;
    }

    public static int ObvLookback()
    {
      return 0;
    }

    public static Core.RetCode Obv(
      int startIdx,
      int endIdx,
      float[] inReal,
      float[] inVolume,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (inVolume == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double num1 = (double) inVolume[startIdx];
        double num2 = (double) inReal[startIdx];
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          double num3 = (double) inReal[index2];
          if (num3 > num2)
            num1 += (double) inVolume[index2];
          else if (num3 < num2)
            num1 -= (double) inVolume[index2];
          outReal[index1] = num1;
          ++index1;
          num2 = num3;
        }
        outBegIdx = startIdx;
        outNBElement = index1;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Obv(
      int startIdx,
      int endIdx,
      double[] inReal,
      double[] inVolume,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (inVolume == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        double num1 = inVolume[startIdx];
        double num2 = inReal[startIdx];
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          double num3 = inReal[index2];
          if (num3 > num2)
            num1 += inVolume[index2];
          else if (num3 < num2)
            num1 -= inVolume[index2];
          outReal[index1] = num1;
          ++index1;
          num2 = num3;
        }
        outBegIdx = startIdx;
        outNBElement = index1;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int PlusDILookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[18];
label_5:
      return num;
    }

    public static Core.RetCode PlusDI(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_62;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[18];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = (double) inHigh[index2];
              double num3 = (double) inLow[index2];
              double num4 = (double) inClose[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num5 = (double) inHigh[index2];
                double num6 = num5 - num2;
                num2 = num5;
                double num7 = (double) inLow[index2];
                double num8 = num3 - num7;
                num3 = num7;
                if (num6 > 0.0 && num6 > num8)
                {
                  double num9 = num2 - num3;
                  double num10 = Math.Abs(num2 - num4);
                  if (num10 > num9)
                    num9 = num10;
                  double num11 = Math.Abs(num3 - num4);
                  if (num11 > num9)
                    num9 = num11;
                  if (-1E-08 < num9 && num9 < 1E-08)
                  {
                    outReal[index1] = 0.0;
                    ++index1;
                  }
                  else
                  {
                    outReal[index1] = num6 / num9;
                    ++index1;
                  }
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                num4 = (double) inClose[index2];
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              int num2 = startIdx;
              outBegIdx = num2;
              double num3 = 0.0;
              double num4 = 0.0;
              int index2 = startIdx - num1;
              double num5 = (double) inHigh[index2];
              double num6 = (double) inLow[index2];
              double num7 = (double) inClose[index2];
              int num8 = optInTimePeriod - 1;
              while (true)
              {
                int num9 = num8;
                --num8;
                if (num9 > 0)
                {
                  ++index2;
                  double num10 = (double) inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = (double) inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num11 > 0.0 && num11 > num13)
                    num3 += num11;
                  double num14 = num5 - num6;
                  double num15 = Math.Abs(num5 - num7);
                  if (num15 > num14)
                    num14 = num15;
                  double num16 = Math.Abs(num6 - num7);
                  if (num16 > num14)
                    num14 = num16;
                  num4 += num14;
                  num7 = (double) inClose[index2];
                }
                else
                  break;
              }
              int num17 = (int) Core.Globals.unstablePeriod[18] + 1;
              while (true)
              {
                int num9 = num17;
                --num17;
                if (num9 != 0)
                {
                  ++index2;
                  double num10 = (double) inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = (double) inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num11 > 0.0 && num11 > num13)
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod + num11;
                  }
                  else
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod;
                  }
                  double num15 = num5 - num6;
                  double num16 = Math.Abs(num5 - num7);
                  if (num16 > num15)
                    num15 = num16;
                  double num18 = Math.Abs(num6 - num7);
                  if (num18 > num15)
                    num15 = num18;
                  double num19 = num4;
                  num4 = num19 - num19 / (double) optInTimePeriod + num15;
                  num7 = (double) inClose[index2];
                }
                else
                  break;
              }
              outReal[0] = -1E-08 >= num4 || num4 >= 1E-08 ? 100.0 * (num3 / num4) : 0.0;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num9 = (double) inHigh[index2];
                double num10 = num9 - num5;
                num5 = num9;
                double num11 = (double) inLow[index2];
                double num12 = num6 - num11;
                num6 = num11;
                if (num10 > 0.0 && num10 > num12)
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod + num10;
                }
                else
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod;
                }
                double num14 = num5 - num6;
                double num15 = Math.Abs(num5 - num7);
                if (num15 > num14)
                  num14 = num15;
                double num16 = Math.Abs(num6 - num7);
                if (num16 > num14)
                  num14 = num16;
                double num18 = num4;
                num4 = num18 - num18 / (double) optInTimePeriod + num14;
                num7 = (double) inClose[index2];
                if (-1E-08 >= num4 || num4 >= 1E-08)
                {
                  outReal[index3] = 100.0 * (num3 / num4);
                  ++index3;
                }
                else
                {
                  outReal[index3] = 0.0;
                  ++index3;
                }
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_62:
      return retCode;
    }

    public static Core.RetCode PlusDI(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_62;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[18];
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = inHigh[index2];
              double num3 = inLow[index2];
              double num4 = inClose[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num5 = inHigh[index2];
                double num6 = num5 - num2;
                num2 = num5;
                double num7 = inLow[index2];
                double num8 = num3 - num7;
                num3 = num7;
                if (num6 > 0.0 && num6 > num8)
                {
                  double num9 = num2 - num3;
                  double num10 = Math.Abs(num2 - num4);
                  if (num10 > num9)
                    num9 = num10;
                  double num11 = Math.Abs(num3 - num4);
                  if (num11 > num9)
                    num9 = num11;
                  if (-1E-08 < num9 && num9 < 1E-08)
                  {
                    outReal[index1] = 0.0;
                    ++index1;
                  }
                  else
                  {
                    outReal[index1] = num6 / num9;
                    ++index1;
                  }
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                num4 = inClose[index2];
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              int num2 = startIdx;
              outBegIdx = num2;
              double num3 = 0.0;
              double num4 = 0.0;
              int index2 = startIdx - num1;
              double num5 = inHigh[index2];
              double num6 = inLow[index2];
              double num7 = inClose[index2];
              int num8 = optInTimePeriod - 1;
              while (true)
              {
                int num9 = num8;
                --num8;
                if (num9 > 0)
                {
                  ++index2;
                  double num10 = inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num11 > 0.0 && num11 > num13)
                    num3 += num11;
                  double num14 = num5 - num6;
                  double num15 = Math.Abs(num5 - num7);
                  if (num15 > num14)
                    num14 = num15;
                  double num16 = Math.Abs(num6 - num7);
                  if (num16 > num14)
                    num14 = num16;
                  num4 += num14;
                  num7 = inClose[index2];
                }
                else
                  break;
              }
              int num17 = (int) Core.Globals.unstablePeriod[18] + 1;
              while (true)
              {
                int num9 = num17;
                --num17;
                if (num9 != 0)
                {
                  ++index2;
                  double num10 = inHigh[index2];
                  double num11 = num10 - num5;
                  num5 = num10;
                  double num12 = inLow[index2];
                  double num13 = num6 - num12;
                  num6 = num12;
                  if (num11 > 0.0 && num11 > num13)
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod + num11;
                  }
                  else
                  {
                    double num14 = num3;
                    num3 = num14 - num14 / (double) optInTimePeriod;
                  }
                  double num15 = num5 - num6;
                  double num16 = Math.Abs(num5 - num7);
                  if (num16 > num15)
                    num15 = num16;
                  double num18 = Math.Abs(num6 - num7);
                  if (num18 > num15)
                    num15 = num18;
                  double num19 = num4;
                  num4 = num19 - num19 / (double) optInTimePeriod + num15;
                  num7 = inClose[index2];
                }
                else
                  break;
              }
              outReal[0] = -1E-08 >= num4 || num4 >= 1E-08 ? 100.0 * (num3 / num4) : 0.0;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num9 = inHigh[index2];
                double num10 = num9 - num5;
                num5 = num9;
                double num11 = inLow[index2];
                double num12 = num6 - num11;
                num6 = num11;
                if (num10 > 0.0 && num10 > num12)
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod + num10;
                }
                else
                {
                  double num13 = num3;
                  num3 = num13 - num13 / (double) optInTimePeriod;
                }
                double num14 = num5 - num6;
                double num15 = Math.Abs(num5 - num7);
                if (num15 > num14)
                  num14 = num15;
                double num16 = Math.Abs(num6 - num7);
                if (num16 > num14)
                  num14 = num16;
                double num18 = num4;
                num4 = num18 - num18 / (double) optInTimePeriod + num14;
                num7 = inClose[index2];
                if (-1E-08 >= num4 || num4 >= 1E-08)
                {
                  outReal[index3] = 100.0 * (num3 / num4);
                  ++index3;
                }
                else
                {
                  outReal[index3] = 0.0;
                  ++index3;
                }
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_62:
      return retCode;
    }

    public static int PlusDMLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[19] - 1;
label_5:
      return num;
    }

    public static Core.RetCode PlusDM(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_39;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[19] - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = (double) inHigh[index2];
              double num3 = (double) inLow[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num4 = (double) inHigh[index2];
                double num5 = num4 - num2;
                num2 = num4;
                double num6 = (double) inLow[index2];
                double num7 = num3 - num6;
                num3 = num6;
                if (num5 > 0.0 && num5 > num7)
                {
                  outReal[index1] = num5;
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              outBegIdx = startIdx;
              double num2 = 0.0;
              int index2 = startIdx - num1;
              double num3 = (double) inHigh[index2];
              double num4 = (double) inLow[index2];
              int num5 = optInTimePeriod - 1;
              while (true)
              {
                double num6;
                double num7;
                do
                {
                  int num8 = num5;
                  --num5;
                  if (num8 > 0)
                  {
                    ++index2;
                    double num9 = (double) inHigh[index2];
                    num6 = num9 - num3;
                    num3 = num9;
                    double num10 = (double) inLow[index2];
                    num7 = num4 - num10;
                    num4 = num10;
                  }
                  else
                    goto label_27;
                }
                while (num6 <= 0.0 || num6 <= num7);
                num2 += num6;
              }
label_27:
              int num11 = (int) Core.Globals.unstablePeriod[19];
              while (true)
              {
                int num6 = num11;
                --num11;
                if (num6 != 0)
                {
                  ++index2;
                  double num7 = (double) inHigh[index2];
                  double num8 = num7 - num3;
                  num3 = num7;
                  double num9 = (double) inLow[index2];
                  double num10 = num4 - num9;
                  num4 = num9;
                  if (num8 > 0.0 && num8 > num10)
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod + num8;
                  }
                  else
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod;
                  }
                }
                else
                  break;
              }
              outReal[0] = num2;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num6 = (double) inHigh[index2];
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = (double) inLow[index2];
                double num9 = num4 - num8;
                num4 = num8;
                if (num7 > 0.0 && num7 > num9)
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod + num7;
                }
                else
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod;
                }
                outReal[index3] = num2;
                ++index3;
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_39:
      return retCode;
    }

    public static Core.RetCode PlusDM(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_39;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod <= 1 ? 1 : optInTimePeriod + (int) Core.Globals.unstablePeriod[19] - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod <= 1)
            {
              outBegIdx = startIdx;
              int index2 = startIdx - 1;
              double num2 = inHigh[index2];
              double num3 = inLow[index2];
              while (index2 < endIdx)
              {
                ++index2;
                double num4 = inHigh[index2];
                double num5 = num4 - num2;
                num2 = num4;
                double num6 = inLow[index2];
                double num7 = num3 - num6;
                num3 = num6;
                if (num5 > 0.0 && num5 > num7)
                {
                  outReal[index1] = num5;
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
            else
            {
              outBegIdx = startIdx;
              double num2 = 0.0;
              int index2 = startIdx - num1;
              double num3 = inHigh[index2];
              double num4 = inLow[index2];
              int num5 = optInTimePeriod - 1;
              while (true)
              {
                double num6;
                double num7;
                do
                {
                  int num8 = num5;
                  --num5;
                  if (num8 > 0)
                  {
                    ++index2;
                    double num9 = inHigh[index2];
                    num6 = num9 - num3;
                    num3 = num9;
                    double num10 = inLow[index2];
                    num7 = num4 - num10;
                    num4 = num10;
                  }
                  else
                    goto label_27;
                }
                while (num6 <= 0.0 || num6 <= num7);
                num2 += num6;
              }
label_27:
              int num11 = (int) Core.Globals.unstablePeriod[19];
              while (true)
              {
                int num6 = num11;
                --num11;
                if (num6 != 0)
                {
                  ++index2;
                  double num7 = inHigh[index2];
                  double num8 = num7 - num3;
                  num3 = num7;
                  double num9 = inLow[index2];
                  double num10 = num4 - num9;
                  num4 = num9;
                  if (num8 > 0.0 && num8 > num10)
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod + num8;
                  }
                  else
                  {
                    double num12 = num2;
                    num2 = num12 - num12 / (double) optInTimePeriod;
                  }
                }
                else
                  break;
              }
              outReal[0] = num2;
              int index3 = 1;
              while (index2 < endIdx)
              {
                ++index2;
                double num6 = inHigh[index2];
                double num7 = num6 - num3;
                num3 = num6;
                double num8 = inLow[index2];
                double num9 = num4 - num8;
                num4 = num8;
                if (num7 > 0.0 && num7 > num9)
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod + num7;
                }
                else
                {
                  double num10 = num2;
                  num2 = num10 - num10 / (double) optInTimePeriod;
                }
                outReal[index3] = num2;
                ++index3;
              }
              outNBElement = index3;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_39:
      return retCode;
    }

    public static int PpoLookback(
      int optInFastPeriod,
      int optInSlowPeriod,
      Core.MAType optInMAType)
    {
      int num;
      if (optInFastPeriod == int.MinValue)
        optInFastPeriod = 12;
      else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInSlowPeriod == int.MinValue)
        optInSlowPeriod = 26;
      else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      num = Core.MovingAverageLookback(optInSlowPeriod <= optInFastPeriod ? optInFastPeriod : optInSlowPeriod, optInMAType);
label_9:
      return num;
    }

    public static Core.RetCode Ppo(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInFastPeriod,
      int optInSlowPeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          double[] tempBuffer = new double[endIdx - startIdx + 1];
          retCode = tempBuffer != null ? Core.TA_INT_PO(startIdx, endIdx, inReal, optInFastPeriod, optInSlowPeriod, optInMAType, out outBegIdx, out outNBElement, outReal, tempBuffer, 1) : Core.RetCode.AllocErr;
        }
      }
label_17:
      return retCode;
    }

    public static Core.RetCode Ppo(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInFastPeriod,
      int optInSlowPeriod,
      Core.MAType optInMAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastPeriod == int.MinValue)
          optInFastPeriod = 12;
        else if (optInFastPeriod < 2 || optInFastPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (optInSlowPeriod == int.MinValue)
          optInSlowPeriod = 26;
        else if (optInSlowPeriod < 2 || optInSlowPeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_17;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          double[] tempBuffer = new double[endIdx - startIdx + 1];
          retCode = tempBuffer != null ? Core.TA_INT_PO(startIdx, endIdx, inReal, optInFastPeriod, optInSlowPeriod, optInMAType, out outBegIdx, out outNBElement, outReal, tempBuffer, 1) : Core.RetCode.AllocErr;
        }
      }
label_17:
      return retCode;
    }

    public static int RocLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 10;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode Roc(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = (double) inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = ((double) inReal[index2] / num - 1.0) * 100.0;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode Roc(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = (inReal[index2] / num - 1.0) * 100.0;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int RocPLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 10;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode RocP(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = (double) inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = ((double) inReal[index2] - num) / num;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode RocP(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = (inReal[index2] - num) / num;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int RocRLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 10;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode RocR(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = (double) inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = (double) inReal[index2] / num;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode RocR(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = inReal[index2] / num;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int RocR100Lookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 10;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod;
label_5:
      return num;
    }

    public static Core.RetCode RocR100(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = (double) inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = (double) inReal[index2] / num * 100.0;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode RocR100(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 10;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < optInTimePeriod)
            startIdx = optInTimePeriod;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int index3 = startIdx - optInTimePeriod;
            for (; index2 <= endIdx; ++index2)
            {
              double num = inReal[index3];
              ++index3;
              if (num != 0.0)
              {
                outReal[index1] = inReal[index2] / num * 100.0;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int RsiLookback(int optInTimePeriod)
    {
      int num1;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num1 = -1;
        goto label_7;
      }
      int num2 = optInTimePeriod + (int) Core.Globals.unstablePeriod[20];
      if (Core.Globals.compatibility == Core.Compatibility.Metastock)
        --num2;
      num1 = num2;
label_7:
      return num1;
    }

    public static Core.RetCode Rsi(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_54;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.RsiLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod == 1)
            {
              outBegIdx = startIdx;
              int length = endIdx - startIdx + 1;
              outNBElement = length;
              Array.Copy((Array) inReal, startIdx, (Array) outReal, 0, length);
              retCode = Core.RetCode.Success;
            }
            else
            {
              int index2 = startIdx - num1;
              double num2 = (double) inReal[index2];
              if (Core.Globals.unstablePeriod[20] == 0U && Core.Globals.compatibility == Core.Compatibility.Metastock)
              {
                double num3 = num2;
                double num4 = 0.0;
                double num5 = 0.0;
                for (int index3 = optInTimePeriod; index3 > 0; --index3)
                {
                  double num6 = (double) inReal[index2];
                  ++index2;
                  double num7 = num6 - num2;
                  num2 = num6;
                  if (num7 >= 0.0)
                    goto label_24;
                  num5 -= num7;
                  continue;
label_24:
                  num4 += num7;
                }
                double num8 = num5 / (double) optInTimePeriod;
                double num9 = num4 / (double) optInTimePeriod;
                double num10 = num9 + num8;
                if (-1E-08 >= num10 || num10 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num9 / num10);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                if (index2 > endIdx)
                {
                  outBegIdx = startIdx;
                  outNBElement = index1;
                  retCode = Core.RetCode.Success;
                  goto label_54;
                }
                else
                {
                  index2 -= optInTimePeriod;
                  num2 = num3;
                }
              }
              double num11 = 0.0;
              double num12 = 0.0;
              int index4 = index2 + 1;
              for (int index3 = optInTimePeriod; index3 > 0; --index3)
              {
                double num3 = (double) inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                if (num4 >= 0.0)
                  goto label_36;
                num12 -= num4;
                continue;
label_36:
                num11 += num4;
              }
              double num13 = num12 / (double) optInTimePeriod;
              double num14 = num11 / (double) optInTimePeriod;
              if (index4 > startIdx)
              {
                double num3 = num14 + num13;
                if (-1E-08 >= num3 || num3 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num14 / num3);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              else
              {
                for (; index4 < startIdx; ++index4)
                {
                  double num3 = (double) inReal[index4];
                  double num4 = num3 - num2;
                  num2 = num3;
                  double num5 = num13 * (double) (optInTimePeriod - 1);
                  double num6 = num14 * (double) (optInTimePeriod - 1);
                  if (num4 < 0.0)
                    num5 -= num4;
                  else
                    num6 += num4;
                  num13 = num5 / (double) optInTimePeriod;
                  num14 = num6 / (double) optInTimePeriod;
                }
              }
              while (index4 <= endIdx)
              {
                double num3 = (double) inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                double num5 = num13 * (double) (optInTimePeriod - 1);
                double num6 = num14 * (double) (optInTimePeriod - 1);
                if (num4 < 0.0)
                  num5 -= num4;
                else
                  num6 += num4;
                num13 = num5 / (double) optInTimePeriod;
                num14 = num6 / (double) optInTimePeriod;
                double num7 = num14 + num13;
                if (-1E-08 >= num7 || num7 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num14 / num7);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outBegIdx = startIdx;
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_54:
      return retCode;
    }

    public static Core.RetCode Rsi(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_54;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.RsiLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            if (optInTimePeriod == 1)
            {
              outBegIdx = startIdx;
              int length = endIdx - startIdx + 1;
              outNBElement = length;
              Array.Copy((Array) inReal, startIdx, (Array) outReal, 0, length);
              retCode = Core.RetCode.Success;
            }
            else
            {
              int index2 = startIdx - num1;
              double num2 = inReal[index2];
              if (Core.Globals.unstablePeriod[20] == 0U && Core.Globals.compatibility == Core.Compatibility.Metastock)
              {
                double num3 = num2;
                double num4 = 0.0;
                double num5 = 0.0;
                for (int index3 = optInTimePeriod; index3 > 0; --index3)
                {
                  double num6 = inReal[index2];
                  ++index2;
                  double num7 = num6 - num2;
                  num2 = num6;
                  if (num7 >= 0.0)
                    goto label_24;
                  num5 -= num7;
                  continue;
label_24:
                  num4 += num7;
                }
                double num8 = num5 / (double) optInTimePeriod;
                double num9 = num4 / (double) optInTimePeriod;
                double num10 = num9 + num8;
                if (-1E-08 >= num10 || num10 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num9 / num10);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
                if (index2 > endIdx)
                {
                  outBegIdx = startIdx;
                  outNBElement = index1;
                  retCode = Core.RetCode.Success;
                  goto label_54;
                }
                else
                {
                  index2 -= optInTimePeriod;
                  num2 = num3;
                }
              }
              double num11 = 0.0;
              double num12 = 0.0;
              int index4 = index2 + 1;
              for (int index3 = optInTimePeriod; index3 > 0; --index3)
              {
                double num3 = inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                if (num4 >= 0.0)
                  goto label_36;
                num12 -= num4;
                continue;
label_36:
                num11 += num4;
              }
              double num13 = num12 / (double) optInTimePeriod;
              double num14 = num11 / (double) optInTimePeriod;
              if (index4 > startIdx)
              {
                double num3 = num14 + num13;
                if (-1E-08 >= num3 || num3 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num14 / num3);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              else
              {
                for (; index4 < startIdx; ++index4)
                {
                  double num3 = inReal[index4];
                  double num4 = num3 - num2;
                  num2 = num3;
                  double num5 = num13 * (double) (optInTimePeriod - 1);
                  double num6 = num14 * (double) (optInTimePeriod - 1);
                  if (num4 < 0.0)
                    num5 -= num4;
                  else
                    num6 += num4;
                  num13 = num5 / (double) optInTimePeriod;
                  num14 = num6 / (double) optInTimePeriod;
                }
              }
              while (index4 <= endIdx)
              {
                double num3 = inReal[index4];
                ++index4;
                double num4 = num3 - num2;
                num2 = num3;
                double num5 = num13 * (double) (optInTimePeriod - 1);
                double num6 = num14 * (double) (optInTimePeriod - 1);
                if (num4 < 0.0)
                  num5 -= num4;
                else
                  num6 += num4;
                num13 = num5 / (double) optInTimePeriod;
                num14 = num6 / (double) optInTimePeriod;
                double num7 = num14 + num13;
                if (-1E-08 >= num7 || num7 >= 1E-08)
                {
                  outReal[index1] = 100.0 * (num14 / num7);
                  ++index1;
                }
                else
                {
                  outReal[index1] = 0.0;
                  ++index1;
                }
              }
              outBegIdx = startIdx;
              outNBElement = index1;
              retCode = Core.RetCode.Success;
            }
          }
        }
      }
label_54:
      return retCode;
    }

    public static int SarLookback(double optInAcceleration, double optInMaximum)
    {
      int num;
      if (optInAcceleration == -4E+37)
        optInAcceleration = 0.02;
      else if (optInAcceleration < 0.0 || optInAcceleration > 3E+37)
      {
        num = -1;
        goto label_9;
      }
      if (optInMaximum == -4E+37)
        optInMaximum = 0.2;
      else if (optInMaximum < 0.0 || optInMaximum > 3E+37)
      {
        num = -1;
        goto label_9;
      }
      num = 1;
label_9:
      return num;
    }

    public static Core.RetCode Sar(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      double optInAcceleration,
      double optInMaximum,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal1 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInAcceleration == -4E+37)
          optInAcceleration = 0.02;
        else if (optInAcceleration < 0.0 || optInAcceleration > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_63;
        }
        if (optInMaximum == -4E+37)
          optInMaximum = 0.2;
        else if (optInMaximum < 0.0 || optInMaximum > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_63;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < 1)
            startIdx = 1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double num1 = optInAcceleration;
            if (num1 > optInMaximum)
            {
              optInAcceleration = optInMaximum;
              num1 = optInAcceleration;
            }
            int num2 = startIdx;
            int num3;
            Core.RetCode retCode2 = Core.MinusDM(num2, num2, inHigh, inLow, 1, out num3, out num3, outReal1);
            int num4 = outReal1[0] <= 0.0 ? 1 : 0;
            if (retCode2 != Core.RetCode.Success)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              outBegIdx = startIdx;
              int index1 = 0;
              int index2 = startIdx;
              double num5 = (double) inHigh[index2 - 1];
              double num6 = (double) inLow[index2 - 1];
              double num7;
              double num8;
              if (num4 == 1)
              {
                num7 = (double) inHigh[index2];
                num8 = num6;
              }
              else
              {
                num7 = (double) inLow[index2];
                num8 = num5;
              }
              double num9 = (double) inLow[index2];
              double num10 = (double) inHigh[index2];
              while (index2 <= endIdx)
              {
                double num11 = num9;
                double num12 = num10;
                num9 = (double) inLow[index2];
                num10 = (double) inHigh[index2];
                ++index2;
                if (num4 == 1)
                {
                  if (num9 <= num8)
                  {
                    num4 = 0;
                    double num13 = num7;
                    if (num13 < num12)
                      num13 = num12;
                    if (num13 < num10)
                      num13 = num10;
                    outReal[index1] = num13;
                    ++index1;
                    num1 = optInAcceleration;
                    num7 = num9;
                    num8 = num13 + num1 * (num7 - num13);
                    if (num8 < num12)
                      num8 = num12;
                    if (num8 < num10)
                      num8 = num10;
                  }
                  else
                  {
                    outReal[index1] = num8;
                    ++index1;
                    if (num10 > num7)
                    {
                      num7 = num10;
                      num1 += optInAcceleration;
                      if (num1 > optInMaximum)
                        num1 = optInMaximum;
                    }
                    num8 += num1 * (num7 - num8);
                    if (num8 > num11)
                      num8 = num11;
                    if (num8 > num9)
                      num8 = num9;
                  }
                }
                else if (num10 >= num8)
                {
                  num4 = 1;
                  double num13 = num7;
                  if (num13 > num11)
                    num13 = num11;
                  if (num13 > num9)
                    num13 = num9;
                  outReal[index1] = num13;
                  ++index1;
                  num1 = optInAcceleration;
                  num7 = num10;
                  num8 = num13 + num1 * (num7 - num13);
                  if (num8 > num11)
                    num8 = num11;
                  if (num8 > num9)
                    num8 = num9;
                }
                else
                {
                  outReal[index1] = num8;
                  ++index1;
                  if (num9 < num7)
                  {
                    num7 = num9;
                    num1 += optInAcceleration;
                    if (num1 > optInMaximum)
                      num1 = optInMaximum;
                  }
                  num8 += num1 * (num7 - num8);
                  if (num8 < num12)
                    num8 = num12;
                  if (num8 < num10)
                    num8 = num10;
                }
              }
              outNBElement = index1;
              retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_63:
      return retCode1;
    }

    public static Core.RetCode Sar(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double optInAcceleration,
      double optInMaximum,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal1 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInAcceleration == -4E+37)
          optInAcceleration = 0.02;
        else if (optInAcceleration < 0.0 || optInAcceleration > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_63;
        }
        if (optInMaximum == -4E+37)
          optInMaximum = 0.2;
        else if (optInMaximum < 0.0 || optInMaximum > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_63;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < 1)
            startIdx = 1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double num1 = optInAcceleration;
            if (num1 > optInMaximum)
            {
              optInAcceleration = optInMaximum;
              num1 = optInAcceleration;
            }
            int num2 = startIdx;
            int num3;
            Core.RetCode retCode2 = Core.MinusDM(num2, num2, inHigh, inLow, 1, out num3, out num3, outReal1);
            int num4 = outReal1[0] <= 0.0 ? 1 : 0;
            if (retCode2 != Core.RetCode.Success)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              outBegIdx = startIdx;
              int index1 = 0;
              int index2 = startIdx;
              double num5 = inHigh[index2 - 1];
              double num6 = inLow[index2 - 1];
              double num7;
              double num8;
              if (num4 == 1)
              {
                num7 = inHigh[index2];
                num8 = num6;
              }
              else
              {
                num7 = inLow[index2];
                num8 = num5;
              }
              double num9 = inLow[index2];
              double num10 = inHigh[index2];
              while (index2 <= endIdx)
              {
                double num11 = num9;
                double num12 = num10;
                num9 = inLow[index2];
                num10 = inHigh[index2];
                ++index2;
                if (num4 == 1)
                {
                  if (num9 <= num8)
                  {
                    num4 = 0;
                    double num13 = num7;
                    if (num13 < num12)
                      num13 = num12;
                    if (num13 < num10)
                      num13 = num10;
                    outReal[index1] = num13;
                    ++index1;
                    num1 = optInAcceleration;
                    num7 = num9;
                    num8 = num13 + num1 * (num7 - num13);
                    if (num8 < num12)
                      num8 = num12;
                    if (num8 < num10)
                      num8 = num10;
                  }
                  else
                  {
                    outReal[index1] = num8;
                    ++index1;
                    if (num10 > num7)
                    {
                      num7 = num10;
                      num1 += optInAcceleration;
                      if (num1 > optInMaximum)
                        num1 = optInMaximum;
                    }
                    num8 += num1 * (num7 - num8);
                    if (num8 > num11)
                      num8 = num11;
                    if (num8 > num9)
                      num8 = num9;
                  }
                }
                else if (num10 >= num8)
                {
                  num4 = 1;
                  double num13 = num7;
                  if (num13 > num11)
                    num13 = num11;
                  if (num13 > num9)
                    num13 = num9;
                  outReal[index1] = num13;
                  ++index1;
                  num1 = optInAcceleration;
                  num7 = num10;
                  num8 = num13 + num1 * (num7 - num13);
                  if (num8 > num11)
                    num8 = num11;
                  if (num8 > num9)
                    num8 = num9;
                }
                else
                {
                  outReal[index1] = num8;
                  ++index1;
                  if (num9 < num7)
                  {
                    num7 = num9;
                    num1 += optInAcceleration;
                    if (num1 > optInMaximum)
                      num1 = optInMaximum;
                  }
                  num8 += num1 * (num7 - num8);
                  if (num8 < num12)
                    num8 = num12;
                  if (num8 < num10)
                    num8 = num10;
                }
              }
              outNBElement = index1;
              retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_63:
      return retCode1;
    }

    public static int SarExtLookback(
      double optInStartValue,
      double optInOffsetOnReverse,
      double optInAccelerationInitLong,
      double optInAccelerationLong,
      double optInAccelerationMaxLong,
      double optInAccelerationInitShort,
      double optInAccelerationShort,
      double optInAccelerationMaxShort)
    {
      int num;
      if (optInStartValue == -4E+37)
        optInStartValue = 0.0;
      else if (optInStartValue < -3E+37 || optInStartValue > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInOffsetOnReverse == -4E+37)
        optInOffsetOnReverse = 0.0;
      else if (optInOffsetOnReverse < 0.0 || optInOffsetOnReverse > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInAccelerationInitLong == -4E+37)
        optInAccelerationInitLong = 0.02;
      else if (optInAccelerationInitLong < 0.0 || optInAccelerationInitLong > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInAccelerationLong == -4E+37)
        optInAccelerationLong = 0.02;
      else if (optInAccelerationLong < 0.0 || optInAccelerationLong > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInAccelerationMaxLong == -4E+37)
        optInAccelerationMaxLong = 0.2;
      else if (optInAccelerationMaxLong < 0.0 || optInAccelerationMaxLong > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInAccelerationInitShort == -4E+37)
        optInAccelerationInitShort = 0.02;
      else if (optInAccelerationInitShort < 0.0 || optInAccelerationInitShort > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInAccelerationShort == -4E+37)
        optInAccelerationShort = 0.02;
      else if (optInAccelerationShort < 0.0 || optInAccelerationShort > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      if (optInAccelerationMaxShort == -4E+37)
        optInAccelerationMaxShort = 0.2;
      else if (optInAccelerationMaxShort < 0.0 || optInAccelerationMaxShort > 3E+37)
      {
        num = -1;
        goto label_33;
      }
      num = 1;
label_33:
      return num;
    }

    public static Core.RetCode SarExt(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      double optInStartValue,
      double optInOffsetOnReverse,
      double optInAccelerationInitLong,
      double optInAccelerationLong,
      double optInAccelerationMaxLong,
      double optInAccelerationInitShort,
      double optInAccelerationShort,
      double optInAccelerationMaxShort,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal1 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInStartValue == -4E+37)
          optInStartValue = 0.0;
        else if (optInStartValue < -3E+37 || optInStartValue > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInOffsetOnReverse == -4E+37)
          optInOffsetOnReverse = 0.0;
        else if (optInOffsetOnReverse < 0.0 || optInOffsetOnReverse > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationInitLong == -4E+37)
          optInAccelerationInitLong = 0.02;
        else if (optInAccelerationInitLong < 0.0 || optInAccelerationInitLong > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationLong == -4E+37)
          optInAccelerationLong = 0.02;
        else if (optInAccelerationLong < 0.0 || optInAccelerationLong > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationMaxLong == -4E+37)
          optInAccelerationMaxLong = 0.2;
        else if (optInAccelerationMaxLong < 0.0 || optInAccelerationMaxLong > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationInitShort == -4E+37)
          optInAccelerationInitShort = 0.02;
        else if (optInAccelerationInitShort < 0.0 || optInAccelerationInitShort > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationShort == -4E+37)
          optInAccelerationShort = 0.02;
        else if (optInAccelerationShort < 0.0 || optInAccelerationShort > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationMaxShort == -4E+37)
          optInAccelerationMaxShort = 0.2;
        else if (optInAccelerationMaxShort < 0.0 || optInAccelerationMaxShort > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < 1)
            startIdx = 1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double num1 = optInAccelerationInitLong;
            double num2 = optInAccelerationInitShort;
            if (num1 > optInAccelerationMaxLong)
            {
              optInAccelerationInitLong = optInAccelerationMaxLong;
              num1 = optInAccelerationInitLong;
            }
            if (optInAccelerationLong > optInAccelerationMaxLong)
              optInAccelerationLong = optInAccelerationMaxLong;
            if (num2 > optInAccelerationMaxShort)
            {
              optInAccelerationInitShort = optInAccelerationMaxShort;
              num2 = optInAccelerationInitShort;
            }
            if (optInAccelerationShort > optInAccelerationMaxShort)
              optInAccelerationShort = optInAccelerationMaxShort;
            int num3;
            if (optInStartValue == 0.0)
            {
              int num4 = startIdx;
              int num5;
              Core.RetCode retCode2 = Core.MinusDM(num4, num4, inHigh, inLow, 1, out num5, out num5, outReal1);
              num3 = outReal1[0] <= 0.0 ? 1 : 0;
              if (retCode2 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode2;
                goto label_103;
              }
            }
            else
              num3 = optInStartValue <= 0.0 ? 0 : 1;
            outBegIdx = startIdx;
            int index1 = 0;
            int index2 = startIdx;
            double num6 = (double) inHigh[index2 - 1];
            double num7 = (double) inLow[index2 - 1];
            double num8;
            double num9;
            if (optInStartValue == 0.0)
            {
              if (num3 == 1)
              {
                num8 = (double) inHigh[index2];
                num9 = num7;
              }
              else
              {
                num8 = (double) inLow[index2];
                num9 = num6;
              }
            }
            else if (optInStartValue > 0.0)
            {
              num8 = (double) inHigh[index2];
              num9 = optInStartValue;
            }
            else
            {
              num8 = (double) inLow[index2];
              num9 = Math.Abs(optInStartValue);
            }
            double num10 = (double) inLow[index2];
            double num11 = (double) inHigh[index2];
            while (index2 <= endIdx)
            {
              double num4 = num10;
              double num5 = num11;
              num10 = (double) inLow[index2];
              num11 = (double) inHigh[index2];
              ++index2;
              if (num3 == 1)
              {
                if (num10 <= num9)
                {
                  num3 = 0;
                  double num12 = num8;
                  if (num12 < num5)
                    num12 = num5;
                  if (num12 < num11)
                    num12 = num11;
                  if (optInOffsetOnReverse != 0.0)
                  {
                    double num13 = num12;
                    num12 = num13 + num13 * optInOffsetOnReverse;
                  }
                  outReal[index1] = -num12;
                  ++index1;
                  num2 = optInAccelerationInitShort;
                  num8 = num10;
                  num9 = num12 + num2 * (num8 - num12);
                  if (num9 < num5)
                    num9 = num5;
                  if (num9 < num11)
                    num9 = num11;
                }
                else
                {
                  outReal[index1] = num9;
                  ++index1;
                  if (num11 > num8)
                  {
                    num8 = num11;
                    num1 += optInAccelerationLong;
                    if (num1 > optInAccelerationMaxLong)
                      num1 = optInAccelerationMaxLong;
                  }
                  num9 += num1 * (num8 - num9);
                  if (num9 > num4)
                    num9 = num4;
                  if (num9 > num10)
                    num9 = num10;
                }
              }
              else if (num11 >= num9)
              {
                num3 = 1;
                double num12 = num8;
                if (num12 > num4)
                  num12 = num4;
                if (num12 > num10)
                  num12 = num10;
                if (optInOffsetOnReverse != 0.0)
                {
                  double num13 = num12;
                  num12 = num13 - num13 * optInOffsetOnReverse;
                }
                outReal[index1] = num12;
                ++index1;
                num1 = optInAccelerationInitLong;
                num8 = num11;
                num9 = num12 + num1 * (num8 - num12);
                if (num9 > num4)
                  num9 = num4;
                if (num9 > num10)
                  num9 = num10;
              }
              else
              {
                outReal[index1] = -num9;
                ++index1;
                if (num10 < num8)
                {
                  num8 = num10;
                  num2 += optInAccelerationShort;
                  if (num2 > optInAccelerationMaxShort)
                    num2 = optInAccelerationMaxShort;
                }
                num9 += num2 * (num8 - num9);
                if (num9 < num5)
                  num9 = num5;
                if (num9 < num11)
                  num9 = num11;
              }
            }
            outNBElement = index1;
            retCode1 = Core.RetCode.Success;
          }
        }
      }
label_103:
      return retCode1;
    }

    public static Core.RetCode SarExt(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double optInStartValue,
      double optInOffsetOnReverse,
      double optInAccelerationInitLong,
      double optInAccelerationLong,
      double optInAccelerationMaxLong,
      double optInAccelerationInitShort,
      double optInAccelerationShort,
      double optInAccelerationMaxShort,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      double[] outReal1 = new double[1];
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInStartValue == -4E+37)
          optInStartValue = 0.0;
        else if (optInStartValue < -3E+37 || optInStartValue > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInOffsetOnReverse == -4E+37)
          optInOffsetOnReverse = 0.0;
        else if (optInOffsetOnReverse < 0.0 || optInOffsetOnReverse > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationInitLong == -4E+37)
          optInAccelerationInitLong = 0.02;
        else if (optInAccelerationInitLong < 0.0 || optInAccelerationInitLong > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationLong == -4E+37)
          optInAccelerationLong = 0.02;
        else if (optInAccelerationLong < 0.0 || optInAccelerationLong > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationMaxLong == -4E+37)
          optInAccelerationMaxLong = 0.2;
        else if (optInAccelerationMaxLong < 0.0 || optInAccelerationMaxLong > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationInitShort == -4E+37)
          optInAccelerationInitShort = 0.02;
        else if (optInAccelerationInitShort < 0.0 || optInAccelerationInitShort > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationShort == -4E+37)
          optInAccelerationShort = 0.02;
        else if (optInAccelerationShort < 0.0 || optInAccelerationShort > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (optInAccelerationMaxShort == -4E+37)
          optInAccelerationMaxShort = 0.2;
        else if (optInAccelerationMaxShort < 0.0 || optInAccelerationMaxShort > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_103;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          if (startIdx < 1)
            startIdx = 1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double num1 = optInAccelerationInitLong;
            double num2 = optInAccelerationInitShort;
            if (num1 > optInAccelerationMaxLong)
            {
              optInAccelerationInitLong = optInAccelerationMaxLong;
              num1 = optInAccelerationInitLong;
            }
            if (optInAccelerationLong > optInAccelerationMaxLong)
              optInAccelerationLong = optInAccelerationMaxLong;
            if (num2 > optInAccelerationMaxShort)
            {
              optInAccelerationInitShort = optInAccelerationMaxShort;
              num2 = optInAccelerationInitShort;
            }
            if (optInAccelerationShort > optInAccelerationMaxShort)
              optInAccelerationShort = optInAccelerationMaxShort;
            int num3;
            if (optInStartValue == 0.0)
            {
              int num4 = startIdx;
              int num5;
              Core.RetCode retCode2 = Core.MinusDM(num4, num4, inHigh, inLow, 1, out num5, out num5, outReal1);
              num3 = outReal1[0] <= 0.0 ? 1 : 0;
              if (retCode2 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode2;
                goto label_103;
              }
            }
            else
              num3 = optInStartValue <= 0.0 ? 0 : 1;
            outBegIdx = startIdx;
            int index1 = 0;
            int index2 = startIdx;
            double num6 = inHigh[index2 - 1];
            double num7 = inLow[index2 - 1];
            double num8;
            double num9;
            if (optInStartValue == 0.0)
            {
              if (num3 == 1)
              {
                num8 = inHigh[index2];
                num9 = num7;
              }
              else
              {
                num8 = inLow[index2];
                num9 = num6;
              }
            }
            else if (optInStartValue > 0.0)
            {
              num8 = inHigh[index2];
              num9 = optInStartValue;
            }
            else
            {
              num8 = inLow[index2];
              num9 = Math.Abs(optInStartValue);
            }
            double num10 = inLow[index2];
            double num11 = inHigh[index2];
            while (index2 <= endIdx)
            {
              double num4 = num10;
              double num5 = num11;
              num10 = inLow[index2];
              num11 = inHigh[index2];
              ++index2;
              if (num3 == 1)
              {
                if (num10 <= num9)
                {
                  num3 = 0;
                  double num12 = num8;
                  if (num12 < num5)
                    num12 = num5;
                  if (num12 < num11)
                    num12 = num11;
                  if (optInOffsetOnReverse != 0.0)
                  {
                    double num13 = num12;
                    num12 = num13 + num13 * optInOffsetOnReverse;
                  }
                  outReal[index1] = -num12;
                  ++index1;
                  num2 = optInAccelerationInitShort;
                  num8 = num10;
                  num9 = num12 + num2 * (num8 - num12);
                  if (num9 < num5)
                    num9 = num5;
                  if (num9 < num11)
                    num9 = num11;
                }
                else
                {
                  outReal[index1] = num9;
                  ++index1;
                  if (num11 > num8)
                  {
                    num8 = num11;
                    num1 += optInAccelerationLong;
                    if (num1 > optInAccelerationMaxLong)
                      num1 = optInAccelerationMaxLong;
                  }
                  num9 += num1 * (num8 - num9);
                  if (num9 > num4)
                    num9 = num4;
                  if (num9 > num10)
                    num9 = num10;
                }
              }
              else if (num11 >= num9)
              {
                num3 = 1;
                double num12 = num8;
                if (num12 > num4)
                  num12 = num4;
                if (num12 > num10)
                  num12 = num10;
                if (optInOffsetOnReverse != 0.0)
                {
                  double num13 = num12;
                  num12 = num13 - num13 * optInOffsetOnReverse;
                }
                outReal[index1] = num12;
                ++index1;
                num1 = optInAccelerationInitLong;
                num8 = num11;
                num9 = num12 + num1 * (num8 - num12);
                if (num9 > num4)
                  num9 = num4;
                if (num9 > num10)
                  num9 = num10;
              }
              else
              {
                outReal[index1] = -num9;
                ++index1;
                if (num10 < num8)
                {
                  num8 = num10;
                  num2 += optInAccelerationShort;
                  if (num2 > optInAccelerationMaxShort)
                    num2 = optInAccelerationMaxShort;
                }
                num9 += num2 * (num8 - num9);
                if (num9 < num5)
                  num9 = num5;
                if (num9 < num11)
                  num9 = num11;
              }
            }
            outNBElement = index1;
            retCode1 = Core.RetCode.Success;
          }
        }
      }
label_103:
      return retCode1;
    }

    public static int SinLookback()
    {
      return 0;
    }

    public static Core.RetCode Sin(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Sin((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Sin(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Sin(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int SinhLookback()
    {
      return 0;
    }

    public static Core.RetCode Sinh(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Sinh((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Sinh(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Sinh(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int SmaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Sma(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_11;
        }
        retCode = outReal != null ? Core.TA_INT_SMA(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal) : Core.RetCode.BadParam;
      }
label_11:
      return retCode;
    }

    public static Core.RetCode Sma(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_11;
        }
        retCode = outReal != null ? Core.TA_INT_SMA(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal) : Core.RetCode.BadParam;
      }
label_11:
      return retCode;
    }

    public static int SqrtLookback()
    {
      return 0;
    }

    public static Core.RetCode Sqrt(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Sqrt((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Sqrt(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Sqrt(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int StdDevLookback(int optInTimePeriod, double optInNbDev)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 5;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInNbDev == -4E+37)
        optInNbDev = 1.0;
      else if (optInNbDev < -3E+37 || optInNbDev > 3E+37)
      {
        num = -1;
        goto label_9;
      }
      num = Core.VarianceLookback(optInTimePeriod, optInNbDev);
label_9:
      return num;
    }

    public static Core.RetCode StdDev(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      double optInNbDev,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_26;
        }
        if (optInNbDev == -4E+37)
          optInNbDev = 1.0;
        else if (optInNbDev < -3E+37 || optInNbDev > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_26;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          Core.RetCode retCode2 = Core.TA_INT_VAR(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
          if (retCode2 != Core.RetCode.Success)
          {
            retCode1 = retCode2;
          }
          else
          {
            if (optInNbDev != 1.0)
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double d = outReal[index];
                outReal[index] = d < 1E-08 ? 0.0 : Math.Sqrt(d) * optInNbDev;
              }
            }
            else
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double d = outReal[index];
                outReal[index] = d < 1E-08 ? 0.0 : Math.Sqrt(d);
              }
            }
            retCode1 = Core.RetCode.Success;
          }
        }
      }
label_26:
      return retCode1;
    }

    public static Core.RetCode StdDev(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      double optInNbDev,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_26;
        }
        if (optInNbDev == -4E+37)
          optInNbDev = 1.0;
        else if (optInNbDev < -3E+37 || optInNbDev > 3E+37)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_26;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          Core.RetCode retCode2 = Core.TA_INT_VAR(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal);
          if (retCode2 != Core.RetCode.Success)
          {
            retCode1 = retCode2;
          }
          else
          {
            if (optInNbDev != 1.0)
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double d = outReal[index];
                outReal[index] = d < 1E-08 ? 0.0 : Math.Sqrt(d) * optInNbDev;
              }
            }
            else
            {
              for (int index = 0; index < outNBElement; ++index)
              {
                double d = outReal[index];
                outReal[index] = d < 1E-08 ? 0.0 : Math.Sqrt(d);
              }
            }
            retCode1 = Core.RetCode.Success;
          }
        }
      }
label_26:
      return retCode1;
    }

    public static int StochLookback(
      int optInFastK_Period,
      int optInSlowK_Period,
      Core.MAType optInSlowK_MAType,
      int optInSlowD_Period,
      Core.MAType optInSlowD_MAType)
    {
      int num;
      if (optInFastK_Period == int.MinValue)
        optInFastK_Period = 5;
      else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInSlowK_Period == int.MinValue)
        optInSlowK_Period = 3;
      else if (optInSlowK_Period < 1 || optInSlowK_Period > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInSlowD_Period == int.MinValue)
        optInSlowD_Period = 3;
      else if (optInSlowD_Period < 1 || optInSlowD_Period > 100000)
      {
        num = -1;
        goto label_13;
      }
      num = optInFastK_Period - 1 + Core.MovingAverageLookback(optInSlowK_Period, optInSlowK_MAType) + Core.MovingAverageLookback(optInSlowD_Period, optInSlowD_MAType);
label_13:
      return num;
    }

    public static Core.RetCode Stoch(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInFastK_Period,
      int optInSlowK_Period,
      Core.MAType optInSlowK_MAType,
      int optInSlowD_Period,
      Core.MAType optInSlowD_MAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outSlowK,
      double[] outSlowD)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastK_Period == int.MinValue)
          optInFastK_Period = 5;
        else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_53;
        }
        if (optInSlowK_Period == int.MinValue)
          optInSlowK_Period = 3;
        else if (optInSlowK_Period < 1 || optInSlowK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_53;
        }
        if (optInSlowD_Period == int.MinValue)
          optInSlowD_Period = 3;
        else if (optInSlowD_Period < 1 || optInSlowD_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_53;
        }
        if (outSlowK == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outSlowD == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInFastK_Period - 1;
          int num2 = Core.MovingAverageLookback(optInSlowK_Period, optInSlowK_MAType);
          int sourceIndex = Core.MovingAverageLookback(optInSlowD_Period, optInSlowD_MAType);
          int num3 = num1 + sourceIndex + num2;
          if (startIdx < num3)
            startIdx = num3;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num4 = startIdx - num3;
            int index2 = num4 + num1;
            int index3 = -1;
            int index4 = index3;
            double num5 = 0.0;
            double num6 = num5;
            double num7 = num6;
            double[] numArray = new double[endIdx - index2 + 1];
            for (; index2 <= endIdx; ++index2)
            {
              double num8 = (double) inLow[index2];
              if (index4 < num4)
              {
                index4 = num4;
                num5 = (double) inLow[index4];
                int index5 = index4;
                while (true)
                {
                  double num9;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num9 = (double) inLow[index5];
                    else
                      goto label_33;
                  }
                  while (num9 >= num5);
                  index4 = index5;
                  num5 = num9;
                }
label_33:
                num7 = (num6 - num5) / 100.0;
              }
              else if (num8 <= num5)
              {
                index4 = index2;
                num5 = num8;
                num7 = (num6 - num5) / 100.0;
              }
              double num10 = (double) inHigh[index2];
              if (index3 < num4)
              {
                index3 = num4;
                num6 = (double) inHigh[index3];
                int index5 = index3;
                while (true)
                {
                  double num9;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num9 = (double) inHigh[index5];
                    else
                      goto label_41;
                  }
                  while (num9 <= num6);
                  index3 = index5;
                  num6 = num9;
                }
label_41:
                num7 = (num6 - num5) / 100.0;
              }
              else if (num10 >= num6)
              {
                index3 = index2;
                num6 = num10;
                num7 = (num6 - num5) / 100.0;
              }
              if (num7 != 0.0)
              {
                numArray[index1] = ((double) inClose[index2] - num5) / num7;
                ++index1;
              }
              else
              {
                numArray[index1] = 0.0;
                ++index1;
              }
              ++num4;
            }
            Core.RetCode retCode2 = Core.MovingAverage(0, index1 - 1, numArray, optInSlowK_Period, optInSlowK_MAType, out outBegIdx, out outNBElement, numArray);
            if (retCode2 != Core.RetCode.Success || outNBElement == 0)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              Core.RetCode retCode3 = Core.MovingAverage(0, outNBElement - 1, numArray, optInSlowD_Period, optInSlowD_MAType, out outBegIdx, out outNBElement, outSlowD);
              Array.Copy((Array) numArray, sourceIndex, (Array) outSlowK, 0, outNBElement);
              if (retCode3 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode3;
              }
              else
              {
                outBegIdx = startIdx;
                retCode1 = Core.RetCode.Success;
              }
            }
          }
        }
      }
label_53:
      return retCode1;
    }

    public static Core.RetCode Stoch(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInFastK_Period,
      int optInSlowK_Period,
      Core.MAType optInSlowK_MAType,
      int optInSlowD_Period,
      Core.MAType optInSlowD_MAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outSlowK,
      double[] outSlowD)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastK_Period == int.MinValue)
          optInFastK_Period = 5;
        else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_53;
        }
        if (optInSlowK_Period == int.MinValue)
          optInSlowK_Period = 3;
        else if (optInSlowK_Period < 1 || optInSlowK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_53;
        }
        if (optInSlowD_Period == int.MinValue)
          optInSlowD_Period = 3;
        else if (optInSlowD_Period < 1 || optInSlowD_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_53;
        }
        if (outSlowK == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outSlowD == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInFastK_Period - 1;
          int num2 = Core.MovingAverageLookback(optInSlowK_Period, optInSlowK_MAType);
          int sourceIndex = Core.MovingAverageLookback(optInSlowD_Period, optInSlowD_MAType);
          int num3 = num1 + sourceIndex + num2;
          if (startIdx < num3)
            startIdx = num3;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num4 = startIdx - num3;
            int index2 = num4 + num1;
            int index3 = -1;
            int index4 = index3;
            double num5 = 0.0;
            double num6 = num5;
            double num7 = num6;
            double[] numArray = outSlowK == inHigh || outSlowK == inLow || outSlowK == inClose ? outSlowK : (outSlowD == inHigh || outSlowD == inLow || outSlowD == inClose ? outSlowD : new double[endIdx - index2 + 1]);
            for (; index2 <= endIdx; ++index2)
            {
              double num8 = inLow[index2];
              if (index4 < num4)
              {
                index4 = num4;
                num5 = inLow[index4];
                int index5 = index4;
                while (true)
                {
                  double num9;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num9 = inLow[index5];
                    else
                      goto label_33;
                  }
                  while (num9 >= num5);
                  index4 = index5;
                  num5 = num9;
                }
label_33:
                num7 = (num6 - num5) / 100.0;
              }
              else if (num8 <= num5)
              {
                index4 = index2;
                num5 = num8;
                num7 = (num6 - num5) / 100.0;
              }
              double num10 = inHigh[index2];
              if (index3 < num4)
              {
                index3 = num4;
                num6 = inHigh[index3];
                int index5 = index3;
                while (true)
                {
                  double num9;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num9 = inHigh[index5];
                    else
                      goto label_41;
                  }
                  while (num9 <= num6);
                  index3 = index5;
                  num6 = num9;
                }
label_41:
                num7 = (num6 - num5) / 100.0;
              }
              else if (num10 >= num6)
              {
                index3 = index2;
                num6 = num10;
                num7 = (num6 - num5) / 100.0;
              }
              if (num7 != 0.0)
              {
                numArray[index1] = (inClose[index2] - num5) / num7;
                ++index1;
              }
              else
              {
                numArray[index1] = 0.0;
                ++index1;
              }
              ++num4;
            }
            Core.RetCode retCode2 = Core.MovingAverage(0, index1 - 1, numArray, optInSlowK_Period, optInSlowK_MAType, out outBegIdx, out outNBElement, numArray);
            if (retCode2 != Core.RetCode.Success || outNBElement == 0)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              Core.RetCode retCode3 = Core.MovingAverage(0, outNBElement - 1, numArray, optInSlowD_Period, optInSlowD_MAType, out outBegIdx, out outNBElement, outSlowD);
              Array.Copy((Array) numArray, sourceIndex, (Array) outSlowK, 0, outNBElement);
              if (retCode3 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode3;
              }
              else
              {
                outBegIdx = startIdx;
                retCode1 = Core.RetCode.Success;
              }
            }
          }
        }
      }
label_53:
      return retCode1;
    }

    public static int StochFLookback(
      int optInFastK_Period,
      int optInFastD_Period,
      Core.MAType optInFastD_MAType)
    {
      int num;
      if (optInFastK_Period == int.MinValue)
        optInFastK_Period = 5;
      else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInFastD_Period == int.MinValue)
        optInFastD_Period = 3;
      else if (optInFastD_Period < 1 || optInFastD_Period > 100000)
      {
        num = -1;
        goto label_9;
      }
      num = optInFastK_Period - 1 + Core.MovingAverageLookback(optInFastD_Period, optInFastD_MAType);
label_9:
      return num;
    }

    public static Core.RetCode StochF(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInFastK_Period,
      int optInFastD_Period,
      Core.MAType optInFastD_MAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outFastK,
      double[] outFastD)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastK_Period == int.MinValue)
          optInFastK_Period = 5;
        else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_49;
        }
        if (optInFastD_Period == int.MinValue)
          optInFastD_Period = 3;
        else if (optInFastD_Period < 1 || optInFastD_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_49;
        }
        if (outFastK == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outFastD == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInFastK_Period - 1;
          int sourceIndex = Core.MovingAverageLookback(optInFastD_Period, optInFastD_MAType);
          int num2 = num1 + sourceIndex;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num3 = startIdx - num2;
            int index2 = num3 + num1;
            int index3 = -1;
            int index4 = index3;
            double num4 = 0.0;
            double num5 = num4;
            double num6 = num5;
            double[] inReal = new double[endIdx - index2 + 1];
            for (; index2 <= endIdx; ++index2)
            {
              double num7 = (double) inLow[index2];
              if (index4 < num3)
              {
                index4 = num3;
                num4 = (double) inLow[index4];
                int index5 = index4;
                while (true)
                {
                  double num8;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num8 = (double) inLow[index5];
                    else
                      goto label_29;
                  }
                  while (num8 >= num4);
                  index4 = index5;
                  num4 = num8;
                }
label_29:
                num6 = (num5 - num4) / 100.0;
              }
              else if (num7 <= num4)
              {
                index4 = index2;
                num4 = num7;
                num6 = (num5 - num4) / 100.0;
              }
              double num9 = (double) inHigh[index2];
              if (index3 < num3)
              {
                index3 = num3;
                num5 = (double) inHigh[index3];
                int index5 = index3;
                while (true)
                {
                  double num8;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num8 = (double) inHigh[index5];
                    else
                      goto label_37;
                  }
                  while (num8 <= num5);
                  index3 = index5;
                  num5 = num8;
                }
label_37:
                num6 = (num5 - num4) / 100.0;
              }
              else if (num9 >= num5)
              {
                index3 = index2;
                num5 = num9;
                num6 = (num5 - num4) / 100.0;
              }
              if (num6 != 0.0)
              {
                inReal[index1] = ((double) inClose[index2] - num4) / num6;
                ++index1;
              }
              else
              {
                inReal[index1] = 0.0;
                ++index1;
              }
              ++num3;
            }
            Core.RetCode retCode2 = Core.MovingAverage(0, index1 - 1, inReal, optInFastD_Period, optInFastD_MAType, out outBegIdx, out outNBElement, outFastD);
            if (retCode2 != Core.RetCode.Success || outNBElement == 0)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              Array.Copy((Array) inReal, sourceIndex, (Array) outFastK, 0, outNBElement);
              if (retCode2 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode2;
              }
              else
              {
                outBegIdx = startIdx;
                retCode1 = Core.RetCode.Success;
              }
            }
          }
        }
      }
label_49:
      return retCode1;
    }

    public static Core.RetCode StochF(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInFastK_Period,
      int optInFastD_Period,
      Core.MAType optInFastD_MAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outFastK,
      double[] outFastD)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInFastK_Period == int.MinValue)
          optInFastK_Period = 5;
        else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_49;
        }
        if (optInFastD_Period == int.MinValue)
          optInFastD_Period = 3;
        else if (optInFastD_Period < 1 || optInFastD_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_49;
        }
        if (outFastK == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outFastD == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInFastK_Period - 1;
          int sourceIndex = Core.MovingAverageLookback(optInFastD_Period, optInFastD_MAType);
          int num2 = num1 + sourceIndex;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int num3 = startIdx - num2;
            int index2 = num3 + num1;
            int index3 = -1;
            int index4 = index3;
            double num4 = 0.0;
            double num5 = num4;
            double num6 = num5;
            double[] inReal = outFastK == inHigh || outFastK == inLow || outFastK == inClose ? outFastK : (outFastD == inHigh || outFastD == inLow || outFastD == inClose ? outFastD : new double[endIdx - index2 + 1]);
            for (; index2 <= endIdx; ++index2)
            {
              double num7 = inLow[index2];
              if (index4 < num3)
              {
                index4 = num3;
                num4 = inLow[index4];
                int index5 = index4;
                while (true)
                {
                  double num8;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num8 = inLow[index5];
                    else
                      goto label_29;
                  }
                  while (num8 >= num4);
                  index4 = index5;
                  num4 = num8;
                }
label_29:
                num6 = (num5 - num4) / 100.0;
              }
              else if (num7 <= num4)
              {
                index4 = index2;
                num4 = num7;
                num6 = (num5 - num4) / 100.0;
              }
              double num9 = inHigh[index2];
              if (index3 < num3)
              {
                index3 = num3;
                num5 = inHigh[index3];
                int index5 = index3;
                while (true)
                {
                  double num8;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num8 = inHigh[index5];
                    else
                      goto label_37;
                  }
                  while (num8 <= num5);
                  index3 = index5;
                  num5 = num8;
                }
label_37:
                num6 = (num5 - num4) / 100.0;
              }
              else if (num9 >= num5)
              {
                index3 = index2;
                num5 = num9;
                num6 = (num5 - num4) / 100.0;
              }
              if (num6 != 0.0)
              {
                inReal[index1] = (inClose[index2] - num4) / num6;
                ++index1;
              }
              else
              {
                inReal[index1] = 0.0;
                ++index1;
              }
              ++num3;
            }
            Core.RetCode retCode2 = Core.MovingAverage(0, index1 - 1, inReal, optInFastD_Period, optInFastD_MAType, out outBegIdx, out outNBElement, outFastD);
            if (retCode2 != Core.RetCode.Success || outNBElement == 0)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              Array.Copy((Array) inReal, sourceIndex, (Array) outFastK, 0, outNBElement);
              if (retCode2 != Core.RetCode.Success)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode2;
              }
              else
              {
                outBegIdx = startIdx;
                retCode1 = Core.RetCode.Success;
              }
            }
          }
        }
      }
label_49:
      return retCode1;
    }

    public static int StochRsiLookback(
      int optInTimePeriod,
      int optInFastK_Period,
      int optInFastD_Period,
      Core.MAType optInFastD_MAType)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInFastK_Period == int.MinValue)
        optInFastK_Period = 5;
      else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInFastD_Period == int.MinValue)
        optInFastD_Period = 3;
      else if (optInFastD_Period < 1 || optInFastD_Period > 100000)
      {
        num = -1;
        goto label_13;
      }
      num = Core.RsiLookback(optInTimePeriod) + Core.StochFLookback(optInFastK_Period, optInFastD_Period, optInFastD_MAType);
label_13:
      return num;
    }

    public static Core.RetCode StochRsi(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      int optInFastK_Period,
      int optInFastD_Period,
      Core.MAType optInFastD_MAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outFastK,
      double[] outFastD)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (optInFastK_Period == int.MinValue)
          optInFastK_Period = 5;
        else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (optInFastD_Period == int.MinValue)
          optInFastD_Period = 3;
        else if (optInFastD_Period < 1 || optInFastD_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (outFastK == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outFastD == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.StochFLookback(optInFastK_Period, optInFastD_Period, optInFastD_MAType);
          int num2 = Core.RsiLookback(optInTimePeriod) + num1;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int length = endIdx - startIdx + 1 + num1;
            double[] outReal = new double[length];
            int outNBElement1;
            Core.RetCode retCode2 = Core.Rsi(startIdx - num1, endIdx, inReal, optInTimePeriod, out int _, out outNBElement1, outReal);
            if (retCode2 != Core.RetCode.Success || outNBElement1 == 0)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              int endIdx1 = length - 1;
              double[] numArray = outReal;
              double[] inClose = outReal;
              int optInFastK_Period1 = optInFastK_Period;
              int optInFastD_Period1 = optInFastD_Period;
              int num3 = (int) optInFastD_MAType;
              int num4;
              ref int local1 = ref num4;
              ref int local2 = ref outNBElement;
              double[] outFastK1 = outFastK;
              double[] outFastD1 = outFastD;
              Core.RetCode retCode3 = Core.StochF(0, endIdx1, numArray, numArray, inClose, optInFastK_Period1, optInFastD_Period1, (Core.MAType) num3, out local1, out local2, outFastK1, outFastD1);
              if (retCode3 != Core.RetCode.Success || outNBElement == 0)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode3;
              }
              else
                retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_31:
      return retCode1;
    }

    public static Core.RetCode StochRsi(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      int optInFastK_Period,
      int optInFastD_Period,
      Core.MAType optInFastD_MAType,
      out int outBegIdx,
      out int outNBElement,
      double[] outFastK,
      double[] outFastD)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (optInFastK_Period == int.MinValue)
          optInFastK_Period = 5;
        else if (optInFastK_Period < 1 || optInFastK_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (optInFastD_Period == int.MinValue)
          optInFastD_Period = 3;
        else if (optInFastD_Period < 1 || optInFastD_Period > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_31;
        }
        if (outFastK == null)
          retCode1 = Core.RetCode.BadParam;
        else if (outFastD == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          int num1 = Core.StochFLookback(optInFastK_Period, optInFastD_Period, optInFastD_MAType);
          int num2 = Core.RsiLookback(optInTimePeriod) + num1;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int length = endIdx - startIdx + 1 + num1;
            double[] outReal = new double[length];
            int outNBElement1;
            Core.RetCode retCode2 = Core.Rsi(startIdx - num1, endIdx, inReal, optInTimePeriod, out int _, out outNBElement1, outReal);
            if (retCode2 != Core.RetCode.Success || outNBElement1 == 0)
            {
              outBegIdx = 0;
              outNBElement = 0;
              retCode1 = retCode2;
            }
            else
            {
              int endIdx1 = length - 1;
              double[] numArray = outReal;
              double[] inClose = outReal;
              int optInFastK_Period1 = optInFastK_Period;
              int optInFastD_Period1 = optInFastD_Period;
              int num3 = (int) optInFastD_MAType;
              int num4;
              ref int local1 = ref num4;
              ref int local2 = ref outNBElement;
              double[] outFastK1 = outFastK;
              double[] outFastD1 = outFastD;
              Core.RetCode retCode3 = Core.StochF(0, endIdx1, numArray, numArray, inClose, optInFastK_Period1, optInFastD_Period1, (Core.MAType) num3, out local1, out local2, outFastK1, outFastD1);
              if (retCode3 != Core.RetCode.Success || outNBElement == 0)
              {
                outBegIdx = 0;
                outNBElement = 0;
                retCode1 = retCode3;
              }
              else
                retCode1 = Core.RetCode.Success;
            }
          }
        }
      }
label_31:
      return retCode1;
    }

    public static int SubLookback()
    {
      return 0;
    }

    public static Core.RetCode Sub(
      int startIdx,
      int endIdx,
      float[] inReal0,
      float[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = (double) inReal0[index1] - (double) inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Sub(
      int startIdx,
      int endIdx,
      double[] inReal0,
      double[] inReal1,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal0 == null)
        retCode = Core.RetCode.BadParam;
      else if (inReal1 == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = inReal0[index1] - inReal1[index1];
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int SumLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Sum(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_22;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            int index1 = startIdx - num1;
            int index2 = index1;
            if (optInTimePeriod > 1)
            {
              for (; index2 < startIdx; ++index2)
                num2 += (double) inReal[index2];
            }
            int index3 = 0;
            do
            {
              double num3 = num2 + (double) inReal[index2];
              ++index2;
              double num4 = num3;
              num2 = num3 - (double) inReal[index1];
              ++index1;
              outReal[index3] = num4;
              ++index3;
            }
            while (index2 <= endIdx);
            outNBElement = index3;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_22:
      return retCode;
    }

    public static Core.RetCode Sum(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_22;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            int index1 = startIdx - num1;
            int index2 = index1;
            if (optInTimePeriod > 1)
            {
              for (; index2 < startIdx; ++index2)
                num2 += inReal[index2];
            }
            int index3 = 0;
            do
            {
              double num3 = num2 + inReal[index2];
              ++index2;
              double num4 = num3;
              num2 = num3 - inReal[index1];
              ++index1;
              outReal[index3] = num4;
              ++index3;
            }
            while (index2 <= endIdx);
            outNBElement = index3;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_22:
      return retCode;
    }

    public static int T3Lookback(int optInTimePeriod, double optInVFactor)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 5;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInVFactor == -4E+37)
        optInVFactor = 0.7;
      else if (optInVFactor < 0.0 || optInVFactor > 1.0)
      {
        num = -1;
        goto label_9;
      }
      num = (optInTimePeriod - 1) * 6 + (int) Core.Globals.unstablePeriod[22];
label_9:
      return num;
    }

    public static Core.RetCode T3(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      double optInVFactor,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_45;
        }
        if (optInVFactor == -4E+37)
          optInVFactor = 0.7;
        else if (optInVFactor < 0.0 || optInVFactor > 1.0)
        {
          retCode = Core.RetCode.BadParam;
          goto label_45;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = (optInTimePeriod - 1) * 6 + (int) Core.Globals.unstablePeriod[22];
          if (startIdx <= num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outNBElement = 0;
            outBegIdx = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num1;
            double num2 = 2.0 / ((double) optInTimePeriod + 1.0);
            double num3 = 1.0 - num2;
            double num4 = (double) inReal[index1];
            int index2 = index1 + 1;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num4 += (double) inReal[index2];
              ++index2;
            }
            double num5 = num4 / (double) optInTimePeriod;
            double num6 = num5;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num6 += num5;
            }
            double num7 = num6 / (double) optInTimePeriod;
            double num8 = num7;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num8 += num7;
            }
            double num9 = num8 / (double) optInTimePeriod;
            double num10 = num9;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num10 += num9;
            }
            double num11 = num10 / (double) optInTimePeriod;
            double num12 = num11;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num12 += num11;
            }
            double num13 = num12 / (double) optInTimePeriod;
            double num14 = num13;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num13 = num2 * num11 + num3 * num13;
              num14 += num13;
            }
            double num15 = num14 / (double) optInTimePeriod;
            while (index2 <= startIdx)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num13 = num2 * num11 + num3 * num13;
              num15 = num2 * num13 + num3 * num15;
            }
            double num16 = optInVFactor;
            double num17 = num16 * num16;
            double num18 = -(num17 * optInVFactor);
            double num19 = 3.0 * (num17 - num18);
            double num20 = -6.0 * num17 - 3.0 * (optInVFactor - num18);
            double num21 = 1.0 + 3.0 * optInVFactor - num18 + 3.0 * num17;
            int index4 = 0;
            outReal[index4] = num18 * num15 + num19 * num13 + num20 * num11 + num21 * num9;
            int index5 = index4 + 1;
            while (index2 <= endIdx)
            {
              num5 = num2 * (double) inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num13 = num2 * num11 + num3 * num13;
              num15 = num2 * num13 + num3 * num15;
              outReal[index5] = num18 * num15 + num19 * num13 + num20 * num11 + num21 * num9;
              ++index5;
            }
            outNBElement = index5;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_45:
      return retCode;
    }

    public static Core.RetCode T3(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      double optInVFactor,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_45;
        }
        if (optInVFactor == -4E+37)
          optInVFactor = 0.7;
        else if (optInVFactor < 0.0 || optInVFactor > 1.0)
        {
          retCode = Core.RetCode.BadParam;
          goto label_45;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = (optInTimePeriod - 1) * 6 + (int) Core.Globals.unstablePeriod[22];
          if (startIdx <= num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outNBElement = 0;
            outBegIdx = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int index1 = startIdx - num1;
            double num2 = 2.0 / ((double) optInTimePeriod + 1.0);
            double num3 = 1.0 - num2;
            double num4 = inReal[index1];
            int index2 = index1 + 1;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num4 += inReal[index2];
              ++index2;
            }
            double num5 = num4 / (double) optInTimePeriod;
            double num6 = num5;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num6 += num5;
            }
            double num7 = num6 / (double) optInTimePeriod;
            double num8 = num7;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num8 += num7;
            }
            double num9 = num8 / (double) optInTimePeriod;
            double num10 = num9;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num10 += num9;
            }
            double num11 = num10 / (double) optInTimePeriod;
            double num12 = num11;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num12 += num11;
            }
            double num13 = num12 / (double) optInTimePeriod;
            double num14 = num13;
            for (int index3 = optInTimePeriod - 1; index3 > 0; --index3)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num13 = num2 * num11 + num3 * num13;
              num14 += num13;
            }
            double num15 = num14 / (double) optInTimePeriod;
            while (index2 <= startIdx)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num13 = num2 * num11 + num3 * num13;
              num15 = num2 * num13 + num3 * num15;
            }
            double num16 = optInVFactor;
            double num17 = num16 * num16;
            double num18 = -(num17 * optInVFactor);
            double num19 = 3.0 * (num17 - num18);
            double num20 = -6.0 * num17 - 3.0 * (optInVFactor - num18);
            double num21 = 1.0 + 3.0 * optInVFactor - num18 + 3.0 * num17;
            int index4 = 0;
            outReal[index4] = num18 * num15 + num19 * num13 + num20 * num11 + num21 * num9;
            int index5 = index4 + 1;
            while (index2 <= endIdx)
            {
              num5 = num2 * inReal[index2] + num3 * num5;
              ++index2;
              num7 = num2 * num5 + num3 * num7;
              num9 = num2 * num7 + num3 * num9;
              num11 = num2 * num9 + num3 * num11;
              num13 = num2 * num11 + num3 * num13;
              num15 = num2 * num13 + num3 * num15;
              outReal[index5] = num18 * num15 + num19 * num13 + num20 * num11 + num21 * num9;
              ++index5;
            }
            outNBElement = index5;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_45:
      return retCode;
    }

    public static int TanLookback()
    {
      return 0;
    }

    public static Core.RetCode Tan(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Tan((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Tan(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Tan(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int TanhLookback()
    {
      return 0;
    }

    public static Core.RetCode Tanh(
      int startIdx,
      int endIdx,
      float[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Tanh((double) inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode Tanh(
      int startIdx,
      int endIdx,
      double[] inReal,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = startIdx;
        int index2 = 0;
        while (index1 <= endIdx)
        {
          outReal[index2] = Math.Tanh(inReal[index1]);
          ++index1;
          ++index2;
        }
        outNBElement = index2;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int TemaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = Core.EmaLookback(optInTimePeriod) * 3;
label_5:
      return num;
    }

    public static Core.RetCode Tema(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_30;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outNBElement = 0;
          outBegIdx = 0;
          int num1 = Core.EmaLookback(optInTimePeriod);
          int num2 = num1 * 3;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double[] numArray1 = new double[num2 + (endIdx - startIdx) + 1];
            if (numArray1 == null)
            {
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double optInK_1 = 2.0 / (double) (optInTimePeriod + 1);
              int outBegIdx1;
              int outNbElement1;
              Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx - num1 * 2, endIdx, inReal, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement1, numArray1);
              if (retCode2 != Core.RetCode.Success || outNbElement1 == 0)
              {
                retCode1 = retCode2;
              }
              else
              {
                double[] numArray2 = new double[outNbElement1];
                if (numArray2 == null)
                {
                  retCode1 = Core.RetCode.AllocErr;
                }
                else
                {
                  int outBegIdx2;
                  int outNbElement2;
                  Core.RetCode retCode3 = Core.TA_INT_EMA(0, outNbElement1 - 1, numArray1, optInTimePeriod, optInK_1, out outBegIdx2, out outNbElement2, numArray2);
                  if (retCode3 != Core.RetCode.Success || outNbElement2 == 0)
                  {
                    retCode1 = retCode3;
                  }
                  else
                  {
                    int outBegIdx3;
                    int outNbElement3;
                    Core.RetCode retCode4 = Core.TA_INT_EMA(0, outNbElement2 - 1, numArray2, optInTimePeriod, optInK_1, out outBegIdx3, out outNbElement3, outReal);
                    if (retCode4 != Core.RetCode.Success || outNbElement3 == 0)
                    {
                      retCode1 = retCode4;
                    }
                    else
                    {
                      int index1 = outBegIdx3 + outBegIdx2;
                      int index2 = outBegIdx3;
                      outBegIdx = index1 + outBegIdx1;
                      int index3;
                      for (index3 = 0; index3 < outNbElement3; ++index3)
                      {
                        outReal[index3] = outReal[index3] + (3.0 * numArray1[index1] - 3.0 * numArray2[index2]);
                        ++index2;
                        ++index1;
                      }
                      outNBElement = index3;
                      retCode1 = Core.RetCode.Success;
                    }
                  }
                }
              }
            }
          }
        }
      }
label_30:
      return retCode1;
    }

    public static Core.RetCode Tema(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_30;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          outNBElement = 0;
          outBegIdx = 0;
          int num1 = Core.EmaLookback(optInTimePeriod);
          int num2 = num1 * 3;
          if (startIdx < num2)
            startIdx = num2;
          if (startIdx > endIdx)
          {
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            double[] numArray1 = new double[num2 + (endIdx - startIdx) + 1];
            if (numArray1 == null)
            {
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double optInK_1 = 2.0 / (double) (optInTimePeriod + 1);
              int outBegIdx1;
              int outNbElement1;
              Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx - num1 * 2, endIdx, inReal, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement1, numArray1);
              if (retCode2 != Core.RetCode.Success || outNbElement1 == 0)
              {
                retCode1 = retCode2;
              }
              else
              {
                double[] numArray2 = new double[outNbElement1];
                if (numArray2 == null)
                {
                  retCode1 = Core.RetCode.AllocErr;
                }
                else
                {
                  int outBegIdx2;
                  int outNbElement2;
                  Core.RetCode retCode3 = Core.TA_INT_EMA(0, outNbElement1 - 1, numArray1, optInTimePeriod, optInK_1, out outBegIdx2, out outNbElement2, numArray2);
                  if (retCode3 != Core.RetCode.Success || outNbElement2 == 0)
                  {
                    retCode1 = retCode3;
                  }
                  else
                  {
                    int outBegIdx3;
                    int outNbElement3;
                    Core.RetCode retCode4 = Core.TA_INT_EMA(0, outNbElement2 - 1, numArray2, optInTimePeriod, optInK_1, out outBegIdx3, out outNbElement3, outReal);
                    if (retCode4 != Core.RetCode.Success || outNbElement3 == 0)
                    {
                      retCode1 = retCode4;
                    }
                    else
                    {
                      int index1 = outBegIdx3 + outBegIdx2;
                      int index2 = outBegIdx3;
                      outBegIdx = index1 + outBegIdx1;
                      int index3;
                      for (index3 = 0; index3 < outNbElement3; ++index3)
                      {
                        outReal[index3] = outReal[index3] + (3.0 * numArray1[index1] - 3.0 * numArray2[index2]);
                        ++index2;
                        ++index1;
                      }
                      outNBElement = index3;
                      retCode1 = Core.RetCode.Success;
                    }
                  }
                }
              }
            }
          }
        }
      }
label_30:
      return retCode1;
    }

    public static int TrueRangeLookback()
    {
      return 1;
    }

    public static Core.RetCode TrueRange(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (startIdx < 1)
          startIdx = 1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = 0;
          for (int index2 = startIdx; index2 <= endIdx; ++index2)
          {
            double num1 = (double) inLow[index2];
            double num2 = (double) inHigh[index2];
            double num3 = (double) inClose[index2 - 1];
            double num4 = num2 - num1;
            double num5 = Math.Abs(num3 - num2);
            if (num5 > num4)
              num4 = num5;
            double num6 = Math.Abs(num3 - num1);
            if (num6 > num4)
              num4 = num6;
            outReal[index1] = num4;
            ++index1;
          }
          outNBElement = index1;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static Core.RetCode TrueRange(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (startIdx < 1)
          startIdx = 1;
        if (startIdx > endIdx)
        {
          outBegIdx = 0;
          outNBElement = 0;
          retCode = Core.RetCode.Success;
        }
        else
        {
          int index1 = 0;
          for (int index2 = startIdx; index2 <= endIdx; ++index2)
          {
            double num1 = inLow[index2];
            double num2 = inHigh[index2];
            double num3 = inClose[index2 - 1];
            double num4 = num2 - num1;
            double num5 = Math.Abs(num3 - num2);
            if (num5 > num4)
              num4 = num5;
            double num6 = Math.Abs(num3 - num1);
            if (num6 > num4)
              num4 = num6;
            outReal[index1] = num4;
            ++index1;
          }
          outNBElement = index1;
          outBegIdx = startIdx;
          retCode = Core.RetCode.Success;
        }
      }
      return retCode;
    }

    public static int TrimaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Trima(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1;
            if (optInTimePeriod % 2 == 1)
            {
              int num2 = optInTimePeriod >> 1;
              double num3 = 1.0 / (double) ((num2 + 1) * (num2 + 1));
              int index2 = startIdx - num1;
              int num4 = index2 + num2;
              int num5 = num4 + num2;
              double num6 = 0.0;
              double num7 = 0.0;
              for (int index3 = num4; index3 >= index2; --index3)
              {
                double num8 = (double) inReal[index3];
                num7 += num8;
                num6 += num7;
              }
              double num9 = 0.0;
              int index4 = num4 + 1;
              for (int index3 = index4; index3 <= num5; ++index3)
              {
                double num8 = (double) inReal[index3];
                num9 += num8;
                num6 += num9;
              }
              int index5 = 0;
              double num10 = (double) inReal[index2];
              int index6 = index2 + 1;
              outReal[index5] = num6 * num3;
              index1 = index5 + 1;
              int index7 = num5 + 1;
              while (index7 <= endIdx)
              {
                double num8 = num6 - num7;
                double num11 = num7 - num10;
                double num12 = (double) inReal[index4];
                ++index4;
                num7 = num11 + num12;
                double num13 = num8 + num9;
                double num14 = num9 - num12;
                double num15 = (double) inReal[index7];
                ++index7;
                num9 = num14 + num15;
                num6 = num13 + num15;
                num10 = (double) inReal[index6];
                ++index6;
                outReal[index1] = num6 * num3;
                ++index1;
              }
            }
            else
            {
              int num2 = optInTimePeriod >> 1;
              int num3 = num2;
              double num4 = 1.0 / (double) (num3 * (num3 + 1));
              int index2 = startIdx - num1;
              int num5 = index2 + num2 - 1;
              int num6 = num5 + num2;
              double num7 = 0.0;
              double num8 = 0.0;
              for (int index3 = num5; index3 >= index2; --index3)
              {
                double num9 = (double) inReal[index3];
                num8 += num9;
                num7 += num8;
              }
              double num10 = 0.0;
              int index4 = num5 + 1;
              for (int index3 = index4; index3 <= num6; ++index3)
              {
                double num9 = (double) inReal[index3];
                num10 += num9;
                num7 += num10;
              }
              int index5 = 0;
              double num11 = (double) inReal[index2];
              int index6 = index2 + 1;
              outReal[index5] = num7 * num4;
              index1 = index5 + 1;
              int index7 = num6 + 1;
              while (index7 <= endIdx)
              {
                double num9 = num7 - num8;
                double num12 = num8 - num11;
                double num13 = (double) inReal[index4];
                ++index4;
                num8 = num12 + num13;
                double num14 = num10 - num13;
                double num15 = num9 + num14;
                double num16 = (double) inReal[index7];
                ++index7;
                num10 = num14 + num16;
                num7 = num15 + num16;
                num11 = (double) inReal[index6];
                ++index6;
                outReal[index1] = num7 * num4;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static Core.RetCode Trima(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_36;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1;
            if (optInTimePeriod % 2 == 1)
            {
              int num2 = optInTimePeriod >> 1;
              double num3 = 1.0 / (double) ((num2 + 1) * (num2 + 1));
              int index2 = startIdx - num1;
              int num4 = index2 + num2;
              int num5 = num4 + num2;
              double num6 = 0.0;
              double num7 = 0.0;
              for (int index3 = num4; index3 >= index2; --index3)
              {
                double num8 = inReal[index3];
                num7 += num8;
                num6 += num7;
              }
              double num9 = 0.0;
              int index4 = num4 + 1;
              for (int index3 = index4; index3 <= num5; ++index3)
              {
                double num8 = inReal[index3];
                num9 += num8;
                num6 += num9;
              }
              int index5 = 0;
              double num10 = inReal[index2];
              int index6 = index2 + 1;
              outReal[index5] = num6 * num3;
              index1 = index5 + 1;
              int index7 = num5 + 1;
              while (index7 <= endIdx)
              {
                double num8 = num6 - num7;
                double num11 = num7 - num10;
                double num12 = inReal[index4];
                ++index4;
                num7 = num11 + num12;
                double num13 = num8 + num9;
                double num14 = num9 - num12;
                double num15 = inReal[index7];
                ++index7;
                num9 = num14 + num15;
                num6 = num13 + num15;
                num10 = inReal[index6];
                ++index6;
                outReal[index1] = num6 * num3;
                ++index1;
              }
            }
            else
            {
              int num2 = optInTimePeriod >> 1;
              int num3 = num2;
              double num4 = 1.0 / (double) (num3 * (num3 + 1));
              int index2 = startIdx - num1;
              int num5 = index2 + num2 - 1;
              int num6 = num5 + num2;
              double num7 = 0.0;
              double num8 = 0.0;
              for (int index3 = num5; index3 >= index2; --index3)
              {
                double num9 = inReal[index3];
                num8 += num9;
                num7 += num8;
              }
              double num10 = 0.0;
              int index4 = num5 + 1;
              for (int index3 = index4; index3 <= num6; ++index3)
              {
                double num9 = inReal[index3];
                num10 += num9;
                num7 += num10;
              }
              int index5 = 0;
              double num11 = inReal[index2];
              int index6 = index2 + 1;
              outReal[index5] = num7 * num4;
              index1 = index5 + 1;
              int index7 = num6 + 1;
              while (index7 <= endIdx)
              {
                double num9 = num7 - num8;
                double num12 = num8 - num11;
                double num13 = inReal[index4];
                ++index4;
                num8 = num12 + num13;
                double num14 = num10 - num13;
                double num15 = num9 + num14;
                double num16 = inReal[index7];
                ++index7;
                num10 = num14 + num16;
                num7 = num15 + num16;
                num11 = inReal[index6];
                ++index6;
                outReal[index1] = num7 * num4;
                ++index1;
              }
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_36:
      return retCode;
    }

    public static int TrixLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = Core.EmaLookback(optInTimePeriod) * 3 + Core.RocRLookback(1);
label_5:
      return num;
    }

    public static Core.RetCode Trix(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.EmaLookback(optInTimePeriod);
          int num2 = Core.RocRLookback(1);
          int num3 = num1 * 3 + num2;
          if (startIdx < num3)
            startIdx = num3;
          if (startIdx > endIdx)
          {
            outNBElement = 0;
            outBegIdx = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int length = endIdx - startIdx + 1 + num3;
            double[] numArray = new double[length];
            if (numArray == null)
            {
              outNBElement = 0;
              outBegIdx = 0;
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double optInK_1 = 2.0 / (double) (optInTimePeriod + 1);
              int outBegIdx1;
              int outNbElement;
              Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx - num3, endIdx, inReal, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement, numArray);
              if (retCode2 != Core.RetCode.Success || outNbElement == 0)
              {
                outNBElement = 0;
                outBegIdx = 0;
                retCode1 = retCode2;
              }
              else
              {
                int endIdx1 = length - 1 - num1;
                Core.RetCode retCode3 = Core.TA_INT_EMA(0, endIdx1, numArray, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement, numArray);
                if (retCode3 != Core.RetCode.Success || outNbElement == 0)
                {
                  outNBElement = 0;
                  outBegIdx = 0;
                  retCode1 = retCode3;
                }
                else
                {
                  int endIdx2 = endIdx1 - num1;
                  Core.RetCode retCode4 = Core.TA_INT_EMA(0, endIdx2, numArray, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement, numArray);
                  if (retCode4 != Core.RetCode.Success || outNbElement == 0)
                  {
                    outNBElement = 0;
                    outBegIdx = 0;
                    retCode1 = retCode4;
                  }
                  else
                  {
                    Core.RetCode retCode5 = Core.Roc(0, endIdx2 - num1, numArray, 1, out outBegIdx1, out outNBElement, outReal);
                    if (retCode5 != Core.RetCode.Success || outNBElement == 0)
                    {
                      outNBElement = 0;
                      outBegIdx = 0;
                      retCode1 = retCode5;
                    }
                    else
                      retCode1 = Core.RetCode.Success;
                  }
                }
              }
            }
          }
        }
      }
label_27:
      return retCode1;
    }

    public static Core.RetCode Trix(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode1;
      if (startIdx < 0)
        retCode1 = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode1 = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode1 = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode1 = Core.RetCode.BadParam;
          goto label_27;
        }
        if (outReal == null)
        {
          retCode1 = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.EmaLookback(optInTimePeriod);
          int num2 = Core.RocRLookback(1);
          int num3 = num1 * 3 + num2;
          if (startIdx < num3)
            startIdx = num3;
          if (startIdx > endIdx)
          {
            outNBElement = 0;
            outBegIdx = 0;
            retCode1 = Core.RetCode.Success;
          }
          else
          {
            outBegIdx = startIdx;
            int length = endIdx - startIdx + 1 + num3;
            double[] numArray = new double[length];
            if (numArray == null)
            {
              outNBElement = 0;
              outBegIdx = 0;
              retCode1 = Core.RetCode.AllocErr;
            }
            else
            {
              double optInK_1 = 2.0 / (double) (optInTimePeriod + 1);
              int outBegIdx1;
              int outNbElement;
              Core.RetCode retCode2 = Core.TA_INT_EMA(startIdx - num3, endIdx, inReal, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement, numArray);
              if (retCode2 != Core.RetCode.Success || outNbElement == 0)
              {
                outNBElement = 0;
                outBegIdx = 0;
                retCode1 = retCode2;
              }
              else
              {
                int endIdx1 = length - 1 - num1;
                Core.RetCode retCode3 = Core.TA_INT_EMA(0, endIdx1, numArray, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement, numArray);
                if (retCode3 != Core.RetCode.Success || outNbElement == 0)
                {
                  outNBElement = 0;
                  outBegIdx = 0;
                  retCode1 = retCode3;
                }
                else
                {
                  int endIdx2 = endIdx1 - num1;
                  Core.RetCode retCode4 = Core.TA_INT_EMA(0, endIdx2, numArray, optInTimePeriod, optInK_1, out outBegIdx1, out outNbElement, numArray);
                  if (retCode4 != Core.RetCode.Success || outNbElement == 0)
                  {
                    outNBElement = 0;
                    outBegIdx = 0;
                    retCode1 = retCode4;
                  }
                  else
                  {
                    Core.RetCode retCode5 = Core.Roc(0, endIdx2 - num1, numArray, 1, out outBegIdx1, out outNBElement, outReal);
                    if (retCode5 != Core.RetCode.Success || outNBElement == 0)
                    {
                      outNBElement = 0;
                      outBegIdx = 0;
                      retCode1 = retCode5;
                    }
                    else
                      retCode1 = Core.RetCode.Success;
                  }
                }
              }
            }
          }
        }
      }
label_27:
      return retCode1;
    }

    public static int TsfLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Tsf(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.TsfLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = (double) inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double num14 = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              double num15 = (num10 - num14 * num4) / (double) optInTimePeriod;
              outReal[index] = num15 + num14 * (double) optInTimePeriod;
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static Core.RetCode Tsf(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_23;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = Core.TsfLookback(optInTimePeriod);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index = 0;
            int num2 = startIdx;
            int num3 = optInTimePeriod;
            double num4 = (double) (num3 * (num3 - 1)) * 0.5;
            int num5 = optInTimePeriod;
            double num6 = (double) (num5 * (num5 - 1) * (optInTimePeriod * 2 - 1) / 6);
            double num7 = num4;
            double num8 = num7 * num7 - (double) optInTimePeriod * num6;
            for (; num2 <= endIdx; ++num2)
            {
              double num9 = 0.0;
              double num10 = 0.0;
              int num11 = optInTimePeriod;
              while (true)
              {
                int num12 = num11;
                --num11;
                if (num12 != 0)
                {
                  double num13 = inReal[num2 - num11];
                  num10 += num13;
                  num9 += (double) num11 * num13;
                }
                else
                  break;
              }
              double num14 = ((double) optInTimePeriod * num9 - num4 * num10) / num8;
              double num15 = (num10 - num14 * num4) / (double) optInTimePeriod;
              outReal[index] = num15 + num14 * (double) optInTimePeriod;
              ++index;
            }
            outBegIdx = startIdx;
            outNBElement = index;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_23:
      return retCode;
    }

    public static int TypPriceLookback()
    {
      return 0;
    }

    public static Core.RetCode TypPrice(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = ((double) inHigh[index2] + (double) inLow[index2] + (double) inClose[index2]) / 3.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode TypPrice(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = (inHigh[index2] + inLow[index2] + inClose[index2]) / 3.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int UltOscLookback(
      int optInTimePeriod1,
      int optInTimePeriod2,
      int optInTimePeriod3)
    {
      int num;
      if (optInTimePeriod1 == int.MinValue)
        optInTimePeriod1 = 7;
      else if (optInTimePeriod1 < 1 || optInTimePeriod1 > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInTimePeriod2 == int.MinValue)
        optInTimePeriod2 = 14;
      else if (optInTimePeriod2 < 1 || optInTimePeriod2 > 100000)
      {
        num = -1;
        goto label_13;
      }
      if (optInTimePeriod3 == int.MinValue)
        optInTimePeriod3 = 28;
      else if (optInTimePeriod3 < 1 || optInTimePeriod3 > 100000)
      {
        num = -1;
        goto label_13;
      }
      num = Core.SmaLookback((optInTimePeriod1 <= optInTimePeriod2 ? optInTimePeriod2 : optInTimePeriod1) <= optInTimePeriod3 ? optInTimePeriod3 : (optInTimePeriod1 <= optInTimePeriod2 ? optInTimePeriod2 : optInTimePeriod1)) + 1;
label_13:
      return num;
    }

    public static Core.RetCode UltOsc(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod1,
      int optInTimePeriod2,
      int optInTimePeriod3,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      int[] numArray1 = new int[3];
      int[] numArray2 = new int[3];
      int[] numArray3 = new int[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod1 == int.MinValue)
          optInTimePeriod1 = 7;
        else if (optInTimePeriod1 < 1 || optInTimePeriod1 > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_79;
        }
        if (optInTimePeriod2 == int.MinValue)
          optInTimePeriod2 = 14;
        else if (optInTimePeriod2 < 1 || optInTimePeriod2 > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_79;
        }
        if (optInTimePeriod3 == int.MinValue)
          optInTimePeriod3 = 28;
        else if (optInTimePeriod3 < 1 || optInTimePeriod3 > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_79;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          numArray2[0] = optInTimePeriod1;
          numArray2[1] = optInTimePeriod2;
          numArray2[2] = optInTimePeriod3;
          numArray1[0] = 0;
          numArray1[1] = 0;
          numArray1[2] = 0;
          for (int index1 = 0; index1 < 3; ++index1)
          {
            int num = 0;
            int index2 = 0;
            for (int index3 = 0; index3 < 3; ++index3)
            {
              if (numArray1[index3] != 0 || numArray2[index3] <= num)
                continue;
              num = numArray2[index3];
              index2 = index3;
            }
            numArray1[index2] = 1;
            numArray3[index1] = num;
          }
          optInTimePeriod1 = numArray3[2];
          optInTimePeriod2 = numArray3[1];
          optInTimePeriod3 = numArray3[0];
          int num1 = Core.UltOscLookback(optInTimePeriod1, optInTimePeriod2, optInTimePeriod3);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            for (int index = startIdx - optInTimePeriod1 + 1; index < startIdx; ++index)
            {
              double num4 = (double) inLow[index];
              double num5 = (double) inHigh[index];
              double num6 = (double) inClose[index - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = (double) inClose[index] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              num2 += num8;
              num3 += num9;
            }
            double num12 = 0.0;
            double num13 = 0.0;
            for (int index = startIdx - optInTimePeriod2 + 1; index < startIdx; ++index)
            {
              double num4 = (double) inLow[index];
              double num5 = (double) inHigh[index];
              double num6 = (double) inClose[index - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = (double) inClose[index] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              num12 += num8;
              num13 += num9;
            }
            double num14 = 0.0;
            double num15 = 0.0;
            for (int index = startIdx - optInTimePeriod3 + 1; index < startIdx; ++index)
            {
              double num4 = (double) inLow[index];
              double num5 = (double) inHigh[index];
              double num6 = (double) inClose[index - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = (double) inClose[index] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              num14 += num8;
              num15 += num9;
            }
            int index1 = startIdx;
            int index2 = 0;
            int index3 = index1 - optInTimePeriod1 + 1;
            int index4 = index1 - optInTimePeriod2 + 1;
            int index5 = index1 - optInTimePeriod3 + 1;
            while (index1 <= endIdx)
            {
              double num4 = (double) inLow[index1];
              double num5 = (double) inHigh[index1];
              double num6 = (double) inClose[index1 - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = (double) inClose[index1] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              double num16 = num2 + num8;
              double num17 = num12 + num8;
              double num18 = num14 + num8;
              double num19 = num3 + num9;
              double num20 = num13 + num9;
              double num21 = num15 + num9;
              double num22 = 0.0;
              if (-1E-08 >= num19 || num19 >= 1E-08)
                num22 += 4.0 * (num16 / num19);
              if (-1E-08 >= num20 || num20 >= 1E-08)
                num22 += 2.0 * (num17 / num20);
              if (-1E-08 >= num21 || num21 >= 1E-08)
                num22 += num18 / num21;
              double num23 = (double) inLow[index3];
              double num24 = (double) inHigh[index3];
              double num25 = (double) inClose[index3 - 1];
              double num26 = num23 >= num25 ? num25 : num23;
              double num27 = (double) inClose[index3] - num26;
              double num28 = num24 - num23;
              double num29 = Math.Abs(num25 - num24);
              if (num29 > num28)
                num28 = num29;
              double num30 = Math.Abs(num25 - num23);
              if (num30 > num28)
                num28 = num30;
              num2 = num16 - num27;
              num3 = num19 - num28;
              double num31 = (double) inLow[index4];
              double num32 = (double) inHigh[index4];
              double num33 = (double) inClose[index4 - 1];
              double num34 = num31 >= num33 ? num33 : num31;
              double num35 = (double) inClose[index4] - num34;
              double num36 = num32 - num31;
              double num37 = Math.Abs(num33 - num32);
              if (num37 > num36)
                num36 = num37;
              double num38 = Math.Abs(num33 - num31);
              if (num38 > num36)
                num36 = num38;
              num12 = num17 - num35;
              num13 = num20 - num36;
              double num39 = (double) inLow[index5];
              double num40 = (double) inHigh[index5];
              double num41 = (double) inClose[index5 - 1];
              double num42 = num39 >= num41 ? num41 : num39;
              double num43 = (double) inClose[index5] - num42;
              double num44 = num40 - num39;
              double num45 = Math.Abs(num41 - num40);
              if (num45 > num44)
                num44 = num45;
              double num46 = Math.Abs(num41 - num39);
              if (num46 > num44)
                num44 = num46;
              num14 = num18 - num43;
              num15 = num21 - num44;
              outReal[index2] = 100.0 * (num22 / 7.0);
              ++index2;
              ++index1;
              ++index3;
              ++index4;
              ++index5;
            }
            outNBElement = index2;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_79:
      return retCode;
    }

    public static Core.RetCode UltOsc(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod1,
      int optInTimePeriod2,
      int optInTimePeriod3,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      int[] numArray1 = new int[3];
      int[] numArray2 = new int[3];
      int[] numArray3 = new int[3];
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod1 == int.MinValue)
          optInTimePeriod1 = 7;
        else if (optInTimePeriod1 < 1 || optInTimePeriod1 > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_79;
        }
        if (optInTimePeriod2 == int.MinValue)
          optInTimePeriod2 = 14;
        else if (optInTimePeriod2 < 1 || optInTimePeriod2 > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_79;
        }
        if (optInTimePeriod3 == int.MinValue)
          optInTimePeriod3 = 28;
        else if (optInTimePeriod3 < 1 || optInTimePeriod3 > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_79;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          outBegIdx = 0;
          outNBElement = 0;
          numArray2[0] = optInTimePeriod1;
          numArray2[1] = optInTimePeriod2;
          numArray2[2] = optInTimePeriod3;
          numArray1[0] = 0;
          numArray1[1] = 0;
          numArray1[2] = 0;
          for (int index1 = 0; index1 < 3; ++index1)
          {
            int num = 0;
            int index2 = 0;
            for (int index3 = 0; index3 < 3; ++index3)
            {
              if (numArray1[index3] != 0 || numArray2[index3] <= num)
                continue;
              num = numArray2[index3];
              index2 = index3;
            }
            numArray1[index2] = 1;
            numArray3[index1] = num;
          }
          optInTimePeriod1 = numArray3[2];
          optInTimePeriod2 = numArray3[1];
          optInTimePeriod3 = numArray3[0];
          int num1 = Core.UltOscLookback(optInTimePeriod1, optInTimePeriod2, optInTimePeriod3);
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            retCode = Core.RetCode.Success;
          }
          else
          {
            double num2 = 0.0;
            double num3 = 0.0;
            for (int index = startIdx - optInTimePeriod1 + 1; index < startIdx; ++index)
            {
              double num4 = inLow[index];
              double num5 = inHigh[index];
              double num6 = inClose[index - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = inClose[index] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              num2 += num8;
              num3 += num9;
            }
            double num12 = 0.0;
            double num13 = 0.0;
            for (int index = startIdx - optInTimePeriod2 + 1; index < startIdx; ++index)
            {
              double num4 = inLow[index];
              double num5 = inHigh[index];
              double num6 = inClose[index - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = inClose[index] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              num12 += num8;
              num13 += num9;
            }
            double num14 = 0.0;
            double num15 = 0.0;
            for (int index = startIdx - optInTimePeriod3 + 1; index < startIdx; ++index)
            {
              double num4 = inLow[index];
              double num5 = inHigh[index];
              double num6 = inClose[index - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = inClose[index] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              num14 += num8;
              num15 += num9;
            }
            int index1 = startIdx;
            int index2 = 0;
            int index3 = index1 - optInTimePeriod1 + 1;
            int index4 = index1 - optInTimePeriod2 + 1;
            int index5 = index1 - optInTimePeriod3 + 1;
            while (index1 <= endIdx)
            {
              double num4 = inLow[index1];
              double num5 = inHigh[index1];
              double num6 = inClose[index1 - 1];
              double num7 = num4 >= num6 ? num6 : num4;
              double num8 = inClose[index1] - num7;
              double num9 = num5 - num4;
              double num10 = Math.Abs(num6 - num5);
              if (num10 > num9)
                num9 = num10;
              double num11 = Math.Abs(num6 - num4);
              if (num11 > num9)
                num9 = num11;
              double num16 = num2 + num8;
              double num17 = num12 + num8;
              double num18 = num14 + num8;
              double num19 = num3 + num9;
              double num20 = num13 + num9;
              double num21 = num15 + num9;
              double num22 = 0.0;
              if (-1E-08 >= num19 || num19 >= 1E-08)
                num22 += 4.0 * (num16 / num19);
              if (-1E-08 >= num20 || num20 >= 1E-08)
                num22 += 2.0 * (num17 / num20);
              if (-1E-08 >= num21 || num21 >= 1E-08)
                num22 += num18 / num21;
              double num23 = inLow[index3];
              double num24 = inHigh[index3];
              double num25 = inClose[index3 - 1];
              double num26 = num23 >= num25 ? num25 : num23;
              double num27 = inClose[index3] - num26;
              double num28 = num24 - num23;
              double num29 = Math.Abs(num25 - num24);
              if (num29 > num28)
                num28 = num29;
              double num30 = Math.Abs(num25 - num23);
              if (num30 > num28)
                num28 = num30;
              num2 = num16 - num27;
              num3 = num19 - num28;
              double num31 = inLow[index4];
              double num32 = inHigh[index4];
              double num33 = inClose[index4 - 1];
              double num34 = num31 >= num33 ? num33 : num31;
              double num35 = inClose[index4] - num34;
              double num36 = num32 - num31;
              double num37 = Math.Abs(num33 - num32);
              if (num37 > num36)
                num36 = num37;
              double num38 = Math.Abs(num33 - num31);
              if (num38 > num36)
                num36 = num38;
              num12 = num17 - num35;
              num13 = num20 - num36;
              double num39 = inLow[index5];
              double num40 = inHigh[index5];
              double num41 = inClose[index5 - 1];
              double num42 = num39 >= num41 ? num41 : num39;
              double num43 = inClose[index5] - num42;
              double num44 = num40 - num39;
              double num45 = Math.Abs(num41 - num40);
              if (num45 > num44)
                num44 = num45;
              double num46 = Math.Abs(num41 - num39);
              if (num46 > num44)
                num44 = num46;
              num14 = num18 - num43;
              num15 = num21 - num44;
              outReal[index2] = 100.0 * (num22 / 7.0);
              ++index2;
              ++index1;
              ++index3;
              ++index4;
              ++index5;
            }
            outNBElement = index2;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_79:
      return retCode;
    }

    public static int VarianceLookback(int optInTimePeriod, double optInNbDev)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 5;
      else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_9;
      }
      if (optInNbDev == -4E+37)
        optInNbDev = 1.0;
      else if (optInNbDev < -3E+37 || optInNbDev > 3E+37)
      {
        num = -1;
        goto label_9;
      }
      num = optInTimePeriod - 1;
label_9:
      return num;
    }

    public static Core.RetCode Variance(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      double optInNbDev,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_15;
        }
        if (optInNbDev == -4E+37)
          optInNbDev = 1.0;
        else if (optInNbDev < -3E+37 || optInNbDev > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_15;
        }
        retCode = outReal != null ? Core.TA_INT_VAR(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal) : Core.RetCode.BadParam;
      }
label_15:
      return retCode;
    }

    public static Core.RetCode Variance(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      double optInNbDev,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 5;
        else if (optInTimePeriod < 1 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_15;
        }
        if (optInNbDev == -4E+37)
          optInNbDev = 1.0;
        else if (optInNbDev < -3E+37 || optInNbDev > 3E+37)
        {
          retCode = Core.RetCode.BadParam;
          goto label_15;
        }
        retCode = outReal != null ? Core.TA_INT_VAR(startIdx, endIdx, inReal, optInTimePeriod, out outBegIdx, out outNBElement, outReal) : Core.RetCode.BadParam;
      }
label_15:
      return retCode;
    }

    public static int WclPriceLookback()
    {
      return 0;
    }

    public static Core.RetCode WclPrice(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = ((double) inHigh[index2] + (double) inLow[index2] + (double) inClose[index2] * 2.0) / 4.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static Core.RetCode WclPrice(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
        retCode = Core.RetCode.BadParam;
      else if (outReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        int index1 = 0;
        for (int index2 = startIdx; index2 <= endIdx; ++index2)
        {
          outReal[index1] = (inHigh[index2] + inLow[index2] + inClose[index2] * 2.0) / 4.0;
          ++index1;
        }
        outNBElement = index1;
        outBegIdx = startIdx;
        retCode = Core.RetCode.Success;
      }
      return retCode;
    }

    public static int WillRLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 14;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode WillR(
      int startIdx,
      int endIdx,
      float[] inHigh,
      float[] inLow,
      float[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_39;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            int index4 = index3;
            double num3 = 0.0;
            double num4 = num3;
            double num5 = num4;
            for (; index2 <= endIdx; ++index2)
            {
              double num6 = (double) inLow[index2];
              if (index4 < num2)
              {
                index4 = num2;
                num3 = (double) inLow[index4];
                int index5 = index4;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = (double) inLow[index5];
                    else
                      goto label_23;
                  }
                  while (num7 >= num3);
                  index4 = index5;
                  num3 = num7;
                }
label_23:
                num5 = (num4 - num3) / -100.0;
              }
              else if (num6 <= num3)
              {
                index4 = index2;
                num3 = num6;
                num5 = (num4 - num3) / -100.0;
              }
              double num8 = (double) inHigh[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num4 = (double) inHigh[index3];
                int index5 = index3;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = (double) inHigh[index5];
                    else
                      goto label_31;
                  }
                  while (num7 <= num4);
                  index3 = index5;
                  num4 = num7;
                }
label_31:
                num5 = (num4 - num3) / -100.0;
              }
              else if (num8 >= num4)
              {
                index3 = index2;
                num4 = num8;
                num5 = (num4 - num3) / -100.0;
              }
              if (num5 != 0.0)
              {
                outReal[index1] = (num4 - (double) inClose[index2]) / num5;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_39:
      return retCode;
    }

    public static Core.RetCode WillR(
      int startIdx,
      int endIdx,
      double[] inHigh,
      double[] inLow,
      double[] inClose,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inHigh == null || inLow == null || inClose == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 14;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_39;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else
          {
            int index1 = 0;
            int index2 = startIdx;
            int num2 = startIdx - num1;
            int index3 = -1;
            int index4 = index3;
            double num3 = 0.0;
            double num4 = num3;
            double num5 = num4;
            for (; index2 <= endIdx; ++index2)
            {
              double num6 = inLow[index2];
              if (index4 < num2)
              {
                index4 = num2;
                num3 = inLow[index4];
                int index5 = index4;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = inLow[index5];
                    else
                      goto label_23;
                  }
                  while (num7 >= num3);
                  index4 = index5;
                  num3 = num7;
                }
label_23:
                num5 = (num4 - num3) / -100.0;
              }
              else if (num6 <= num3)
              {
                index4 = index2;
                num3 = num6;
                num5 = (num4 - num3) / -100.0;
              }
              double num8 = inHigh[index2];
              if (index3 < num2)
              {
                index3 = num2;
                num4 = inHigh[index3];
                int index5 = index3;
                while (true)
                {
                  double num7;
                  do
                  {
                    ++index5;
                    if (index5 <= index2)
                      num7 = inHigh[index5];
                    else
                      goto label_31;
                  }
                  while (num7 <= num4);
                  index3 = index5;
                  num4 = num7;
                }
label_31:
                num5 = (num4 - num3) / -100.0;
              }
              else if (num8 >= num4)
              {
                index3 = index2;
                num4 = num8;
                num5 = (num4 - num3) / -100.0;
              }
              if (num5 != 0.0)
              {
                outReal[index1] = (num4 - inClose[index2]) / num5;
                ++index1;
              }
              else
              {
                outReal[index1] = 0.0;
                ++index1;
              }
              ++num2;
            }
            outBegIdx = startIdx;
            outNBElement = index1;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_39:
      return retCode;
    }

    public static int WmaLookback(int optInTimePeriod)
    {
      int num;
      if (optInTimePeriod == int.MinValue)
        optInTimePeriod = 30;
      else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
      {
        num = -1;
        goto label_5;
      }
      num = optInTimePeriod - 1;
label_5:
      return num;
    }

    public static Core.RetCode Wma(
      int startIdx,
      int endIdx,
      float[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_25;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else if (optInTimePeriod == 1)
          {
            outBegIdx = startIdx;
            outNBElement = endIdx - startIdx + 1;
            Array.Copy((Array) inReal, startIdx, (Array) outReal, 0, outNBElement);
            retCode = Core.RetCode.Success;
          }
          else
          {
            int num2 = optInTimePeriod;
            int num3 = num2 * (num2 + 1) >> 1;
            int index1 = 0;
            int index2 = startIdx - num1;
            double num4 = 0.0;
            double num5 = num4;
            int index3 = index2;
            int num6 = 1;
            while (index3 < startIdx)
            {
              double num7 = (double) inReal[index3];
              ++index3;
              num4 += num7;
              num5 += num7 * (double) num6;
              ++num6;
            }
            double num8 = 0.0;
            while (index3 <= endIdx)
            {
              double num7 = (double) inReal[index3];
              ++index3;
              num4 = num4 + num7 - num8;
              double num9 = num5 + num7 * (double) optInTimePeriod;
              num8 = (double) inReal[index2];
              ++index2;
              outReal[index1] = num9 / (double) num3;
              ++index1;
              num5 = num9 - num4;
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_25:
      return retCode;
    }

    public static Core.RetCode Wma(
      int startIdx,
      int endIdx,
      double[] inReal,
      int optInTimePeriod,
      out int outBegIdx,
      out int outNBElement,
      double[] outReal)
    {
      Core.RetCode retCode;
      if (startIdx < 0)
        retCode = Core.RetCode.OutOfRangeStartIndex;
      else if (endIdx < 0 || endIdx < startIdx)
        retCode = Core.RetCode.OutOfRangeEndIndex;
      else if (inReal == null)
      {
        retCode = Core.RetCode.BadParam;
      }
      else
      {
        if (optInTimePeriod == int.MinValue)
          optInTimePeriod = 30;
        else if (optInTimePeriod < 2 || optInTimePeriod > 100000)
        {
          retCode = Core.RetCode.BadParam;
          goto label_25;
        }
        if (outReal == null)
        {
          retCode = Core.RetCode.BadParam;
        }
        else
        {
          int num1 = optInTimePeriod - 1;
          if (startIdx < num1)
            startIdx = num1;
          if (startIdx > endIdx)
          {
            outBegIdx = 0;
            outNBElement = 0;
            retCode = Core.RetCode.Success;
          }
          else if (optInTimePeriod == 1)
          {
            outBegIdx = startIdx;
            outNBElement = endIdx - startIdx + 1;
            Array.Copy((Array) inReal, startIdx, (Array) outReal, 0, outNBElement);
            retCode = Core.RetCode.Success;
          }
          else
          {
            int num2 = optInTimePeriod;
            int num3 = num2 * (num2 + 1) >> 1;
            int index1 = 0;
            int index2 = startIdx - num1;
            double num4 = 0.0;
            double num5 = num4;
            int index3 = index2;
            int num6 = 1;
            while (index3 < startIdx)
            {
              double num7 = inReal[index3];
              ++index3;
              num4 += num7;
              num5 += num7 * (double) num6;
              ++num6;
            }
            double num8 = 0.0;
            while (index3 <= endIdx)
            {
              double num7 = inReal[index3];
              ++index3;
              num4 = num4 + num7 - num8;
              double num9 = num5 + num7 * (double) optInTimePeriod;
              num8 = inReal[index2];
              ++index2;
              outReal[index1] = num9 / (double) num3;
              ++index1;
              num5 = num9 - num4;
            }
            outNBElement = index1;
            outBegIdx = startIdx;
            retCode = Core.RetCode.Success;
          }
        }
      }
label_25:
      return retCode;
    }

    public enum RetCode
    {
      Success = 0,
      LibNotInitialize = 1,
      BadParam = 2,
      AllocErr = 3,
      GroupNotFound = 4,
      FuncNotFound = 5,
      InvalidHandle = 6,
      InvalidParamHolder = 7,
      InvalidParamHolderType = 8,
      InvalidParamFunction = 9,
      InputNotAllInitialize = 10, // 0x0000000A
      OutputNotAllInitialize = 11, // 0x0000000B
      OutOfRangeStartIndex = 12, // 0x0000000C
      OutOfRangeEndIndex = 13, // 0x0000000D
      InvalidListType = 14, // 0x0000000E
      BadObject = 15, // 0x0000000F
      NotSupported = 16, // 0x00000010
      InternalError = 5000, // 0x00001388
      UnknownErr = 65535, // 0x0000FFFF
    }

    public enum Compatibility
    {
      Default,
      Metastock,
    }

    public enum MAType
    {
      Sma,
      Ema,
      Wma,
      Dema,
      Tema,
      Trima,
      Kama,
      Mama,
      T3,
    }

    public enum FuncUnstId
    {
      FuncUnstNone = -1, // 0xFFFFFFFF
      Adx = 0,
      Adxr = 1,
      Atr = 2,
      Cmo = 3,
      Dx = 4,
      Ema = 5,
      HtDcPeriod = 6,
      HtDcPhase = 7,
      HtPhasor = 8,
      HtSine = 9,
      HtTrendline = 10, // 0x0000000A
      HtTrendMode = 11, // 0x0000000B
      Kama = 12, // 0x0000000C
      Mama = 13, // 0x0000000D
      Mfi = 14, // 0x0000000E
      MinusDI = 15, // 0x0000000F
      MinusDM = 16, // 0x00000010
      Natr = 17, // 0x00000011
      PlusDI = 18, // 0x00000012
      PlusDM = 19, // 0x00000013
      Rsi = 20, // 0x00000014
      StochRsi = 21, // 0x00000015
      T3 = 22, // 0x00000016
      FuncUnstAll = 23, // 0x00000017
    }

    public enum RangeType
    {
      RealBody,
      HighLow,
      Shadows,
    }

    public enum CandleSettingType
    {
      BodyLong,
      BodyVeryLong,
      BodyShort,
      BodyDoji,
      ShadowLong,
      ShadowVeryLong,
      ShadowShort,
      ShadowVeryShort,
      Near,
      Far,
      Equal,
      AllCandleSettings,
    }

    private sealed class CandleSetting
    {
      public Core.CandleSettingType settingType;
      public Core.RangeType rangeType;
      public int avgPeriod;
      public double factor;
    }

    private sealed class GlobalsType
    {
      public Core.Compatibility compatibility;
      public uint[] unstablePeriod;
      public Core.CandleSetting[] candleSettings;

      public GlobalsType()
      {
        this.unstablePeriod = new uint[23];
        this.compatibility = Core.Compatibility.Default;
        for (int index = 0; index < 23; ++index)
          this.unstablePeriod[index] = 0U;
        this.candleSettings = new Core.CandleSetting[11];
        for (int index = 0; index < this.candleSettings.Length; ++index)
          this.candleSettings[index] = new Core.CandleSetting();
      }
    }
  }
}
